/* Copyright Fritz Lekschas: D3 layout for list-based graphs */
!function(t){"use strict";function e(t){return"number"==typeof t&&_(t)}function i(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function n(t){return i(t)&&y.call(t)==m}function s(t){return!!t&&"object"==typeof t}function o(t){return null==t?!1:n(t)?P.test(O.call(t)):s(t)&&v.test(t)}function r(t,e){var i=null==t?void 0:t[e];return o(i)?i:void 0}function a(t){return"number"==typeof t&&t>-1&&t%1==0&&j>=t}function h(t,e,n,s,o,r,a){function h(t){if(t.data.bars)if(A(t.data.bars)){t.data.barRefs={};for(var e=t.data.bars.length;e--;)t.data.bars[e].value=Math.max(Math.min(t.data.bars[e].value,1),0),t.data.barRefs[t.data.bars[e].id]=t.data.bars[e].value}else if(i(t.data.bars)){var n=[],s=Object.keys(t.data.bars);t.data.barRefs={};for(var e=s.length;e--;)t.data.barRefs[s[e]]=Math.max(Math.min(t.data.bars[s[e]],1),0),n.push({id:s[e],value:t.data.barRefs[s[e]]});t.data.bars=n}}function l(e,i,o,l){var d=e,u=i;l?o.depth+1!==i.depth&&(m=e+"."+i.clones.length+1,t[m]={children:[],clone:!0,cloneId:i.clones.length+1,data:i.data,originalId:e,originalNode:i},d=m,u=t[m],i.clones.push(u)):u.clones=[],u.id=d,u.parent||(u.parent=[]),o&&u.parent.push(o),u.childRefs||(u.childRefs=[]),o?(u.depth=o.depth+1,o.childRefs.push(u)):u.depth=0,u.links||(u.links=[]),n[u.depth]||(n[u.depth]={},s[u.depth]=[]),n[u.depth][d]||(n[u.depth][d]=!0,s[u.depth].push(u),u.x=r(u.depth),u.y=a(Object.keys(n[u.depth]).length-1)),h(u),o&&c(o,u)}function c(t,e){t.links.push({id:"("+t.id+")->("+e.id+")",source:{node:t,offsetX:0,offsetY:0},target:{node:e,offsetX:0,offsetY:0}})}for(var d=void 0,u=void 0,f=void 0,g=void 0,p=void 0,b={},_=[],m=void 0,w=e.length;w--;){if(!t[e[w]])return;for(l(e[w],t[e[w]]),_.push(e[w]),b[e[w]]=!0;_.length>0;)for(p=t[_.shift()],d=p.children.length;d--;)f=p.children[d],u=t[f],u&&(b[f]?g=!0:(_.push(f),b[f]=!0,g=!1),l(f,u,p,g))}}var l={};l.classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},l.createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l.inherits=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},l.possibleConstructorReturn=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e};var c={"function":!0,object:!0},d=c[typeof exports]&&exports&&!exports.nodeType&&exports,u=c[typeof module]&&module&&!module.nodeType&&module,f=d&&u&&"object"==typeof global&&global&&global.Object&&global,g=c[typeof self]&&self&&self.Object&&self,p=c[typeof window]&&window&&window.Object&&window,b=f||p!==(this&&this.window)&&p||g||this,_=b.isFinite,m="[object Function]",w=Object.prototype,y=w.toString,v=/^\[object .+?Constructor\]$/,k=Object.prototype,O=Function.prototype.toString,C=k.hasOwnProperty,P=RegExp("^"+O.call(C).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),j=9007199254740991,R="[object Array]",I=Object.prototype,x=I.toString,z=r(Array,"isArray"),A=z||function(t){return s(t)&&a(t.length)&&x.call(t)==R},M=function(t){function e(t){l.classCallCheck(this,e);var i=l.possibleConstructorReturn(this,Object.getPrototypeOf(e).call(this,t));return i.name=i.constructor.name,i.message=t,Error.captureStackTrace(i,i.constructor.name),i}return l.inherits(e,t),e}(Error),S=function(t){function e(t){return l.classCallCheck(this,e),l.possibleConstructorReturn(this,Object.getPrototypeOf(e).call(this,t||"No root node IDs specified."))}return l.inherits(e,t),e}(M),H={width:300,height:300},W={columns:3,rows:3},N=.2,T=.05,E=.05,$=function(){function n(e,i){l.classCallCheck(this,n),this.scale={x:t.scale.linear(),y:t.scale.linear()},this._colRelPadding=N,this._rowRelPadding=T,this._cellRelInnerPadding=E,this._grid={columns:W.columns,rows:W.rows},this._size={width:H.width,height:H.height},this.grid(i),this.size(e),this.columnCache={},this.columns={},this.columnNodeOrder={}}return l.createClass(n,[{key:"nodesToMatrix",value:function(t){var i=[],n=void 0,s=0,o=Object.keys(this.columnCache).length;e(t)&&(s=t,o=t+1);for(var r=s;o>r;r++){i.push({y:0,x:this.scale.x(r),level:r,rows:[]}),n=Object.keys(this.columnCache[r]);for(var a=n.length;a--;)i[r-s].rows.push(this.data[n[a]])}return i}},{key:"process",value:function(t,i){if(this.data=t||this.data,this.rootIds=i||this.rootIds,!A(this.rootIds)){if(!e(this.rootIds))throw new S("No root node IDs specified.");this.rootIds=[this.rootIds]}return h(this.data,this.rootIds,this.columnCache,this.columnNodeOrder,this.links,this.scale.x,this.scale.y),{global:this.compileGlobalProps(),nodes:this.nodesToMatrix()}}},{key:"sort",value:function(t,i,n){var s=0,o=this.columnCache.length,r=void 0;switch(n=1===n?1:-1,i){case"precision":r=function(t){return t.data.barRefs.precision};break;case"recall":r=function(t){return t.data.barRefs.recall};break;default:r=function(t){return t.data.name.toLowerCase()}}for(e(t)&&(s=t,o=t+1),s;o>s;s++){this.columnNodeOrder[s].sort(function(t,e){var i=r(t),s=r(e);return i>s?n:s>i?-n:0});for(var a=this.columnNodeOrder[s].length;a--;)this.columnNodeOrder[s][a].y=this.scale.y(a)}return this}},{key:"compileGlobalProps",value:function(){return{column:{width:this._columnWidth,height:this._size.height,padding:this._colAbsPadding,contentWidth:this._colAbsContentWidth},row:{height:this._rowHeight,padding:this._rowAbsPadding,contentHeight:this._rowAbsContentHeight},cell:{padding:this._cellAbsInnerPadding}}}},{key:"nodes",value:function(t){return this.nodesToMatrix(t)}},{key:"links",value:function(t,i){var n=[],s=[],o=void 0;if(e(t)){t=Math.max(t,0),i=e(i)?Math.min(i,Object.keys(this.columnCache).length):t+1;for(var r=t;i>r;r++)s=s.concat(Object.keys(this.columnCache[r]))}else s=Object.keys(this.data);for(var r=s.length;r--;){o=this.data[s[r]].links;for(var a=o.length;a--;)n.push(o[a])}return n}},{key:"offsetLinks",value:function(t,i,n){var s=this.links(t);if(("source"===n||"target"===n)&&e(i))for(var o=s.length;o--;)s[o][n].offsetY=i;return s}},{key:"grid",value:function(t){return arguments.length?(A(t)&&(this._grid.columns=parseInt(t[0])||this._grid.columns,this._grid.rows=parseInt(t[1])||this._grid.rows,this.updateScaling()),i(t)&&(this._grid.columns=parseInt(t.columns)||this._grid.columns,this._grid.rows=parseInt(t.rows)||this._grid.rows,this.updateScaling()),this):this._grid}},{key:"updateScaling",value:function(){return this.scale.x.domain([0,this._grid.columns]).range([0,this._size.width]),this.scale.y.domain([0,this._grid.rows]).range([0,this._size.height]),this._columnWidth=this._size.width/this._grid.columns,this._rowHeight=this._size.height/this._grid.rows,this._colAbsPadding=this._columnWidth*this._colRelPadding,this._colAbsContentWidth=this._columnWidth*(1-2*this._colRelPadding),this._rowAbsPadding=this._rowHeight*this._rowRelPadding,this._rowAbsContentHeight=this._rowHeight*(1-2*this._rowRelPadding),this._cellAbsInnerPadding=this._cellRelInnerPadding*Math.min(this._colAbsContentWidth,this._rowAbsContentHeight),this}},{key:"size",value:function(t){return arguments.length?(A(t)&&(this._size.width=parseInt(t[0])||this._size.width,this._size.height=parseInt(t[1])||this._size.height,this.updateScaling()),i(t)&&(this._size.width=parseInt(t.width)||this._size.width,this._size.height=parseInt(t.height)||this._size.height,this.updateScaling()),this):this._size}},{key:"columnPadding",value:function(t,i){return arguments.length?(e(t)&&(i&&e(this._columnWidth)&&(t/=this._columnWidth),this._colRelPadding=Math.max(Math.min(t,.66),.1),this.updateScaling()),this):this._colRelPadding}},{key:"rowPadding",value:function(t,i){return arguments.length?(e(t)&&(i&&e(this._rowHeight)&&(t/=this._rowHeight),this._rowRelPadding=Math.max(Math.min(t,.5),0),this.updateScaling()),this):this._rowRelPadding}}]),n}();t.layout.listGraph=$}(d3);
//# sourceMappingURL=d3.layout.listGraph.min.js.map
