/* Copyright Fritz Lekschas: D3 layout for list-based graphs */
var D3LayoutListGraph=function(t){"use strict";function i(t){return"number"==typeof t&&b(t)}function e(t){var i=typeof t;return!!t&&("object"==i||"function"==i)}function s(t){return e(t)&&m.call(t)==w}function n(t){return!!t&&"object"==typeof t}function o(t){return null==t?!1:s(t)?R.test(P.call(t)):n(t)&&v.test(t)}function h(t,i){var e=null==t?void 0:t[i];return o(e)?e:void 0}function a(t){return"number"==typeof t&&t>-1&&t%1==0&&I>=t}function r(t,i,s,n,o,h){function a(t){if(t.data.bars)if(O(t.data.bars)){t.data.barRefs={};for(var i=t.data.bars.length;i--;)t.data.bars[i].value=Math.max(Math.min(t.data.bars[i].value,1),0),t.data.barRefs[t.data.bars[i].id]=t.data.bars[i].value}else if(e(t.data.bars)){var s=[],n=Object.keys(t.data.bars);t.data.barRefs={};for(var i=n.length;i--;)t.data.barRefs[n[i]]=Math.max(Math.min(t.data.bars[n[i]],1),0),s.push({id:n[i],value:t.data.barRefs[n[i]]});t.data.bars=s}}function r(i,e,n,r){var d=i,c=e;r?(b=i+"."+e.clones.length+1,t[b]={children:[],clone:!0,cloneId:e.clones.length+1,data:e.data,originalId:i,originalNode:e},d=b,c=t[b],e.clones.push(c)):c.clones=[],c.parent=n,c.childRefs||(c.childRefs=[]),n?(c.depth=n.depth+1,n.childRefs.push(c)):c.depth=0,c.links||(c.links=[]),s[c.depth]||(s[c.depth]={}),s[c.depth][d]||(s[c.depth][d]=!0,c.x=o(c.depth),c.y=h(Object.keys(s[c.depth]).length-1)),a(c),n&&l(n,c)}function l(t,i){t.links.push({source:{x:t.x,y:t.y,offsetX:0,offsetY:0},target:{x:i.x,y:i.y,offsetX:0,offsetY:0}})}for(var d=void 0,c=void 0,u=void 0,g=void 0,f=void 0,p={},_=[],b=void 0,w=i.length;w--;){if(!t[i[w]])return;for(r(i[w],t[i[w]]),_.push(i[w]),p[i[w]]=!0;_.length>0;)for(f=t[_.shift()],d=f.children.length;d--;)u=f.children[d],c=t[u],c&&(p[u]?g=!0:(_.push(u),p[u]=!0,g=!1),r(u,c,f,g))}}t="default"in t?t["default"]:t;var l={};l.classCallCheck=function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")},l.createClass=function(){function t(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(i,e,s){return e&&t(i.prototype,e),s&&t(i,s),i}}();var d={"function":!0,object:!0},c=d[typeof exports]&&exports&&!exports.nodeType&&exports,u=d[typeof module]&&module&&!module.nodeType&&module,g=c&&u&&"object"==typeof global&&global&&global.Object&&global,f=d[typeof self]&&self&&self.Object&&self,p=d[typeof window]&&window&&window.Object&&window,_=g||p!==(this&&this.window)&&p||f||this,b=_.isFinite,w="[object Function]",y=Object.prototype,m=y.toString,v=/^\[object .+?Constructor\]$/,k=Object.prototype,P=Function.prototype.toString,x=k.hasOwnProperty,R=RegExp("^"+P.call(x).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),I=9007199254740991,j="[object Array]",C=Object.prototype,z=C.toString,A=h(Array,"isArray"),O=A||function(t){return n(t)&&a(t.length)&&z.call(t)==j},M={width:300,height:300},H={columns:3,rows:3},S=.2,W=.05,T=.05,$=function(){function s(i,e){l.classCallCheck(this,s),this.scale={x:t.scale.linear(),y:t.scale.linear()},this._colRelPadding=S,this._rowRelPadding=W,this._cellRelInnerPadding=T,this._grid={columns:H.columns,rows:H.rows},this._size={width:M.width,height:M.height},this.grid(e),this.size(i),this.columnCache={},this.columns={}}return l.createClass(s,[{key:"nodesToMatrix",value:function(){for(var t=[],i=void 0,e=Object.keys(this.columnCache).length,s=0;e>s;s++){t.push({y:0,x:this.scale.x(s),level:s,rows:[]}),i=Object.keys(this.columnCache[s]);for(var n=i.length;n--;)t[s].rows.push(this.data[i[n]])}return t}},{key:"process",value:function(t,i){return this.data=t||this.data,this.rootIds=i||this.rootIds,O(this.rootIds)||(this.rootIds=[this.rootIds]),r(this.data,this.rootIds,this.columnCache,this.links,this.scale.x,this.scale.y),{global:this.compileGlobalProps(),nodes:this.nodesToMatrix()}}},{key:"compileGlobalProps",value:function(){return{column:{width:this._columnWidth,height:this._size.height,padding:this._colAbsPadding,contentWidth:this._colAbsContentWidth},row:{height:this._rowHeight,padding:this._rowAbsPadding,contentHeight:this._rowAbsContentHeight},cell:{padding:this._cellAbsInnerPadding}}}},{key:"nodes",value:function(){return this.nodesToMatrix()}},{key:"links",value:function(t){var e=[],s=void 0,n=void 0,o=void 0;s=i(t)?this.columnCache[t]:this.data,n=s?Object.keys(s):[];for(var h=n.length;h--;){o=this.data[n[h]].links;for(var a=o.length;a--;)e.push(o[a])}return e}},{key:"offsetLinks",value:function(t,e,s){var n=this.links(t);if(("source"===s||"target"===s)&&i(e))for(var o=n.length;o--;)n[o][s].offsetY=e;return n}},{key:"grid",value:function(t){return arguments.length?(O(t)&&(this._grid.columns=parseInt(t[0])||this._grid.columns,this._grid.rows=parseInt(t[1])||this._grid.rows,this.updateScaling()),e(t)&&(this._grid.columns=parseInt(t.columns)||this._grid.columns,this._grid.rows=parseInt(t.rows)||this._grid.rows,this.updateScaling()),this):this._grid}},{key:"updateScaling",value:function(){return this.scale.x.domain([0,this._grid.columns]).range([0,this._size.width]),this.scale.y.domain([0,this._grid.rows]).range([0,this._size.height]),this._columnWidth=this._size.width/this._grid.columns,this._rowHeight=this._size.height/this._grid.rows,this._colAbsPadding=this._columnWidth*this._colRelPadding,this._colAbsContentWidth=this._columnWidth*(1-2*this._colRelPadding),this._rowAbsPadding=this._rowHeight*this._rowRelPadding,this._rowAbsContentHeight=this._rowHeight*(1-2*this._rowRelPadding),this._cellAbsInnerPadding=this._cellRelInnerPadding*Math.min(this._colAbsContentWidth,this._rowAbsContentHeight),this}},{key:"size",value:function(t){return arguments.length?(O(t)&&(this._size.width=parseInt(t[0])||this._size.width,this._size.height=parseInt(t[1])||this._size.height,this.updateScaling()),e(t)&&(this._size.width=parseInt(t.width)||this._size.width,this._size.height=parseInt(t.height)||this._size.height,this.updateScaling()),this):this._size}},{key:"columnPadding",value:function(t,e){return arguments.length?(i(t)&&(e&&i(this._columnWidth)&&(t/=this._columnWidth),this._colRelPadding=Math.max(Math.min(t,.66),.1),this.updateScaling()),this):this._colRelPadding}},{key:"rowPadding",value:function(t,e){return arguments.length?(i(t)&&(e&&i(this._rowHeight)&&(t/=this._rowHeight),this._rowRelPadding=Math.max(Math.min(t,.5),0),this.updateScaling()),this):this._rowRelPadding}}]),s}();return $}(d3);
//# sourceMappingURL=d3.layout.listGraph.min.js.map
