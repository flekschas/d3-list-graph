/* Copyright Fritz Lekschas: D3 layout for list-based graphs */
!function(t){"use strict";function e(t){return"number"==typeof t&&_(t)}function i(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function s(t){return i(t)&&m.call(t)==w}function n(t){return!!t&&"object"==typeof t}function o(t){return null==t?!1:s(t)?j.test(P.call(t)):n(t)&&v.test(t)}function r(t,e){var i=null==t?void 0:t[e];return o(i)?i:void 0}function h(t){return"number"==typeof t&&t>-1&&t%1==0&&R>=t}function a(t,e,s,n,o,r){function h(t){if(t.data.bars)if(A(t.data.bars)){t.data.barRefs={};for(var e=t.data.bars.length;e--;)t.data.bars[e].value=Math.max(Math.min(t.data.bars[e].value,1),0),t.data.barRefs[t.data.bars[e].id]=t.data.bars[e].value}else if(i(t.data.bars)){var s=[],n=Object.keys(t.data.bars);t.data.barRefs={};for(var e=n.length;e--;)t.data.barRefs[n[e]]=Math.max(Math.min(t.data.bars[n[e]],1),0),s.push({id:n[e],value:t.data.barRefs[n[e]]});t.data.bars=s}}function a(e,i,n,a){var c=e,d=i;a?(_=e+"."+i.clones.length+1,t[_]={children:[],clone:!0,cloneId:i.clones.length+1,data:i.data,originalId:e,originalNode:i},c=_,d=t[_],i.clones.push(d)):d.clones=[],d.parent=n,d.childRefs||(d.childRefs=[]),n?(d.depth=n.depth+1,n.childRefs.push(d)):d.depth=0,d.links||(d.links=[]),s[d.depth]||(s[d.depth]={}),s[d.depth][c]||(s[d.depth][c]=!0,d.x=o(d.depth),d.y=r(Object.keys(s[d.depth]).length-1)),h(d),n&&l(n,d)}function l(t,e){t.links.push({source:{x:t.x,y:t.y,offsetX:0,offsetY:0},target:{x:e.x,y:e.y,offsetX:0,offsetY:0}})}for(var c=void 0,d=void 0,u=void 0,f=void 0,g=void 0,p={},b=[],_=void 0,w=e.length;w--;){if(!t[e[w]])return;for(a(e[w],t[e[w]]),b.push(e[w]),p[e[w]]=!0;b.length>0;)for(g=t[b.shift()],c=g.children.length;c--;)u=g.children[c],d=t[u],d&&(p[u]?f=!0:(b.push(u),p[u]=!0,f=!1),a(u,d,g,f))}}var l={};l.classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},l.createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),l.inherits=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},l.possibleConstructorReturn=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e};var c={"function":!0,object:!0},d=c[typeof exports]&&exports&&!exports.nodeType&&exports,u=c[typeof module]&&module&&!module.nodeType&&module,f=d&&u&&"object"==typeof global&&global&&global.Object&&global,g=c[typeof self]&&self&&self.Object&&self,p=c[typeof window]&&window&&window.Object&&window,b=f||p!==(this&&this.window)&&p||g||this,_=b.isFinite,w="[object Function]",y=Object.prototype,m=y.toString,v=/^\[object .+?Constructor\]$/,k=Object.prototype,P=Function.prototype.toString,C=k.hasOwnProperty,j=RegExp("^"+P.call(C).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),R=9007199254740991,x="[object Array]",I=Object.prototype,O=I.toString,z=r(Array,"isArray"),A=z||function(t){return n(t)&&h(t.length)&&O.call(t)==x},M=function(t){function e(t){l.classCallCheck(this,e);var i=l.possibleConstructorReturn(this,Object.getPrototypeOf(e).call(this,t));return i.name=i.constructor.name,i.message=t,Error.captureStackTrace(i,i.constructor.name),i}return l.inherits(e,t),e}(Error),S=function(t){function e(t){return l.classCallCheck(this,e),l.possibleConstructorReturn(this,Object.getPrototypeOf(e).call(this,t||"No root node IDs specified."))}return l.inherits(e,t),e}(M),H={width:300,height:300},W={columns:3,rows:3},T=.2,E=.05,$=.05,F=function(){function s(e,i){l.classCallCheck(this,s),this.scale={x:t.scale.linear(),y:t.scale.linear()},this._colRelPadding=T,this._rowRelPadding=E,this._cellRelInnerPadding=$,this._grid={columns:W.columns,rows:W.rows},this._size={width:H.width,height:H.height},this.grid(i),this.size(e),this.columnCache={},this.columns={}}return l.createClass(s,[{key:"nodesToMatrix",value:function(){for(var t=[],e=void 0,i=Object.keys(this.columnCache).length,s=0;i>s;s++){t.push({y:0,x:this.scale.x(s),level:s,rows:[]}),e=Object.keys(this.columnCache[s]);for(var n=e.length;n--;)t[s].rows.push(this.data[e[n]])}return t}},{key:"process",value:function(t,i){if(this.data=t||this.data,this.rootIds=i||this.rootIds,!A(this.rootIds)){if(!e(this.rootIds))throw new S("No root node IDs specified.");this.rootIds=[this.rootIds]}return a(this.data,this.rootIds,this.columnCache,this.links,this.scale.x,this.scale.y),{global:this.compileGlobalProps(),nodes:this.nodesToMatrix()}}},{key:"compileGlobalProps",value:function(){return{column:{width:this._columnWidth,height:this._size.height,padding:this._colAbsPadding,contentWidth:this._colAbsContentWidth},row:{height:this._rowHeight,padding:this._rowAbsPadding,contentHeight:this._rowAbsContentHeight},cell:{padding:this._cellAbsInnerPadding}}}},{key:"nodes",value:function(){return this.nodesToMatrix()}},{key:"links",value:function(t){var i=[],s=void 0,n=void 0,o=void 0;s=e(t)?this.columnCache[t]:this.data,n=s?Object.keys(s):[];for(var r=n.length;r--;){o=this.data[n[r]].links;for(var h=o.length;h--;)i.push(o[h])}return i}},{key:"offsetLinks",value:function(t,i,s){var n=this.links(t);if(("source"===s||"target"===s)&&e(i))for(var o=n.length;o--;)n[o][s].offsetY=i;return n}},{key:"grid",value:function(t){return arguments.length?(A(t)&&(this._grid.columns=parseInt(t[0])||this._grid.columns,this._grid.rows=parseInt(t[1])||this._grid.rows,this.updateScaling()),i(t)&&(this._grid.columns=parseInt(t.columns)||this._grid.columns,this._grid.rows=parseInt(t.rows)||this._grid.rows,this.updateScaling()),this):this._grid}},{key:"updateScaling",value:function(){return this.scale.x.domain([0,this._grid.columns]).range([0,this._size.width]),this.scale.y.domain([0,this._grid.rows]).range([0,this._size.height]),this._columnWidth=this._size.width/this._grid.columns,this._rowHeight=this._size.height/this._grid.rows,this._colAbsPadding=this._columnWidth*this._colRelPadding,this._colAbsContentWidth=this._columnWidth*(1-2*this._colRelPadding),this._rowAbsPadding=this._rowHeight*this._rowRelPadding,this._rowAbsContentHeight=this._rowHeight*(1-2*this._rowRelPadding),this._cellAbsInnerPadding=this._cellRelInnerPadding*Math.min(this._colAbsContentWidth,this._rowAbsContentHeight),this}},{key:"size",value:function(t){return arguments.length?(A(t)&&(this._size.width=parseInt(t[0])||this._size.width,this._size.height=parseInt(t[1])||this._size.height,this.updateScaling()),i(t)&&(this._size.width=parseInt(t.width)||this._size.width,this._size.height=parseInt(t.height)||this._size.height,this.updateScaling()),this):this._size}},{key:"columnPadding",value:function(t,i){return arguments.length?(e(t)&&(i&&e(this._columnWidth)&&(t/=this._columnWidth),this._colRelPadding=Math.max(Math.min(t,.66),.1),this.updateScaling()),this):this._colRelPadding}},{key:"rowPadding",value:function(t,i){return arguments.length?(e(t)&&(i&&e(this._rowHeight)&&(t/=this._rowHeight),this._rowRelPadding=Math.max(Math.min(t,.5),0),this.updateScaling()),this):this._rowRelPadding}}]),s}();t.layout.listGraph=F}(d3);
//# sourceMappingURL=d3.layout.listGraph.min.js.map
