/* Copyright Fritz Lekschas: D3 example visualization app using the list-like graph layout */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("$"),require("d3")):"function"==typeof define&&define.amd?define(["$","d3"],e):t.ListGraph=e(t.$,t.d3)}(this,function(t,e){"use strict";function i(){this.__data__=[],this.size=0}function n(t,e){return t===e||t!==t&&e!==e}function s(t,e){for(var i=t.length;i--;)if(n(t[i][0],e))return i;return-1}function o(t){var e=this.__data__,i=s(e,t);if(i<0)return!1;var n=e.length-1;return i==n?e.pop():ze.call(e,i,1),--this.size,!0}function a(t){var e=this.__data__,i=s(e,t);return i<0?void 0:e[i][1]}function r(t){return s(this.__data__,t)>-1}function l(t,e){var i=this.__data__,n=s(i,t);return n<0?(++this.size,i.push([t,e])):i[n][1]=e,this}function c(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function h(){this.__data__=new c,this.size=0}function u(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i}function d(t){return this.__data__.get(t)}function v(t){return this.__data__.has(t)}function g(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function p(t){var e=g(t)?Pe.call(t):"";return e==Ee||e==Fe}function f(t){return!!Qe&&Qe in t}function b(t){if(null!=t){try{return Ue.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function y(t){if(!g(t)||f(t))return!1;var e=p(t)?ti:Je;return e.test(b(t))}function m(t,e){return null==t?void 0:t[e]}function k(t,e){var i=m(t,e);return y(i)?i:void 0}function w(){this.__data__=ii?ii(null):{},this.size=0}function x(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function D(t){var e=this.__data__;if(ii){var i=e[t];return i===ni?void 0:i}return oi.call(e,t)?e[t]:void 0}function _(t){var e=this.__data__;return ii?void 0!==e[t]:ri.call(e,t)}function S(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=ii&&void 0===e?li:e,this}function L(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function C(){this.size=0,this.__data__={hash:new L,map:new(ei||c),string:new L}}function N(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function B(t,e){var i=t.__data__;return N(e)?i["string"==typeof e?"string":"hash"]:i.map}function M(t){var e=B(this,t).delete(t);return this.size-=e?1:0,e}function A(t){return B(this,t).get(t)}function H(t){return B(this,t).has(t)}function O(t,e){var i=B(this,t),n=i.size;return i.set(t,e),this.size+=i.size==n?0:1,this}function R(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function j(t,e){var i=this.__data__;if(i instanceof c){var n=i.__data__;if(!ei||n.length<ci-1)return n.push([t,e]),this.size=++i.size,this;i=this.__data__=new R(n)}return i.set(t,e),this.size=i.size,this}function z(t){var e=this.__data__=new c(t);this.size=e.size}function E(t,e){for(var i=-1,n=t?t.length:0;++i<n&&e(t[i],i,t)!==!1;);return t}function F(t,e,i){"__proto__"==e&&hi?hi(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}function V(t,e,i){var s=t[e];di.call(t,e)&&n(s,i)&&(void 0!==i||e in t)||F(t,e,i)}function P(t,e,i,n){var s=!i;i||(i={});for(var o=-1,a=e.length;++o<a;){var r=e[o],l=n?n(i[r],t[r],r,i,t):void 0;void 0===l&&(l=t[r]),s?F(i,r,l):V(i,r,l)}return i}function I(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}function T(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=vi}function q(t){return null!=t&&T(t.length)&&!p(t)}function W(t){return null!=t&&"object"==typeof t}function Q(t){return W(t)&&q(t)}function G(t){return Q(t)&&fi.call(t,"callee")&&(!yi.call(t,"callee")||bi.call(t)==gi)}function U(t,e){return e=null==e?mi:e,!!e&&("number"==typeof t||ki.test(t))&&t>-1&&t%1==0&&t<e}function Y(t,e){var i=Re(t)||G(t)?I(t.length,String):[],n=i.length,s=!!n;for(var o in t)!e&&!xi.call(t,o)||s&&("length"==o||U(o,n))||i.push(o);return i}function J(t){var e=t&&t.constructor,i="function"==typeof e&&e.prototype||Di;return t===i}function X(t,e){return function(i){return t(e(i))}}function Z(t){if(!J(t))return _i(t);var e=[];for(var i in Object(t))Li.call(t,i)&&"constructor"!=i&&e.push(i);return e}function K(t){return q(t)?Y(t):Z(t)}function tt(t,e){return t&&P(e,K(e),t)}function et(t,e){if(e)return t.slice();var i=t.length,n=Ai?Ai(i):new t.constructor(i);return t.copy(n),n}function it(t,e){var i=-1,n=t.length;for(e||(e=Array(n));++i<n;)e[i]=t[i];return e}function nt(){return[]}function st(t,e){return P(t,Oi(t),e)}function ot(t,e){for(var i=-1,n=e.length,s=t.length;++i<n;)t[s+i]=e[i];return t}function at(t,e,i){var n=e(t);return Re(t)?n:ot(n,i(t))}function rt(t){return at(t,K,Oi)}function lt(t){return Vi.call(t)}function ct(t){var e=t.length,i=t.constructor(e);return e&&"string"==typeof t[0]&&nn.call(t,"index")&&(i.index=t.index,i.input=t.input),i}function ht(t){var e=new t.constructor(t.byteLength);return new sn(e).set(new sn(t)),e}function ut(t,e){var i=e?ht(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}function dt(t,e){return t.set(e[0],e[1]),t}function vt(t,e,i,n){var s=-1,o=t?t.length:0;for(n&&o&&(i=t[++s]);++s<o;)i=e(i,t[s],s,t);return i}function gt(t){var e=-1,i=Array(t.size);return t.forEach(function(t,n){i[++e]=[n,t]}),i}function pt(t,e,i){var n=e?i(gt(t),!0):gt(t);return vt(n,dt,new t.constructor)}function ft(t){var e=new t.constructor(t.source,on.exec(t));return e.lastIndex=t.lastIndex,e}function bt(t,e){return t.add(e),t}function yt(t){var e=-1,i=Array(t.size);return t.forEach(function(t){i[++e]=t}),i}function mt(t,e,i){var n=e?i(yt(t),!0):yt(t);return vt(n,bt,new t.constructor)}function kt(t){return ln?Object(ln.call(t)):{}}function wt(t,e){var i=e?ht(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}function xt(t,e,i,n){var s=t.constructor;switch(e){case bn:return ht(t);case cn:case hn:return new s((+t));case yn:return ut(t,n);case mn:case kn:case wn:case xn:case Dn:case _n:case Sn:case Ln:case Cn:return wt(t,n);case un:return pt(t,n,i);case dn:case pn:return new s(t);case vn:return ft(t);case gn:return mt(t,n,i);case fn:return kt(t)}}function Dt(t){return"function"!=typeof t.constructor||J(t)?{}:Bn(Mn(t))}function _t(){return!1}function St(t,e,i,n,s,o,a){var r;if(n&&(r=o?n(t,s,o,a):n(t)),void 0!==r)return r;if(!g(t))return t;var l=Re(t);if(l){if(r=ct(t),!e)return it(t,r)}else{var c=tn(t),h=c==Tn||c==qn;if(zn(t))return et(t,e);if(c==Gn||c==En||h&&!o){if(r=Dt(h?{}:t),!e)return st(t,tt(r,t))}else{if(!cs[c])return o?t:{};r=xt(t,c,St,e)}}a||(a=new z);var u=a.get(t);if(u)return u;if(a.set(t,r),!l)var d=i?rt(t):K(t);return E(d||t,function(s,o){d&&(o=s,s=t[o]),V(r,o,St(s,e,i,n,o,t,a))}),r}function Lt(t){return St(t,!0,!0)}function Ct(t){return"number"==typeof t&&Ys(t)}function Nt(t,e){var i=t;if(t.clone&&(i=t.originalNode,e))return[];var n=[i];return i.clones.length&&(n=n.concat(i.clones)),n}function Bt(t,e,i,n,s,o){if(o[t.id])return void(o[t.id][s.id]||e(t,s));for(var a=n?Nt(t):[t],r=a.length;r--;)if(o[a[r].id]={},s&&(e(a[r],s),o[a[r].id][s.id]=!0),!Ct(i)||i>0)for(var l=Object.keys(a[r].parents),c=l.length;c--;)Bt(a[r].parents[l[c]],e,i-1,n,a[r],o)}function Mt(t,e,i,n){var s={};Bt(t,e,i,n,void 0,s)}function At(t,e,i,n,s){if(!s[t.id])for(var o=n?Nt(t):[t],a=o.length;a--;)if(e(o[a]),s[o[a].id]=!0,0===a&&(!Ct(i)||i>0))for(var r=o[a].childRefs.length;r--;)At(o[a].childRefs[r],e,i-1,n,s)}function Ht(t,e,i,n){var s={};At(t,e,i,n,s)}function Ot(t,e,i,n,s){if(i)Mt(t,e,n,s),Ht(t,i,n,s);else{var o={};Mt(t,e,n,s,o),Ht(t,e,n,s,o)}}function Rt(t,e){for(var i=Object.keys(t.parents),n=i.length;n--;)for(var s=t.parents[i[n]].childRefs.length;s--;)e(t.parents[i[n]].childRefs[s]);if(t.siblings)for(var o=Object.keys(t.siblings),a=o.length;a--;)e(t.siblings[o[a]])}function jt(t,e,i,n,s){var o=s.topLeft||0,a=s.topRight||0,r=s.bottomLeft||0,l=s.bottomRight||0;return"M"+(t+o)+","+e+"h"+(i-o-a)+"a"+a+","+a+" 0 0 1 "+a+","+a+"v"+(n-(a+l))+"a"+l+","+l+" 0 0 1 "+-l+","+l+"h"+(r-(i-l))+"a"+r+","+r+" 0 0 1 "+-r+","+-r+"v"+(o-(n-r))+"a"+o+","+o+" 0 0 1 "+o+","+-o+"z"}function zt(t){return"M"+(t.x+t.radius)+","+t.y+"h"+(t.width-2*t.radius)+"a"+t.radius+","+t.radius+" 0 0 1 "+t.radius+","+t.radius+"v"+(t.height-2*t.radius)+"a"+t.radius+","+t.radius+" 0 0 1 "+-t.radius+","+t.radius+"h"+-(t.width-2*t.radius-2*t.arrowSize)/2+"l"+-t.arrowSize+","+t.arrowSize+"l"+-t.arrowSize+","+-t.arrowSize+"h"+-(t.width-2*t.radius-2*t.arrowSize)/2+"a"+t.radius+","+t.radius+" 0 0 1 "+-t.radius+","+-t.radius+"v"+(t.radius-(t.height-t.radius))+"a"+t.radius+","+t.radius+" 0 0 1 "+t.radius+","+-t.radius+"z"}function Et(t){for(var i=e.selectAll(".d3-list-graph-not-existent"),n=t.length;n--;)i._groups=i._groups.concat(t[n]._groups);return i}function Ft(t,e){0===t.size()&&e();var i=0;t.each(function(){return++i}).on("interrupt end",function(){for(var t=arguments.length,n=Array(t),s=0;s<t;s++)n[s]=arguments[s];--i||e.apply(this,n)})}function Vt(t){return"function"==typeof t||"object"==typeof t&&null!==t}function Pt(t){return"function"==typeof t}function It(t){mo=t}function Tt(t){Do=t}function qt(){return function(){process.nextTick(Yt)}}function Wt(){return function(){yo(Yt)}}function Qt(){var t=0,e=new Lo(Yt),i=document.createTextNode("");return e.observe(i,{characterData:!0}),function(){i.data=t=++t%2}}function Gt(){var t=new MessageChannel;return t.port1.onmessage=Yt,function(){t.port2.postMessage(0)}}function Ut(){return function(){setTimeout(Yt,1)}}function Yt(){for(var t=0;t<xo;t+=2){var e=Bo[t],i=Bo[t+1];e(i),Bo[t]=void 0,Bo[t+1]=void 0}xo=0}function Jt(){try{var t=require,e=t("vertx");return yo=e.runOnLoop||e.runOnContext,Wt()}catch(t){return Ut()}}function $t(t,e){var i=this,n=new this.constructor(Zt);void 0===n[Mo]&&be(n);var s=i._state;if(s){var o=arguments[s-1];Do(function(){ge(s,n,o,i._result)})}else he(i,n,t,e);return n}function Xt(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var i=new e(Zt);return ae(i,t),i}function Zt(){}function Kt(){return new TypeError("You cannot resolve a promise with itself")}function te(){return new TypeError("A promises callback cannot return that same promise.")}function ee(t){try{return t.then}catch(t){return Ro.error=t,Ro}}function ie(t,e,i,n){try{t.call(e,i,n)}catch(t){return t}}function ne(t,e,i){Do(function(t){var n=!1,s=ie(i,e,function(i){n||(n=!0,e!==i?ae(t,i):le(t,i))},function(e){n||(n=!0,ce(t,e))},"Settle: "+(t._label||" unknown promise"));!n&&s&&(n=!0,ce(t,s))},t)}function se(t,e){e._state===Ho?le(t,e._result):e._state===Oo?ce(t,e._result):he(e,void 0,function(e){ae(t,e)},function(e){ce(t,e)})}function oe(t,e,i){e.constructor===t.constructor&&i===$t&&constructor.resolve===Xt?se(t,e):i===Ro?ce(t,Ro.error):void 0===i?le(t,e):Pt(i)?ne(t,e,i):le(t,e)}function ae(t,e){t===e?ce(t,Kt()):Vt(e)?oe(t,e,ee(e)):le(t,e)}function re(t){t._onerror&&t._onerror(t._result),ue(t)}function le(t,e){t._state===Ao&&(t._result=e,t._state=Ho,0!==t._subscribers.length&&Do(ue,t))}function ce(t,e){t._state===Ao&&(t._state=Oo,t._result=e,Do(re,t))}function he(t,e,i,n){var s=t._subscribers,o=s.length;t._onerror=null,s[o]=e,s[o+Ho]=i,s[o+Oo]=n,0===o&&t._state&&Do(ue,t)}function ue(t){var e=t._subscribers,i=t._state;if(0!==e.length){for(var n,s,o=t._result,a=0;a<e.length;a+=3)n=e[a],s=e[a+i],n?ge(i,n,s,o):s(o);t._subscribers.length=0}}function de(){this.error=null}function ve(t,e){try{return t(e)}catch(t){return jo.error=t,jo}}function ge(t,e,i,n){var s,o,a,r,l=Pt(i);if(l){if(s=ve(i,n),s===jo?(r=!0,o=s.error,s=null):a=!0,e===s)return void ce(e,te())}else s=n,a=!0;e._state!==Ao||(l&&a?ae(e,s):r?ce(e,o):t===Ho?le(e,s):t===Oo&&ce(e,s))}function pe(t,e){try{e(function(e){ae(t,e)},function(e){ce(t,e)})}catch(e){ce(t,e)}}function fe(){return zo++}function be(t){t[Mo]=zo++,t._state=void 0,t._result=void 0,t._subscribers=[]}function ye(t,e){this._instanceConstructor=t,this.promise=new t(Zt),this.promise[Mo]||be(this.promise),wo(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?le(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&le(this.promise,this._result))):ce(this.promise,me())}function me(){return new Error("Array Methods must be provided an Array")}function ke(t){return new ye(this,t).promise}function we(t){var e=this;return new e(wo(t)?function(i,n){for(var s=t.length,o=0;o<s;o++)e.resolve(t[o]).then(i,n)}:function(t,e){e(new TypeError("You must pass an array to race."))})}function xe(t){var e=this,i=new e(Zt);return ce(i,t),i}function De(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function _e(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function Se(t){this[Mo]=fe(),this._result=this._state=void 0,this._subscribers=[],Zt!==t&&("function"!=typeof t&&De(),this instanceof Se?pe(this,t):_e())}function Le(t){return"symbol"==typeof t||W(t)&&Po.call(t)==Fo}function Ce(t){if("number"==typeof t)return t;if(Le(t))return Io;if(g(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=g(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(To,"");var i=Wo.test(t);return i||Qo.test(t)?Go(t.slice(2),i?2:8):qo.test(t)?Io:+t}function Ne(t,e,i){function n(e){var i=d,n=v;return d=v=void 0,m=e,f=t.apply(n,i)}function s(t){return m=t,b=setTimeout(r,e),k?n(t):f}function o(t){var i=t-y,n=t-m,s=e-i;return w?Jo(s,p-n):s}function a(t){var i=t-y,n=t-m;return void 0===y||i>=e||i<0||w&&n>=p}function r(){var t=Eo();return a(t)?l(t):void(b=setTimeout(r,o(t)))}function l(t){return b=void 0,x&&d?n(t):(d=v=void 0,f)}function c(){void 0!==b&&clearTimeout(b),m=0,d=y=v=b=void 0}function h(){return void 0===b?f:l(Eo())}function u(){var t=Eo(),i=a(t);if(d=arguments,v=this,y=t,i){if(void 0===b)return s(y);if(w)return b=setTimeout(r,e),n(y)}return void 0===b&&(b=setTimeout(r,e)),f}var d,v,p,f,b,y,m=0,k=!1,w=!1,x=!0;if("function"!=typeof t)throw new TypeError(Uo);return e=Ce(e)||0,g(i)&&(k=!!i.leading,w="maxWait"in i,p=w?Yo(Ce(i.maxWait)||0,e):p,x="trailing"in i?!!i.trailing:x),u.cancel=c,u.flush=h,u}function Be(t,i,n,s,o,a,r,l,c,h){var u=e.drag(),d=p(l),v=r||{},g=function(){return!(d&&l())};u.filter(g);var f=void 0;u.on("start",function(){f=0,"function"==typeof r&&(v=r())}),n&&u.on("drag",function(t){d&&l()||(e.event.sourceEvent.preventDefault(),i(),n.call(this,t,o,a,v),f+=e.event.dx*e.event.dx+e.event.dy*e.event.dy)}),s&&u.on("end",function(){s.call(this),f<=(h||0)&&e.select(window).on("click.drag",null)}),t.each(function(t){var i=e.select(this);t||(t={drag:c},i.datum(t)),i.call(u)})}function Me(t,i,n,s){function o(t,e){var i=void 0;if(e)try{i=Math.min(e.max,Math.max(e.min,t))}catch(t){throw new ca}return i}var a=e.select(this);i&&i.length&&(a=Et(i)),"horizontal"===n||"vertical"===n?("horizontal"===n&&(t.drag.x+=e.event.dx,t.drag.x=o(t.drag.x+e.event.dx,s.x),a.style("transform","translateX("+t.drag.x+"px)")),"vertical"===n&&(t.drag.y+=e.event.dy,t.drag.x=o(t.drag.y+e.event.dy,s.y),a.style("transform","translateY("+t.drag.y+"px)"))):(t.drag.x+=e.event.dx,t.drag.y+=e.event.dy,a.style("transform","translate("+t.drag.x+"px,"+t.drag.y+"px)"))}function Ae(t,e,i,n,s,o){var a=t.select("defs");a.empty()&&(a=t.append("defs"));var r=a.append("filter").attr("id","drop-shadow"+(e?"-"+e:"")).attr("height","130%");r.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",s),r.append("feOffset").attr("dx",i).attr("dy",n).attr("result","offsetBlur"),r.append("feComponentTransfer").append("feFuncA").attr("type","linear").attr("slope",o||1);var l=r.append("feMerge");l.append("feMergeNode"),l.append("feMergeNode").attr("in","SourceGraphic")}function He(t,e,i){return i?t||e:"undefined"!=typeof t?t:e}function Oe(t,e,i,n){var s=t.append("symbol").attr("id",e).attr("viewBox",n);i.forEach(function(t){return s.append("path").attr("d",t).attr("fill","currentColor")})}var Re=Array.isArray,je=Array.prototype,ze=je.splice;c.prototype.clear=i,c.prototype.delete=o,c.prototype.get=a,c.prototype.has=r,c.prototype.set=l;var Ee="[object Function]",Fe="[object GeneratorFunction]",Ve=Object.prototype,Pe=Ve.toString,Ie="object"==typeof global&&global&&global.Object===Object&&global,Te="object"==typeof self&&self&&self.Object===Object&&self,qe=Ie||Te||Function("return this")(),We=qe["__core-js_shared__"],Qe=function(){var t=/[^.]+$/.exec(We&&We.keys&&We.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Ge=Function.prototype,Ue=Ge.toString,Ye=/[\\^$.*+?()[\]{}|]/g,Je=/^\[object .+?Constructor\]$/,$e=Function.prototype,Xe=Object.prototype,Ze=$e.toString,Ke=Xe.hasOwnProperty,ti=RegExp("^"+Ze.call(Ke).replace(Ye,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ei=k(qe,"Map"),ii=k(Object,"create"),ni="__lodash_hash_undefined__",si=Object.prototype,oi=si.hasOwnProperty,ai=Object.prototype,ri=ai.hasOwnProperty,li="__lodash_hash_undefined__";L.prototype.clear=w,L.prototype.delete=x,L.prototype.get=D,L.prototype.has=_,L.prototype.set=S,R.prototype.clear=C,R.prototype.delete=M,R.prototype.get=A,R.prototype.has=H,R.prototype.set=O;var ci=200;z.prototype.clear=h,z.prototype.delete=u,z.prototype.get=d,z.prototype.has=v,z.prototype.set=j;var hi=Object.defineProperty,ui=Object.prototype,di=ui.hasOwnProperty,vi=9007199254740991,gi="[object Arguments]",pi=Object.prototype,fi=pi.hasOwnProperty,bi=pi.toString,yi=pi.propertyIsEnumerable,mi=9007199254740991,ki=/^(?:0|[1-9]\d*)$/,wi=Object.prototype,xi=wi.hasOwnProperty,Di=Object.prototype,_i=X(Object.keys,Object),Si=Object.prototype,Li=Si.hasOwnProperty,Ci="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ni=Ci&&"object"==typeof module&&module&&!module.nodeType&&module,Bi=Ni&&Ni.exports===Ci,Mi=Bi?qe.Buffer:void 0,Ai=Mi?Mi.allocUnsafe:void 0,Hi=Object.getOwnPropertySymbols,Oi=Hi?X(Hi,Object):nt,Ri=k(qe,"DataView"),ji=k(qe,"Promise"),zi=k(qe,"Set"),Ei=k(qe,"WeakMap"),Fi=Object.prototype,Vi=Fi.toString,Pi="[object Map]",Ii="[object Object]",Ti="[object Promise]",qi="[object Set]",Wi="[object WeakMap]",Qi="[object DataView]",Gi=Object.prototype,Ui=Gi.toString,Yi=b(Ri),Ji=b(ei),$i=b(ji),Xi=b(zi),Zi=b(Ei),Ki=lt;(Ri&&Ki(new Ri(new ArrayBuffer(1)))!=Qi||ei&&Ki(new ei)!=Pi||ji&&Ki(ji.resolve())!=Ti||zi&&Ki(new zi)!=qi||Ei&&Ki(new Ei)!=Wi)&&(Ki=function(t){var e=Ui.call(t),i=e==Ii?t.constructor:void 0,n=i?b(i):void 0;if(n)switch(n){case Yi:return Qi;case Ji:return Pi;case $i:return Ti;case Xi:return qi;case Zi:return Wi}return e});var tn=Ki,en=Object.prototype,nn=en.hasOwnProperty,sn=qe.Uint8Array,on=/\w*$/,an=qe.Symbol,rn=an?an.prototype:void 0,ln=rn?rn.valueOf:void 0,cn="[object Boolean]",hn="[object Date]",un="[object Map]",dn="[object Number]",vn="[object RegExp]",gn="[object Set]",pn="[object String]",fn="[object Symbol]",bn="[object ArrayBuffer]",yn="[object DataView]",mn="[object Float32Array]",kn="[object Float64Array]",wn="[object Int8Array]",xn="[object Int16Array]",Dn="[object Int32Array]",_n="[object Uint8Array]",Sn="[object Uint8ClampedArray]",Ln="[object Uint16Array]",Cn="[object Uint32Array]",Nn=Object.create,Bn=function(){function t(){}return function(e){if(!g(e))return{};if(Nn)return Nn(e);t.prototype=prototype;var i=new t;return t.prototype=void 0,i}}(),Mn=X(Object.getPrototypeOf,Object),An="object"==typeof exports&&exports&&!exports.nodeType&&exports,Hn=An&&"object"==typeof module&&module&&!module.nodeType&&module,On=Hn&&Hn.exports===An,Rn=On?qe.Buffer:void 0,jn=Rn?Rn.isBuffer:void 0,zn=jn||_t,En="[object Arguments]",Fn="[object Array]",Vn="[object Boolean]",Pn="[object Date]",In="[object Error]",Tn="[object Function]",qn="[object GeneratorFunction]",Wn="[object Map]",Qn="[object Number]",Gn="[object Object]",Un="[object RegExp]",Yn="[object Set]",Jn="[object String]",$n="[object Symbol]",Xn="[object WeakMap]",Zn="[object ArrayBuffer]",Kn="[object DataView]",ts="[object Float32Array]",es="[object Float64Array]",is="[object Int8Array]",ns="[object Int16Array]",ss="[object Int32Array]",os="[object Uint8Array]",as="[object Uint8ClampedArray]",rs="[object Uint16Array]",ls="[object Uint32Array]",cs={};cs[En]=cs[Fn]=cs[Zn]=cs[Kn]=cs[Vn]=cs[Pn]=cs[ts]=cs[es]=cs[is]=cs[ns]=cs[ss]=cs[Wn]=cs[Qn]=cs[Gn]=cs[Un]=cs[Yn]=cs[Jn]=cs[$n]=cs[os]=cs[as]=cs[rs]=cs[ls]=!0,cs[In]=cs[Tn]=cs[Xn]=!1;var hs,us=(function(){function t(t){this.value=t}function e(e){function i(t,e){return new Promise(function(i,s){var r={key:t,arg:e,resolve:i,reject:s,next:null};a?a=a.next=r:(o=a=r,n(t,e))})}function n(i,o){try{var a=e[i](o),r=a.value;r instanceof t?Promise.resolve(r.value).then(function(t){n("next",t)},function(t){n("throw",t)}):s(a.done?"return":"normal",a.value)}catch(t){s("throw",t)}}function s(t,e){switch(t){case"return":o.resolve({value:e,done:!0});break;case"throw":o.reject(e);break;default:o.resolve({value:e,done:!1})}o=o.next,o?n(o.key,o.arg):a=null}var o,a;this._invoke=i,"function"!=typeof e.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)},{wrap:function(t){return function(){return new e(t.apply(this,arguments))}},await:function(e){return new t(e)}}}(),function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}),ds=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),vs=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},gs=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},ps=function(t){function e(t){us(this,e);var i=gs(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.name=i.constructor.name,i.message=t,Error.captureStackTrace(i,i.constructor.name),i}return vs(e,t),e}(Error),fs=function(t){function e(t){return us(this,e),gs(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"D3 version 4 is required to run the code. Found version "+t))}return vs(e,t),e}(ps),bs=(function(t){function e(t){return us(this,e),gs(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,'The "'+t+'" must be an object.'))}return vs(e,t),e}(ps),function(t){function e(t){return us(this,e),gs(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t||"D3.layout.listGraph.js has not been loaded yet."))}return vs(e,t),e}(ps)),ys=function(t){function e(t){return us(this,e),gs(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t||"Dispatcher needs to be a function."))}return vs(e,t),e}(ps),ms="list-graph",ks=6,ws=5,xs=5,Ds="",_s=-1,Ss="one",Ls=!0,Cs=0,Ns=0,Bs=!1,Ms=!1,As=!1,Hs=!1,Os=150,Rs=250,js=.95,zs="div",Es="top-bar",Fs="ul",Vs="controls",Ps="global-controls",Is=function(){function t(i,n,s,o){var a=this;us(this,t);var r=this;this.vis=i,this.visData=s,this.customTopbarButtons=o,this.el=n.select("."+Es),this.el.empty()&&(this.el=n.insert(zs,":first-child").attr("class",Es)),this.controlSwitch=this.el.append("div").attr("title","Toggle global / local topbar").style("width",this.visData.global.column.padding+"px").classed("control-switch",!0).on("click",this.switch.bind(this)),this.switchArrow=this.controlSwitch.append("svg").append("use").attr("xlink:href",this.vis.iconPath+"#arrow-down").attr("class","switch-arrow"),this.globalControls=this.el.append(Fs).classed(Ps,!0),this.globalPrecision=this.globalControls.append("li").attr("class","control-btn sort-precision").classed("active",function(){return"precision"===r.vis.currentSorting.global.type&&(r.vis.currentSorting.global.el=e.select(this),!0)}).on("click",function(){r.sortAllColumns(this,"precision")}).on("mouseenter",function(){a.vis.interactionWrapper.call(a.vis,function(){a.highlightBars(void 0,"precision")},[])}).on("mouseleave",function(){a.vis.interactionWrapper.call(a.vis,function(){a.highlightBars(void 0,"precision",!0)},[])}),this.globalPrecisionWrapper=this.globalPrecision.append("div").attr("class","wrapper"),this.globalPrecisionWrapper.append("span").attr("class","label").text("Precision"),this.globalPrecisionWrapper.append("svg").attr("class","icon-unsort invisible-default").classed("visible","precision"!==this.vis.currentSorting.global.type).append("use").attr("xlink:href",this.vis.iconPath+"#unsort"),this.globalPrecisionWrapper.append("svg").attr("class","icon-sort-asc invisible-default").classed("visible","precision"===this.vis.currentSorting.global.type&&1===this.vis.currentSorting.global.order).append("use").attr("xlink:href",this.vis.iconPath+"#sort-asc"),this.globalPrecisionWrapper.append("svg").attr("class","icon-sort-desc invisible-default").classed("visible","precision"===this.vis.currentSorting.global.type&&1!==this.vis.currentSorting.global.order).append("use").attr("xlink:href",this.vis.iconPath+"#sort-desc"),this.globalRecall=this.globalControls.append("li").attr("class","control-btn sort-recall").classed("active",function(){return"recall"===r.vis.currentSorting.global.type&&(r.vis.currentSorting.global.el=e.select(this),!0)}).on("click",function(){r.sortAllColumns(this,"recall")}).on("mouseenter",function(){a.vis.interactionWrapper.call(a.vis,function(){a.highlightBars(void 0,"recall")},[])}).on("mouseleave",function(){a.vis.interactionWrapper.call(a.vis,function(){a.highlightBars(void 0,"recall",!0)},[])}),this.globalRecallWrapper=this.globalRecall.append("div").attr("class","wrapper"),this.globalRecallWrapper.append("span").attr("class","label").text("Recall"),this.globalRecallWrapper.append("svg").attr("class","icon-unsort invisible-default").classed("visible","recall"!==this.vis.currentSorting.global.type).append("use").attr("xlink:href",this.vis.iconPath+"#unsort"),this.globalRecallWrapper.append("svg").attr("class","icon-sort-asc invisible-default").classed("visible","recall"===this.vis.currentSorting.global.type&&1===this.vis.currentSorting.global.order).append("use").attr("xlink:href",this.vis.iconPath+"#sort-asc"),this.globalRecallWrapper.append("svg").attr("class","icon-sort-desc invisible-default").classed("visible","recall"===this.vis.currentSorting.global.type&&1!==this.vis.currentSorting.global.order).append("use").attr("xlink:href",this.vis.iconPath+"#sort-desc"),this.globalName=this.globalControls.append("li").attr("class","control-btn sort-name").classed("active",function(){return"name"===r.vis.currentSorting.global.type&&(r.vis.currentSorting.global.el=e.select(this),!0)}).on("click",function(){r.sortAllColumns(this,"name")}).on("mouseenter",function(){a.vis.interactionWrapper.call(a.vis,function(){a.highlightLabels()},[])}).on("mouseleave",function(){a.vis.interactionWrapper.call(a.vis,function(){a.highlightLabels(!0)},[])}),this.globalNameWrapper=this.globalName.append("div").attr("class","wrapper"),this.globalNameWrapper.append("span").attr("class","label").text("Name"),this.globalNameWrapper.append("svg").attr("class","icon-unsort invisible-default").classed("visible","name"!==this.vis.currentSorting.global.type).append("use").attr("xlink:href",this.vis.iconPath+"#unsort"),this.globalNameWrapper.append("svg").attr("class","icon-sort-asc invisible-default").classed("visible","name"===this.vis.currentSorting.global.type&&1===this.vis.currentSorting.global.order).append("use").attr("xlink:href",this.vis.iconPath+"#sort-alpha-asc"),this.globalNameWrapper.append("svg").attr("class","icon-sort-desc invisible-default").classed("visible","name"===this.vis.currentSorting.global.type&&1!==this.vis.currentSorting.global.order).append("use").attr("xlink:href",this.vis.iconPath+"#sort-alpha-desc"),this.globalOneBar=this.globalControls.append("li").attr("class","control-btn one-bar").classed("active","one"===this.vis.barMode).on("click",function(){r.switchBarMode(this,"one")}),this.globalOneBarWrapper=this.globalOneBar.append("div").attr("class","wrapper").text("One bar"),this.globalOneBarWrapper.append("svg").attr("class","icon-one-bar").append("use").attr("xlink:href",this.vis.iconPath+"#one-bar"),this.globalTwoBars=this.globalControls.append("li").attr("class","control-btn two-bars").classed("active","two"===this.vis.barMode).on("click",function(){r.switchBarMode(this,"two")}),this.globalTwoBarsWrapper=this.globalTwoBars.append("div").attr("class","wrapper").text("Two bars"),this.globalTwoBarsWrapper.append("svg").attr("class","icon-two-bars").append("use").attr("xlink:href",this.vis.iconPath+"#two-bars"),this.globalZoomOut=this.globalControls.append("li").attr("class","control-btn zoom-out").classed("active",this.vis.zoomedOut).on("click",function(){r.vis.toggleView.call(r.vis),e.select(this).classed("active",r.vis.zoomedOut)}),this.globalZoomOutWrapper=this.globalZoomOut.append("div").attr("class","wrapper").text("Zoom Out"),this.globalZoomOutWrapper.append("svg").attr("class","icon-zoom-out").append("use").attr("xlink:href",this.vis.iconPath+"#zoom-out");for(var l=0;l<this.customTopbarButtons.length;l++){var c=this.globalControls.append("li").attr("class","control-btn").on("click",this.customTopbarButtons[l].callback),h=c.append("div").attr("class","wrapper").text(this.customTopbarButtons[l].label);this.customTopbarButtons[l].iconSvg&&h.append("svg").attr("class","icon").append("use").attr("xlink:href",this.customTopbarButtons[l].iconSvg),this.customTopbarButtons[l].iconSpan&&h.append("span").attr("class","icon "+this.customTopbarButtons[l].iconSpan)}this.localControlWrapper=this.el.append("div").classed("local-controls",!0),this.localControls=this.localControlWrapper.selectAll(Vs).data(s.nodes).enter().append(Fs).classed(Vs,!0).style("width",this.visData.global.column.width+"px"),this.localControls.each(function(t,i){var n=e.select(this);r.vis.currentSorting.local[i]={type:t.sortBy,order:t.sortOrder,el:void 0},n.append("li").attr("class","control-btn").style("width",r.visData.global.column.padding+"px"),n.append("li").attr("class","control-btn sort-precision ease-all").classed("active",function(){return"precision"===r.vis.currentSorting.local[i].type&&(r.vis.currentSorting.local[i].el=e.select(this),!0)}).style("width",r.visData.global.column.contentWidth/2+"px").style("left",r.visData.global.column.padding+"px").on("click",function(t){r.sortColumn(this,t.level,"precision")}).on("mouseenter",function(){r.highlightBars(this.parentNode,"precision"),e.select(this).style("width",r.visData.global.column.contentWidth-16+"px")}).on("mouseleave",function(){r.highlightBars(this.parentNode,"precision",!0),e.select(this).style("width",r.visData.global.column.contentWidth/2+"px")}).html('<div class="expandable-label">  <span class="letter abbr">P</span>  <span class="letter abbr">r</span>  <span class="letter">e</span>  <span class="letter abbr">c</span>  <span class="letter">i</span>  <span class="letter">s</span>  <span class="letter">i</span>  <span class="letter">o</span>  <span class="letter">n</span></div><svg class="icon-unsort invisible-default '+("precision"!==r.vis.currentSorting.local[i].type?"visible":"")+'">  <use xlink:href="'+r.vis.iconPath+'#unsort"></use></svg><svg class="icon-sort-asc invisible-default '+("precision"===r.vis.currentSorting.local[i].type&&1===r.vis.currentSorting.local[i].order?"visible":"")+'">  <use xlink:href="'+r.vis.iconPath+'#sort-asc"></use></svg><svg class="icon-sort-desc invisible-default '+("precision"===r.vis.currentSorting.local[i].type&&1!==r.vis.currentSorting.local[i].order?"visible":"")+'">  <use xlink:href="'+r.vis.iconPath+'#sort-desc"></use></svg>'),n.append("li").attr("class","control-btn sort-recall ease-all").classed("active",function(){
return"recall"===r.vis.currentSorting.local[i].type&&(r.vis.currentSorting.local[i].el=e.select(this),!0)}).style("width",r.visData.global.column.contentWidth/2+"px").style("left",r.visData.global.column.contentWidth/2+r.visData.global.column.padding+"px").on("click",function(t){r.sortColumn(this,t.level,"recall")}).on("mouseenter",function(){r.highlightBars(this.parentNode,"recall"),e.select(this).style("width",r.visData.global.column.contentWidth-16+"px").style("left",r.visData.global.column.padding+16+"px")}).on("mouseleave",function(){r.highlightBars(this.parentNode,"recall",!0),e.select(this).style("width",r.visData.global.column.contentWidth/2+"px").style("left",r.visData.global.column.contentWidth/2+r.visData.global.column.padding+"px")}).html('<div class="expandable-label">  <span class="letter abbr">R</span>  <span class="letter">e</span>  <span class="letter abbr">c</span>  <span class="letter">a</span>  <span class="letter abbr">l</span>  <span class="letter">l</span></div><svg class="icon-unsort invisible-default '+("recall"!==r.vis.currentSorting.local[i].type?"visible":"")+'">  <use xlink:href="'+r.vis.iconPath+'#unsort"></use></svg><svg class="icon-sort-asc invisible-default '+("recall"===r.vis.currentSorting.local[i].type&&1===r.vis.currentSorting.local[i].order?"visible":"")+'">  <use xlink:href="'+r.vis.iconPath+'#sort-asc"></use></svg><svg class="icon-sort-desc invisible-default '+("recall"===r.vis.currentSorting.local[i].type&&1!==r.vis.currentSorting.local[i].order?"visible":"")+'">  <use xlink:href="'+r.vis.iconPath+'#sort-desc"></use></svg>'),n.append("li").attr("class","control-btn").style("width",r.visData.global.column.padding+"px"),r.vis.currentSorting.local[i].type&&(r.vis.currentSorting.local[i].el=n.select(".sort-"+r.vis.currentSorting.local[i].type))})}return ds(t,[{key:"highlightBars",value:function(t,e,i){var n=t?this.selectNodesLevel(t):this.vis.baseElD3.selectAll(".node");n.classed("highlight-bar",!i).selectAll(".bar."+e).classed("highlight",!i)}},{key:"highlightLabels",value:function(t){this.vis.baseElD3.selectAll(".node").classed("highlight-label",!t)}},{key:"resetSemiActiveSortingEls",value:function(){this.el.selectAll(".semi-active").classed("semi-active",!1)}},{key:"resetSortEl",value:function(t,e){t.classed("active",!1),t.select(".icon-sort-desc").classed("visible",!1),t.select(".icon-sort-asc").classed("visible",!1),t.select(".icon-unsort").classed("visible",!0),"name"===e&&(t.classed("semi-active",!0),this.semiActiveSortingEls=!0)}},{key:"reRender",value:function(t){t&&(this.visData=t),this.controlSwitch.style("width",this.visData.global.column.padding+"px"),this.localControls.style("width",this.visData.global.column.width+"px"),this.localControls.selectAll(".control-btn").style("width",this.visData.global.column.padding+"px"),this.localControls.selectAll(".control-btn.sort-precision").style("width",this.visData.global.column.contentWidth/2+"px").style("left",this.visData.global.column.padding+"px"),this.localControls.selectAll(".control-btn.sort-recall").style("width",this.visData.global.column.contentWidth/2+"px").style("left",this.visData.global.column.contentWidth/2+this.visData.global.column.padding+"px")}},{key:"selectNodesLevel",value:function(t){return this.vis.selectByLevel(e.select(t).datum().level,".node")}},{key:"sortAllColumns",value:function(t,i){var n=this.vis.currentSorting.global.type!==i;n&&(this.semiActiveSortingEls&&this.resetSemiActiveSortingEls(),this.vis.currentSorting.global.el&&this.resetSortEl(this.vis.currentSorting.global.el,i)),this.vis.currentSorting.global.el=e.select(t),this.vis.currentSorting.global.el.classed("active",!0),this.vis.currentSorting.global.type=i;for(var s=Object.keys(this.vis.currentSorting.local),o=0,a=s.length;o<a;o++)this.sortColumn(t,s[o],i,!0);this.vis.sortAllColumns(i,n)}},{key:"sortColumn",value:function(t,i,n,s){s||(this.semiActiveSortingEls&&this.resetSemiActiveSortingEls(),this.vis.currentSorting.global.type&&this.resetSortEl(this.vis.currentSorting.global.el,n),this.vis.currentSorting.global.type=void 0);var o=!1;this.vis.currentSorting.local[i].el&&this.vis.currentSorting.local[i].type!==n&&this.resetSortEl(this.vis.currentSorting.local[i].el,n),this.vis.currentSorting.local[i].type!==n&&(o=!0,this.vis.currentSorting.local[i].order=0),this.vis.currentSorting.local[i].el=e.select(t),this.vis.currentSorting.local[i].type=n,this.vis.currentSorting.local[i].order===-1?(this.vis.currentSorting.local[i].order=1,this.vis.currentSorting.local[i].el.select(".icon-sort-desc").classed("visible",!1),this.vis.currentSorting.local[i].el.select(".icon-sort-asc").classed("visible",!0)):(this.vis.currentSorting.local[i].order=-1,this.vis.currentSorting.local[i].el.select(".icon-sort-asc").classed("visible",!1),this.vis.currentSorting.local[i].el.select(".icon-sort-desc").classed("visible",!0)),this.vis.currentSorting.local[i].el.select(".icon-unsort").classed("visible",!1),this.vis.currentSorting.local[i].el.classed("active",!0),s||this.vis.sortColumn(i,n,this.vis.currentSorting.local[i].order,o)}},{key:"switch",value:function(){this.el.classed("details",!this.el.classed("details"))}},{key:"switchBarMode",value:function(t,e){this.vis.nodes.barMode!==e&&("one"===e?(this.globalOneBar.classed("active",!0),this.globalTwoBars.classed("active",!1)):(this.globalOneBar.classed("active",!1),this.globalTwoBars.classed("active",!0)),this.vis.switchBarMode(e))}}]),t}(),Ts="column",qs="scroll-container",Ws=function(){function t(e,i,n){var s=this;us(this,t),this.vis=i,this.visData=n,this.groups=e.selectAll("g").data(this.visData.nodes).enter().append("g").attr("class",Ts).classed("active",function(t,e){return!!s.vis.highlightActiveLevel&&(s.vis.nodes&&s.vis.nodes.rootedNode?e===s.vis.activeLevel:e===s.vis.activeLevel-s.vis.noRootActiveLevelDiff)}).each(function(t){t.scrollTop=0}),this.scrollHelper=this.groups.append("rect").attr("class",qs).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("width",this.visData.global.column.width+1).attr("height",this.visData.global.column.height)}return ds(t,[{key:"reRender",value:function(t){t&&(this.visData=t),this.groups.data(this.visData.nodes),this.scrollHelper.data(this.visData.nodes).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("width",this.visData.global.column.width+1).attr("height",this.visData.global.column.height)}},{key:"scrollPreparation",value:function(t){var i=this;this.groups.each(function(n,s){var o=n.nodes.getBoundingClientRect().height+2*i.visData.global.row.padding,a=o-i.visData.global.column.height,r=a>0?Math.max(i.visData.global.column.height*i.visData.global.column.height/o,10):0;n.height=o,n.linkSelections={incoming:s>0?i.vis.selectByLevel(s-1,".link"):null,outgoing:i.vis.selectByLevel(s,".link")},n.scrollHeight=a,n.scrollTop=0,n.scrollbar={el:void 0,x:n.x+(i.visData.global.column.width-t)-1,y:0,width:t,height:r,scrollHeight:i.visData.global.column.height-r,scrollTop:0,heightScale:e.scaleLinear().domain([0,a]).range([0,i.visData.global.column.height-r])},n.invertedHeightScale=n.scrollbar.heightScale.invert})}},{key:"updateScrollProperties",value:function(){var t=this;this.groups.each(function(i){var n=i.nodes.getBoundingClientRect().height+2*t.visData.global.row.padding,s=n-t.visData.global.column.height,o=s>0?Math.max(t.visData.global.column.height*t.visData.global.column.height/n,10):0;i.height=n,i.scrollHeight=s,i.scrollTop=0,i.scrollbar.x=i.x+(t.visData.global.column.width-i.scrollbar.width)-1,i.scrollbar.y=0,i.scrollbar.height=o,i.scrollbar.scrollHeight=t.visData.global.column.height-o,i.scrollbar.scrollTop=0,i.scrollbar.heightScale=e.scaleLinear().domain([0,s]).range([0,t.visData.global.column.height-o])})}},{key:"updateVisibility",value:function(){this.groups.each(function(){var t=e.select(this);t.classed("hidden",t.selectAll(".node").filter(function(t){return!t.hidden}).empty())})}},{key:"focus",value:function(t){this.vis.highlightActiveLevel&&this.groups.filter(function(e){return e.level===t}).classed("active",!0)}},{key:"blur",value:function(t){this.vis.highlightActiveLevel&&(t?this.groups.filter(function(e){return e.level===t}).classed("active",!1):this.groups.classed("active",!1))}},{key:"height",get:function(){return this.visData.global.column.height}}],[{key:"className",get:function(){return Ts}}]),t}(),Qs="links",Gs="link",Us=function(){function t(i,n,s,o){var a=this;us(this,t),this.vis=i,this.visData=s,this.layout=o,this.groups=n.append("g").attr("class",Qs).call(function(t){t.each(function(){e.select(this.parentNode).datum().links=this})}),this.links=this.groups.selectAll(Gs).data(function(t,e){return a.layout.links(e)}).enter().append("g").attr("class",Gs).classed("visible",!this.vis.hideOutwardsLinks||this.linkVisibility.bind(this)),this.links.append("path").attr("class",Gs+"-bg").attr("d",this.diagonal.bind(this)),this.links.append("path").attr("class",Gs+"-direct").attr("d",this.diagonal.bind(this))}return ds(t,[{key:"linkVisibility",value:function(t){return t.hidden=this.vis.pointsOutside.call(this.vis,t),0===t.hidden}},{key:"highlight",value:function(t,e,i){this.links.filter(function(e){return t[e.id]}).classed(i,e)}},{key:"makeAllTempVisible",value:function(t){t?this.links.classed("visible",this.linkVisibility.bind(this)):this.links.classed("visible",!0)}},{key:"reRender",value:function(t){var e=this;t&&(this.visData=t,this.groups.data(this.visData.nodes),this.links.data(function(t,i){return e.layout.links(i)})),this.links.selectAll("path").attr("d",this.diagonal),this.makeAllTempVisible(!0)}},{key:"scroll",value:function(t,e){t.data(e),this.vis.hideOutwardsLinks&&t.classed("visible",this.linkVisibility.bind(this)),t.selectAll("path").attr("d",this.diagonal)}},{key:"sort",value:function(t){var i=function(){e.select(this).classed("sorting",!0)},n=function(){e.select(this).classed("sorting",!1)};this.links.data(t,function(t){return t.id}),this.links.selectAll("path").transition().duration(Rs).attr("d",this.diagonal).on("start",i).on("end",n)}},{key:"updateVisibility",value:function(){this.links.classed("hidden",function(t){return t.target.node.hidden||t.source.node.hidden}),this.links.selectAll("path").transition().duration(Rs).attr("d",this.diagonal)}},{key:"diagonal",get:function(){function t(t){return t.node.x+t.offsetX+this.visData.global.column.contentWidth+this.visData.global.column.padding}function i(t){return t.node.x+t.offsetX+this.visData.global.column.padding}function n(t){return t.node.y+t.offsetY+this.visData.global.row.height/2}function s(t){var e=t.indexOf("L"),i=t.lastIndexOf("L"),n=t.substr(1,e-1).split(","),s=t.substr(i+1).split(",");return"M"+(parseInt(n[0],10)-a)+","+n[1]+"L"+n[0]+","+n[1]+t.substring(e,i)+"L"+s[0]+","+s[1]+"L"+(parseInt(s[0],10)+a)+","+s[1]}var o=this,a=this.vis.showLinkLocation?6:0,r=e.line().x(function(t){return t.x}).y(function(t){return t.y}).curve(e.curveBundle.beta(js));return function(e){var l=[],c=t.call(o,e.source),h=n.call(o,e.source),u=i.call(o,e.target),d=n.call(o,e.target),v=(c+u)/2,g=2*(u-(c+u)/2)/3;return l.push({x:c+a,y:h}),l.push({x:v,y:h}),l.push({x:u-g,y:d}),l.push({x:u-a,y:d}),s(r(l))}}}]),t}(),Ys=qe.isFinite,Js="bar",$s=function t(e,i,n,s,o){function a(t){var e=this,i=this.visData.nodes[this.nodeData.depth].sortBy;t.attr("d",function(t){return e.bars.generatePath(t,i)}).classed("bar-magnitude",!0)}var r=this;us(this,t),this.data=i,this.nodeData=n,this.visData=s,this.bars=o,this.data.x=n.x,this.data.level=n.depth,this.height=this.visData.global.row.contentHeight/(2*this.data.length)-2*this.visData.global.cell.padding,this.activeHeight=this.visData.global.row.contentHeight-2,this.inactiveheight=2*this.visData.global.cell.padding-1,this.selection=e.selectAll(Js).data(this.data).enter().append("g").attr("class",function(t){return Js+" "+t.id}).classed("active",function(t){return t.id===r.visData.nodes[r.nodeData.depth].sortBy}),this.selection.append("path").call(a.bind(this))},Xs="bars",Zs=function(){function t(i,n,s){us(this,t);var o=this;this.mode=n,this.visData=s,this.xScale=e.scaleLinear().domain([0,1]).range([1,this.visData.global.column.contentWidth-3]),this.baseEl=i.append("g").attr("class",Xs),this.baseEl.each(function(t){new $s(e.select(this),t.data.bars,t,o.visData,o)})}return ds(t,[{key:"reRender",value:function(t,e){var i=this;t&&(this.visData=t),this.baseEl.selectAll(".bar-magnitude").attr("d",function(t){return i.generatePath(t,e)})}},{key:"updateAll",value:function(t,e){var i=this;this.baseEl.selectAll(".bar-magnitude").data(t,function(t){return t.barId}).transition().duration(Rs).attr("d",function(t){return i.generatePath(t,e)})}},{key:"update",value:function(t,i){var n=this;t.each(function(t){var n=e.select(this);t.id!==i||n.classed("active")||(n.classed("active",!0),this.parentNode.insertBefore(this,this.parentNode.children[0])),t.id!==i&&n.classed("active",!1)}),t.selectAll(".bar-magnitude").transition().duration(Rs).attr("d",function(t){return n.generatePath(t,i)})}},{key:"switchMode",value:function(t,e){var i=this;this.mode!==t&&("one"===t&&e.global.type&&this.baseEl.selectAll(".bar").selectAll(".bar-magnitude").transition().duration(Rs).attr("d",function(t){return i.generateOneBarPath(t,e.global.type)}),"two"===t&&(this.baseEl.selectAll(".bar.precision").selectAll(".bar-magnitude").transition().duration(Rs).attr("d",function(t){return i.generateTwoBarsPath(t)}),this.baseEl.selectAll(".bar.recall").selectAll(".bar-magnitude").transition().duration(Rs).attr("d",function(t){return i.generateTwoBarsPath(t,!0)})),this.mode=t)}},{key:"generatePath",value:function(t,e){return"two"===this.mode?this.generateTwoBarsPath(t):this.generateOneBarPath(t,e)}},{key:"generateOneBarPath",value:function(t,e){var i=this.visData.global.row.contentHeight,n=Math.min(t.value,1)||0,s=0,o=2,a={topLeft:2,bottomLeft:2};return t.id!==e?(s=this.xScale(n),a={}):o=this.visData.global.column.contentWidth*n,s=Math.min(s,this.visData.global.column.contentWidth-2),jt(s,this.visData.global.row.padding,o,i,a)}},{key:"generateTwoBarsPath",value:function(t,e){var i=Math.min(t.value,1),n=this.visData.global.row.contentHeight/2,s=this.visData.global.column.contentWidth*i,o=this.visData.global.row.padding,a={topLeft:2};return e&&(a={bottomLeft:2},o+=n),jt(0,o,s,n,a)}}]),t}(),Ks="nodes",to="node",eo="visible-node",io="clone",no="label-wrapper",so="focus-controls",oo="root",ao="query",ro="link-indicator",lo="link-location-indicator",co="incoming",ho="outgoing",uo="above",vo="below",go=function(){function t(i,n,s,o,a){var r=this;us(this,t),this.vis=i,this.visData=s,this.links=o,this.events=a,this.currentLinks={},this.iconDimension=Math.min(this.visData.global.row.contentHeight/2-2*this.visData.global.cell.padding,this.visData.global.column.padding/2-4),this.linkDensityBg=e.scaleLinear().domain([1,this.vis.rows]).range(["#ccc","#000"]),this.groups=n.append("g").attr("class",Ks).call(function(t){t.each(function(){e.select(this.parentNode).datum().nodes=this})}),this.nodes=this.groups.selectAll("."+to).data(function(t){return t.rows}).enter().append("g").classed(to,!0).classed(io,function(t){return t.clone}).attr("transform",function(t){return"translate("+(t.x+r.visData.global.column.padding)+", "+t.y+")"}),this.nodes.append("rect").call(this.drawMaxSizedRect.bind(this)),this.visNodes=this.nodes.append("g").attr("class",eo),this.visNodes.append("rect").call(this.drawFullSizeRect.bind(this),"bg-border"),this.visNodes.append("rect").call(this.drawFullSizeRect.bind(this),"bg",1,!0),this.vis.showLinkLocation&&(this.nodes.append("rect").call(this.drawLinkLocationIndicator.bind(this),"incoming","above"),this.nodes.append("rect").call(this.drawLinkLocationIndicator.bind(this),"incoming","bottom"),this.nodes.append("rect").call(this.drawLinkLocationIndicator.bind(this),"outgoing","above"),this.nodes.append("rect").call(this.drawLinkLocationIndicator.bind(this),"outgoing","bottom"),this.nodes.append("path").call(this.drawLinkIndicator.bind(this),"incoming"),this.nodes.append("path").call(this.drawLinkIndicator.bind(this),"outgoing"),this.groups.each(function(t,e){r.calcHeightLinkLocationIndicator(e,!0,!0)})),this.nodeRooted=this.nodes.append("g").attr("class",so+" "+oo),this.nodeRooted.append("rect").call(this.setUpFocusControls.bind(this),"left",.6,"hover-helper","hover-helper"),this.nodeRooted.append("svg").call(this.setUpFocusControls.bind(this),"left",.6,"icon","ease-all state-active invisible-default icon").append("use").attr("xlink:href",this.vis.iconPath+"#locked"),this.vis.querying&&(this.nodeQuery=this.nodes.append("g").attr("class",so+" "+ao),this.nodeQuery.append("rect").call(this.setUpFocusControls.bind(this),"right",.6,"hover-helper","hover-helper"),this.nodeQuery.append("svg").call(this.setUpFocusControls.bind(this),"right",.6,"icon","ease-all state-and-or invisible-default icon").append("use").attr("xlink:href",this.vis.iconPath+"#union"),this.nodeQuery.append("svg").call(this.setUpFocusControls.bind(this),"right",.6,"icon","ease-all state-not invisible-default icon").append("use").attr("xlink:href",this.vis.iconPath+"#not")),this.bars=new Zs(this.visNodes,this.vis.barMode,this.visData),this.visNodes.append("rect").call(this.drawFullSizeRect.bind(this),"border"),this.visNodes.append("foreignObject").attr("x",this.visData.global.cell.padding).attr("y",this.visData.global.row.padding+this.visData.global.cell.padding).attr("width",this.visData.global.column.contentWidth).attr("height",this.visData.global.row.contentHeight-2*this.visData.global.cell.padding).attr("class",no).append("xhtml:div").attr("class","label").attr("title",function(t){return t.data.name}).style("line-height",Math.floor(this.visData.global.row.contentHeight-2*this.visData.global.cell.padding)+"px").append("xhtml:span").text(function(t){return t.data.name}),p(this.events.on)&&(this.events.on("d3ListGraphFocusNodes",function(t){return r.focusNodes(t)}),this.events.on("d3ListGraphBlurNodes",function(t){return r.blurNodes(t)}),this.events.on("d3ListGraphNodeEnter",function(t){return r.eventHelper(t,r.highlightNodes)}),this.events.on("d3ListGraphNodeLeave",function(t){return r.eventHelper(t,r.unhighlightNodes)}),this.events.on("d3ListGraphNodeLock",function(t){return r.eventHelper(t,r.toggleLock,[])}),this.events.on("d3ListGraphNodeUnlock",function(t){return r.eventHelper(t,r.toggleLock,[!0])}),this.events.on("d3ListGraphNodeRoot",function(t){return r.eventHelper(t,r.toggleRoot,[!1,!0])}),this.events.on("d3ListGraphNodeUnroot",function(t){return r.eventHelper(t,r.toggleRoot,[!0,!0])}),this.events.on("d3ListGraphNodeQuery",function(t){return r.eventHelper(t.nodeIds,r.queryHandler,["query",t.mode,!0])}),this.events.on("d3ListGraphNodeUnquery",function(t){return r.eventHelper(t.nodeIds,r.queryHandler,["unquery",void 0,!0])})),this.nodes.call(this.isInvisible.bind(this))}return ds(t,[{key:"batchQueryHandler",value:function(t,e){for(var i=[],n=t.length;n--;)i.push(this.queryHandler(t[n].d3El,t[n].action,t[n].mode,!0));e||this.events.broadcast("d3ListGraphBatchQuery",i)}},{key:"blurNodes",value:function(t){this.eventHelper(t.nodeIds,this.unhighlightNodes,["focus","directParentsOnly",!!t.excludeClones]),t.zoomIn&&this.vis.zoomedView(),this.tempHidingUnrelatedNodes&&this.hideUnrelatedNodes(void 0,!0)}},{key:"calcHeightLinkLocationIndicator",value:function(t,e){var i=this.nodes.filter(function(e){return e.depth===t});i.each(function(t){if(e){t.links.outgoing.above=0,t.links.outgoing.below=0;for(var i=t.links.outgoing.total;i--;)(4&t.links.outgoing.refs[i].hidden)>0&&t.links.outgoing.above++,(8&t.links.outgoing.refs[i].hidden)>0&&t.links.outgoing.below++}else{t.links.incoming.above=0,t.links.incoming.below=0;for(var n=t.links.incoming.total;n--;)(1&t.links.incoming.refs[n].hidden)>0&&t.links.incoming.above++,(2&t.links.incoming.refs[n].hidden)>0&&t.links.incoming.below++}}),e?this.updateHeightLinkLocationIndicatorBars(i,!0):this.updateHeightLinkLocationIndicatorBars(i)}},{key:"checkNodeFocusSameEvent",value:function(t){if(!this.nodeFocusIds)return!1;if(t.length!==this.nodeFocusIds.length)return!1;for(var e=t.length;e--;)if(t[e]!==this.nodeFocusIds[e])return!1;return!0}},{key:"drawLinkIndicator",value:function(t,e){var i=this,n="incoming"===e;t.attr("class",ro+" "+(n?co:ho)).attr("d",jt(n?-7:this.visData.global.column.contentWidth,this.visData.global.row.height/2-1,7,2,{topLeft:n?1:0,topRight:n?0:1,bottomLeft:n?1:0,bottomRight:n?0:1})).attr("fill",function(t){return i.linkDensityBg(t.links[e].refs.length)}).classed("visible",function(t){return t.links[e].refs.length>0}).style("transform-origin",(n?0:this.visData.global.column.contentWidth)+"px "+this.visData.global.row.height/2+"px")}},{key:"drawLinkLocationIndicator",value:function(t,e,i,n){var s=this,o="above"===i,a="incoming"===e,r=lo+" "+(a?co:ho)+" "+(o?uo:vo);n||t.datum(function(t){return t.links[e]}),t.attr("class",r).attr("x",a?-5:this.visData.global.column.contentWidth+2).attr("y",o?this.visData.global.row.height/2-1:this.visData.global.row.height/2+1).attr("width",3).attr("height",0).attr("fill",function(t){return s.linkDensityBg(t.refs.length)})}},{key:"drawFullSizeRect",value:function(t,e,i,n){var s=i||0;t.attr("x",s).attr("y",this.visData.global.row.padding+s).attr("width",this.visData.global.column.contentWidth-2*s).attr("height",this.visData.global.row.contentHeight-2*s).attr("rx",n?0:2-s).attr("ry",n?0:2-s).classed(e,!0)}},{key:"drawMaxSizedRect",value:function(t){t.attr("x",0).attr("y",0).attr("width",this.visData.global.column.contentWidth).attr("height",this.visData.global.row.height).attr("class","invisible-container")}},{key:"enterHandler",value:function(t,i){this.highlightNodes(e.select(t));var n={id:i.clone?i.originalNode.id:i.id};this.events.broadcast("d3ListGraphNodeEnter",n)}},{key:"eventHelper",value:function(t,i,n,s){var o=this;this.nodes.filter(function(e){return!!~t.indexOf(e.id)}).each(function(){var t=e.select(this);s&&(t=t.select(s)),i.apply(o,[t].concat(n||[]))})}},{key:"focusNodes",value:function(t){var e=this.checkNodeFocusSameEvent(t.nodeIds);this.nodeFocusIds&&!e&&this.blurNodes({nodeIds:this.nodeFocusIds}),this.nodeFocusIds=t.nodeIds,this.eventHelper(t.nodeIds,this.highlightNodes,["focus","directParentsOnly",!!t.excludeClones,t.zoomOut||t.hideUnrelatedNodes]),t.zoomOut?this.vis.globalView(this.nodes.filter(function(t){return t.hovering>0})):this.vis.zoomedView(),t.hideUnrelatedNodes?e&&this.tempHidingUnrelatedNodes||this.hideUnrelatedNodes(t.nodeIds):this.tempHidingUnrelatedNodes&&this.hideUnrelatedNodes(void 0,!0)}},{key:"hideNodes",value:function(t){this.nodesVisibility(t)}},{key:"hideUnrelatedNodes",value:function(t,e){this.tempHidingUnrelatedNodes=e?void 0:t,this.nodes.filter(function(t){return!t.hovering}).classed("hidden",function(t){return!e||t._hidden}).each(function(t){e?(t.hidden=t._hidden,t._hidden=void 0):(t._hidden=t.hidden,t.hidden=!0)}),this.updateVisibility()}},{key:"highlightNodes",value:function(t,e,i,n,s){function o(t,e){return s||!e.hidden&&!c.vis.isHidden.call(c.vis,t)}function a(t){return 1===t.hovering&&o(this,t)}function r(t){return 2===t.hovering&&o(this,t)}var l=this,c=this,h=t.datum(),u=h.id,d=h.clone?h.originalNode:h,v=!0,g=e||"hovering",p=!n,f="directParentsOnly"!==i;this.currentLinks[g]||(this.currentLinks[g]={}),this.currentLinks[g][u]={};var b=t.selectAll(".bar.active .bar-magnitude");b=b.empty()?void 0:b.datum();var y=function(t,e){t.hovering=2;for(var i=t.links.outgoing.refs.length;i--;)t.links.outgoing.refs[i].target.node.id===e.id&&(l.currentLinks[g][u][t.links.outgoing.refs[i].id]=!0)},m=function(t){t.hovering=2;for(var e=t.links.outgoing.refs.length;e--;)l.currentLinks[g][u][t.links.outgoing.refs[e].id]=!0};if(v&&f&&Ot(h.clone?h.originalNode:h,y,m,void 0,p),v&&!f&&Mt(h,y,void 0,p),!v&&f&&Ht(h.clone?h.originalNode:h,y,void 0,p),d.hovering=1,p)for(var k=d.clones.length;k--;)d.clones[k].hovering=1;this.nodes.filter(a).classed(g+"-directly",!0),this.nodes.filter(r).classed(g+"-indirectly",!0),this.links.highlight(this.currentLinks[g][h.id],!0,g)}},{key:"isInvisible",value:function(t,e){var i=this;t.classed("invisible",function(t){var n=e||i.visData.nodes[t.depth].scrollTop;return t.x+i.vis.dragged.x>=i.vis.width?t.invisible=!0:t.y+n>=i.vis.height?t.invisible=!0:t.y+i.visData.global.row.height+n<=0?t.invisible=!0:t.x+i.vis.dragged.x+i.visData.global.column.width<=0?t.invisible=!0:t.invisible=!1})}},{key:"leaveHandler",value:function(t,i){this.unhighlightNodes(e.select(t));var n={id:i.clone?i.originalNode.id:i.id};this.events.broadcast("d3ListGraphNodeLeave",n)}},{key:"lockHandler",value:function(t){var e=this.toggleLock(t);e.locked&&e.unlocked?this.events.broadcast("d3ListGraphNodeLockChange",{lock:{id:e.locked.id},unlock:{id:e.unlocked.id}}):(e.locked&&this.events.broadcast("d3ListGraphNodeLock",{id:e.locked.id}),e.unlocked&&this.events.broadcast("d3ListGraphNodeUnlock",{id:e.unlocked.id}))}},{key:"lockNode",value:function(t){var i=this,n=this.nodes.filter(function(e){return e.id===t});n.each(function(t){i.highlightNodes(e.select(this),"lock",void 0),t.data.state.lock=!0})}},{key:"makeAllTempVisible",value:function(t){t?this.nodes.classed("invisible",function(t){var e=t._invisible;return t._invisible=void 0,e}):this.nodes.classed("invisible",function(t){return t._invisible=t.invisible,!1})}},{key:"nodesVisibility",value:function(t,e){e?this.nodes.classed("hidden",!1).each(function(t){t.hidden=!1}):(this.nodes.each(function(t){t.hidden=!t.data.state.query}),Ot(t,function(t){t.hidden=!1}),Rt(t,function(t){t.hidden=!1}),this.nodes.classed("hidden",function(t){return t.hidden})),this.updateVisibility()}},{key:"queryHandler",value:function(e,i,n,s){var o=e.datum(),a=o.data.state.query,r={};if(a||"unquery"!==i){switch(i){case"query":t.setNodeQueryState(e,n);break;case"unquery":this.unsetNodeQueryState(e);break;default:this.toggleNodeQueryStates(e)}return o.data.state.query?o.data.state.query!==a&&(r.name="d3ListGraphNodeQuery",r.data={id:o.clone?o.originalNode.id:o.id,mode:o.data.state.query}):(r.name="d3ListGraphNodeUnquery",r.data={id:o.clone?o.originalNode.id:o.id}),r.name&&!s&&this.events.broadcast(r.name,r.data),r.name?r:void 0}}},{key:"reRender",value:function(t){var i=this;t&&(this.visData=t,this.groups.data(this.visData.nodes).call(function(t){t.each(function(){e.select(this.parentNode).datum().nodes=this})})),this.nodes=this.groups.selectAll("."+to).data(function(t){return t.rows}).attr("transform",function(t){return"translate("+(t.x+i.visData.global.column.padding)+", "+t.y+")"}),this.nodes.selectAll(".invisible-container").call(this.drawMaxSizedRect.bind(this)),this.visNodes.selectAll(".bg-border").call(this.drawFullSizeRect.bind(this),"bg-border"),this.visNodes.selectAll(".bg").call(this.drawFullSizeRect.bind(this),"bg",1,!0),this.visNodes.selectAll(".border").call(this.drawFullSizeRect.bind(this),"border"),this.vis.showLinkLocation&&(this.nodes.selectAll(".link-location-indicator.incoming.above").call(this.drawLinkLocationIndicator.bind(this),"incoming","above",!0),this.nodes.selectAll(".link-location-indicator.incoming.below").call(this.drawLinkLocationIndicator.bind(this),"incoming","bottom",!0),this.nodes.selectAll(".link-location-indicator.outgoing.above").call(this.drawLinkLocationIndicator.bind(this),"outgoing","above",!0),this.nodes.selectAll(".link-location-indicator.outgoing.below").call(this.drawLinkLocationIndicator.bind(this),"outgoing","bottom",!0),this.nodes.selectAll(".link-indicator.incoming").call(this.drawLinkIndicator.bind(this),"incoming"),this.nodes.selectAll(".link-indicator.outgoing").call(this.drawLinkIndicator.bind(this),"outgoing"),this.groups.each(function(t,e){i.calcHeightLinkLocationIndicator(e,!0,!0)})),this.nodes.selectAll("."+so+"."+oo+" .hover-helper").call(this.setUpFocusControls.bind(this),"left",.6,"hover-helper","hover-helper"),this.nodes.selectAll("."+so+"."+oo+" .icon").call(this.setUpFocusControls.bind(this),"left",.6,"icon","ease-all state-active invisible-default icon"),this.vis.querying&&(this.nodes.selectAll("."+so+"."+ao+" .hover-helper").call(this.setUpFocusControls.bind(this),"right",.6,"hover-helper","hover-helper"),this.nodes.selectAll("."+so+"."+ao+" .state-and-or.icon").call(this.setUpFocusControls.bind(this),"right",.6,"icon","ease-all state-and-or invisible-default icon"),this.nodes.selectAll("."+so+"."+ao+" .state-not.icon").call(this.setUpFocusControls.bind(this),"right",.6,"icon","ease-all state-not invisible-default icon")),this.bars.reRender(this.visData,this.vis.currentSorting.global.type),this.visNodes.selectAll("."+no).attr("x",this.visData.global.cell.padding).attr("y",this.visData.global.row.padding+this.visData.global.cell.padding).attr("width",this.visData.global.column.contentWidth).attr("height",this.visData.global.row.contentHeight-2*this.visData.global.cell.padding),this.visNodes.selectAll("."+no+" .label").style("line-height",Math.floor(this.visData.global.row.contentHeight-2*this.visData.global.cell.padding)+"px"),this.nodes.call(this.isInvisible.bind(this))}},{key:"rootHandler",value:function(t,e){if(t.datum().data.state.root||!e){var i=this.toggleRoot(t,e);i.rooted&&i.unrooted?this.events.broadcast("d3ListGraphNodeReroot",{rooted:{id:i.rooted.clone?i.rooted.originalNode.id:i.rooted.id},unrooted:{id:i.unrooted.clone?i.unrooted.originalNode.id:i.unrooted.id}}):(i.rooted&&this.events.broadcast("d3ListGraphNodeRoot",{id:i.rooted.clone?i.rooted.originalNode.id:i.rooted.id}),i.unrooted&&this.events.broadcast("d3ListGraphNodeUnroot",{id:i.unrooted.clone?i.unrooted.originalNode.id:i.unrooted.id}))}}},{key:"rootNode",value:function(t){var e=t.datum();return e.data.state.root=!0,t.classed("rooted",!0),this.hideNodes(e),this.vis.levels.focus(e.depth+this.vis.activeLevel),e.data.state.query&&"not"!==e.data.state.query?(e.data.queryBeforeRooting=!0,{query:!1}):(e.data.queryBeforeRooting=!1,{query:!0})}},{key:"setUpFocusControls",value:function(t,e,i,n,s){var o=this.iconDimension+4,a=0-o*(i+1);"right"===e&&(a=this.visData.global.column.contentWidth+2+o*i);var r=this.visData.global.row.padding+(this.visData.global.row.contentHeight-2*this.visData.global.cell.padding)/4;"bg"===n?t.attr("class",s).attr("cx",a+this.iconDimension/2).attr("cy",r+this.iconDimension/2).attr("r",3*this.iconDimension/4):"hover-helper"===n?t.attr("class",s).attr("x",a-4).attr("y",(this.visData.global.row.height-(this.iconDimension+8))/2).attr("width",this.iconDimension+8).attr("height",this.iconDimension+8).attr("rx",this.iconDimension).attr("ry",this.iconDimension):t.attr("class",s).attr("x",a).attr("y",(this.visData.global.row.height-this.iconDimension)/2).attr("width",this.iconDimension).attr("height",this.iconDimension)}},{key:"showNodes",value:function(){this.nodesVisibility(void 0,!0)}},{key:"sort",value:function(t,e){for(var i=this,n=t.length;n--;){var s=this.nodes.data(t[n].rows,function(t){return t.id});this.vis.svgD3.classed("sorting",!0),s.transition().duration(Rs).attr("transform",function(t){return"translate("+(t.x+i.visData.global.column.padding)+", "+t.y+")"}).call(Ft,function(){i.vis.svgD3.classed("sorting",!1),i.vis.updateLevelsVisibility(),i.vis.updateScrolling()}),e&&"name"!==this.vis.currentSorting.local[t[n].level].type&&this.bars.update(s.selectAll(".bar"),t[n].sortBy)}}},{key:"toggleLock",value:function(t,e){var i=t.datum(),n={locked:!1,unlocked:!1};return this.lockedNode?this.lockedNode.datum().id===i.id?(this.unlockNode(this.lockedNode.datum().id),n.unlocked=this.lockedNode.datum(),this.lockedNode=void 0):(this.unlockNode(this.lockedNode.datum().id),n.unlocked=this.lockedNode.datum(),e||(this.lockNode(i.id),n.locked=i,this.lockedNode=t)):e||(this.lockNode(i.id),n.locked=i,this.lockedNode=t),n}},{key:"toggleNodeQueryStates",value:function(e){var i=e.datum(),n=i.data.state.query;if(i.data.state.root)"or"!==n?t.setNodeQueryState(e,"or"):t.setNodeQueryState(e,"and");else switch(n){case"or":t.setNodeQueryState(e,"and");break;case"and":t.setNodeQueryState(e,"not");break;case"not":this.unsetNodeQueryState(e);break;default:
t.setNodeQueryState(e,"or")}}},{key:"toggleRoot",value:function(t,e,i){var n=t.datum(),s={rooted:!1,unrooted:!1},o=[];return this.vis.levels.blur(),this.rootedNode?(this.rootedNode.classed("active",!1).classed("inactive",!0),s.unrooted=this.rootedNode.datum(),this.unrootNode(this.rootedNode).unquery&&o.push({d3El:this.rootedNode,action:"unquery"}),this.rootedNode.datum().id===n.id||e?(this.rootedNode=void 0,this.vis.levels.focus(this.vis.activeLevel-this.vis.noRootActiveLevelDiff)):(t.classed("active",!0).classed("inactive",!1),this.rootedNode=t,s.rooted=t.datum(),this.rootNode(t).query&&o.push({d3El:t,action:"query",mode:"or"}))):e||(t.classed("active",!0).classed("inactive",!1),this.rootedNode=t,s.rooted=t.datum(),this.rootNode(t).query&&o.push({d3El:t,action:"query",mode:"or"})),o.length&&this.batchQueryHandler(o,i),s}},{key:"unhighlightNodes",value:function(t,e,i,n){var s=t.datum(),o=function(t){t.hovering=0},a=!0,r=e||"hovering",l=!n,c="directParentsOnly"!==i;if(s.hovering=0,a&&c&&Ot(s,o,void 0,void 0,l),a&&!c&&Mt(s,o,void 0,l),!a&&c&&Ht(s,o,void 0,l),s.clone)s.originalNode.hovering=0;else if(l)for(var h=s.clones.length;h--;)s.clones[h].hovering=0;this.nodes.classed(r+"-directly",!1),this.nodes.classed(r+"-indirectly",!1),this.currentLinks[r]&&this.currentLinks[r][s.id]&&this.links.highlight(this.currentLinks[r][s.id],!1,r)}},{key:"unlockNode",value:function(t){var i=this,n=this.nodes.filter(function(e){return e.id===t});n.each(function(t){i.unhighlightNodes(e.select(this),"lock",void 0),t.data.state.lock=void 0})}},{key:"unrootNode",value:function(t){var e=t.datum();return e.data.state.root=!1,t.classed("rooted",!1),this.showNodes(),e.data.queryBeforeRooting?{unquery:!1}:{unquery:!0}}},{key:"unsetNodeQueryState",value:function(t){var e=t.datum();e.data.state.query=void 0,e.data.queryBeforeRooting=void 0,t.classed("active",!0).classed("inactive",!1).classed("query-and",!1).classed("query-or",!1).classed("query-not",!1),this.rootedNode&&this.hideNodes(this.rootedNode.datum())}},{key:"updateHeightLinkLocationIndicatorBars",value:function(t,e){var i=this.visData.global.row.contentHeight/2-1,n=this.visData.global.row.height/2-1,s="."+lo+"."+(e?ho:co);t.selectAll(s+"."+uo).attr("y",function(t){return t.total?n-t.above/t.total*i:n}).attr("height",function(t){return t.total?t.above/t.total*i:0}),t.selectAll(s+"."+vo).attr("height",function(t){return t.total?t.below/t.total*i:0})}},{key:"updateLinkLocationIndicators",value:function(t,e){this.calcHeightLinkLocationIndicator(t,!0),this.calcHeightLinkLocationIndicator(e)}},{key:"updateVisibility",value:function(){var t=this;this.vis.layout.updateNodesVisibility(),this.nodes.transition().duration(Rs).attr("transform",function(e){return"translate("+(e.x+t.visData.global.column.padding)+", "+e.y+")"}).call(Ft,function(){t.vis.updateLevelsVisibility(),t.vis.updateScrolling(),t.nodes.call(t.isInvisible.bind(t))}),this.vis.links.updateVisibility()}},{key:"barMode",get:function(){return this.bars.mode}}],[{key:"setNodeQueryState",value:function(t,e){t.datum().data.state.query=e,t.classed("active",!0).classed("inactive",!1).classed("query-and","and"===e).classed("query-or","or"===e).classed("query-not","not"===e)}},{key:"classNodeVisible",get:function(){return eo}},{key:"classFocusControls",get:function(){return so}},{key:"classRoot",get:function(){return oo}},{key:"classQuery",get:function(){return ao}}]),t}(),po="scrollbar",fo=function(){function t(i,n,s){us(this,t),this.visData=n,this.width=s,this.all=i.append("rect").attr("class",po).call(function(t){t.each(function(){e.select(this.parentNode).datum().scrollbar.el=this})}).attr("x",function(t){return t.scrollbar.x-2}).attr("y",function(t){return t.scrollbar.y}).attr("width",this.width).attr("height",function(t){return t.scrollbar.height}).attr("rx",this.width/2).attr("ry",this.width/2).classed("ready",!0)}return ds(t,[{key:"reRender",value:function(t){t&&(this.visData=t),this.all.data(this.visData.nodes).call(function(t){t.each(function(){e.select(this.parentNode).datum().scrollbar.el=this})}),this.updateVisibility()}},{key:"updateVisibility",value:function(){this.all.transition().duration(Os).attr("x",function(t){return t.scrollbar.x}).attr("height",function(t){return t.scrollbar.height})}}]),t}(),bo=function(){function t(e,i){if(us(this,t),i&&!p(i))throw new ys;this.el=e,this._stack={},this.dispatch=i||this._dispatchEvent}return ds(t,[{key:"_dispatchEvent",value:function(t,e){var i=document.createEvent("CustomEvent");i.initCustomEvent(t,!1,!1,e),this.el.dispatchEvent(i)}},{key:"broadcast",value:function(t,e){this.dispatch(t,e)}},{key:"on",value:function(t,e,i){if(!p(e))return!1;var n=Ct(i)?parseInt(i,10):1/0;return Re(this.stack[t])?this.stack[t].push({callback:e,times:n})-1:(this.stack[t]=[{callback:e,times:n}],0)}},{key:"off",value:function(t,e){try{return this.stack[t].splice(e,1),!0}catch(t){return!1}}},{key:"trigger",value:function(t,e){if(Re(this.stack[t])){for(var i=this.stack[t].length;i--;)this.stack[t][i].times--?this.stack[t][i].callback(e):this.off(t,i);return!0}return!1}},{key:"stack",get:function(){return this._stack}}]),t}();hs=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var yo,mo,ko,wo=hs,xo=0,Do=function(t,e){Bo[xo]=t,Bo[xo+1]=e,xo+=2,2===xo&&(mo?mo(Yt):ko())},_o="undefined"!=typeof window?window:void 0,So=_o||{},Lo=So.MutationObserver||So.WebKitMutationObserver,Co="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),No="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Bo=new Array(1e3);ko=Co?qt():Lo?Qt():No?Gt():void 0===_o&&"function"==typeof require?Jt():Ut();var Mo=Math.random().toString(36).substring(16),Ao=void 0,Ho=1,Oo=2,Ro=new de,jo=new de,zo=0;ye.prototype._enumerate=function(){for(var t=this.length,e=this._input,i=0;this._state===Ao&&i<t;i++)this._eachEntry(e[i],i)},ye.prototype._eachEntry=function(t,e){var i=this._instanceConstructor,n=i.resolve;if(n===Xt){var s=ee(t);if(s===$t&&t._state!==Ao)this._settledAt(t._state,e,t._result);else if("function"!=typeof s)this._remaining--,this._result[e]=t;else if(i===Se){var o=new i(Zt);oe(o,t,s),this._willSettleAt(o,e)}else this._willSettleAt(new i(function(e){e(t)}),e)}else this._willSettleAt(n(t),e)},ye.prototype._settledAt=function(t,e,i){var n=this.promise;n._state===Ao&&(this._remaining--,t===Oo?ce(n,i):this._result[e]=i),0===this._remaining&&le(n,this._result)},ye.prototype._willSettleAt=function(t,e){var i=this;he(t,void 0,function(t){i._settledAt(Ho,e,t)},function(t){i._settledAt(Oo,e,t)})},Se.all=ke,Se.race=we,Se.resolve=Xt,Se.reject=xe,Se._setScheduler=It,Se._setAsap=Tt,Se._asap=Do,Se.prototype={constructor:Se,then:$t,catch:function(t){return this.then(null,t)}};var Eo=function(){return qe.Date.now()},Fo="[object Symbol]",Vo=Object.prototype,Po=Vo.toString,Io=NaN,To=/^\s+|\s+$/g,qo=/^[-+]0x[0-9a-f]+$/i,Wo=/^0b[01]+$/i,Qo=/^0o[0-7]+$/i,Go=parseInt,Uo="Expected a function",Yo=Math.max,Jo=Math.min,$o=function(){var t=0;return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){var i=(new Date).getTime(),n=Math.max(0,16-(i-t)),s=window.setTimeout(function(){e(i+n)},n);return t=i+n,s}}(),Xo=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){window.clearTimeout(t)}}(),Zo=function(){function t(){var t=void 0;do t=Math.floor(1e9*Math.random());while(t in e);return t}var e={};return{request:window.requestNextAnimationFrame||function(i,n){var s=t();return e[s]=$o(function(){e[s]=$o(function(t){delete e[s],i(t)},n)},n),s},cancel:window.cancelNextAnimationFrame||function(t){e[t]&&(Xo(e[t]),delete e[t])}}}(),Ko=Zo.request,ta="context-menu",ea="checkbox",ia=6,na=125,sa=666,oa=500,aa=150,ra=700,la=function(){function t(e){var i=this;us(this,t);var n=this;if(this._x=0,this._y=0,this._yOffset=0,this._scale=0,this.visData=e.visData,this.baseEl=e.baseEl,this.events=e.events,this.nodes=e.nodes,this.isQueryable=e.isQueryable,this.infoFields=e.infoFields,this.isDebounced=e.isDebounced,this.iconPath=e.iconPath,this.numButtonRows=1,this.numButtonRows=this.isQueryable?++this.numButtonRows:this.numButtonRows,this.numButtonRows=this.infoFields&&this.infoFields.length?++this.numButtonRows:this.numButtonRows,this.height=this.visData.global.row.height*this.numButtonRows,this.toBottom=!1,this.nodeInfoId=0,this.wrapper=this.baseEl.append("g").attr("class",ta),this.updateAppearance(),this.bgWrapper=this.wrapper.append("g").classed("bg-outer-wrapper",!0).attr("transform","translate("+this.visData.global.column.width/2+" "+this.height/2+")").append("g").classed("bg-inner-wrapper",!0),this.bgBorder=this.bgWrapper.append("path").attr("class","bgBorder").attr("d",zt({x:-1,y:-1,width:this.visData.global.column.width+2,height:this.height+2,radius:ia-2,arrowSize:ia})).attr("transform","translate("+-this.visData.global.column.width/2+" "+-this.height/2+")"),this.bg=this.bgWrapper.append("path").attr("class","bg").attr("d",zt({x:0,y:0,width:this.visData.global.column.width,height:this.height,radius:ia-1,arrowSize:ia})).style("filter","url(#drop-shadow-context-menu)").attr("transform","translate("+-this.visData.global.column.width/2+" "+-this.height/2+")"),this.infoFields&&this.infoFields.length&&(this.textNodeInfo=this.wrapper.append("g").call(this.createTextField.bind(this),{alignRight:!1,classNames:[],distanceFromCenter:this.isQueryable?2:1,fullWidth:!0,labels:this.infoFields},this.infoFields.length>1),this.infoFields.length>1)){var s=this.textNodeInfo.append("g").attr("class","toggler").on("click",function(){n.clickNodeInfo.call(n,this)}),o=this.visData.global.column.width-this.visData.global.row.contentHeight-this.visData.global.row.padding+this.visData.global.cell.padding,a=this.visData.global.row.padding+this.visData.global.cell.padding;s.append("rect").attr("class","bg").attr("x",o).attr("y",a).attr("width",this.visData.global.row.contentHeight).attr("height",this.visData.global.row.contentHeight),s.append("use").attr("x",o+(this.visData.global.row.contentHeight-10)/2).attr("y",a+(this.visData.global.row.contentHeight-10)/2).attr("width",10).attr("height",10).attr("xlink:href",this.iconPath+"#arrow-right")}this.isQueryable&&(this.buttonQuery=this.wrapper.append("g").call(this.createButton.bind(this),{alignRight:!1,classNames:[],distanceFromCenter:1,fullWidth:!0,label:"Query",labelTwo:!0,bamEffect:!0,unselectable:!0}).on("click",function(){n.clickQueryHandler.call(n,this)}),this.buttonQueryFill=this.buttonQuery.select(".bg-fill-effect"),this.buttonQueryBamEffect=this.buttonQuery.select(".bam-effect")),this.buttonRoot=this.wrapper.append("g").call(this.createButton.bind(this),{alignRight:!1,classNames:[],distanceFromCenter:0,fullWidth:!1,label:"Root",unselectable:!0}).on("click",function(){n.clickRootHandler.call(n,this)}),this.buttonRootFill=this.buttonRoot.select(".bg-fill-effect"),this.checkboxRoot=this.createCheckbox(this.buttonRoot),this.buttonLock=this.wrapper.append("g").call(this.createButton.bind(this),{alignRight:!0,classNames:[],distanceFromCenter:0,fullWidth:!1,label:"Lock",bamEffect:!0,unselectable:!0}).on("click",function(){n.clickLockHandler.call(n,this)}),this.buttonLockFill=this.buttonLock.select(".bg-fill-effect"),this.buttonLockBamEffect=this.buttonLock.select(".bam-effect"),this.checkboxLock=this.createCheckbox(this.buttonLock),this.components=this.wrapper.selectAll(".component"),this.debouncedQueryHandler=Ne(this.queryHandler,sa),this.debouncedRootHandler=Ne(this.rootHandler,oa),this.events.on("d3ListGraphNodeLock",function(){i.node&&i.clickLockHandler()}),this.events.on("d3ListGraphNodeUnlock",function(){return i.updateStates()}),this.events.on("d3ListGraphNodeRoot",function(){return i.close()}),this.events.on("d3ListGraphNodeUnroot",function(){return i.close()}),this.events.on("d3ListGraphNodeQuery",function(){return Ko(function(){i.updateStates()})}),this.events.on("d3ListGraphNodeUnquery",function(){return Ko(function(){i.updateStates()})})}return ds(t,[{key:"addLabel",value:function(t,e,i,n,s,o){var a=this.visData.global.column.width*(e?1:.5)-4*this.visData.global.row.padding-(s?this.visData.global.row.contentHeight:0),r=this.visData.global.row.contentHeight-2*this.visData.global.cell.padding,l=t.append("foreignObject").attr("x",2*this.visData.global.row.padding).attr("y",this.visData.global.row.padding+this.visData.global.cell.padding).attr("width",a).attr("height",r).classed("label-wrapper",!0).classed("unselectable",o).append("xhtml:div").style("line-height",r-2+"px").style("width",a+"px");l.append("xhtml:span").attr("class","label").text(i),n&&(l.append("xhtml:span").attr("class","separator").text(":"),l.append("xhtml:span").attr("class","label-two"))}},{key:"checkLock",value:function(e){var i=this.node.datum().data.state.lock;return this.buttonLock.classed("semi-active",i),this.buttonLock.classed("active",!e),this.checkboxLock.style("transform","translateX("+(i?this.checkBoxMovement:0)+"px)"),i?t.fillButton(this.buttonLockFill):t.emptyButton(this.buttonLockFill),i}},{key:"checkOrientation",value:function(){this._y+this._yOffset>=0?this.toBottom=!1:this.toBottom=!0,this.components.call(this.positionComponent.bind(this)),this.bgWrapper.classed("is-mirrored-horizontally",this.toBottom);var t="translate("+-this.visData.global.column.width/2+" "+-(this.height/2+(this.toBottom?ia:0))+")";this.bg.attr("transform",t).style("filter","url(#drop-shadow-context-menu"+(this.toBottom?"-inverted":"")+")"),this.bgBorder.attr("transform",t)}},{key:"checkRoot",value:function(e,i){var n=this.node.datum().data.state.root,s=n;e&&("undefined"==typeof this.currentRootState&&(this.currentRootState=!!n),"undefined"==typeof this.tempRoot&&(this.tempRoot=this.currentRootState),this.tempRoot=!this.tempRoot,s=this.tempRoot),n?e?s?t.showElement(this.buttonRootFill):t.emptyButton(this.buttonRootFill,i):t.fillButton(this.buttonRootFill,i):e?s?t.fillButton(this.buttonRootFill,i):t.hideElement(this.buttonRootFill):t.emptyButton(this.buttonRootFill,i),this.buttonRoot.classed("semi-active",s),this.buttonRoot.classed("active",!e),this.checkboxRoot.style("transform","translateX("+(s?this.checkBoxMovement:0)+"px)")}},{key:"clickLockHandler",value:function(){var e=this;this.buttonLock.classed("fill-effect",!0),this.nodes.lockHandler(this.node);var i=this.checkLock(aa);setTimeout(function(){i&&(t.triggerButtonBamEffect(e.buttonLockBamEffect),e.buttonLock.classed("active",!0)),e.buttonLock.classed("fill-effect",!1)},aa)}},{key:"clickNodeInfo",value:function(){var t=this;this.nodeInfoId=(this.nodeInfoId+1)%this.infoFields.length;var e=this.textNodeInfo.select(".label-wrapper");e.attr("opacity",1).transition().duration(Os).attr("opacity",0).call(Ft,function(){t.textNodeInfo.select(".label").text(t.infoFields[t.nodeInfoId].label),t.textNodeInfo.select(".label-two").text(t.getNodeProperty(t.infoFields[t.nodeInfoId].property)),e.transition().duration(Os).attr("opacity",1)})}},{key:"clickQueryHandler",value:function(){this.buttonQuery.classed("fill-effect",!0),this.updateQuery(!0,sa),this.isDebounced?this.debouncedQueryHandler(!0):this.queryHandler()}},{key:"clickRootHandler",value:function(){this.buttonRoot.classed("fill-effect",!0),this.checkRoot(!0,oa),this.isDebounced?this.debouncedRootHandler(!0):this.rootHandler()}},{key:"close",value:function(){var t=this;return this.node&&!this.closing&&(this.closing=new Se(function(e){t.opened=!1,t.updateAppearance(),setTimeout(function(){t.visible=!1,t.updateAppearance(),e(t.node.datum().id),t.node=void 0},na)})),this.closing}},{key:"createButton",value:function(t,e){var i="component button";e.classNames&&e.classNames.length&&(i+=" "+e.classNames.join(" ")),t.attr("class",i),t.datum(e).call(this.createButtonBg.bind(this),{bamEffect:e.bamEffect,fullWidth:e.fullWidth}).call(this.addLabel.bind(this),e.fullWidth,e.label,e.labelTwo,!1,e.unselectable).call(this.positionComponent.bind(this),e.distanceFromCenter,e.alignRight)}},{key:"createButtonBg",value:function(t,e){var i=this;t.datum(function(t){return t.x=i.visData.global.row.padding,t.y=i.visData.global.row.padding,t.width=i.visData.global.column.width*(e.fullWidth?1:.5)-2*i.visData.global.row.padding,t.height=i.visData.global.row.contentHeight,t.rx=2,t.ry=2,t}).append("rect").attr("class","bg").attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("width",function(t){return t.width}).attr("height",function(t){return t.height}).attr("rx",function(t){return t.rx}).attr("ry",function(t){return t.ry}),t.append("rect").attr("class","bg-fill-effect").attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("width",function(t){return t.width}).attr("height",0).attr("rx",function(t){return t.rx}).attr("ry",function(t){return t.ry}),e.bamEffect&&t.append("g").attr("transform",function(t){return"translate("+t.width/2+" "+t.height/2+")"}).append("g").attr("class","bam-effect").append("rect").attr("class","bam-effect-bg").attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("width",function(t){return t.width}).attr("height",function(t){return t.height}).attr("rx",function(t){return t.rx}).attr("ry",function(t){return t.ry}).attr("transform",function(t){return"translate("+-t.width/2+" "+-t.height/2+")"})}},{key:"createCheckbox",value:function(t){var e=Math.round(t.datum().height/2),i=-1.75*e+this.visData.global.row.padding,n=t.append("g").attr("class",ea);return n.append("rect").attr("class","checkbox-bg").attr("x",function(t){return t.width+i}).attr("y",e/2+this.visData.global.row.padding).attr("width",1.5*e).attr("height",e).attr("rx",e/2).attr("ry",e/2),this.checkBoxMovement=(e-2)/2,n.append("rect").attr("class","checkbox-knob").attr("x",function(t){return t.width+i+1}).attr("y",e/2+this.visData.global.row.padding+1).attr("width",e-2).attr("height",e-2).attr("rx",e-2)}},{key:"createTextField",value:function(t,e,i){var n="component text-field";e.classNames&&e.classNames.length&&(n+=" "+e.classNames.join(" ")),t.attr("class",n),t.datum(e).call(this.addLabel.bind(this),!0,e.labels[this.nodeInfoId].label,!0,i).call(this.positionComponent.bind(this),e.distanceFromCenter,e.alignRight)}},{key:"destroy",value:function(){var t=this.wrapper.node().cloneNode(!0);this.baseEl.node().replaceChild(t,this.wrapper.node()),this.baseEl.node().removeChild(t)}},{key:"getNodeProperty",value:function(t){try{return t(this.node.datum())}catch(t){return}}},{key:"isOpenSameColumn",value:function(t){return this.opened&&this.node.datum().depth===t}},{key:"open",value:function(t){var e=this;return new Se(function(i){e.node=t,e.closing=void 0,e.updateStates(),e._yOffset=e.visData.nodes[e.node.datum().depth].scrollTop,e.translate={x:e.node.datum().x,y:e.node.datum().y-e.height},e.checkOrientation(),e.updateAppearance(),e.opened=!0,e.visible=!0,Ko(function(){e.updateAppearance(),setTimeout(function(){i(!0)},na)})})}},{key:"positionComponent",value:function(t,e,i){var n=this;t.datum(function(t){return e&&(t.distanceFromCenter=e),i&&(t.alignRight=i),t}).attr("transform",function(t){var e=t.alignRight?n.visData.global.column.width/2:0,i=n.visData.global.row.height*(n.toBottom?t.distanceFromCenter:n.numButtonRows-t.distanceFromCenter-1)+(n.toBottom?ia:0);return"translate("+e+", "+i+")"})}},{key:"queryHandler",value:function(e){e?this.tempQueryMode!==this.currentQueryMode&&(this.tempQueryMode?(this.nodes.queryHandler(this.node,"query",this.tempQueryMode),t.triggerButtonBamEffect(this.buttonQueryBamEffect),this.buttonQuery.classed("active",!0)):(this.nodes.queryHandler(this.node,"unquery"),this.buttonQuery.classed("active",!1))):this.nodes.queryHandler(this.node),this.tempQueryMode=void 0,this.currentQueryMode=void 0,this.buttonQuery.classed("fill-effect",!1)}},{key:"rootHandler",value:function(t){t&&this.tempRoot===this.currentRootState||(this.close(),this.nodes.rootHandler(this.node)),this.tempRoot=void 0,this.currentRootState=void 0,this.buttonRoot.classed("fill-effect",!1)}},{key:"scrollY",value:function(t){this._yOffset=t,this.updateAppearance()}},{key:"toggle",value:function(t){var e=this;return new Se(function(i){var n=t.datum().id,s=Se.resolve();e.visible&&(s=e.close()),s.then(function(s){n!==s?e.open(t).then(function(){i(n)}):i(n)})})}},{key:"updateAppearance",value:function(){var t=this.toBottom?0:this.height+this.visData.global.row.height;this.wrapper.classed("transitionable",this.visible).classed("open",this.opened).style("transform",this.translate+" "+this.scale).style("transform-origin",this.visData.global.column.width/2+"px "+t+"px")}},{key:"updateInfoText",value:function(){this.infoFields&&this.infoFields.length&&(this.textNodeInfo.select(".label").text(this.infoFields[this.nodeInfoId].label),this.textNodeInfo.select(".label-two").text(this.getNodeProperty(this.infoFields[this.nodeInfoId].property)))}},{key:"updatePosition",value:function(){this.node&&this.opened&&this.open(this.node)}},{key:"updateQuery",value:function(e,i){function n(t){switch(t){case"or":return"and";case"and":return"not";case"not":return null;default:return"or"}}if(this.isQueryable){var s=this.node.datum().data.state.query,o=s;e&&("undefined"==typeof this.currentQueryMode&&(this.currentQueryMode=s),"undefined"==typeof this.tempQueryMode&&(this.tempQueryMode=this.currentQueryMode),this.tempQueryMode=n(this.tempQueryMode),o=this.tempQueryMode),e?o?o===s?t.showElement(this.buttonQueryFill):t.fillButton(this.buttonQueryFill,i):s?t.emptyButton(this.buttonQueryFill,i):t.hideElement(this.buttonQueryFill):t.emptyButton(this.buttonQueryFill,i),this.buttonQuery.classed("semi-active",!!o).classed("active",!!s).select(".label-two").text(o||"not queried").classed("inactive",!o)}}},{key:"updateStates",value:function(){this.node&&(this.checkLock(),this.checkRoot(),this.updateQuery(),this.updateInfoText())}},{key:"scale",get:function(){return"scale("+(this.opened?1:.5)+")"}},{key:"translate",get:function(){var t=this.toBottom?this._y+this.height+this.visData.global.row.height-ia:this._y;return"translate("+this._x+"px,"+(t+this._yOffset)+"px)"},set:function(t){this._x=t.x,this._y=t.y}}],[{key:"emptyButton",value:function(t,i){t.transition().duration(0).attr("y",function(t){return t.y}).attr("height",function(t){return t.height}).call(Ft,function(){t.transition().duration(i||aa).ease(e.easeLinear).attr("y",function(t){return t.height}).attr("height",0)})}},{key:"fillButton",value:function(t,i){t.transition().duration(0).attr("y",function(t){return t.y}).attr("height",0).call(Ft,function(){t.transition().duration(i||aa).ease(e.easeLinear).attr("height",function(t){return t.height})})}},{key:"hideElement",value:function(t){t.transition().duration(0).attr("height",0)}},{key:"showElement",value:function(t){t.transition().duration(0).attr("y",function(t){return t.y}).attr("height",function(t){return t.height})}},{key:"triggerButtonBamEffect",value:function(t){t.classed("trigger",!0),setTimeout(function(){t.classed("trigger",!1)},ra)}}]),t}(),ca=function(t){function e(t){return us(this,e),gs(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t||"The limits are wrongly formatted. Please provide an object of the following format: `{ x: { min: 0, max: 1 }, y: { min: 0, max: 1 } }`"))}return vs(e,t),e}(ps),ha={id:"arrow-down",paths:["M2.539,2.667L0,5.236l8,8.097l8-8.097l-2.538-2.569L8,8.196L2.539,2.667z"],viewBox:"0 0 16 16"},ua={id:"arrow-right",paths:["M8.196,8l-5.529,5.462L5.236,16l8.097-8L5.236,0L2.667,2.539L8.196,8z"],viewBox:"0 0 16 16"},da={id:"sort-asc",paths:["M10.718,2V0.286c0-0.083-0.026-0.152-0.079-0.206C10.584,0.026,10.516,0,10.434,0H8.146C8.063,0,7.995,0.027,7.941,0.081C7.887,0.135,7.86,0.203,7.86,0.286V2c0,0.083,0.027,0.151,0.081,0.205c0.054,0.054,0.122,0.081,0.205,0.081h2.286c0.084,0,0.151-0.027,0.205-0.081C10.691,2.151,10.718,2.083,10.718,2z M6.432,12.857c0-0.084-0.027-0.152-0.08-0.207c-0.054-0.053-0.123-0.08-0.206-0.08H4.432V0.285c0-0.083-0.027-0.151-0.08-0.205C4.298,0.025,4.229,0,4.146,0H2.432C2.349,0,2.28,0.025,2.228,0.081C2.174,0.135,2.147,0.203,2.147,0.286v12.286H0.433c-0.131,0-0.221,0.059-0.268,0.178c-0.048,0.113-0.027,0.217,0.062,0.312l2.857,2.856C3.15,15.973,3.218,16,3.29,16c0.077,0,0.145-0.027,0.205-0.081l2.848-2.849C6.402,13,6.432,12.928,6.432,12.857L6.432,12.857z M12.434,6.572V4.857c0-0.083-0.027-0.152-0.082-0.206c-0.054-0.053-0.121-0.08-0.205-0.08h-4c-0.083,0-0.151,0.027-0.205,0.08C7.888,4.706,7.86,4.774,7.86,4.857v1.714c0,0.083,0.027,0.152,0.081,0.205C7.995,6.83,8.063,6.857,8.146,6.857h4c0.082,0,0.15-0.027,0.205-0.081C12.404,6.724,12.434,6.655,12.434,6.572z M14.146,11.145V9.43c0-0.084-0.026-0.152-0.08-0.205c-0.055-0.055-0.123-0.08-0.207-0.08H8.146c-0.083,0-0.151,0.025-0.205,0.08C7.887,9.277,7.86,9.346,7.86,9.43v1.715c0,0.082,0.027,0.15,0.081,0.205c0.054,0.053,0.122,0.08,0.205,0.08h5.713c0.084,0,0.152-0.027,0.207-0.08C14.12,11.295,14.146,11.227,14.146,11.145z M15.859,15.715V14c0-0.083-0.025-0.15-0.08-0.205c-0.053-0.054-0.121-0.08-0.204-0.08H8.146c-0.083,0-0.151,0.026-0.205,0.08C7.887,13.85,7.86,13.917,7.86,14v1.715c0,0.083,0.027,0.151,0.081,0.205C7.995,15.975,8.063,16,8.146,16h7.429c0.083,0,0.151-0.025,0.204-0.08C15.834,15.866,15.859,15.798,15.859,15.715z"],viewBox:"0 0 16 16"},va={id:"sort-desc",paths:["M6.432,12.857c0-0.084-0.027-0.152-0.08-0.206c-0.054-0.054-0.123-0.08-0.206-0.08H4.432V0.285c0-0.084-0.027-0.151-0.081-0.205S4.229,0,4.146,0H2.432C2.348,0,2.28,0.026,2.226,0.08S2.146,0.201,2.146,0.285v12.286H0.431c-0.131,0-0.22,0.06-0.268,0.179c-0.047,0.113-0.027,0.217,0.062,0.312l2.857,2.857C3.149,15.973,3.217,16,3.289,16c0.077,0,0.145-0.027,0.205-0.08l2.848-2.849C6.402,13,6.432,12.928,6.432,12.857L6.432,12.857z M15.861,2V0.286c0-0.083-0.027-0.152-0.081-0.206C15.728,0.027,15.658,0,15.575,0H8.146C8.063,0,7.994,0.027,7.941,0.081c-0.054,0.053-0.08,0.122-0.08,0.206V2c0,0.083,0.026,0.152,0.08,0.206c0.053,0.053,0.122,0.08,0.205,0.08h7.429c0.083,0,0.152-0.027,0.205-0.08C15.834,2.152,15.861,2.083,15.861,2z M14.147,6.572V4.857c0-0.083-0.027-0.152-0.081-0.206c-0.054-0.054-0.122-0.081-0.205-0.081H8.146c-0.083,0-0.152,0.027-0.205,0.081c-0.054,0.053-0.08,0.122-0.08,0.206v1.714c0,0.083,0.026,0.151,0.08,0.205c0.053,0.054,0.122,0.08,0.205,0.08h5.715c0.083,0,0.151-0.026,0.205-0.08S14.147,6.655,14.147,6.572z M12.433,11.144V9.429c0-0.083-0.027-0.151-0.081-0.205s-0.122-0.081-0.205-0.081h-4c-0.083,0-0.152,0.027-0.205,0.081c-0.054,0.054-0.08,0.122-0.08,0.205v1.715c0,0.083,0.026,0.151,0.08,0.205c0.053,0.053,0.122,0.08,0.205,0.08h4c0.083,0,0.151-0.027,0.205-0.08C12.405,11.295,12.433,11.227,12.433,11.144z M10.718,15.715V14c0-0.083-0.026-0.151-0.08-0.205s-0.122-0.081-0.205-0.081H8.146c-0.083,0-0.152,0.027-0.205,0.081c-0.054,0.054-0.08,0.122-0.08,0.205v1.715c0,0.084,0.026,0.151,0.08,0.205C7.994,15.974,8.063,16,8.146,16h2.287c0.083,0,0.151-0.026,0.205-0.08S10.718,15.799,10.718,15.715z"],viewBox:"0 0 16 16"},ga={id:"unsort",paths:["M12.433,2V0.286c0-0.083-0.027-0.152-0.081-0.206C12.298,0.027,12.229,0,12.146,0h-4C8.063,0,7.995,0.027,7.941,0.08C7.887,0.134,7.86,0.202,7.86,0.286V2c0,0.083,0.027,0.152,0.081,0.205c0.054,0.054,0.122,0.081,0.205,0.081h4c0.083,0,0.151-0.027,0.205-0.081C12.405,2.152,12.433,2.083,12.433,2z M14.146,15.715V14c0-0.083-0.026-0.151-0.08-0.205s-0.122-0.08-0.206-0.08H8.146c-0.083,0-0.151,0.026-0.205,0.08S7.86,13.917,7.86,14v1.715c0,0.083,0.027,0.151,0.081,0.205S8.063,16,8.146,16h5.714c0.084,0,0.152-0.026,0.206-0.08S14.146,15.798,14.146,15.715zM15.861,6.572V4.857c0-0.083-0.027-0.151-0.08-0.205c-0.055-0.054-0.123-0.08-0.205-0.08h-7.43c-0.082,0-0.15,0.026-0.205,0.08c-0.053,0.054-0.08,0.122-0.08,0.205v1.715c0,0.083,0.027,0.151,0.08,0.205c0.055,0.054,0.123,0.08,0.205,0.08h7.43c0.082,0,0.15-0.026,0.205-0.08C15.834,6.724,15.861,6.655,15.861,6.572z M10.718,11.144V9.429c0-0.083-0.026-0.151-0.08-0.205s-0.122-0.08-0.205-0.08H8.146c-0.083,0-0.151,0.026-0.205,0.08S7.86,9.346,7.86,9.429v1.715c0,0.084,0.027,0.152,0.081,0.205c0.054,0.055,0.122,0.08,0.205,0.08h2.286c0.083,0,0.151-0.025,0.205-0.08C10.691,11.296,10.718,11.228,10.718,11.144z"],viewBox:"0 0 16 16"},pa={id:"sort-alpha-desc",paths:["M11.731,10.84c0.023-0.072,0.046-0.158,0.066-0.26c0.021-0.102,0.031-0.154,0.031-0.16l0.027-0.179h0.035c0,0.023,0.006,0.083,0.019,0.179l0.106,0.42l0.644,1.945h-1.581L11.731,10.84z M7.017,12.857c0-0.084-0.027-0.152-0.081-0.205c-0.054-0.055-0.122-0.081-0.206-0.081H5.017V0.286c0-0.084-0.027-0.152-0.081-0.206S4.814,0,4.731,0H3.017C2.934,0,2.865,0.026,2.812,0.08S2.731,0.202,2.731,0.286v12.285H1.017c-0.131,0-0.22,0.06-0.268,0.179c-0.047,0.113-0.027,0.217,0.062,0.312l2.857,2.857C3.734,15.973,3.803,16,3.874,16c0.078,0,0.146-0.027,0.206-0.08l2.848-2.849C6.987,13,7.017,12.929,7.017,12.857L7.017,12.857z M15.275,15.054H14.65l-2.053-5.911H11.15l-2.053,5.911H8.472V16h2.563v-0.946h-0.67l0.42-1.286h2.169l0.42,1.286h-0.67V16h2.571V15.054L15.275,15.054z M14.481,4.776H13.4v1.062h-2.214c-0.125,0-0.214,0.003-0.268,0.01l-0.125,0.026V5.849l0.098-0.09c0.09-0.107,0.152-0.185,0.188-0.232l3.295-4.731V0H9.312v2.045h1.071V1.018h2.071c0.107,0,0.196-0.009,0.269-0.026c0.018,0,0.04-0.002,0.066-0.005c0.027-0.003,0.046-0.004,0.059-0.004v0.026l-0.099,0.08c-0.054,0.054-0.116,0.135-0.188,0.241L9.267,6.054v0.804h5.215V4.776L14.481,4.776z"],viewBox:"0 0 16 16"},fa={id:"sort-alpha-asc",paths:["M11.731,1.696c0.023-0.071,0.046-0.158,0.066-0.259c0.021-0.102,0.031-0.155,0.031-0.161l0.027-0.179h0.035c0,0.024,0.006,0.084,0.019,0.179l0.106,0.42l0.644,1.946h-1.581L11.731,1.696z M7.016,12.856c0-0.083-0.026-0.151-0.08-0.205s-0.122-0.08-0.205-0.08H5.016V0.285c0-0.083-0.026-0.151-0.08-0.205S4.814,0,4.731,0H3.016C2.933,0,2.865,0.026,2.811,0.08s-0.08,0.122-0.08,0.205v12.286H1.016c-0.131,0-0.22,0.06-0.268,0.179c-0.048,0.113-0.026,0.217,0.062,0.312l2.857,2.856C3.734,15.973,3.802,16,3.874,16c0.077,0,0.146-0.027,0.205-0.081l2.849-2.848C6.987,13,7.016,12.929,7.016,12.856L7.016,12.856zM14.481,13.919h-1.08v1.062h-2.215c-0.125,0-0.214,0.007-0.268,0.019l-0.125,0.018V15l0.098-0.099c0.09-0.107,0.152-0.185,0.188-0.232l3.295-4.731V9.143H9.312v2.045h1.071V10.16h2.071c0.107,0,0.197-0.009,0.269-0.026c0.018,0,0.04-0.002,0.066-0.005c0.027-0.003,0.046-0.004,0.059-0.004v0.026l-0.099,0.08c-0.054,0.054-0.116,0.135-0.188,0.241l-3.295,4.724V16h5.215V13.919L14.481,13.919z M15.276,5.91h-0.625L12.598,0h-1.446L9.098,5.91H8.472v0.946h2.563V5.91h-0.67l0.42-1.285h2.169l0.42,1.285h-0.67v0.946h2.571L15.276,5.91L15.276,5.91z"],viewBox:"0 0 16 16"},ba={id:"one-bar",paths:["M14,3H2C0.896,3,0,3.896,0,5v6c0,1.104,0.896,2,2,2h12c1.104,0,2-0.896,2-2V5C16,3.896,15.104,3,14,3zM15,11c0,0.553-0.448,1-1,1H8V4h6c0.552,0,1,0.448,1,1V11z"],viewBox:"0 0 16 16"},ya={id:"two-bars",paths:["M14,3H2C0.896,3,0,3.896,0,5v6c0,1.104,0.896,2,2,2h12c1.104,0,2-0.896,2-2V5C16,3.896,15.104,3,14,3z M15,11c0,0.553-0.448,1-1,1H6V8h5V4h3c0.552,0,1,0.448,1,1V11z"],viewBox:"0 0 16 16"},ma={id:"locked",paths:["M5.333,7.333v-2c0-0.736,0.26-1.364,0.781-1.886c0.521-0.521,1.149-0.781,1.885-0.781c0.736,0,1.365,0.261,1.886,0.781c0.521,0.521,0.781,1.149,0.781,1.886v2H5.333L5.333,7.333z M14,8.333c0-0.278-0.098-0.514-0.292-0.708c-0.194-0.195-0.431-0.292-0.709-0.292h-0.333v-2c0-1.278-0.458-2.375-1.375-3.292C10.374,1.125,9.277,0.667,8,0.667c-1.278,0-2.375,0.459-3.292,1.375C3.791,2.958,3.333,4.055,3.333,5.333v2H2.999c-0.277,0-0.514,0.097-0.708,0.292C2.097,7.82,2,8.055,2,8.333v6c0,0.277,0.097,0.514,0.291,0.707c0.194,0.195,0.431,0.293,0.708,0.293h10c0.278,0,0.515-0.098,0.709-0.293c0.194-0.193,0.291-0.43,0.291-0.707L14,8.333L14,8.333z"],viewBox:"0 0 16 16"},ka={id:"union",paths:["M12,1v7C11.999,10.21,10.209,12,8,12c-2.209,0-4-1.79-4-3.999h0l0-7H1v7C1,11.867,4.134,15,8,15c3.865,0,6.999-3.133,7-6.999V1H12z"],viewBox:"0 0 16 16"},wa={id:"intersection",paths:["M15,15V7.999C14.999,4.133,11.865,1,8,1C4.134,1,1,4.133,1,7.999V15h3l0-7.001h0C4.001,5.79,5.792,4,8,4c2.208,0,3.999,1.79,4,3.999V15H15z"],
viewBox:"0 0 16 16"},xa={id:"not",paths:["M8,1C4.134,1,1,4.134,1,8c0,3.865,3.134,7,7,7c3.865,0,7-3.135,7-7C15,4.134,11.865,1,8,1z M3,8c0-2.761,2.239-5,5-5c1.019,0,1.964,0.308,2.754,0.832l-6.922,6.923C3.309,9.965,3,9.019,3,8z M8,13c-1.019,0-1.964-0.309-2.754-0.831l6.922-6.923C12.691,6.036,13,6.981,13,8C13,10.762,10.762,13,8,13z"],viewBox:"0 0 16 16"},Da={id:"zoom-out",paths:["M3.5,5.5H9.5V7.5H3.5V5.5z","M15.682,14.268l-3.938-3.938C12.53,9.254,13,7.934,13,6.5C13,2.91,10.09,0,6.5,0S0,2.91,0,6.5S2.91,13,6.5,13c1.434,0,2.756-0.47,3.83-1.257l3.938,3.94L15.682,14.268z M2,6.5C2,4.015,4.015,2,6.5,2S11,4.015,11,6.5C11,8.985,8.985,11,6.5,11S2,8.985,2,6.5z"],viewBox:"0 0 16 16"},_a=[ha,ua,da,va,ga,pa,fa,ba,ya,ma,ka,wa,xa,Da],Sa=e,La=function(){function t(e){var i=this;if(us(this,t),e.d3&&(Sa=e.d3),"4"!==Sa.version[0])throw new fs(Sa.version);if(!Sa.listGraph)throw new bs;var n=this;this.init=e,this.baseEl=e.element,this.baseEl.__d3ListGraphBase__=!0,this.baseElD3=Sa.select(this.baseEl),this.baseElJq=$(this.baseEl),this.svgD3=this.baseElD3.select("svg.base"),this.svgEl=this.svgD3.node(),this.outsideClickHandler={},this.outsideClickClassHandler={},this.svgD3.empty()?(this.svgD3=this.baseElD3.append("svg").attr("class","base"),this.svgJq=$(this.svgD3.node())):this.svgJq=$(this.svgD3.node()),this.rootNodes=e.rootNodes,this.width=He(e.width,this.svgJq.width(),!0),this.height=He(e.height,this.svgJq.height(),!0),this.svgD3.on("mouseenter",this.getBoundingRect.bind(this)),this.scrollbarWidth=He(e.scrollbarWidth,ks,!0),this.columns=He(e.columns,ws,!0),this.rows=He(e.rows,xs,!0),this.iconPath=He(e.iconPath,Ds,!0),this.querying=He(e.querying,Bs),this.hideOutwardsLinks=He(e.hideOutwardsLinks,Ms),this.showLinkLocation=He(e.showLinkLocation,As),this.linkLocationBucketSize=e.linkLocationBucketSize,this.highlightActiveLevel=He(e.highlightActiveLevel,Ls),this.activeLevel=He(e.activeLevel,Cs),this.noRootActiveLevelDiff=He(e.noRootActiveLevelDiff,Ns),this.lessTransitionsJs=e.lessTransitions>0,this.lessTransitionsCss=e.lessTransitions>1,this.disableDebouncedContextMenu=He(e.disableDebouncedContextMenu,Hs),this.customTopbarButtons=He(e.customTopbarButtons,[]),this.baseElD3.classed("less-animations",this.lessTransitionsCss),_a.forEach(function(t){return Oe(i.svgD3,t.id,t.paths,t.viewBox)}),this.sortBy=e.sortBy,this.sortOrder="asc"===e.sortOrder?1:_s,this.nodeInfoContextMenu=Re(e.nodeInfoContextMenu)?e.nodeInfoContextMenu:[],this.events=new bo(this.baseEl,e.dispatcher),this.baseElJq.addClass(ms),this.dragged={x:0,y:0},e.forceWidth&&this.baseElJq.width(this.width),this.layout=new Sa.listGraph({size:[this.width,this.height],grid:[this.columns,this.rows],d3:Sa}),this.data=Lt(e.data),this.visData=this.layout.process(this.data,this.rootNodes,{showLinkLocation:this.showLinkLocation,linkLocationBucketSize:this.linkLocationBucketSize,sortBy:this.sortBy,sortOrder:this.sortOrder}),this.currentSorting={global:{type:this.sortBy,order:this.sortOrder},local:{}},this.barMode=e.barMode||Ss,this.svgD3.classed(this.barMode+"-bar",!0),this.topbar=new Is(this,this.baseElD3,this.visData,this.customTopbarButtons),this.svgD3.attr("viewBox","0 0 "+this.width+" "+this.height),this.container=this.svgD3.append("g").attr("class","main-container"),this.levels=new Ws(this.container,this,this.visData),this.links=new Us(this,this.levels.groups,this.visData,this.layout),this.nodes=new go(this,this.levels.groups,this.visData,this.links,this.events),this.levels.scrollPreparation(this.scrollbarWidth),this.scrollbars=new fo(this.levels.groups,this.visData,this.scrollbarWidth),this.nodeContextMenu=new la({visData:this.visData,baseEl:this.container,events:this.events,nodes:this.nodes,iconPath:this.iconPath,infoFields:this.nodeInfoContextMenu,isQueryable:this.querying,isDebounced:!this.disableDebouncedContextMenu}),this.nodeContextMenu.wrapper.on("mousedown",function(){i.mouseDownOnContextMenu=!0}),Ae(this.svgD3,"context-menu",0,1,2,.2),Ae(this.svgD3,"context-menu-inverted",0,-1,2,.2),this.svgJq.on("mousewheel","."+Ws.className,function(t){n.zoomedOut||n.mousewheelColumn(this,t)}),this.svgJq.on("click",function(t){n.checkGlobalClick.call(n,t.target)}),this.svgJq.on("click","."+go.classNodeVisible,function(){Ko(function(){n.registerOutSideClickHandler("nodeContextMenu",[n.nodeContextMenu.wrapper.node()],["visible-node"],function(){n.nodeContextMenu.close(),n.unregisterOutSideClickHandler.call(n,"nodeContextMenu")})}),n.nodeContextMenu.toggle.call(n.nodeContextMenu,Sa.select(this.parentNode))}),this.svgJq.on("click","."+go.classFocusControls+"."+go.classRoot,function(){n.nodes.rootHandler.call(n.nodes,Sa.select(this),!0)}),this.querying&&this.svgJq.on("click","."+go.classFocusControls+"."+go.classQuery,function(){n.nodes.queryHandler.call(n.nodes,Sa.select(this.parentNode),"unquery"),n.nodeContextMenu.updateStates()}),this.svgJq.on("mouseenter","."+go.classNodeVisible,function(){n.interactionWrapper.call(n,function(t,e){this.vis.activeScrollbar||this.enterHandler.call(this,t,e)}.bind(n.nodes),[this,Sa.select(this).datum()])}),this.svgJq.on("mouseleave","."+go.classNodeVisible,function(){n.interactionWrapper.call(n,function(t,e){this.vis.activeScrollbar||this.leaveHandler.call(this,t,e)}.bind(n.nodes),[this,Sa.select(this).datum()])}),this.scrollbars.all.on("mousedown",function(){n.scrollbarMouseDown(this,Sa.event)}),Sa.select(document).on("mouseup",function(){i.globalMouseUp(Sa.event)}),this.svgD3.call(Be,this.dragStartHandler.bind(this),this.dragMoveHandler.bind(this),this.dragEndHandler.bind(this),[this.container,this.topbar.localControlWrapper],"horizontal",this.getDragLimits.bind(this),this.noDragging.bind(this),this.dragged,2),this.events.on("d3ListGraphLevelFocus",function(t){return i.levels.focus(t)}),this.events.on("d3ListGraphNodeRoot",function(){i.nodes.bars.updateAll(Sa.listGraph.updateBars(i.data),i.currentSorting.global.type),i.updateSorting()}),this.events.on("d3ListGraphNodeUnroot",function(){i.nodes.bars.updateAll(Sa.listGraph.updateBars(i.data),i.currentSorting.global.type),i.updateSorting()}),this.events.on("d3ListGraphUpdateBars",function(){i.nodes.bars.updateAll(Sa.listGraph.updateBars(i.data),i.currentSorting.global.type),i.updateSorting()}),this.events.on("d3ListGraphActiveLevel",function(t){var e=i.activeLevel;if(i.activeLevel=Math.max(t,0),i.nodes.rootedNode){var n=i.nodes.rootedNode.datum().depth;i.levels.blur(n+e),i.levels.focus(n+i.activeLevel)}else i.levels.blur(e-i.noRootActiveLevelDiff),i.levels.focus(i.activeLevel-i.noRootActiveLevelDiff)}),this.getBoundingRect()}return ds(t,[{key:"checkGlobalClick",value:function(t){var e={},i=Object.keys(this.outsideClickClassHandler).length,n=t;try{for(;!n.__d3ListGraphBase__;){if(n.__id__)for(var s=n.__id__.length;s--;)e[n.__id__[s]]=!0;if(i)for(var o=Object.keys(this.outsideClickClassHandler),a=o.length;a--;){var r=n.getAttribute("class");r&&r.indexOf(o[a])>=0&&(e[this.outsideClickClassHandler[o[a]].id]=!0)}n=n.parentNode}}catch(t){return}for(var l=Object.keys(this.outsideClickHandler),c=l.length;c--;)e[l[c]]||this.outsideClickHandler[l[c]].callback.call(this)}},{key:"checkNodeVisibility",value:function(t,e){var i=t?this.nodes.nodes.filter(function(e){return e.depth===t}):this.nodes.nodes;i.call(this.nodes.isInvisible.bind(this.nodes),e)}},{key:"dragEndHandler",value:function(){this.dragging&&(this.noInteractions=this.dragging=!1)}},{key:"dragMoveHandler",value:function(t,e,i,n){Me(t,e,i,n),this.checkNodeVisibility()}},{key:"dragScrollbar",value:function(e){e.preventDefault();var i=this.activeScrollbar.datum(),n=i.scrollbar.clientY-e.clientY;t.scrollElVertically(this.activeScrollbar.node(),Math.min(Math.max(i.scrollbar.scrollTop-n,0),i.scrollbar.scrollHeight));var s=Math.max(Math.min(i.scrollTop+i.invertedHeightScale(n),0),-i.scrollHeight);t.scrollElVertically(i.nodes,s),i.level!==this.visData.nodes.length&&this.links.scroll(i.linkSelections.outgoing,this.layout.offsetLinks(i.level,s,"source")),i.level>0&&this.links.scroll(i.linkSelections.incoming,this.layout.offsetLinks(i.level-1,s,"target")),this.showLinkLocation&&this.nodes.updateLinkLocationIndicators(i.level-1,i.level+1),this.nodeContextMenu.opened&&this.nodeContextMenu.scrollY(s),this.checkNodeVisibility(i.level,s)}},{key:"dragStartHandler",value:function(){this.dragging||(this.noInteractions=this.dragging=!0)}},{key:"getBoundingRect",value:function(){this.left=this.svgEl.getBoundingClientRect().left,this.top=this.svgEl.getBoundingClientRect().top}},{key:"getDragLimits",value:function(){return{x:{min:this.dragMinX,max:0}}}},{key:"globalMouseUp",value:function(e){if(this.noInteractions=!1,this.mouseDownOnContextMenu=!1,this.activeScrollbar){var i=this.activeScrollbar.datum(),n=i.scrollbar.clientY-e.clientY;i.scrollbar.scrollTop=Math.min(Math.max(i.scrollbar.scrollTop-n,0),i.scrollbar.scrollHeight),i.scrollTop=Math.max(Math.min(i.scrollTop+i.invertedHeightScale(n),0),-i.scrollHeight),this.activeScrollbar.classed("active",!1),this.activeScrollbar=void 0,t.stopScrollBarMouseMove()}}},{key:"globalView",value:function(t){var e=this;this.zoomedOut||!function(){var i=0,n=0,s=0,o=0,a=void 0,r=e.container.node().getBBox(),l=e.svgD3.node().getBoundingClientRect();t&&!t.empty()?(t.each(function(){a=this.getBoundingClientRect(),s=Math.max(s,a.left-(l.left+a.width)),o=Math.max(o,a.top-(l.top+a.height))}),s=e.width>s?e.width:s,o=e.height>o?e.height:o):(s=e.width>r.width?e.width:r.width,o=e.height>r.height?e.height:r.height),i=r.x+e.dragged.x,n=r.y,e.nodes.makeAllTempVisible(),e.links.makeAllTempVisible(),e.svgD3.classed("zoomedOut",!0).transition().duration(Rs).attr("viewBox",i+" "+n+" "+s+" "+o)}()}},{key:"interactionWrapper",value:function(t,e){this.noInteractions||t.apply(this,e)}},{key:"isHidden",value:function(t){var e=t.getBoundingClientRect();return e.top+e.height<=this.top||e.left+e.width<=this.left||e.top>=this.top+this.height||e.left>=this.left+this.width}},{key:"linkPointsOutside",value:function(t){var e=t.node.y+t.offsetY;return t.node.hidden?16:e+this.visData.global.row.height-this.visData.global.row.padding<=0?1:e+this.visData.global.row.padding>=this.height?2:0}},{key:"mousewheelColumn",value:function(t,e){e.preventDefault();var i=Sa.select(t).datum();i.scrollHeight>0&&(i.scrollTop=Math.max(Math.min(i.scrollTop+e.deltaY,0),-i.scrollHeight),this.scrollY(i)),this.checkNodeVisibility(i.level)}},{key:"noDragging",value:function(){return!!this.activeScrollbar||this.mouseDownOnContextMenu}},{key:"pointsOutside",value:function(t){var e=this.linkPointsOutside(t.source),i=this.linkPointsOutside(t.target)<<2;return e|i}},{key:"registerOutSideClickHandler",value:function(t,e,i,n){for(var s=e.length;s--;)e[s].__id__?e[s].__id__.push(t):e[s].__id__=[t];for(var o=this.outsideClickHandler[t]={id:t,els:e,elClassNames:i,callback:n},a=i.length;a--;)this.outsideClickClassHandler[i[a]]=this.outsideClickHandler[t];return o}},{key:"reRender",value:function(t){this.width=He(this.init.width,this.svgJq.width(),!0),this.height=He(this.init.height,this.svgJq.height(),!0),t&&t.grid&&(this.columns=t.grid.columns||this.columns,this.rows=t.grid.rows||this.rows),this.init.forceWidth&&this.baseElJq.width(this.width),this.layout.size([this.width,this.height]),this.layout.grid([this.columns,this.rows]),this.visData=this.layout.process(this.data,this.rootNodes,{showLinkLocation:this.showLinkLocation,linkLocationBucketSize:this.linkLocationBucketSize,sortBy:this.currentSorting.global.type,sortOrder:this.currentSorting.global.order}),this.svgD3.attr("viewBox","0 0 "+this.width+" "+this.height),this.topbar.reRender(this.visData),this.levels.reRender(this.visData),this.links.reRender(this.visData),this.nodes.reRender(this.visData),this.levels.scrollPreparation(this.scrollbarWidth),this.scrollbars.reRender(this.visData),this.nodeContextMenu.destroy(),this.nodeContextMenu=new la({visData:this.visData,baseEl:this.container,events:this.events,nodes:this.nodes,iconPath:this.iconPath,infoFields:this.nodeInfoContextMenu,isQueryable:this.querying,isDebounced:!this.disableDebouncedContextMenu}),this.getBoundingRect()}},{key:"resetAllScrollPositions",value:function(){return this.scrollYTo(this.levels.groups,0)}},{key:"scrollbarMouseDown",value:function(t,e){this.noInteractions=!0,this.activeScrollbar=Sa.select(t).classed("active",!0),this.activeScrollbar.datum().scrollbar.clientY=e.clientY,this.startScrollBarMouseMove()}},{key:"scrollY",value:function(e,i){t.scrollElVertically(e.nodes,e.scrollTop),i||(e.scrollbar.scrollTop=e.scrollbar.heightScale(-e.scrollTop),t.scrollElVertically(e.scrollbar.el,e.scrollbar.scrollTop)),e.level!==this.visData.nodes.length&&this.links.scroll(e.linkSelections.outgoing,this.layout.offsetLinks(e.level,e.scrollTop,"source")),e.level>0&&this.links.scroll(e.linkSelections.incoming,this.layout.offsetLinks(e.level-1,e.scrollTop,"target")),this.showLinkLocation&&this.nodes.updateLinkLocationIndicators(e.level-1,e.level+1),this.nodeContextMenu.isOpenSameColumn(e.level)&&this.nodeContextMenu.scrollY(e.scrollTop)}},{key:"scrollYTo",value:function(t,e){var i=this;return t.transition().duration(Rs).tween("scrollY",function(t){var n=Sa.interpolateNumber(t.scrollTop,e);return function(e){t.scrollTop=n(e),i.scrollY(t)}})}},{key:"selectByLevel",value:function(t,e){return Sa.select(this.levels.groups._groups[0][t]).selectAll(e)}},{key:"sortAllColumns",value:function(t,e){this.currentSorting.global.order=this.currentSorting.global.order!==-1||e?-1:1,this.nodes.sort(this.layout.sort(void 0,t,this.currentSorting.global.order).updateNodesVisibility().nodes(),e),this.links.sort(this.layout.links()),this.nodeContextMenu.updatePosition(),this.checkNodeVisibility()}},{key:"sortColumn",value:function(t,e,i,n){this.nodes.sort(this.layout.sort(t,e,i).updateNodesVisibility().nodes(t),n),this.links.sort(this.layout.links(t-1,t+1)),this.nodeContextMenu.updatePosition(),this.checkNodeVisibility()}},{key:"startScrollBarMouseMove",value:function(){var t=this;Sa.select(document).on("mousemove",function(){t.dragScrollbar(Sa.event)})}},{key:"switchBarMode",value:function(t){this.svgD3.classed("one-bar","one"===t),this.svgD3.classed("two-bar","two"===t),this.nodes.bars.switchMode(t,this.currentSorting)}},{key:"trigger",value:function(t,e){this.events.trigger(t,e)}},{key:"toggleView",value:function(){this.zoomedOut?(this.zoomedOut=!1,this.zoomedView()):(this.globalView(),this.zoomedOut=!0)}},{key:"unregisterOutSideClickHandler",value:function(t){for(var e=this.outsideClickHandler[t],i=e.els.length;i--;)e.els[i].__id__=void 0,delete e.els[i].__id__;this.outsideClickHandler[t]=void 0,delete this.outsideClickHandler[t]}},{key:"updateLevelsVisibility",value:function(){this.levels.updateVisibility()}},{key:"updateScrolling",value:function(){var t=this;this.resetAllScrollPositions().call(Ft,function(){t.levels.updateScrollProperties(),t.scrollbars.updateVisibility()})}},{key:"updateSorting",value:function(){for(var t=Object.keys(this.currentSorting.local),e=t.length;e--;)this.sortColumn(e,this.currentSorting.local[t[e]].type,this.currentSorting.local[t[e]].order,this.currentSorting.local[t[e]].type)}},{key:"zoomedView",value:function(){this.zoomedOut||(this.nodes.makeAllTempVisible(!0),this.links.makeAllTempVisible(!0),this.svgD3.classed("zoomedOut",!1).transition().duration(Rs).attr("viewBox","0 0 "+this.width+" "+this.height))}},{key:"area",get:function(){return this.container.node().getBoundingClientRect()}},{key:"barMode",get:function(){return this.bars?this.nodes.bars.mode:this._barMode},set:function(t){this.bars&&(this.nodes.bars.mode=t),this._barMode=t}},{key:"dragMinX",get:function(){return Math.min(0,this.width-this.area.width)}}],[{key:"scrollElVertically",value:function(t,e){Sa.select(t).attr("transform","translate(0, "+e+")")}},{key:"stopScrollBarMouseMove",value:function(){Sa.select(document).on("mousemove",null)}}]),t}();return La.version="1.1.0",La});
//# sourceMappingURL=listGraph.min.js.map
