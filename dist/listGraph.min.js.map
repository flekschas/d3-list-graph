{"version":3,"sources":["listGraph.min.js"],"names":["global","factory","exports","module","require","define","amd","ListGraph","$","d3","this","isObject","value","type","isFunction","tag","objectToString","call","funcTag","genTag","isFinite","nativeIsFinite","collectInclClones","node","onlyForOriginalNode","originalNode","clone","clones","length","concat","_up","callback","depth","includeClones","child","visitedNodes","id","nodes","i","parentsId","Object","keys","parents","j","up","_down","childRefs","down","upAndDown","callbackUp","callbackDown","siblings","siblingsId","_i","roundRect","x","y","width","height","radius","topLeft","topRight","bottomLeft","bottomRight","dropMenu","c","arrowSize","mergeSelections","selections","mergedSelection","selectAll","_groups","allTransitionsEnded","transition","size","n","each","on","_len","arguments","args","Array","_key","apply","objectOrFunction","isFunction$1","setScheduler","scheduleFn","customSchedulerFn","setAsap","asapFn","asap","useNextTick","process","nextTick","flush","useVertxTimer","vertxNext","useMutationObserver","iterations","observer","BrowserMutationObserver","document","createTextNode","observe","characterData","data","useMessageChannel","channel","MessageChannel","port1","onmessage","port2","postMessage","useSetTimeout","setTimeout","len","queue","arg","undefined","attemptVertx","r","vertx","runOnLoop","runOnContext","e","then","onFulfillment","onRejection","parent","constructor","noop","PROMISE_ID","makePromise","state","_state","invokeCallback","_result","subscribe","resolve","object","Constructor","promise","_resolve","selfFulfillment","TypeError","cannotReturnOwn","getThen","error","GET_THEN_ERROR","tryThen","fulfillmentHandler","rejectionHandler","handleForeignThenable","thenable","sealed","fulfill","reason","_reject","_label","handleOwnThenable","FULFILLED","REJECTED","handleMaybeThenable","maybeThenable","then$$","publishRejection","_onerror","publish","PENDING","_subscribers","subscribers","settled","detail","ErrorObject","tryCatch","TRY_CATCH_ERROR","succeeded","failed","hasCallback","initializePromise","resolver","nextId","Enumerator","input","_instanceConstructor","isArray$1","_input","_remaining","_enumerate","validationError","Error","all","entries","race","reject","needsResolver","needsNew","Promise$1","isObjectLike","isSymbol","objectToString$1","symbolTag","toNumber","NAN","other","valueOf","replace","reTrim","isBinary","reIsBinary","test","reIsOctal","freeParseInt","slice","reIsBadHex","debounce","func","wait","options","invokeFunc","time","lastArgs","thisArg","lastThis","lastInvokeTime","result","leadingEdge","timerId","timerExpired","leading","remainingWait","timeSinceLastCall","lastCallTime","timeSinceLastInvoke","maxing","nativeMin","maxWait","shouldInvoke","now","trailingEdge","trailing","cancel","clearTimeout","debounced","isInvoking","FUNC_ERROR_TEXT","nativeMax","onDragDrop","selection","dragStartHandler","dragMoveHandler","dropHandler","elsToBeDragged","orientation","limits","noDraggingWhenTrue","dragData","drag","checkWhenDragging","appliedLimits","filter","event","sourceEvent","preventDefault","el","select","datum","withinLimits","applyingLimits","restrictedValue","Math","min","max","LimitsUnsupportedFormat","els","dx","style","dy","dropShadow","name","blur","opacity","defs","empty","append","attr","feMerge","setOption","defaultValue","noFalsyValue","_isArray","isArray","classCallCheck","instance","createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","protoProps","staticProps","prototype","inherits","subClass","superClass","create","setPrototypeOf","__proto__","possibleConstructorReturn","self","ReferenceError","ExtendableError","_Error","message","_this","getPrototypeOf","captureStackTrace","D3VersionFourRequired","_ExtendableError","versionFound","LayoutNotAvailable","EventDispatcherNoFunction","_ExtendableError2","CLASSNAME","SCROLLBAR_WIDTH","COLUMNS","ROWS","ICON_PATH","DEFAULT_SORT_ORDER","DEFAULT_BAR_MODE","HIGHLIGHT_ACTIVE_LEVEL","ACTIVE_LEVEL","NO_ROOT_ACTIVE_LEVEL_DIFF","QUERYING","HIDE_OUTWARDS_LINKS","SHOW_LINK_LOCATION","DISABLE_DEBOUNCED_CONTEXT_MENU","TRANSITION_LIGHTNING_FAST","TRANSITION_SEMI_FAST","TOPBAR_EL","TOPBAR_CLASS","TOPBAR_CONTROL_EL","TOPBAR_CONTROL_CLASS","TOPBAR_GLOBAL_CONTROL_CLASS","Topbar","vis","visData","that","insert","controlSwitch","column","padding","classed","switch","bind","switchArrow","iconPath","globalControls","globalPrecision","currentSorting","sortAllColumns","interactionWrapper","highlightBars","globalPrecisionWrapper","text","order","globalRecall","globalRecallWrapper","globalName","highlightLabels","globalNameWrapper","globalOneBar","barMode","switchBarMode","globalOneBarWrapper","globalTwoBars","globalTwoBarsWrapper","globalZoomOut","zoomedOut","globalView","zoomedView","toggleView","globalZoomOutWrapper","localControlWrapper","localControls","enter","index","control","local","sortBy","sortOrder","toggleColumn","contentWidth","controlData","sortColumn","level","parentNode","html","toggleOptions","selectByLevel","deHighlight","baseElD3","selectNodesLevel","newSortType","semiActiveSortingEls","resetSemiActiveSortingEls","resetSortEl","columnKeys","newType","mode","COLUMN_CLASS","SCROLL_CONTAINER_CLASS","Levels","groups","highlightActiveLevel","rootedNode","activeLevel","noRootActiveLevelDiff","scrollTop","scrollbarWidth","_this2","contentHeight","getBoundingClientRect","row","scrollHeight","scrollbarHeight","linkSelections","incoming","outgoing","scrollbar","heightScale","scaleLinear","domain","range","invertedHeightScale","invert","_this3","group","hidden","get","LINKS_CLASS","LINK_CLASS","Links","levels","layout","links","hideOutwardsLinks","linkVisibility","diagonal","pointsOutside","nodeIds","_highlight","className","update","start","end","duration","source","getSourceX","offsetX","getTargetX","getY","offsetY","extraOffsetX","showLinkLocation","sourceY","sourceX","targetY","targetX","middleX","objectProto","toString","freeGlobal","freeSelf","root","Function","BAR_CLASS","Bar","barGroup","barData","nodeData","bars","setupMagnitude","generatePath","setupBorder","setupIndicator","class","cell","activeHeight","inactiveheight","BARS_CLASS","Bars","indicatorX","barId","insertBefore","children","referenceValue","generateOneBarPath","generateTwoBarsPath","indicator","adjustWidth","bottom","normValue","normIndicator","abs","CLASS_NODES","CLASS_NODE","CLASS_NODE_VISIBLE","CLASS_CLONE","CLASS_LABEL_WRAPPER","CLASS_FOCUS_CONTROLS","CLASS_ROOT","CLASS_QUERY","CLASS_LOCK","CLASS_INACTIVE","CLASS_INDICATOR_BAR","CLASS_INDICATOR_LOCATION","CLASS_INDICATOR_INCOMING","CLASS_INDICATOR_OUTGOING","CLASS_INDICATOR_ABOVE","CLASS_INDICATOR_BELOW","Nodes","baseSelection","events","drawLinkIndicator","direction","linkDensityBg","refs","drawLinkLocationIndicator","position","above","drawFullSizeRect","shrinking","noRoundBorder","shrinkingAmount","drawMaxSizedRect","currentLinks","iconDimension","rows","visNodes","calcHeightLinkLocationIndicator","nodeRooted","setUpFocusControls","querying","nodeQuery","focusNodes","blurNodes","eventHelper","highlightNodes","unhighlightNodes","toggleLock","toggleRoot","isInvisible","left","right","below","total","updateHeightLinkLocationIndicatorBars","barRefHeight","barAboveRefTop","baseClassName","eventData","clonedFromId","broadcast","d3El","locked","unlocked","lock","unlock","unroot","rooted","unrooted","same","checkNodeFocusEventSame","nodeFocusId","excludeClones","zoomOut","hideUnrelatedNodes","hovering","tempHidingUnrelatedNodes","showUnrelatedNodes","zoomIn","_hidden","updateVisibility","optionalParams","subSelectionClass","indexOf","setFalse","lockedNode","unlockNode","lockNode","query","active","inactive","query-and","query-or","query-not","queryBeforeRooting","previousMode","queryByNode","unqueryByNode","noNotification","actions","push","queryHandler","action","returnNoNotification","toggleQueryByNode","queries","unrootNode","unquery","focus","rootNode","batchQueryHandler","hideNodes","showNodes","location","paddedDim","nodesVisibility","show","customScrollTop","dragged","invisible","unset","prevInvisible","_invisible","restriction","noVisibilityCheck","checkNodeVisibility","_el","_data","isHidden","checkNodeDirect","checkNodeIndirect","updateDirectBarIndicator","updateIndicator","currentlyActiveBar","updateIndirectBarIndicator","nodeId","currentNodeData","includeParents","appliedClassName","includeChildren","traverseCallbackUp","childData","traverseCallbackDown","barIndicatorClass","directNodes","indirectNodes","highlight","traverseCallback","_this4","svgD3","updateLevelsVisibility","updateScrolling","_this5","updateNodesVisibility","SCROLLBAR_CLASS","Scrollbars","Events","_stack","dispatch","_dispatchEvent","eventName","createEvent","initCustomEvent","dispatchEvent","times","normTimes","parseInt","Infinity","stack","splice","off","scheduleFlush","browserWindow","window","browserGlobal","MutationObserver","WebKitMutationObserver","isNode","isWorker","Uint8ClampedArray","importScripts","random","substring","_eachEntry","entry","resolve$$","_settledAt","_willSettleAt","enumerator","_setScheduler","_setAsap","_asap","catch","Date","objectProto$1","requestAnimationFrame","lastTime","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","currTime","getTime","timeToCall","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","oCancelAnimationFrame","msCancelAnimationFrame","nextAnimationFrame","requestId","floor","ids","request","requestNextAnimationFrame","element","ts","cancelNextAnimationFrame","CLASS_NAME","CLASS_CHECKBOX","ARROW_SIZE","TRANSITION_SPEED","BUTTON_QUERY_DEBOUNCE","BUTTON_ROOT_DEBOUNCE","BUTTON_DEFAULT_DEBOUNCE","BUTTON_BAM_EFFECT_ANIMATION_TIME","NodeContextMenu","baseEl","infoFields","_x","_y","_yOffset","_scale","numButtonRows","toBottom","nodeInfoId","wrapper","updateAppearance","bgBorder","bg","textNodeInfo","createTextField","alignRight","classNames","distanceFromCenter","fullWidth","labels","toggler","clickNodeInfo","togglerX","togglerY","buttonQuery","createButton","label","labelTwo","bamEffect","clickQueryHandler","buttonQueryFill","buttonQueryBamEffect","buttonRoot","clickRootHandler","buttonRootFill","checkboxRoot","createCheckbox","buttonLock","clickLockHandler","buttonLockFill","buttonLockBamEffect","checkboxLock","components","debouncedQueryHandler","debouncedRootHandler","rootHandler","div","checked","checkBoxMovement","fillButton","emptyButton","positionComponent","currentRootState","tempRoot","showFillButton","hideFillButton","lockHandler","checkLock","triggerButtonBamEffect","getNodeProperty","property","updateQuery","disableDebouncedContextMenu","checkRoot","closing","opened","visible","properties","join","createButtonBg","addLabel","params","rx","ry","round","container","ease","easeLinear","columnNum","updateStates","translate","checkOrientation","tempQueryMode","currentQueryMode","close","offset","_this6","closed","previousNodeId","open","button","centerY","scale","nextQueryMode","queryMode","updateInfoText","set","_d3","init","version","listGraph","__d3ListGraphBase__","baseElJq","svgEl","outsideClickHandler","outsideClickClassHandler","svgJq","rootNodes","getBoundingRect","columns","linkLocationBucketSize","lessTransitionsJs","lessTransitions","lessTransitionsCss","nodeInfoContextMenu","dispatcher","addClass","forceWidth","topbar","scrollPreparation","scrollbars","nodeContextMenu","mouseDownOnContextMenu","mousewheelColumn","checkGlobalClick","classNodeVisible","registerOutSideClickHandler","unregisterOutSideClickHandler","toggle","classFocusControls","classRoot","classQuery","classLock","domEl","activeScrollbar","enterHandler","leaveHandler","scrollbarMouseDown","globalMouseUp","globalMouseMove","dragEndHandler","getDragLimits","noDragging","levelId","updateAll","updateBars","updateSorting","nextLevel","oldLevel","rootNodeDepth","notWhenTrue","elClassNames","__id__","newLength","handler","found","checkClass","_i2","getAttribute","handlerIds","_i3","dragMinX","top","noInteractions","dragging","deltaY","clientY","scrollElVertically","contentScrollTop","scroll","offsetLinks","updateLinkLocationIndicators","scrollY","columnData","scrollbarDragging","isOpenSameColumn","positionY","tween","scrollPositionY","interpolateNumber","scrollYTo","selector","sort","updatePosition","switchMode","trigger","resetAllScrollPositions","updateScrollProperties","selectionInterst","cRect","contBBox","getBBox","globalCRect","makeAllTempVisible","boundingRect","linkPointsOutside","area","_barMode"],"mappings":"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","file":"listGraph.min.js","sourcesContent":["/* Copyright Fritz Lekschas: D3 example visualization app using the list-like graph layout */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('$'), require('d3')) :\n  typeof define === 'function' && define.amd ? define(['$', 'd3'], factory) :\n  (global.ListGraph = factory(global.$,global.d3));\n}(this, (function ($,d3) { 'use strict';\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nvar createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar inherits = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\nvar possibleConstructorReturn = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n};\n\nvar ExtendableError = function (_Error) {\n  inherits(ExtendableError, _Error);\n\n  function ExtendableError(message) {\n    classCallCheck(this, ExtendableError);\n\n    var _this = possibleConstructorReturn(this, (ExtendableError.__proto__ || Object.getPrototypeOf(ExtendableError)).call(this, message));\n\n    _this.name = _this.constructor.name;\n    _this.message = message;\n    Error.captureStackTrace(_this, _this.constructor.name);\n    return _this;\n  }\n\n  return ExtendableError;\n}(Error);\n\nvar D3VersionFourRequired = function (_ExtendableError) {\n  inherits(D3VersionFourRequired, _ExtendableError);\n\n  function D3VersionFourRequired(versionFound) {\n    classCallCheck(this, D3VersionFourRequired);\n    return possibleConstructorReturn(this, (D3VersionFourRequired.__proto__ || Object.getPrototypeOf(D3VersionFourRequired)).call(this, 'D3 version 4 is required to run the code. Found version ' + versionFound));\n  }\n\n  return D3VersionFourRequired;\n}(ExtendableError);\n\n// Internal\nvar LayoutNotAvailable = function (_ExtendableError) {\n  inherits(LayoutNotAvailable, _ExtendableError);\n\n  function LayoutNotAvailable(message) {\n    classCallCheck(this, LayoutNotAvailable);\n    return possibleConstructorReturn(this, (LayoutNotAvailable.__proto__ || Object.getPrototypeOf(LayoutNotAvailable)).call(this, message || 'D3.layout.listGraph.js has not been loaded yet.'));\n  }\n\n  return LayoutNotAvailable;\n}(ExtendableError);\n\nvar EventDispatcherNoFunction = function (_ExtendableError2) {\n  inherits(EventDispatcherNoFunction, _ExtendableError2);\n\n  function EventDispatcherNoFunction(message) {\n    classCallCheck(this, EventDispatcherNoFunction);\n    return possibleConstructorReturn(this, (EventDispatcherNoFunction.__proto__ || Object.getPrototypeOf(EventDispatcherNoFunction)).call(this, message || 'Dispatcher needs to be a function.'));\n  }\n\n  return EventDispatcherNoFunction;\n}(ExtendableError);\n\nvar CLASSNAME = 'list-graph';\n\nvar SCROLLBAR_WIDTH = 6;\nvar COLUMNS = 5;\nvar ROWS = 5;\n\n// An empty path is equal to inline SVG.\nvar ICON_PATH = '';\n\n// -1 = desc, 1 = asc\nvar DEFAULT_SORT_ORDER = -1;\n\nvar DEFAULT_BAR_MODE = 'one';\n\nvar HIGHLIGHT_ACTIVE_LEVEL = true;\nvar ACTIVE_LEVEL = 0;\nvar NO_ROOT_ACTIVE_LEVEL_DIFF = 0;\nvar QUERYING = false;\nvar HIDE_OUTWARDS_LINKS = false;\nvar SHOW_LINK_LOCATION = false;\nvar DISABLE_DEBOUNCED_CONTEXT_MENU = false;\n\nvar TRANSITION_LIGHTNING_FAST = 150;\nvar TRANSITION_SEMI_FAST = 250;\n\n// External\n// eslint-disable-line import/no-unresolved\n\nvar TOPBAR_EL = 'div';\nvar TOPBAR_CLASS = 'top-bar';\n\nvar TOPBAR_CONTROL_EL = 'ul';\nvar TOPBAR_CONTROL_CLASS = 'controls';\nvar TOPBAR_GLOBAL_CONTROL_CLASS = 'global-controls';\n\nvar Topbar = function () {\n  function Topbar(vis, selection, visData) {\n    var _this = this;\n\n    classCallCheck(this, Topbar);\n\n    var that = this;\n\n    this.vis = vis;\n    this.visData = visData;\n    // Add base topbar element\n    this.el = selection.select('.' + TOPBAR_CLASS);\n\n    if (this.el.empty()) {\n      this.el = selection.insert(TOPBAR_EL, ':first-child').attr('class', TOPBAR_CLASS);\n    }\n\n    this.controlSwitch = this.el.append('div').attr('title', 'Toggle global / local topbar').style('width', this.visData.global.column.padding + 'px').classed('control-switch', true).on('click', this.switch.bind(this));\n\n    this.switchArrow = this.controlSwitch.append('svg').append('use').attr('xlink:href', this.vis.iconPath + '#arrow-down').attr('class', 'switch-arrow');\n\n    this.globalControls = this.el.append(TOPBAR_CONTROL_EL).classed(TOPBAR_GLOBAL_CONTROL_CLASS, true);\n\n    // Add button for sorting by precision\n    this.globalPrecision = this.globalControls.append('li').attr('class', 'control-btn sort-precision').classed('active', function () {\n      if (that.vis.currentSorting.global.type === 'precision') {\n        // Save currently active element. Needed when when re-sorting for the\n        // first time, to be able to de-highlight this element.\n        that.vis.currentSorting.global.el = d3.select(this);\n        return true;\n      }\n      return false;\n    }).on('click', function () {\n      that.sortAllColumns(this, 'precision');\n    }).on('mouseenter', function () {\n      _this.vis.interactionWrapper.call(_this.vis, function () {\n        _this.highlightBars(undefined, 'precision');\n      }, []);\n    }).on('mouseleave', function () {\n      _this.vis.interactionWrapper.call(_this.vis, function () {\n        _this.highlightBars(undefined, 'precision', true);\n      }, []);\n    });\n\n    this.globalPrecisionWrapper = this.globalPrecision.append('div').attr('class', 'wrapper');\n\n    this.globalPrecisionWrapper.append('span').attr('class', 'label').text('Precision');\n\n    this.globalPrecisionWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'precision').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n    this.globalPrecisionWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'precision' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-asc');\n\n    this.globalPrecisionWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'precision' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-desc');\n\n    // Add button for sorting by recall\n    this.globalRecall = this.globalControls.append('li').attr('class', 'control-btn sort-recall').classed('active', function () {\n      if (that.vis.currentSorting.global.type === 'recall') {\n        // See precision\n        that.vis.currentSorting.global.el = d3.select(this);\n        return true;\n      }\n      return false;\n    }).on('click', function () {\n      that.sortAllColumns(this, 'recall');\n    }).on('mouseenter', function () {\n      _this.vis.interactionWrapper.call(_this.vis, function () {\n        _this.highlightBars(undefined, 'recall');\n      }, []);\n    }).on('mouseleave', function () {\n      _this.vis.interactionWrapper.call(_this.vis, function () {\n        _this.highlightBars(undefined, 'recall', true);\n      }, []);\n    });\n\n    this.globalRecallWrapper = this.globalRecall.append('div').attr('class', 'wrapper');\n\n    this.globalRecallWrapper.append('span').attr('class', 'label').text('Recall');\n\n    this.globalRecallWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'recall').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n    this.globalRecallWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'recall' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-asc');\n\n    this.globalRecallWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'recall' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-desc');\n\n    // Add button for sorting by name\n    this.globalName = this.globalControls.append('li').attr('class', 'control-btn sort-name').classed('active', function () {\n      if (that.vis.currentSorting.global.type === 'name') {\n        // See precision\n        that.vis.currentSorting.global.el = d3.select(this);\n        return true;\n      }\n      return false;\n    }).on('click', function () {\n      that.sortAllColumns(this, 'name');\n    }).on('mouseenter', function () {\n      _this.vis.interactionWrapper.call(_this.vis, function () {\n        _this.highlightLabels();\n      }, []);\n    }).on('mouseleave', function () {\n      _this.vis.interactionWrapper.call(_this.vis, function () {\n        _this.highlightLabels(true);\n      }, []);\n    });\n\n    this.globalNameWrapper = this.globalName.append('div').attr('class', 'wrapper');\n\n    this.globalNameWrapper.append('span').attr('class', 'label').text('Name');\n\n    this.globalNameWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'name').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n    this.globalNameWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'name' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-alpha-asc');\n\n    this.globalNameWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'name' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-alpha-desc');\n\n    // Add button for switching to 'one bar'\n    this.globalOneBar = this.globalControls.append('li').attr('class', 'control-btn one-bar').classed('active', this.vis.barMode === 'one').on('click', function () {\n      that.switchBarMode(this, 'one');\n    });\n\n    this.globalOneBarWrapper = this.globalOneBar.append('div').attr('class', 'wrapper').text('One bar');\n\n    this.globalOneBarWrapper.append('svg').attr('class', 'icon-one-bar').append('use').attr('xlink:href', this.vis.iconPath + '#one-bar');\n\n    // Add button for switching to 'two bars'\n    this.globalTwoBars = this.globalControls.append('li').attr('class', 'control-btn two-bars').classed('active', this.vis.barMode === 'two').on('click', function () {\n      that.switchBarMode(this, 'two');\n    });\n\n    this.globalTwoBarsWrapper = this.globalTwoBars.append('div').attr('class', 'wrapper').text('Two bars');\n\n    this.globalTwoBarsWrapper.append('svg').attr('class', 'icon-two-bars').append('use').attr('xlink:href', this.vis.iconPath + '#two-bars');\n\n    // Add button for zoom-out\n    this.globalZoomOut = this.globalControls.append('li').attr('class', 'control-btn zoom-out').classed('active', this.vis.zoomedOut).on('mouseenter', function () {\n      _this.vis.interactionWrapper.call(_this.vis, function () {\n        _this.vis.globalView.call(_this.vis);\n      }, []);\n    }).on('mouseleave', function () {\n      _this.vis.interactionWrapper.call(_this.vis, function () {\n        _this.vis.zoomedView.call(_this.vis);\n      }, []);\n    }).on('click', function () {\n      that.vis.toggleView.call(that.vis);\n      d3.select(this).classed('active', that.vis.zoomedOut);\n    });\n\n    this.globalZoomOutWrapper = this.globalZoomOut.append('div').attr('class', 'wrapper').text('Zoom Out');\n\n    this.globalZoomOutWrapper.append('svg').attr('class', 'icon-zoom-out').append('use').attr('xlink:href', this.vis.iconPath + '#zoom-out');\n\n    this.localControlWrapper = this.el.append('div').classed('local-controls', true);\n\n    this.localControls = this.localControlWrapper.selectAll(TOPBAR_CONTROL_CLASS).data(visData.nodes).enter().append(TOPBAR_CONTROL_EL).classed(TOPBAR_CONTROL_CLASS, true).style('width', this.visData.global.column.width + 'px');\n\n    this.localControls.each(function (data, index) {\n      var control = d3.select(this);\n\n      /*\n       * Order:\n       * 0 = unsorted\n       * 1 = asc\n       * -1 = desc\n       */\n      that.vis.currentSorting.local[index] = {\n        type: data.sortBy,\n        order: data.sortOrder,\n        el: undefined\n      };\n\n      control.append('li').attr('class', 'control-btn toggle').style('width', that.visData.global.column.padding + 'px').on('click', that.toggleColumn);\n\n      control.append('li').attr('class', 'control-btn sort-precision ease-all').classed('active', function () {\n        if (that.vis.currentSorting.local[index].type === 'precision') {\n          // See precision\n          that.vis.currentSorting.local[index].el = d3.select(this);\n          return true;\n        }\n        return false;\n      }).style('width', that.visData.global.column.contentWidth / 2 + 'px').style('left', that.visData.global.column.padding + 'px').on('click', function (controlData) {\n        that.sortColumn(this, controlData.level, 'precision');\n      }).on('mouseenter', function () {\n        that.highlightBars(this.parentNode, 'precision');\n        d3.select(this).style('width', that.visData.global.column.contentWidth - 16 + 'px');\n      }).on('mouseleave', function () {\n        that.highlightBars(this.parentNode, 'precision', true);\n        d3.select(this).style('width', that.visData.global.column.contentWidth / 2 + 'px');\n      }).html('<div class=\"expandable-label\">' + '  <span class=\"letter abbr\">P</span>' + '  <span class=\"letter abbr\">r</span>' + '  <span class=\"letter\">e</span>' + '  <span class=\"letter abbr\">c</span>' + '  <span class=\"letter\">i</span>' + '  <span class=\"letter\">s</span>' + '  <span class=\"letter\">i</span>' + '  <span class=\"letter\">o</span>' + '  <span class=\"letter\">n</span>' + '</div>' + '<svg class=\"icon-unsort invisible-default ' + (that.vis.currentSorting.local[index].type !== 'precision' ? 'visible' : '') + '\">' + // eslint-disable-line\n      '  <use xlink:href=\"' + that.vis.iconPath + '#unsort\"></use>' + '</svg>' + '<svg class=\"icon-sort-asc invisible-default ' + (that.vis.currentSorting.local[index].type === 'precision' && that.vis.currentSorting.local[index].order === 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n      '  <use xlink:href=\"' + that.vis.iconPath + '#sort-asc\"></use>' + '</svg>' + '<svg class=\"icon-sort-desc invisible-default ' + (that.vis.currentSorting.local[index].type === 'precision' && that.vis.currentSorting.local[index].order !== 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n      '  <use xlink:href=\"' + that.vis.iconPath + '#sort-desc\"></use>' + '</svg>');\n\n      control.append('li').attr('class', 'control-btn sort-recall ease-all').classed('active', function () {\n        if (that.vis.currentSorting.local[index].type === 'recall') {\n          // See recall\n          that.vis.currentSorting.local[index].el = d3.select(this);\n          return true;\n        }\n        return false;\n      }).style('width', that.visData.global.column.contentWidth / 2 + 'px').style('left', that.visData.global.column.contentWidth / 2 + that.visData.global.column.padding + 'px').on('click', function (controlData) {\n        that.sortColumn(this, controlData.level, 'recall');\n      }).on('mouseenter', function () {\n        that.highlightBars(this.parentNode, 'recall');\n        d3.select(this).style('width', that.visData.global.column.contentWidth - 16 + 'px').style('left', that.visData.global.column.padding + 16 + 'px');\n      }).on('mouseleave', function () {\n        that.highlightBars(this.parentNode, 'recall', true);\n        d3.select(this).style('width', that.visData.global.column.contentWidth / 2 + 'px').style('left', that.visData.global.column.contentWidth / 2 + that.visData.global.column.padding + 'px');\n      }).html('<div class=\"expandable-label\">' + '  <span class=\"letter abbr\">R</span>' + '  <span class=\"letter\">e</span>' + '  <span class=\"letter abbr\">c</span>' + '  <span class=\"letter\">a</span>' + '  <span class=\"letter abbr\">l</span>' + '  <span class=\"letter\">l</span>' + '</div>' + '<svg class=\"icon-unsort invisible-default ' + (that.vis.currentSorting.local[index].type !== 'recall' ? 'visible' : '') + '\">' + // eslint-disable-line\n      '  <use xlink:href=\"' + that.vis.iconPath + '#unsort\"></use>' + '</svg>' + '<svg class=\"icon-sort-asc invisible-default ' + (that.vis.currentSorting.local[index].type === 'recall' && that.vis.currentSorting.local[index].order === 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n      '  <use xlink:href=\"' + that.vis.iconPath + '#sort-asc\"></use>' + '</svg>' + '<svg class=\"icon-sort-desc invisible-default ' + (that.vis.currentSorting.local[index].type === 'recall' && that.vis.currentSorting.local[index].order !== 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n      '  <use xlink:href=\"' + that.vis.iconPath + '#sort-desc\"></use>' + '</svg>');\n\n      control.append('li').attr('class', 'control-btn options').style('width', that.visData.global.column.padding + 'px').on('click', that.toggleOptions).html('<svg class=\"icon-gear\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#gear\"></use>' + '</svg>');\n\n      if (that.vis.currentSorting.local[index].type) {\n        that.vis.currentSorting.local[index].el = control.select('.sort-' + that.vis.currentSorting.local[index].type);\n      }\n    });\n  }\n\n  // toggleColumn () {\n  //   console.log('Toggle column');\n  // }\n\n  createClass(Topbar, [{\n    key: 'selectNodesLevel',\n    value: function selectNodesLevel(el) {\n      return this.vis.selectByLevel(d3.select(el).datum().level, '.node');\n    }\n  }, {\n    key: 'highlightLabels',\n    value: function highlightLabels(deHighlight) {\n      this.vis.baseElD3.selectAll('.node').classed('highlight-label', !deHighlight);\n    }\n  }, {\n    key: 'highlightBars',\n    value: function highlightBars(el, type, deHighlight) {\n      var nodes = el ? this.selectNodesLevel(el) : this.vis.baseElD3.selectAll('.node');\n\n      nodes.classed('highlight-bar', !deHighlight).selectAll('.bar.' + type).classed('highlight', !deHighlight);\n    }\n  }, {\n    key: 'sortAllColumns',\n    value: function sortAllColumns(el, type) {\n      var newSortType = this.vis.currentSorting.global.type !== type;\n\n      if (newSortType) {\n        if (this.semiActiveSortingEls) {\n          this.resetSemiActiveSortingEls();\n        }\n        // Unset class of previous global sorting element\n        if (this.vis.currentSorting.global.el) {\n          this.resetSortEl(this.vis.currentSorting.global.el, type);\n        }\n      }\n\n      this.vis.currentSorting.global.el = d3.select(el);\n      this.vis.currentSorting.global.el.classed('active', true);\n      this.vis.currentSorting.global.type = type;\n\n      var columnKeys = Object.keys(this.vis.currentSorting.local);\n      for (var i = 0, len = columnKeys.length; i < len; i++) {\n        // Update local sorting properties and buttons but do **not** sort\n        // locally!\n        this.sortColumn(el, columnKeys[i], type, true);\n      }\n\n      this.vis.sortAllColumns(type, newSortType);\n    }\n  }, {\n    key: 'sortColumn',\n    value: function sortColumn(el, index, type, global) {\n      // Reset global sorting\n      if (!global) {\n        if (this.semiActiveSortingEls) {\n          this.resetSemiActiveSortingEls();\n        }\n        if (this.vis.currentSorting.global.type) {\n          this.resetSortEl(this.vis.currentSorting.global.el, type);\n        }\n        this.vis.currentSorting.global.type = undefined;\n      }\n\n      var newSortType = false;\n\n      if (this.vis.currentSorting.local[index].el) {\n        if (this.vis.currentSorting.local[index].type !== type) {\n          this.resetSortEl(this.vis.currentSorting.local[index].el, type);\n        }\n      }\n\n      if (this.vis.currentSorting.local[index].type !== type) {\n        newSortType = true;\n        // Reset sort order\n        this.vis.currentSorting.local[index].order = 0;\n      }\n\n      this.vis.currentSorting.local[index].el = d3.select(el);\n      this.vis.currentSorting.local[index].type = type;\n\n      // -1 = desc, 1 = asc\n      if (this.vis.currentSorting.local[index].order === -1) {\n        this.vis.currentSorting.local[index].order = 1;\n        this.vis.currentSorting.local[index].el.select('.icon-sort-desc').classed('visible', false);\n        this.vis.currentSorting.local[index].el.select('.icon-sort-asc').classed('visible', true);\n      } else {\n        this.vis.currentSorting.local[index].order = -1;\n        this.vis.currentSorting.local[index].el.select('.icon-sort-asc').classed('visible', false);\n        this.vis.currentSorting.local[index].el.select('.icon-sort-desc').classed('visible', true);\n      }\n\n      this.vis.currentSorting.local[index].el.select('.icon-unsort').classed('visible', false);\n\n      this.vis.currentSorting.local[index].el.classed('active', true);\n\n      if (!global) {\n        this.vis.sortColumn(index, type, this.vis.currentSorting.local[index].order, newSortType);\n      }\n    }\n  }, {\n    key: 'resetSortEl',\n    value: function resetSortEl(el, newType) {\n      el.classed('active', false);\n      el.select('.icon-sort-desc').classed('visible', false);\n      el.select('.icon-sort-asc').classed('visible', false);\n      el.select('.icon-unsort').classed('visible', true);\n      if (newType === 'name') {\n        el.classed('semi-active', true);\n        this.semiActiveSortingEls = true;\n      }\n    }\n  }, {\n    key: 'resetSemiActiveSortingEls',\n    value: function resetSemiActiveSortingEls() {\n      this.el.selectAll('.semi-active').classed('semi-active', false);\n    }\n\n    // toggleOptions () {\n    //   console.log('Toggle options');\n    // }\n\n  }, {\n    key: 'switch',\n    value: function _switch() {\n      this.el.classed('details', !this.el.classed('details'));\n    }\n  }, {\n    key: 'switchBarMode',\n    value: function switchBarMode(el, mode) {\n      if (this.vis.nodes.barMode !== mode) {\n        if (mode === 'one') {\n          this.globalOneBar.classed('active', true);\n          this.globalTwoBars.classed('active', false);\n        } else {\n          this.globalOneBar.classed('active', false);\n          this.globalTwoBars.classed('active', true);\n        }\n        this.vis.switchBarMode(mode);\n      }\n    }\n  }]);\n  return Topbar;\n}();\n\n// External\n// eslint-disable-line import/no-unresolved\n\nvar COLUMN_CLASS = 'column';\nvar SCROLL_CONTAINER_CLASS = 'scroll-container';\n\nvar Levels = function () {\n  function Levels(selection, vis, visData) {\n    var _this = this;\n\n    classCallCheck(this, Levels);\n\n    this.vis = vis;\n    this.visData = visData;\n    this.groups = selection.selectAll('g').data(this.visData.nodes).enter().append('g').attr('class', COLUMN_CLASS).classed('active', function (data, index) {\n      if (_this.vis.highlightActiveLevel) {\n        if (!_this.vis.nodes || !_this.vis.nodes.rootedNode) {\n          return index === _this.vis.activeLevel - _this.vis.noRootActiveLevelDiff;\n        }\n        return index === _this.vis.activeLevel;\n      }\n      return false;\n    }).each(function (data) {\n      data.scrollTop = 0;\n    });\n\n    // We need to add an empty rectangle that fills up the whole column to ensure\n    // that the `g`'s size is at a maximum, otherwise scrolling will be halted\n    // when the cursor leaves an actually drawn element.\n    this.groups.append('rect').attr('class', SCROLL_CONTAINER_CLASS).attr('x', function (data) {\n      return data.x;\n    }).attr('y', function (data) {\n      return data.y;\n    }).attr('width', this.visData.global.column.width + 1).attr('height', this.visData.global.column.height);\n  }\n\n  createClass(Levels, [{\n    key: 'scrollPreparation',\n    value: function scrollPreparation(vis, scrollbarWidth) {\n      var _this2 = this;\n\n      this.groups.each(function (data, index) {\n        var contentHeight = data.nodes.getBoundingClientRect().height + 2 * _this2.visData.global.row.padding;\n        var scrollHeight = contentHeight - _this2.visData.global.column.height;\n        var scrollbarHeight = scrollHeight > 0 ? Math.max(_this2.visData.global.column.height * _this2.visData.global.column.height / contentHeight, 10) : 0;\n\n        data.height = contentHeight;\n        data.linkSelections = {\n          incoming: index > 0 ? vis.selectByLevel(index - 1, '.link') : null,\n          outgoing: vis.selectByLevel(index, '.link')\n        };\n        data.scrollHeight = scrollHeight;\n        data.scrollTop = 0;\n        data.scrollbar = {\n          el: undefined,\n          x: data.x + (_this2.visData.global.column.width - scrollbarWidth),\n          y: 0,\n          width: scrollbarWidth,\n          height: scrollbarHeight,\n          scrollHeight: _this2.visData.global.column.height - scrollbarHeight,\n          scrollTop: 0,\n          heightScale: d3.scaleLinear().domain([0, scrollHeight]).range([0, _this2.visData.global.column.height - scrollbarHeight])\n        };\n        data.invertedHeightScale = data.scrollbar.heightScale.invert;\n      });\n    }\n  }, {\n    key: 'updateScrollProperties',\n    value: function updateScrollProperties() {\n      var _this3 = this;\n\n      this.groups.each(function (data) {\n        var contentHeight = data.nodes.getBoundingClientRect().height + 2 * _this3.visData.global.row.padding;\n        var scrollHeight = contentHeight - _this3.visData.global.column.height;\n        var scrollbarHeight = scrollHeight > 0 ? Math.max(_this3.visData.global.column.height * _this3.visData.global.column.height / contentHeight, 10) : 0;\n\n        data.height = contentHeight;\n        data.scrollHeight = scrollHeight;\n        data.scrollTop = 0;\n        data.scrollbar.y = 0;\n        data.scrollbar.height = scrollbarHeight;\n        data.scrollbar.scrollHeight = _this3.visData.global.column.height - scrollbarHeight;\n        data.scrollbar.scrollTop = 0;\n        data.scrollbar.heightScale = d3.scaleLinear().domain([0, scrollHeight]).range([0, _this3.visData.global.column.height - scrollbarHeight]);\n      });\n    }\n  }, {\n    key: 'updateVisibility',\n    value: function updateVisibility() {\n      this.groups.each(function () {\n        var group = d3.select(this);\n\n        group.classed('hidden', group.selectAll('.node').filter(function (data) {\n          return !data.hidden;\n        }).empty());\n      });\n    }\n  }, {\n    key: 'focus',\n    value: function focus(level) {\n      if (this.vis.highlightActiveLevel) {\n        this.groups.filter(function (data) {\n          return data.level === level;\n        }).classed('active', true);\n      }\n    }\n  }, {\n    key: 'blur',\n    value: function blur(level) {\n      if (this.vis.highlightActiveLevel) {\n        if (level) {\n          this.groups.filter(function (data) {\n            return data.level === level;\n          }).classed('active', false);\n        } else {\n          this.groups.classed('active', false);\n        }\n      }\n    }\n  }, {\n    key: 'className',\n    get: function get() {\n      return COLUMN_CLASS;\n    }\n  }, {\n    key: 'height',\n    get: function get() {\n      return this.visData.global.column.height;\n    }\n  }]);\n  return Levels;\n}();\n\n// External\n// eslint-disable-line import/no-unresolved\n\n// Internal\nvar LINKS_CLASS = 'links';\nvar LINK_CLASS = 'link';\n\nvar Links = function () {\n  function Links(vis, levels, visData, layout) {\n    var _this = this;\n\n    classCallCheck(this, Links);\n\n    this.vis = vis;\n    this.visData = visData;\n    this.layout = layout;\n\n    this.groups = levels.append('g').attr('class', LINKS_CLASS).call(function (selection) {\n      selection.each(function () {\n        d3.select(this.parentNode).datum().links = this;\n      });\n    });\n\n    this.links = this.groups.selectAll(LINK_CLASS).data(function (data, index) {\n      return _this.layout.links(index);\n    }).enter().append('g').attr('class', LINK_CLASS).classed('visible', !this.vis.hideOutwardsLinks || this.linkVisibility.bind(this));\n\n    this.links.append('path').attr('class', LINK_CLASS + '-bg').attr('d', this.diagonal.bind(this));\n\n    this.links.append('path').attr('class', LINK_CLASS + '-direct').attr('d', this.diagonal.bind(this));\n  }\n\n  createClass(Links, [{\n    key: 'linkVisibility',\n    value: function linkVisibility(data) {\n      // Cache visibility.\n      data.hidden = this.vis.pointsOutside.call(this.vis, data);\n      return data.hidden === 0;\n    }\n  }, {\n    key: 'highlight',\n    value: function highlight(nodeIds, _highlight, className) {\n      this.links.filter(function (data) {\n        return nodeIds[data.id];\n      }).classed(className, _highlight);\n    }\n  }, {\n    key: 'scroll',\n    value: function scroll(selection, data) {\n      // Update data of `g`.\n      selection.data(data);\n\n      if (this.vis.hideOutwardsLinks) {\n        // Check if links point outwards.\n        selection.classed('visible', this.linkVisibility.bind(this));\n      }\n\n      // Next, update all paths according to the new data.\n      selection.selectAll('path').attr('d', this.diagonal);\n    }\n  }, {\n    key: 'sort',\n    value: function sort(update) {\n      var start = function start() {\n        d3.select(this).classed('sorting', true);\n      };\n      var end = function end() {\n        d3.select(this).classed('sorting', false);\n      };\n\n      // Update data of `g`.\n      this.links.data(update, function (data) {\n        return data.id;\n      });\n\n      // Next update all paths according to the new data.\n      this.links.selectAll('path').transition().duration(TRANSITION_SEMI_FAST).attr('d', this.diagonal).on('start', start).on('end', end);\n    }\n  }, {\n    key: 'updateVisibility',\n    value: function updateVisibility() {\n      this.links.selectAll('path').classed('hidden', function (data) {\n        return data.target.node.hidden || data.source.node.hidden;\n      }).transition().duration(TRANSITION_SEMI_FAST).attr('d', this.diagonal);\n    }\n  }, {\n    key: 'diagonal',\n    get: function get() {\n      var _this2 = this;\n\n      var extraOffsetX = this.vis.showLinkLocation ? 6 : 0;\n\n      function getSourceX(source) {\n        return source.node.x + source.offsetX + this.visData.global.column.contentWidth + this.visData.global.column.padding;\n      }\n\n      function getTargetX(source) {\n        return source.node.x + source.offsetX + this.visData.global.column.padding;\n      }\n\n      function getY(source) {\n        return source.node.y + source.offsetY + this.visData.global.row.height / 2;\n      }\n\n      return function (data) {\n        var sourceY = getY.call(_this2, data.source);\n        var sourceX = getSourceX.call(_this2, data.source);\n        var targetY = getY.call(_this2, data.target);\n        var targetX = getTargetX.call(_this2, data.target);\n        var middleX = (sourceX + targetX) / 2;\n\n        return 'M' + sourceX + ',' + sourceY + 'h' + extraOffsetX + 'C' + (middleX + extraOffsetX) + ',' + sourceY + ' ' + (middleX - extraOffsetX) + ',' + targetY + ' ' + (targetX - extraOffsetX) + ',' + targetY + 'h' + extraOffsetX;\n      };\n    }\n  }]);\n  return Links;\n}();\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\nvar funcTag = '[object Function]';\nvar genTag = '[object GeneratorFunction]';\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n  var tag = isObject(value) ? objectToString.call(value) : '';\n  return tag == funcTag || tag == genTag;\n}\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsFinite = root.isFinite;\n\n/**\n * Checks if `value` is a finite primitive number.\n *\n * **Note:** This method is based on\n * [`Number.isFinite`](https://mdn.io/Number/isFinite).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a finite number, else `false`.\n * @example\n *\n * _.isFinite(3);\n * // => true\n *\n * _.isFinite(Number.MIN_VALUE);\n * // => true\n *\n * _.isFinite(Infinity);\n * // => false\n *\n * _.isFinite('3');\n * // => false\n */\nfunction isFinite(value) {\n  return typeof value == 'number' && nativeIsFinite(value);\n}\n\n/**\n * Collect all cloned nodes, including the original node.\n *\n * @method  collectInclClones\n * @author  Fritz Lekschas\n * @date    2016-03-20\n * @param   {Object}   node                 Start node\n * @param   {Boolean}  onlyForOriginalNode  If `true` only collect clones when\n *   `node` is not a clone itself.\n * @return  {Array}                         Array of original and cloned nodes.\n */\nfunction collectInclClones(node, onlyForOriginalNode) {\n  var originalNode = node;\n\n  if (node.clone) {\n    originalNode = node.originalNode;\n    if (onlyForOriginalNode) {\n      return [];\n    }\n  }\n\n  var clones = [originalNode];\n\n  if (originalNode.clones.length) {\n    clones = clones.concat(originalNode.clones);\n  }\n\n  return clones;\n}\n\n// External\n// Internal\nfunction _up(node, callback, depth, includeClones, child, visitedNodes) {\n  if (visitedNodes[node.id]) {\n    if (!visitedNodes[node.id][child.id]) {\n      callback(node, child);\n    }\n    return;\n  }\n\n  var nodes = includeClones ? collectInclClones(node) : [node];\n\n  for (var i = nodes.length; i--;) {\n    visitedNodes[nodes[i].id] = {};\n\n    if (child) {\n      callback(nodes[i], child);\n      visitedNodes[nodes[i].id][child.id] = true;\n    }\n\n    if (!isFinite(depth) || depth > 0) {\n      var parentsId = Object.keys(nodes[i].parents);\n      for (var j = parentsId.length; j--;) {\n        _up(nodes[i].parents[parentsId[j]], callback, depth - 1, includeClones, nodes[i], visitedNodes);\n      }\n    }\n  }\n}\n\nfunction up(node, callback, depth, includeClones, child) {\n  var visitedNodes = {};\n  _up(node, callback, depth, includeClones, child, visitedNodes);\n}\n\nfunction _down(node, callback, depth, includeClones, visitedNodes) {\n  if (visitedNodes[node.id]) {\n    return;\n  }\n\n  var nodes = includeClones ? collectInclClones(node) : [node];\n\n  for (var i = nodes.length; i--;) {\n    callback(nodes[i]);\n\n    visitedNodes[nodes[i].id] = true;\n\n    // We only need to recursivly traverse the graph for the original node as\n    // the clones do not have any children (i.e. the have the same children as\n    // the original node)\n    if (i === 0 && (!isFinite(depth) || depth > 0)) {\n      for (var j = nodes[i].childRefs.length; j--;) {\n        _down(nodes[i].childRefs[j], callback, depth - 1, includeClones, visitedNodes);\n      }\n    }\n  }\n}\n\nfunction down(node, callback, depth, includeClones) {\n  var visitedNodes = {};\n  _down(node, callback, depth, includeClones, visitedNodes);\n}\n\nfunction upAndDown(node, callbackUp, callbackDown, depth, includeClones) {\n  if (callbackDown) {\n    up(node, callbackUp, depth, includeClones);\n    down(node, callbackDown, depth, includeClones);\n  } else {\n    var visitedNodes = {};\n    up(node, callbackUp, depth, includeClones, visitedNodes);\n    down(node, callbackUp, depth, includeClones, visitedNodes);\n  }\n}\n\nfunction siblings(node, callback) {\n  var parentsId = Object.keys(node.parents);\n  for (var i = parentsId.length; i--;) {\n    for (var j = node.parents[parentsId[i]].childRefs.length; j--;) {\n      callback(node.parents[parentsId[i]].childRefs[j]);\n    }\n  }\n  // The root node doesn't have a `parents` property but might have `siblings`.\n  if (node.siblings) {\n    var siblingsId = Object.keys(node.siblings);\n    for (var _i = siblingsId.length; _i--;) {\n      callback(node.siblings[siblingsId[_i]]);\n    }\n  }\n}\n\nvar BAR_CLASS = 'bar';\n\nvar Bar = function Bar(barGroup, barData, nodeData, visData, bars) {\n  var _this = this;\n\n  classCallCheck(this, Bar);\n\n  this.data = barData;\n  this.nodeData = nodeData;\n  this.visData = visData;\n  this.bars = bars;\n\n  this.data.x = nodeData.x;\n  this.data.level = nodeData.depth;\n\n  this.height = this.visData.global.row.contentHeight / (this.data.length * 2) - this.visData.global.cell.padding * 2;\n\n  this.activeHeight = this.visData.global.row.contentHeight - 2;\n\n  this.inactiveheight = this.visData.global.cell.padding * 2 - 1;\n\n  this.selection = barGroup.selectAll(BAR_CLASS).data(this.data).enter().append('g').attr('class', function (data) {\n    return BAR_CLASS + ' ' + data.id;\n  }).classed('active', function (data) {\n    return data.id === _this.visData.nodes[_this.nodeData.depth].sortBy;\n  });\n\n  // Local helper method to avoid code duplication.\n  function setupMagnitude(selection) {\n    var _this2 = this;\n\n    var currentSorting = this.visData.nodes[this.nodeData.depth].sortBy;\n\n    selection.attr('d', function (data) {\n      return _this2.bars.generatePath(data, currentSorting);\n    }).classed('bar-magnitude', true);\n  }\n\n  function setupBorder(selection) {\n    selection.attr('x', 0).attr('y', this.visData.global.row.padding).attr('width', this.visData.global.column.contentWidth).attr('height', this.visData.global.row.contentHeight).attr('rx', 2).attr('ry', 2).classed('bar-border', true);\n  }\n\n  function setupIndicator(selection) {\n    selection.attr({\n      class: 'bar-indicator',\n      x: 0,\n      y: this.visData.global.row.padding,\n      width: 2,\n      height: this.visData.global.row.contentHeight\n    });\n  }\n\n  this.selection.append('rect').call(setupBorder.bind(this));\n\n  this.selection.append('path').call(setupMagnitude.bind(this));\n\n  this.selection.append('rect').call(setupIndicator.bind(this));\n};\n\n// Credits go to Mike Bostock: http://bl.ocks.org/mbostock/3468167\nfunction roundRect(x, y, width, height, radius) {\n  var topLeft = radius.topLeft || 0;\n  var topRight = radius.topRight || 0;\n  var bottomLeft = radius.bottomLeft || 0;\n  var bottomRight = radius.bottomRight || 0;\n\n  return 'M' + (x + topLeft) + ',' + y + 'h' + (width - topLeft - topRight) + 'a' + topRight + ',' + topRight + ' 0 0 1 ' + topRight + ',' + topRight + 'v' + (height - (topRight + bottomRight)) + 'a' + bottomRight + ',' + bottomRight + ' 0 0 1 ' + -bottomRight + ',' + bottomRight + 'h' + (bottomLeft - (width - bottomRight)) + 'a' + bottomLeft + ',' + bottomLeft + ' 0 0 1 ' + -bottomLeft + ',' + -bottomLeft + 'v' + (topLeft - (height - bottomLeft)) + 'a' + topLeft + ',' + topLeft + ' 0 0 1 ' + topLeft + ',' + -topLeft + 'z';\n}\n\n/**\n * Creates a path that looks like a drop menu\n *\n * @example\n * The following is an example how to create a drop menu path:\n * ```javascript\n * import { dropMenu } from './charts';\n * const dropMenuPath = dropMenu({\n *   x: 0,\n *   y: 0,\n *   width: 50,\n *   height: 100,\n *   radius: 5,\n *   arrowSize: 5\n * });\n * ```\n *\n * @method  dropMenu\n * @author  Fritz Lekschas\n * @date    2016-03-03\n * @param   {Object}  c  Config object that needs to contain the following\n *   properties: x, y, width, height, radius and arrowSize.\n */\nfunction dropMenu(c) {\n  return 'M' + (c.x + c.radius) + ',' + c.y + 'h' + (c.width - c.radius * 2) + 'a' + c.radius + ',' + c.radius + ' 0 0 1 ' + c.radius + ',' + c.radius + 'v' + (c.height - c.radius * 2) + 'a' + c.radius + ',' + c.radius + ' 0 0 1 ' + -c.radius + ',' + c.radius + 'h' + -(c.width - c.radius * 2 - c.arrowSize * 2) / 2 + 'l' + -c.arrowSize + ',' + c.arrowSize + 'l' + -c.arrowSize + ',' + -c.arrowSize + 'h' + -(c.width - c.radius * 2 - c.arrowSize * 2) / 2 + 'a' + c.radius + ',' + c.radius + ' 0 0 1 ' + -c.radius + ',' + -c.radius + 'v' + (c.radius - (c.height - c.radius)) + 'a' + c.radius + ',' + c.radius + ' 0 0 1 ' + c.radius + ',' + -c.radius + 'z';\n}\n\n// External\n// eslint-disable-line import/no-unresolved\n\n// Internal\nvar BARS_CLASS = 'bars';\n\nvar Bars = function () {\n  function Bars(vis, selection, mode, visData) {\n    classCallCheck(this, Bars);\n\n    var that = this;\n\n    this.vis = vis;\n    this.mode = mode;\n    this.visData = visData;\n\n    this.indicatorX = d3.scaleLinear().domain([0, 1]).range([1, this.visData.global.column.contentWidth - 3]);\n\n    this.selection = selection.append('g').attr('class', BARS_CLASS);\n\n    this.selection.each(function (datum) {\n      new Bar(d3.select(this), datum.data.bars, datum, that.visData, that);\n    });\n  }\n\n  createClass(Bars, [{\n    key: 'updateAll',\n    value: function updateAll(update, sortBy) {\n      var _this = this;\n\n      this.selection.selectAll('.bar-magnitude').data(update, function (data) {\n        return data.barId;\n      }).transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n        return _this.generatePath(data, _this.mode, sortBy, _this.visData);\n      });\n    }\n  }, {\n    key: 'update',\n    value: function update(selection, sortBy) {\n      var _this2 = this;\n\n      selection.each(function (data) {\n        var el = d3.select(this);\n\n        if (data.id === sortBy && !el.classed('active')) {\n          el.classed('active', true);\n          // Ensure that the active bars we are places before any other bar,\n          // thus placing them in the background\n          this.parentNode.insertBefore(this, this.parentNode.children[0]);\n        }\n\n        if (data.id !== sortBy) {\n          el.classed('active', false);\n        }\n      });\n\n      selection.selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n        return _this2.generatePath(data, sortBy);\n      });\n    }\n  }, {\n    key: 'updateIndicator',\n    value: function updateIndicator(selection, referenceValue) {\n      selection.attr('x', this.indicatorX(referenceValue)).attr('width', 2);\n    }\n  }, {\n    key: 'switchMode',\n    value: function switchMode(mode, currentSorting) {\n      var _this3 = this;\n\n      if (this.mode !== mode) {\n        if (mode === 'one') {\n          if (currentSorting.global.type) {\n            this.selection.selectAll('.bar').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n              return _this3.generateOneBarPath(data, currentSorting.global.type);\n            });\n          } else {\n            // console.error(\n            //   'Switching magnitude visualization after individual sorting is ' +\n            //   'not supported yet.'\n            // );\n          }\n        }\n\n        if (mode === 'two') {\n          this.selection.selectAll('.bar.precision').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n            return _this3.generateTwoBarsPath(data);\n          });\n\n          this.selection.selectAll('.bar.recall').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n            return _this3.generateTwoBarsPath(data, true);\n          });\n        }\n\n        this.mode = mode;\n      }\n    }\n  }, {\n    key: 'generatePath',\n    value: function generatePath(data, currentSorting, indicator, adjustWidth, bottom) {\n      if (this.mode === 'two') {\n        return this.generateTwoBarsPath(data, bottom);\n      }\n      return this.generateOneBarPath(data, currentSorting, indicator, adjustWidth);\n    }\n  }, {\n    key: 'generateOneBarPath',\n    value: function generateOneBarPath(data, currentSorting, indicator, adjustWidth) {\n      var height = this.visData.global.row.contentHeight;\n      var normValue = Math.min(data.value, 1) || 0;\n      var normIndicator = Math.min(indicator, 1) || 0;\n\n      var x = 0;\n      var width = 2;\n\n      var radius = {\n        topLeft: 2,\n        bottomLeft: 2\n      };\n\n      if (indicator) {\n        radius = {};\n      }\n\n      if (data.id !== currentSorting && typeof indicator === 'undefined') {\n        x = this.indicatorX(normValue);\n        radius = {};\n      } else if (indicator) {\n        x = normIndicator * this.visData.global.column.contentWidth;\n        if (adjustWidth) {\n          if (normValue < normIndicator) {\n            x = normValue * this.visData.global.column.contentWidth;\n          }\n          width = Math.max(Math.abs(normIndicator - normValue) * this.visData.global.column.contentWidth, 2);\n        }\n      } else {\n        width = this.visData.global.column.contentWidth * normValue;\n      }\n\n      x = Math.min(x, this.visData.global.column.contentWidth - 2);\n\n      return roundRect(x, this.visData.global.row.padding, width, height, radius);\n    }\n  }, {\n    key: 'generateTwoBarsPath',\n    value: function generateTwoBarsPath(data, bottom) {\n      var normValue = Math.min(data.value, 1);\n      var height = this.visData.global.row.contentHeight / 2;\n      var width = this.visData.global.column.contentWidth * normValue;\n\n      var y = this.visData.global.row.padding;\n      var radius = { topLeft: 2 };\n\n      if (bottom) {\n        radius = { bottomLeft: 2 };\n        y += height;\n      }\n\n      return roundRect(0, y, width, height, radius);\n    }\n  }]);\n  return Bars;\n}();\n\n// External\nfunction mergeSelections(selections) {\n  // Create a new empty selection\n  var mergedSelection = d3.selectAll('.d3-list-graph-not-existent');\n\n  for (var i = selections.length; i--;) {\n    mergedSelection._groups = mergedSelection._groups.concat(selections[i]._groups);\n  }\n\n  return mergedSelection;\n}\n\nfunction allTransitionsEnded(transition, callback) {\n  if (transition.size() === 0) {\n    callback();\n  }\n  var n = 0;\n  transition.each(function () {\n    return ++n;\n  }).on('end', function () {\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    if (! --n) callback.apply(this, args);\n  });\n}\n\n// External\n// eslint-disable-line import/no-unresolved\n// Internal\nvar CLASS_NODES = 'nodes';\nvar CLASS_NODE = 'node';\nvar CLASS_NODE_VISIBLE = 'visible-node';\nvar CLASS_CLONE = 'clone';\nvar CLASS_LABEL_WRAPPER = 'label-wrapper';\nvar CLASS_FOCUS_CONTROLS = 'focus-controls';\nvar CLASS_ROOT = 'root';\nvar CLASS_QUERY = 'query';\nvar CLASS_LOCK = 'lock';\nvar CLASS_INACTIVE = 'inactive';\nvar CLASS_INDICATOR_BAR = 'link-indicator';\nvar CLASS_INDICATOR_LOCATION = 'link-location-indicator';\nvar CLASS_INDICATOR_INCOMING = 'incoming';\nvar CLASS_INDICATOR_OUTGOING = 'outgoing';\nvar CLASS_INDICATOR_ABOVE = 'above';\nvar CLASS_INDICATOR_BELOW = 'below';\n\nvar Nodes = function () {\n  function Nodes(vis, baseSelection, visData, links, events) {\n    var _this = this;\n\n    classCallCheck(this, Nodes);\n\n    var that = this;\n\n    this.vis = vis;\n    this.visData = visData;\n    this.links = links;\n    this.events = events;\n    this.currentLinks = {};\n    this.iconDimension = Math.min(this.visData.global.row.contentHeight / 2 - this.visData.global.cell.padding * 2, this.visData.global.column.padding / 2 - 4);\n\n    var linkDensityBg = d3.scaleLinear().domain([1, this.vis.rows]).range(['#ccc', '#000']);\n\n    function drawLinkIndicator(selection, direction) {\n      var incoming = direction === 'incoming';\n\n      selection.attr('class', CLASS_INDICATOR_BAR + ' ' + (incoming ? CLASS_INDICATOR_INCOMING : CLASS_INDICATOR_OUTGOING)).attr('d', roundRect(incoming ? -7 : this.visData.global.column.contentWidth, this.visData.global.row.height / 2 - 1, 7, 2, {\n        topLeft: incoming ? 1 : 0,\n        topRight: incoming ? 0 : 1,\n        bottomLeft: incoming ? 1 : 0,\n        bottomRight: incoming ? 0 : 1\n      })).attr('fill', function (data) {\n        return linkDensityBg(data.links[direction].refs.length);\n      }).classed('visible', function (data) {\n        return data.links[direction].refs.length > 0;\n      });\n    }\n\n    function drawLinkLocationIndicator(selection, direction, position) {\n      var above = position === 'above';\n      var incoming = direction === 'incoming';\n\n      var className = CLASS_INDICATOR_LOCATION + ' ' + (incoming ? CLASS_INDICATOR_INCOMING : CLASS_INDICATOR_OUTGOING) + ' ' + (above ? CLASS_INDICATOR_ABOVE : CLASS_INDICATOR_BELOW);\n\n      selection.datum(function (data) {\n        return data.links[direction];\n      }).attr('class', className).attr('x', incoming ? -5 : this.visData.global.column.contentWidth + 2).attr('y', above ? this.visData.global.row.height / 2 - 1 : this.visData.global.row.height / 2 + 1).attr('width', 3).attr('height', 3).attr('fill', function (data) {\n        return linkDensityBg(data.refs.length);\n      });\n    }\n\n    // Helper\n    function drawFullSizeRect(selection, className, shrinking, noRoundBorder) {\n      var shrinkingAmount = shrinking || 0;\n\n      selection.attr('x', shrinkingAmount).attr('y', that.visData.global.row.padding + shrinkingAmount).attr('width', that.visData.global.column.contentWidth - 2 * shrinkingAmount).attr('height', that.visData.global.row.contentHeight - 2 * shrinkingAmount).attr('rx', noRoundBorder ? 0 : 2 - shrinkingAmount).attr('ry', noRoundBorder ? 0 : 2 - shrinkingAmount).classed(className, true);\n    }\n\n    function drawMaxSizedRect(selection) {\n      selection.attr('x', 0).attr('y', 0).attr('width', that.visData.global.column.contentWidth).attr('height', that.visData.global.row.height).attr('class', 'invisible-container');\n    }\n\n    this.groups = baseSelection.append('g').attr('class', CLASS_NODES).call(function (selection) {\n      selection.each(function storeLinkToGroupNode() {\n        d3.select(this.parentNode).datum().nodes = this;\n      });\n    });\n\n    this.nodes = this.groups.selectAll('.' + CLASS_NODE).data(function (data) {\n      return data.rows;\n    }).enter().append('g').classed(CLASS_NODE, true).classed(CLASS_CLONE, function (data) {\n      return data.clone;\n    }).attr('transform', function (data) {\n      return 'translate(' + (data.x + _this.visData.global.column.padding) + ', ' + data.y + ')';\n    });\n\n    this.nodes.append('rect').call(drawMaxSizedRect);\n\n    this.visNodes = this.nodes.append('g').attr('class', CLASS_NODE_VISIBLE);\n\n    this.visNodes.append('rect').call(drawFullSizeRect, 'bg-border');\n\n    this.visNodes.append('rect').call(drawFullSizeRect, 'bg', 1, true);\n\n    if (this.vis.showLinkLocation) {\n      this.nodes.append('rect').call(drawLinkLocationIndicator.bind(this), 'incoming', 'above');\n      this.nodes.append('rect').call(drawLinkLocationIndicator.bind(this), 'incoming', 'bottom');\n      this.nodes.append('rect').call(drawLinkLocationIndicator.bind(this), 'outgoing', 'above');\n      this.nodes.append('rect').call(drawLinkLocationIndicator.bind(this), 'outgoing', 'bottom');\n\n      this.nodes.append('path').call(drawLinkIndicator.bind(this), 'incoming');\n      this.nodes.append('path').call(drawLinkIndicator.bind(this), 'outgoing');\n\n      // Set all the link location indicator bars.\n      this.groups.each(function (data, index) {\n        _this.calcHeightLinkLocationIndicator(index, true, true);\n      });\n    }\n\n    // Rooting icons\n    var nodeRooted = this.nodes.append('g').attr('class', CLASS_FOCUS_CONTROLS + ' ' + CLASS_ROOT + ' ' + CLASS_INACTIVE);\n\n    nodeRooted.append('rect').call(this.setUpFocusControls.bind(this), 'left', 0.6, 'hover-helper', 'hover-helper');\n\n    nodeRooted.append('svg').call(this.setUpFocusControls.bind(this), 'left', 0.6, 'icon', 'ease-all state-inactive invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#unlocked');\n\n    nodeRooted.append('svg').call(this.setUpFocusControls.bind(this), 'left', 0.6, 'icon', 'ease-all state-active invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#locked');\n\n    // Querying icons\n    if (this.vis.querying) {\n      var nodeQuery = this.nodes.append('g').attr('class', CLASS_FOCUS_CONTROLS + ' ' + CLASS_QUERY + ' ' + CLASS_INACTIVE);\n\n      nodeQuery.append('rect').call(this.setUpFocusControls.bind(this), 'right', 0.6, 'hover-helper', 'hover-helper');\n\n      nodeQuery.append('svg').call(this.setUpFocusControls.bind(this), 'right', 0.6, 'icon', 'ease-all state-and-or invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#union');\n\n      nodeQuery.append('svg').call(this.setUpFocusControls.bind(this), 'right', 0.6, 'icon', 'ease-all state-not invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#not');\n    }\n\n    this.bars = new Bars(this.vis, this.visNodes, this.vis.barMode, this.visData);\n\n    this.visNodes.append('rect').call(drawFullSizeRect, 'border');\n\n    // Add node label\n    this.visNodes.append('foreignObject').attr('x', this.visData.global.cell.padding).attr('y', this.visData.global.row.padding + this.visData.global.cell.padding).attr('width', this.visData.global.column.contentWidth).attr('height', this.visData.global.row.contentHeight - this.visData.global.cell.padding * 2).attr('class', CLASS_LABEL_WRAPPER).append('xhtml:div').attr('class', 'label').attr('title', function (data) {\n      return data.data.name;\n    }).style('line-height', this.visData.global.row.contentHeight - this.visData.global.cell.padding * 2 + 'px').append('xhtml:span').text(function (data) {\n      return data.data.name;\n    });\n\n    if (isFunction(this.events.on)) {\n      this.events.on('d3ListGraphFocusNodes', function (event) {\n        return _this.focusNodes(event);\n      });\n\n      this.events.on('d3ListGraphBlurNodes', function (event) {\n        return _this.blurNodes(event);\n      });\n\n      this.events.on('d3ListGraphNodeEnter', function (nodeIds) {\n        return _this.eventHelper(nodeIds, _this.highlightNodes);\n      });\n\n      this.events.on('d3ListGraphNodeLeave', function (nodeIds) {\n        return _this.eventHelper(nodeIds, _this.unhighlightNodes);\n      });\n\n      this.events.on('d3ListGraphNodeLock', function (nodeIds) {\n        return _this.eventHelper(nodeIds, _this.toggleLock, []);\n      });\n\n      this.events.on('d3ListGraphNodeUnlock', function (nodeIds) {\n        return _this.eventHelper(nodeIds, _this.toggleLock, [true]);\n      });\n\n      this.events.on('d3ListGraphNodeRoot', function (data) {\n        return _this.eventHelper(data.nodeIds, _this.toggleRoot, [false, true]);\n      });\n\n      this.events.on('d3ListGraphNodeUnroot', function (data) {\n        return _this.eventHelper(data.nodeIds, _this.toggleRoot, [true, true]);\n      });\n    }\n\n    this.nodes.call(this.isInvisible.bind(this));\n  }\n\n  createClass(Nodes, [{\n    key: 'updateLinkLocationIndicators',\n    value: function updateLinkLocationIndicators(left, right) {\n      this.calcHeightLinkLocationIndicator(left, false, true);\n      this.calcHeightLinkLocationIndicator(right, true, false);\n    }\n  }, {\n    key: 'calcHeightLinkLocationIndicator',\n    value: function calcHeightLinkLocationIndicator(level, incoming, outgoing) {\n      var nodes = this.nodes.filter(function (data) {\n        return data.depth === level;\n      });\n      nodes.each(function (data) {\n        if (incoming) {\n          data.links.incoming.above = 0;\n          data.links.incoming.below = 0;\n          for (var i = data.links.incoming.total; i--;) {\n            // We are checking the source location of the incoming link. The\n            // source location is the location of the node of the column being\n            // scrolled.\n            if ((data.links.incoming.refs[i].hidden & 1) > 0) {\n              data.links.incoming.above++;\n            }\n            if ((data.links.incoming.refs[i].hidden & 2) > 0) {\n              data.links.incoming.below++;\n            }\n          }\n        }\n        if (outgoing) {\n          data.links.outgoing.above = 0;\n          data.links.outgoing.below = 0;\n          for (var _i = data.links.outgoing.total; _i--;) {\n            // We are checking the target location of the outgoing link. The\n            // source location is the location of the node of the column being\n            // scrolled.\n            if ((data.links.outgoing.refs[_i].hidden & 4) > 0) {\n              data.links.outgoing.above++;\n            }\n            if ((data.links.outgoing.refs[_i].hidden & 8) > 0) {\n              data.links.outgoing.below++;\n            }\n          }\n        }\n      });\n\n      if (incoming) {\n        this.updateHeightLinkLocationIndicatorBars(nodes);\n      }\n\n      if (outgoing) {\n        this.updateHeightLinkLocationIndicatorBars(nodes, true);\n      }\n    }\n  }, {\n    key: 'updateHeightLinkLocationIndicatorBars',\n    value: function updateHeightLinkLocationIndicatorBars(selection, outgoing) {\n      var barRefHeight = this.visData.global.row.contentHeight / 2 - 1;\n      var barAboveRefTop = this.visData.global.row.height / 2 - 1;\n\n      var baseClassName = '.' + CLASS_INDICATOR_LOCATION + '.' + (outgoing ? CLASS_INDICATOR_OUTGOING : CLASS_INDICATOR_INCOMING);\n\n      selection.selectAll(baseClassName + '.' + CLASS_INDICATOR_ABOVE).attr('y', function (data) {\n        return data.total ? barAboveRefTop - data.above / data.total * barRefHeight : barAboveRefTop;\n      }).attr('height', function (data) {\n        return data.total ? data.above / data.total * barRefHeight : 0;\n      });\n\n      selection.selectAll(baseClassName + '.' + CLASS_INDICATOR_BELOW).attr('height', function (data) {\n        return data.total ? data.below / data.total * barRefHeight : 0;\n      });\n    }\n  }, {\n    key: 'enterHandler',\n    value: function enterHandler(el, data) {\n      this.highlightNodes(d3.select(el));\n\n      var eventData = {\n        id: data.id,\n        clone: false,\n        clonedFromId: undefined\n      };\n\n      if (data.clone) {\n        eventData.clone = true;\n        eventData.clonedFromId = data.originalNode.id;\n      }\n\n      this.events.broadcast('d3ListGraphNodeEnter', eventData);\n    }\n  }, {\n    key: 'leaveHandler',\n    value: function leaveHandler(el, data) {\n      this.unhighlightNodes(d3.select(el));\n\n      var eventData = {\n        id: data.id,\n        clone: false,\n        clonedFromId: undefined\n      };\n\n      if (data.clone) {\n        eventData.clone = true;\n        eventData.clonedFromId = data.originalNode.id;\n      }\n\n      this.events.broadcast('d3ListGraphNodeLeave', eventData);\n    }\n  }, {\n    key: 'lockHandler',\n    value: function lockHandler(d3El) {\n      var events = this.toggleLock(d3El);\n\n      if (events.locked && events.unlocked) {\n        this.events.broadcast('d3ListGraphNodeLockChange', {\n          lock: {\n            id: events.locked.id,\n            clone: events.locked.clone,\n            clonedFromId: events.locked.clone ? events.locked.originalNode.id : undefined\n          },\n          unlock: {\n            id: events.unlocked.id,\n            clone: events.unlocked.clone,\n            clonedFromId: events.unlocked.clone ? events.unlocked.originalNode.id : undefined\n          }\n        });\n      } else {\n        if (events.locked) {\n          this.events.broadcast('d3ListGraphNodeLock', {\n            id: events.locked.id,\n            clone: events.locked.clone,\n            clonedFromId: events.locked.clone ? events.locked.originalNode.id : undefined\n          });\n        }\n\n        if (events.unlocked) {\n          this.events.broadcast('d3ListGraphNodeUnlock', {\n            id: events.unlocked.id,\n            clone: events.unlocked.clone,\n            clonedFromId: events.unlocked.clone ? events.unlocked.originalNode.id : undefined\n          });\n        }\n      }\n    }\n  }, {\n    key: 'rootHandler',\n    value: function rootHandler(d3El, unroot) {\n      if (!d3El.datum().data.state.root && unroot) {\n        // The node is not rooted so there's no point in unrooting.\n        return;\n      }\n      var events = this.toggleRoot(d3El, unroot);\n\n      if (events.rooted && events.unrooted) {\n        this.events.broadcast('d3ListGraphNodeReroot', {\n          rooted: {\n            id: events.rooted.id,\n            clone: events.rooted.clone,\n            clonedFromId: events.rooted.clone ? events.rooted.originalNode.id : undefined\n          },\n          unrooted: {\n            id: events.unrooted.id,\n            clone: events.unrooted.clone,\n            clonedFromId: events.unrooted.clone ? events.unrooted.originalNode.id : undefined\n          }\n        });\n      } else {\n        if (events.rooted) {\n          this.events.broadcast('d3ListGraphNodeRoot', {\n            id: events.rooted.id,\n            clone: events.rooted.clone,\n            clonedFromId: events.rooted.clone ? events.rooted.originalNode.id : undefined\n          });\n        }\n\n        if (events.unrooted) {\n          this.events.broadcast('d3ListGraphNodeUnroot', {\n            id: events.unrooted.id,\n            clone: events.unrooted.clone,\n            clonedFromId: events.unrooted.clone ? events.unrooted.originalNode.id : undefined\n          });\n        }\n      }\n    }\n  }, {\n    key: 'focusNodes',\n    value: function focusNodes(event) {\n      var same = this.checkNodeFocusEventSame(event.nodeIds);\n      if (this.nodeFocusId && !same) {\n        // Show unrelated nodes first before we hide them again.\n        this.blurNodes({\n          nodeIds: this.nodeFocusId\n        });\n      }\n\n      this.nodeFocusId = event.nodeIds;\n\n      this.eventHelper(event.nodeIds, this.highlightNodes, ['focus', 'directParentsOnly', !!event.excludeClones, event.zoomOut || event.hideUnrelatedNodes]);\n\n      if (event.zoomOut) {\n        this.vis.globalView(this.nodes.filter(function (data) {\n          return data.hovering > 0;\n        }));\n      } else {\n        this.vis.zoomedView();\n      }\n\n      if (event.hideUnrelatedNodes) {\n        if (!same || !this.tempHidingUnrelatedNodes) {\n          this.hideUnrelatedNodes(event.nodeIds);\n        }\n      } else if (this.tempHidingUnrelatedNodes) {\n        this.showUnrelatedNodes();\n      }\n    }\n  }, {\n    key: 'blurNodes',\n    value: function blurNodes(event) {\n      this.eventHelper(event.nodeIds, this.unhighlightNodes, ['focus', 'directParentsOnly', !!event.excludeClones]);\n\n      if (event.zoomIn) {\n        this.vis.zoomedView();\n      }\n\n      if (this.tempHidingUnrelatedNodes) {\n        this.showUnrelatedNodes();\n      }\n    }\n  }, {\n    key: 'checkNodeFocusEventSame',\n    value: function checkNodeFocusEventSame(nodeIds) {\n      if (!this.nodeFocusId) {\n        return false;\n      }\n      if (nodeIds.length !== this.nodeFocusId.length) {\n        return false;\n      }\n      for (var i = nodeIds.length; i--;) {\n        if (nodeIds[i] !== this.nodeFocusId[i]) {\n          return false;\n        }\n      }\n      return true;\n    }\n  }, {\n    key: 'hideUnrelatedNodes',\n    value: function hideUnrelatedNodes(nodeIds) {\n      this.tempHidingUnrelatedNodes = nodeIds;\n\n      this.nodes.filter(function (data) {\n        return !data.hovering;\n      }).classed('hidden', true).each(function (data) {\n        // Store old value for `hidden` temporarily\n        data._hidden = data.hidden;\n        data.hidden = true;\n      });\n\n      this.updateVisibility();\n    }\n  }, {\n    key: 'showUnrelatedNodes',\n    value: function showUnrelatedNodes() {\n      this.tempHidingUnrelatedNodes = undefined;\n\n      this.nodes.filter(function (data) {\n        return !data.hovering;\n      }).classed('hidden', function (data) {\n        return data._hidden;\n      }).each(function (data) {\n        data.hidden = data._hidden;\n        data._hidden = undefined;\n      });\n\n      this.updateVisibility();\n    }\n  }, {\n    key: 'eventHelper',\n    value: function eventHelper(nodeIds, callback, optionalParams, subSelectionClass) {\n      var that = this;\n\n      this.nodes\n      // Filter by node ID\n      .filter(function (data) {\n        return !!~nodeIds.indexOf(data.id);\n      }).each(function triggerCallback() {\n        var d3El = d3.select(this);\n\n        if (subSelectionClass) {\n          d3El = d3El.select(subSelectionClass);\n        }\n\n        callback.apply(that, [d3El].concat(optionalParams || []));\n      });\n    }\n  }, {\n    key: 'toggleLock',\n    value: function toggleLock(d3El, setFalse) {\n      var data = d3El.datum();\n      var events = { locked: false, unlocked: false };\n\n      if (this.lockedNode) {\n        if (this.lockedNode.datum().id === data.id) {\n          this.unlockNode(this.lockedNode.datum().id);\n          events.unlocked = this.lockedNode.datum();\n          this.lockedNode = undefined;\n        } else {\n          // Reset previously locked node;\n          this.unlockNode(this.lockedNode.datum().id);\n          events.unlocked = this.lockedNode.datum();\n\n          if (!setFalse) {\n            this.lockNode(data.id);\n            events.locked = data;\n            this.lockedNode = d3El;\n          }\n        }\n      } else {\n        if (!setFalse) {\n          this.lockNode(data.id);\n          events.locked = data;\n          this.lockedNode = d3El;\n        }\n      }\n\n      return events;\n    }\n  }, {\n    key: 'lockNode',\n    value: function lockNode(id) {\n      var that = this;\n      var els = this.nodes.filter(function (data) {\n        return data.id === id;\n      });\n\n      els.each(function (data) {\n        that.highlightNodes(d3.select(this), 'lock', undefined);\n        data.data.state.lock = true;\n      });\n    }\n  }, {\n    key: 'unlockNode',\n    value: function unlockNode(id) {\n      var that = this;\n      var els = this.nodes.filter(function (data) {\n        return data.id === id;\n      });\n\n      els.each(function (data) {\n        that.unhighlightNodes(d3.select(this), 'lock', undefined);\n        data.data.state.lock = undefined;\n      });\n    }\n  }, {\n    key: 'queryByNode',\n    value: function queryByNode(d3El, mode) {\n      d3El.datum().data.state.query = mode;\n      d3El.classed({\n        active: true,\n        inactive: false,\n        'query-and': mode === 'and',\n        'query-or': mode === 'or',\n        'query-not': mode === 'not'\n      });\n    }\n  }, {\n    key: 'unqueryByNode',\n    value: function unqueryByNode(d3El) {\n      var data = d3El.datum();\n\n      data.data.state.query = undefined;\n      data.data.queryBeforeRooting = undefined;\n\n      d3El.classed({\n        active: false,\n        inactive: true,\n        'query-and': false,\n        'query-or': false,\n        'query-not': false\n      });\n\n      if (this.rootedNode) {\n        this.updateVisibility();\n      }\n    }\n  }, {\n    key: 'toggleQueryByNode',\n    value: function toggleQueryByNode(d3El) {\n      var data = d3El.datum();\n      var previousMode = data.data.state.query;\n\n      if (data.data.state.root) {\n        if (previousMode !== 'or') {\n          this.queryByNode(d3El, 'or');\n        } else {\n          this.queryByNode(d3El, 'and');\n        }\n      } else {\n        switch (previousMode) {\n          case 'or':\n            this.queryByNode(d3El, 'and');\n            break;\n          case 'and':\n            this.queryByNode(d3El, 'not');\n            break;\n          case 'not':\n            this.unqueryByNode(d3El);\n            break;\n          default:\n            this.queryByNode(d3El, 'or');\n            break;\n        }\n      }\n    }\n  }, {\n    key: 'batchQueryHandler',\n    value: function batchQueryHandler(els, noNotification) {\n      var actions = [];\n      for (var i = els.length; i--;) {\n        actions.push(this.queryHandler(els[i].d3El, els[i].action, els[i].mode, true));\n      }\n\n      if (!noNotification) {\n        this.events.broadcast('d3ListGraphBatchQuery', actions);\n      }\n    }\n  }, {\n    key: 'queryHandler',\n    value: function queryHandler(d3El, action, mode, returnNoNotification) {\n      var data = d3El.datum();\n      var previousMode = data.data.state.query;\n      var event = {};\n\n      if (!previousMode && action === 'unquery') {\n        // We haven't queried anything so there's nothing to unquery.\n        return undefined;\n      }\n\n      switch (action) {\n        case 'query':\n          this.queryByNode(d3El, mode);\n          break;\n        case 'unquery':\n          this.unqueryByNode(d3El);\n          break;\n        default:\n          this.toggleQueryByNode(d3El);\n          break;\n      }\n\n      if (data.data.state.query) {\n        if (data.data.state.query !== previousMode) {\n          event.name = 'd3ListGraphNodeQuery';\n          event.data = {\n            id: data.id,\n            clone: data.clone,\n            clonedFromId: data.clone ? data.originalNode.id : undefined,\n            mode: data.data.state.query\n          };\n        }\n      } else {\n        event.name = 'd3ListGraphNodeUnquery';\n        event.data = {\n          id: data.id,\n          clone: data.clone,\n          clonedFromId: data.clone ? data.originalNode.id : undefined\n        };\n      }\n\n      if (event.name && !returnNoNotification) {\n        this.events.broadcast(event.name, event.data);\n      }\n\n      return event.name ? event : undefined;\n    }\n  }, {\n    key: 'toggleRoot',\n    value: function toggleRoot(d3El, setFalse, noNotification) {\n      var data = d3El.datum();\n      var events = { rooted: false, unrooted: false };\n      var queries = [];\n\n      // Blur current levels\n      this.vis.levels.blur();\n\n      if (this.rootedNode) {\n        // Reset current root node\n        this.rootedNode.classed({ active: false, inactive: true });\n        events.unrooted = this.rootedNode.datum();\n        if (this.unrootNode(this.rootedNode).unquery) {\n          queries.push({\n            d3El: this.rootedNode,\n            action: 'unquery'\n          });\n        }\n\n        // Activate new root\n        if (this.rootedNode.datum().id !== data.id && !setFalse) {\n          d3El.classed({ active: true, inactive: false });\n          this.rootedNode = d3El;\n          events.rooted = d3El.datum();\n          if (this.rootNode(d3El).query) {\n            queries.push({\n              d3El: d3El,\n              action: 'query',\n              mode: 'or'\n            });\n          }\n        } else {\n          this.rootedNode = undefined;\n          // Highlight first level\n          this.vis.levels.focus(this.vis.activeLevel - this.vis.noRootActiveLevelDiff);\n        }\n      } else {\n        if (!setFalse) {\n          d3El.classed({ active: true, inactive: false });\n          this.rootedNode = d3El;\n          events.rooted = d3El.datum();\n          if (this.rootNode(d3El).query) {\n            queries.push({\n              d3El: d3El,\n              action: 'query',\n              mode: 'or'\n            });\n          }\n        }\n      }\n\n      if (queries.length) {\n        this.batchQueryHandler(queries, noNotification);\n      }\n\n      return events;\n    }\n  }, {\n    key: 'rootNode',\n    value: function rootNode(d3El) {\n      var data = d3El.datum();\n\n      data.data.state.root = true;\n      d3El.classed('rooted', true);\n      this.hideNodes(data);\n\n      // Highlight level\n      this.vis.levels.focus(data.depth + this.vis.activeLevel);\n\n      if (!data.data.state.query || data.data.state.query === 'not') {\n        data.data.queryBeforeRooting = false;\n        // this.queryHandler(d3El, 'query', 'or');\n        return {\n          query: true\n        };\n      }\n\n      data.data.queryBeforeRooting = true;\n\n      return {\n        query: false\n      };\n    }\n  }, {\n    key: 'unrootNode',\n    value: function unrootNode(d3El) {\n      var data = d3El.datum();\n\n      data.data.state.root = false;\n      d3El.classed('rooted', false);\n      this.showNodes();\n\n      if (!data.data.queryBeforeRooting) {\n        // this.queryHandler(d3El, 'unquery');\n        return {\n          unquery: true\n        };\n      }\n\n      return {\n        unquery: false\n      };\n    }\n  }, {\n    key: 'setUpFocusControls',\n    value: function setUpFocusControls(selection, location, position, mode, className) {\n      var paddedDim = this.iconDimension + 4;\n\n      var x = 0 - paddedDim * (position + 1);\n\n      if (location === 'right') {\n        x = this.visData.global.column.contentWidth + 2 + paddedDim * position;\n      }\n\n      var y = this.visData.global.row.padding + (this.visData.global.row.contentHeight - 2 * this.visData.global.cell.padding) / 4;\n\n      if (mode === 'bg') {\n        selection.attr('class', className).attr('cx', x + this.iconDimension / 2).attr('cy', y + this.iconDimension / 2).attr('r', this.iconDimension * 3 / 4);\n      } else if (mode === 'hover-helper') {\n        selection.attr('class', className).attr('x', x - 4).attr('y', y - 4).attr('width', this.iconDimension + 8).attr('height', this.iconDimension + 8).attr('rx', this.iconDimension).attr('ry', this.iconDimension);\n      } else {\n        selection.attr('class', className).attr('x', x).attr('y', y).attr('width', this.iconDimension).attr('height', this.iconDimension);\n      }\n    }\n\n    /**\n     * Helper method to hide nodes.\n     *\n     * @method  hideNodes\n     * @author  Fritz Lekschas\n     * @date    2016-02-21\n     * @param   {Object}   data        Node data object.\n     */\n\n  }, {\n    key: 'hideNodes',\n    value: function hideNodes(data) {\n      this.nodesVisibility(data);\n    }\n\n    /**\n     * Helper method to show nodes.\n     *\n     * @method  showNodes\n     * @author  Fritz Lekschas\n     * @date    2016-02-21\n     * @param   {Object}  data       Node data object.\n     */\n\n  }, {\n    key: 'showNodes',\n    value: function showNodes() {\n      this.nodesVisibility(undefined, true);\n    }\n\n    /**\n     * Sets the nodes' visibility\n     *\n     * @method  nodesVisibility\n     * @author  Fritz Lekschas\n     * @date    2016-02-21\n     * @param   {Object}   data        Node data object.\n     * @param   {Boolean}  show        If `true` nodes will be shown.\n     */\n\n  }, {\n    key: 'nodesVisibility',\n    value: function nodesVisibility(data, show) {\n      if (show) {\n        this.nodes.classed('hidden', false).each(function (nodeData) {\n          nodeData.hidden = false;\n        });\n      } else {\n        // First we set all nodes to `hidden`.\n        this.nodes.each(function (nodeData) {\n          nodeData.hidden = true;\n        });\n\n        // Then we set direct child and parent nodes of the current node visible.\n        upAndDown(data, function (nodeData) {\n          nodeData.hidden = false;\n        });\n\n        // We also show sibling nodes.\n        siblings(data, function (nodeData) {\n          nodeData.hidden = false;\n        });\n\n        this.nodes.classed('hidden', function (nodeData) {\n          return nodeData.hidden && !nodeData.data.state.query;\n        });\n      }\n      this.updateVisibility();\n    }\n  }, {\n    key: 'isInvisible',\n    value: function isInvisible(selection, customScrollTop) {\n      var _this2 = this;\n\n      selection.classed('invisible', function (data) {\n        var scrollTop = customScrollTop || _this2.visData.nodes[data.depth].scrollTop;\n\n        // Node is right to the visible container\n        if (data.x + _this2.vis.dragged.x >= _this2.vis.width) {\n          return data.invisible = true;\n        }\n        // Node is below the visible container\n        if (data.y + scrollTop >= _this2.vis.height) {\n          return data.invisible = true;\n        }\n        // Node is above the visible container\n        if (data.y + _this2.visData.global.row.height + scrollTop <= 0) {\n          return data.invisible = true;\n        }\n        // Node is left to the visible container\n        if (data.x + _this2.vis.dragged.x + _this2.visData.global.column.width <= 0) {\n          return data.invisible = true;\n        }\n        return data.invisible = false;\n      });\n    }\n  }, {\n    key: 'makeAllTempVisible',\n    value: function makeAllTempVisible(unset) {\n      if (unset) {\n        this.nodes.classed('invisible', function (data) {\n          var prevInvisible = data._invisible;\n          data._invisible = undefined;\n\n          return prevInvisible;\n        });\n      } else {\n        this.nodes.classed('invisible', function (data) {\n          data._invisible = data.invisible;\n          return false;\n        });\n      }\n    }\n  }, {\n    key: 'highlightNodes',\n    value: function highlightNodes(d3El, className, restriction, excludeClones, noVisibilityCheck) {\n      var _this3 = this;\n\n      var that = this;\n      var data = d3El.datum();\n      var nodeId = data.id;\n      var currentNodeData = data.clone ? data.originalNode : data;\n      var includeParents = true;\n      var appliedClassName = className || 'hovering';\n      var includeClones = !excludeClones;\n      var includeChildren = restriction !== 'directParentsOnly';\n\n      // Store link IDs\n      if (!this.currentLinks[appliedClassName]) {\n        this.currentLinks[appliedClassName] = {};\n      }\n      this.currentLinks[appliedClassName][nodeId] = {};\n\n      var currentlyActiveBar = d3El.selectAll('.bar.active .bar-magnitude');\n      if (!currentlyActiveBar.empty()) {\n        currentlyActiveBar = currentlyActiveBar.datum();\n      } else {\n        currentlyActiveBar = undefined;\n      }\n\n      var traverseCallbackUp = function traverseCallbackUp(nodeData, childData) {\n        nodeData.hovering = 2;\n        for (var i = nodeData.links.outgoing.refs.length; i--;) {\n          // Only push direct parent child connections. E.g.\n          // Store: (parent)->(child)\n          // Ignore: (parent)->(siblings of child)\n          if (nodeData.links.outgoing.refs[i].target.node.id === childData.id) {\n            _this3.currentLinks[appliedClassName][nodeId][nodeData.links.outgoing.refs[i].id] = true;\n          }\n        }\n      };\n\n      var traverseCallbackDown = function traverseCallbackDown(nodeData) {\n        nodeData.hovering = 2;\n        for (var i = nodeData.links.outgoing.refs.length; i--;) {\n          _this3.currentLinks[appliedClassName][nodeId][nodeData.links.outgoing.refs[i].id] = true;\n        }\n      };\n\n      if (includeParents && includeChildren) {\n        upAndDown(data.clone ? data.originalNode : data, traverseCallbackUp, traverseCallbackDown, undefined, includeClones);\n      }\n      if (includeParents && !includeChildren) {\n        up(data, traverseCallbackUp, undefined, includeClones);\n      }\n      if (!includeParents && includeChildren) {\n        down(data.clone ? data.originalNode : data, traverseCallbackUp, undefined, includeClones);\n      }\n\n      currentNodeData.hovering = 1;\n\n      if (includeClones) {\n        for (var i = currentNodeData.clones.length; i--;) {\n          currentNodeData.clones[i].hovering = 1;\n        }\n      }\n\n      /**\n       * Helper method to assess the node visibility.\n       *\n       * @method  checkNodeVisibility\n       * @author  Fritz Lekschas\n       * @date    2016-02-25\n       * @param   {Object}  _el    [description]\n       * @param   {Object}  _data  [description]\n       * @return  {Boolean}        If `true` element is hidden.\n       */\n      function checkNodeVisibility(_el, _data) {\n        return noVisibilityCheck || !_data.hidden && !that.vis.isHidden.call(that.vis, _el);\n      }\n\n      /**\n       * Helper method to filter out directly hovered nodes.\n       *\n       * @method  checkNodeDirect\n       * @author  Fritz Lekschas\n       * @date    2016-02-25\n       * @param   {Object}  nodeData  The node's data object.\n       * @return  {Boolean}           If `true` element will not be filtered out.\n       */\n      function checkNodeDirect(nodeData) {\n        return nodeData.hovering === 1 && checkNodeVisibility(this, nodeData);\n      }\n\n      /**\n       * Helper method to filter out indirectly hovered nodes.\n       *\n       * @method  checkNodeIndirect\n       * @author  Fritz Lekschas\n       * @date    2016-02-25\n       * @param   {Object}  nodeData  The node's data object.\n       * @return  {Boolean}           If `true` element will not be filtered out.\n       */\n      function checkNodeIndirect(nodeData) {\n        return nodeData.hovering === 2 && checkNodeVisibility(this, nodeData);\n      }\n\n      /**\n       * Helper method to update bar indicators of the directly hovered node and\n       * clones.\n       *\n       * @method  updateDirectBarIndicator\n       * @author  Fritz Lekschas\n       * @date    2016-02-25\n       * @param   {Object}  selection  D3 node selection.\n       */\n      function updateDirectBarIndicator(selection) {\n        that.bars.updateIndicator(selection, currentlyActiveBar.value, true);\n      }\n\n      /**\n       * Helper method to update bar indicators of the indirectly hovered nodes.\n       *\n       * @method  updateDirectBarIndicator\n       * @author  Fritz Lekschas\n       * @date    2016-02-25\n       * @param   {Object}  selection  D3 node selection.\n       */\n      function updateIndirectBarIndicator(selection) {\n        that.bars.updateIndicator(selection, currentlyActiveBar.value);\n      }\n\n      var barIndicatorClass = currentlyActiveBar ? '.bar.' + currentlyActiveBar.id + ' .bar-indicator' : '';\n      var directNodes = this.nodes.filter(checkNodeDirect).classed(appliedClassName + '-directly', true);\n      var indirectNodes = this.nodes.filter(checkNodeIndirect).classed(appliedClassName + '-indirectly', true);\n\n      if (currentlyActiveBar) {\n        directNodes.select(barIndicatorClass).call(updateDirectBarIndicator);\n        indirectNodes.select(barIndicatorClass).call(updateIndirectBarIndicator);\n      }\n\n      this.links.highlight(this.currentLinks[appliedClassName][data.id], true, appliedClassName);\n    }\n  }, {\n    key: 'unhighlightNodes',\n    value: function unhighlightNodes(d3El, className, restriction, excludeClones) {\n      var data = d3El.datum();\n      var traverseCallback = function traverseCallback(nodeData) {\n        nodeData.hovering = 0;\n      };\n      var includeParents = true;\n      var appliedClassName = className || 'hovering';\n      var includeClones = !excludeClones;\n      var includeChildren = restriction !== 'directParentsOnly';\n\n      data.hovering = 0;\n      if (includeParents && includeChildren) {\n        upAndDown(data, traverseCallback, undefined, undefined, includeClones);\n      }\n      if (includeParents && !includeChildren) {\n        up(data, traverseCallback, undefined, includeClones);\n      }\n      if (!includeParents && includeChildren) {\n        down(data, traverseCallback, undefined, includeClones);\n      }\n\n      if (data.clone) {\n        data.originalNode.hovering = 0;\n      } else {\n        if (includeClones) {\n          for (var i = data.clones.length; i--;) {\n            data.clones[i].hovering = 0;\n          }\n        }\n      }\n\n      this.nodes.classed(appliedClassName + '-directly', false);\n      this.nodes.classed(appliedClassName + '-indirectly', false);\n\n      if (this.currentLinks[appliedClassName] && this.currentLinks[appliedClassName][data.id]) {\n        this.links.highlight(this.currentLinks[appliedClassName][data.id], false, appliedClassName);\n      }\n    }\n  }, {\n    key: 'sort',\n    value: function sort(update, newSortType) {\n      var _this4 = this;\n\n      for (var i = update.length; i--;) {\n        var selection = this.nodes.data(update[i].rows, function (data) {\n          return data.id;\n        });\n\n        this.vis.svgD3.classed('sorting', true);\n        selection.transition().duration(TRANSITION_SEMI_FAST).attr('transform', function (data) {\n          return 'translate(' + (data.x + _this4.visData.global.column.padding) + ', ' + data.y + ')';\n        }).call(allTransitionsEnded, function () {\n          _this4.vis.svgD3.classed('sorting', false);\n          _this4.vis.updateLevelsVisibility();\n          _this4.vis.updateScrolling();\n        });\n\n        if (newSortType && this.vis.currentSorting.local[update[i].level].type !== 'name') {\n          this.bars.update(selection.selectAll('.bar'), update[i].sortBy);\n        }\n      }\n    }\n\n    /**\n     * Updates the nodes' visibility visually.\n     *\n     * @method  updateVisibility\n     * @author  Fritz Lekschas\n     * @date    2016-02-21\n     */\n\n  }, {\n    key: 'updateVisibility',\n    value: function updateVisibility() {\n      var _this5 = this;\n\n      // Calls the D3 list graph layout method to update the nodes position.\n      this.vis.layout.updateNodesVisibility();\n\n      // Transition to the updated position\n      this.nodes.transition().duration(TRANSITION_SEMI_FAST).attr('transform', function (data) {\n        return 'translate(' + (data.x + _this5.visData.global.column.padding) + ', ' + data.y + ')';\n      }).call(allTransitionsEnded, function () {\n        _this5.vis.updateLevelsVisibility();\n        _this5.vis.updateScrolling();\n        _this5.nodes.call(_this5.isInvisible.bind(_this5));\n      });\n\n      this.vis.links.updateVisibility();\n    }\n  }, {\n    key: 'classNnodes',\n    get: function get() {\n      return CLASS_NODES;\n    }\n  }, {\n    key: 'classNode',\n    get: function get() {\n      return CLASS_NODE;\n    }\n  }, {\n    key: 'classNodeVisible',\n    get: function get() {\n      return CLASS_NODE_VISIBLE;\n    }\n  }, {\n    key: 'classClone',\n    get: function get() {\n      return CLASS_CLONE;\n    }\n  }, {\n    key: 'classLabelWrapper',\n    get: function get() {\n      return CLASS_LABEL_WRAPPER;\n    }\n  }, {\n    key: 'classFocusControls',\n    get: function get() {\n      return CLASS_FOCUS_CONTROLS;\n    }\n  }, {\n    key: 'classRoot',\n    get: function get() {\n      return CLASS_ROOT;\n    }\n  }, {\n    key: 'classQuery',\n    get: function get() {\n      return CLASS_QUERY;\n    }\n  }, {\n    key: 'classLock',\n    get: function get() {\n      return CLASS_LOCK;\n    }\n  }, {\n    key: 'barMode',\n    get: function get() {\n      return this.bars.mode;\n    }\n  }]);\n  return Nodes;\n}();\n\n// External\n// eslint-disable-line import/no-unresolved\n\n// Internal\nvar SCROLLBAR_CLASS = 'scrollbar';\n\nvar Scrollbars = function () {\n  function Scrollbars(baseSelection, visData, width) {\n    classCallCheck(this, Scrollbars);\n\n    this.visData = visData;\n    this.width = width;\n\n    // Add empty scrollbar element\n    this.all = baseSelection.append('rect').attr('class', SCROLLBAR_CLASS).call(function (selection) {\n      selection.each(function setScrollBarDomElement() {\n        d3.select(this.parentNode).datum().scrollbar.el = this;\n      });\n    }).attr('x', function (data) {\n      return data.scrollbar.x - 2;\n    }).attr('y', function (data) {\n      return data.scrollbar.y;\n    }).attr('width', this.width).attr('height', function (data) {\n      return data.scrollbar.height;\n    }).attr('rx', this.width / 2).attr('ry', this.width / 2).classed('ready', true);\n  }\n\n  createClass(Scrollbars, [{\n    key: 'updateVisibility',\n    value: function updateVisibility() {\n      this.all.transition().duration(TRANSITION_LIGHTNING_FAST).attr({\n        x: function x(data) {\n          return data.scrollbar.x;\n        },\n        height: function height(data) {\n          return data.scrollbar.height;\n        }\n      });\n    }\n  }]);\n  return Scrollbars;\n}();\n\n// External\n// Internal\nvar Events = function () {\n  function Events(el, broadcast) {\n    classCallCheck(this, Events);\n\n    if (broadcast && !isFunction(broadcast)) {\n      throw new EventDispatcherNoFunction();\n    }\n\n    this.el = el;\n    this._stack = {};\n    this.dispatch = broadcast || this._dispatchEvent;\n  }\n\n  createClass(Events, [{\n    key: '_dispatchEvent',\n    value: function _dispatchEvent(eventName, data) {\n      var event = document.createEvent('CustomEvent');\n      event.initCustomEvent(eventName, false, false, data);\n      this.el.dispatchEvent(event);\n    }\n  }, {\n    key: 'broadcast',\n    value: function broadcast(event, data) {\n      this.dispatch(event, data);\n    }\n\n    /**\n     * Add a callback function to an event stack.\n     *\n     * @method  on\n     * @author  Fritz Lekschas\n     * @date    2016-01-07\n     *\n     * @param   {String}    event     Event identifier.\n     * @param   {Function}  callback  Function which is called when the event\n     *   stack is triggered.\n     * @param   {Number}    times     Number of times the callback function should\n     *   be triggered before it is removed from the event stack. This is useful\n     *   when an event happens only a certain number of times.\n     * @return  {Number}              Index of callback, which is needed to\n     *   manually remove the callback from the event stack.\n     */\n\n  }, {\n    key: 'on',\n    value: function on(event, callback, times) {\n      if (!isFunction(callback)) {\n        return false;\n      }\n\n      var normTimes = isFinite(times) ? parseInt(times, 10) : Infinity;\n\n      if (isArray(this.stack[event])) {\n        return this.stack[event].push({ callback: callback, times: normTimes }) - 1;\n      }\n      this.stack[event] = [{ callback: callback, times: normTimes }];\n      return 0;\n    }\n\n    /**\n     * Removes a callback function from an event stack given its index.\n     *\n     * @method  off\n     * @author  Fritz Lekschas\n     * @date    2016-01-07\n     *\n     * @param   {String}   event  Event identifier.\n     * @param   {Number}   index  Index of the callback to be removed.\n     * @return  {Boolean}         Returns `true` if event callback was found and\n     *   successfully removed.\n     */\n\n  }, {\n    key: 'off',\n    value: function off(event, index) {\n      try {\n        this.stack[event].splice(index, 1);\n        return true;\n      } catch (e) {\n        return false;\n      }\n    }\n\n    /**\n     * Trigger an event stack\n     *\n     * @method  trigger\n     * @author  Fritz Lekschas\n     * @date    2016-01-07\n     *\n     * @param   {String}   event  Event identifier.\n     * @return  {Boolean}         Returns `true` if an event stack was found.\n     */\n\n  }, {\n    key: 'trigger',\n    value: function trigger(event, data) {\n      if (isArray(this.stack[event])) {\n        // Traversing from the end to the start, which has the advantage that\n        // deletion of events, i.e. calling `Event.off()` doesn't affect the index\n        // of event listeners in the next step.\n        for (var i = this.stack[event].length; i--;) {\n          // Instead of checking whether `stack[event][i]` is a function here,\n          // we do it just once when we add the function to the stack.\n          if (this.stack[event][i].times--) {\n            this.stack[event][i].callback(data);\n          } else {\n            this.off(event, i);\n          }\n        }\n        return true;\n      }\n      return false;\n    }\n  }, {\n    key: 'stack',\n    get: function get() {\n      return this._stack;\n    }\n  }]);\n  return Events;\n}();\n\nfunction objectOrFunction(x) {\n  return typeof x === 'function' || (typeof x === 'object' && x !== null);\n}\n\nfunction isFunction$1(x) {\n  return typeof x === 'function';\n}\n\nvar _isArray;\nif (!Array.isArray) {\n  _isArray = function (x) {\n    return Object.prototype.toString.call(x) === '[object Array]';\n  };\n} else {\n  _isArray = Array.isArray;\n}\n\nvar isArray$1 = _isArray;\n\nvar len = 0;\nvar vertxNext;\nvar customSchedulerFn;\n\nvar asap = function asap(callback, arg) {\n  queue[len] = callback;\n  queue[len + 1] = arg;\n  len += 2;\n  if (len === 2) {\n    // If len is 2, that means that we need to schedule an async flush.\n    // If additional callbacks are queued before the queue is flushed, they\n    // will be processed by this flush that we are scheduling.\n    if (customSchedulerFn) {\n      customSchedulerFn(flush);\n    } else {\n      scheduleFlush();\n    }\n  }\n}\n\nfunction setScheduler(scheduleFn) {\n  customSchedulerFn = scheduleFn;\n}\n\nfunction setAsap(asapFn) {\n  asap = asapFn;\n}\n\nvar browserWindow = (typeof window !== 'undefined') ? window : undefined;\nvar browserGlobal = browserWindow || {};\nvar BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;\nvar isNode = typeof self === 'undefined' && typeof process !== 'undefined' && {}.toString.call(process) === '[object process]';\n\n// test for web worker but not in IE10\nvar isWorker = typeof Uint8ClampedArray !== 'undefined' &&\n  typeof importScripts !== 'undefined' &&\n  typeof MessageChannel !== 'undefined';\n\n// node\nfunction useNextTick() {\n  // node version 0.10.x displays a deprecation warning when nextTick is used recursively\n  // see https://github.com/cujojs/when/issues/410 for details\n  return function() {\n    process.nextTick(flush);\n  };\n}\n\n// vertx\nfunction useVertxTimer() {\n  return function() {\n    vertxNext(flush);\n  };\n}\n\nfunction useMutationObserver() {\n  var iterations = 0;\n  var observer = new BrowserMutationObserver(flush);\n  var node = document.createTextNode('');\n  observer.observe(node, { characterData: true });\n\n  return function() {\n    node.data = (iterations = ++iterations % 2);\n  };\n}\n\n// web worker\nfunction useMessageChannel() {\n  var channel = new MessageChannel();\n  channel.port1.onmessage = flush;\n  return function () {\n    channel.port2.postMessage(0);\n  };\n}\n\nfunction useSetTimeout() {\n  return function() {\n    setTimeout(flush, 1);\n  };\n}\n\nvar queue = new Array(1000);\nfunction flush() {\n  for (var i = 0; i < len; i+=2) {\n    var callback = queue[i];\n    var arg = queue[i+1];\n\n    callback(arg);\n\n    queue[i] = undefined;\n    queue[i+1] = undefined;\n  }\n\n  len = 0;\n}\n\nfunction attemptVertx() {\n  try {\n    var r = require;\n    var vertx = r('vertx');\n    vertxNext = vertx.runOnLoop || vertx.runOnContext;\n    return useVertxTimer();\n  } catch(e) {\n    return useSetTimeout();\n  }\n}\n\nvar scheduleFlush;\n// Decide what async method to use to triggering processing of queued callbacks:\nif (isNode) {\n  scheduleFlush = useNextTick();\n} else if (BrowserMutationObserver) {\n  scheduleFlush = useMutationObserver();\n} else if (isWorker) {\n  scheduleFlush = useMessageChannel();\n} else if (browserWindow === undefined && typeof require === 'function') {\n  scheduleFlush = attemptVertx();\n} else {\n  scheduleFlush = useSetTimeout();\n}\n\nfunction then(onFulfillment, onRejection) {\n  var parent = this;\n\n  var child = new this.constructor(noop);\n\n  if (child[PROMISE_ID] === undefined) {\n    makePromise(child);\n  }\n\n  var state = parent._state;\n\n  if (state) {\n    var callback = arguments[state - 1];\n    asap(function(){\n      invokeCallback(state, child, callback, parent._result);\n    });\n  } else {\n    subscribe(parent, child, onFulfillment, onRejection);\n  }\n\n  return child;\n}\n\n/**\n  `Promise.resolve` returns a promise that will become resolved with the\n  passed `value`. It is shorthand for the following:\n\n  ```javascript\n  var promise = new Promise(function(resolve, reject){\n    resolve(1);\n  });\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  var promise = Promise.resolve(1);\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  @method resolve\n  @static\n  @param {Any} value value that the returned promise will be resolved with\n  Useful for tooling.\n  @return {Promise} a promise that will become fulfilled with the given\n  `value`\n*/\nfunction resolve(object) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (object && typeof object === 'object' && object.constructor === Constructor) {\n    return object;\n  }\n\n  var promise = new Constructor(noop);\n  _resolve(promise, object);\n  return promise;\n}\n\nvar PROMISE_ID = Math.random().toString(36).substring(16);\n\nfunction noop() {}\n\nvar PENDING   = void 0;\nvar FULFILLED = 1;\nvar REJECTED  = 2;\n\nvar GET_THEN_ERROR = new ErrorObject();\n\nfunction selfFulfillment() {\n  return new TypeError(\"You cannot resolve a promise with itself\");\n}\n\nfunction cannotReturnOwn() {\n  return new TypeError('A promises callback cannot return that same promise.');\n}\n\nfunction getThen(promise) {\n  try {\n    return promise.then;\n  } catch(error) {\n    GET_THEN_ERROR.error = error;\n    return GET_THEN_ERROR;\n  }\n}\n\nfunction tryThen(then, value, fulfillmentHandler, rejectionHandler) {\n  try {\n    then.call(value, fulfillmentHandler, rejectionHandler);\n  } catch(e) {\n    return e;\n  }\n}\n\nfunction handleForeignThenable(promise, thenable, then) {\n   asap(function(promise) {\n    var sealed = false;\n    var error = tryThen(then, thenable, function(value) {\n      if (sealed) { return; }\n      sealed = true;\n      if (thenable !== value) {\n        _resolve(promise, value);\n      } else {\n        fulfill(promise, value);\n      }\n    }, function(reason) {\n      if (sealed) { return; }\n      sealed = true;\n\n      _reject(promise, reason);\n    }, 'Settle: ' + (promise._label || ' unknown promise'));\n\n    if (!sealed && error) {\n      sealed = true;\n      _reject(promise, error);\n    }\n  }, promise);\n}\n\nfunction handleOwnThenable(promise, thenable) {\n  if (thenable._state === FULFILLED) {\n    fulfill(promise, thenable._result);\n  } else if (thenable._state === REJECTED) {\n    _reject(promise, thenable._result);\n  } else {\n    subscribe(thenable, undefined, function(value) {\n      _resolve(promise, value);\n    }, function(reason) {\n      _reject(promise, reason);\n    });\n  }\n}\n\nfunction handleMaybeThenable(promise, maybeThenable, then$$) {\n  if (maybeThenable.constructor === promise.constructor &&\n      then$$ === then &&\n      constructor.resolve === resolve) {\n    handleOwnThenable(promise, maybeThenable);\n  } else {\n    if (then$$ === GET_THEN_ERROR) {\n      _reject(promise, GET_THEN_ERROR.error);\n    } else if (then$$ === undefined) {\n      fulfill(promise, maybeThenable);\n    } else if (isFunction$1(then$$)) {\n      handleForeignThenable(promise, maybeThenable, then$$);\n    } else {\n      fulfill(promise, maybeThenable);\n    }\n  }\n}\n\nfunction _resolve(promise, value) {\n  if (promise === value) {\n    _reject(promise, selfFulfillment());\n  } else if (objectOrFunction(value)) {\n    handleMaybeThenable(promise, value, getThen(value));\n  } else {\n    fulfill(promise, value);\n  }\n}\n\nfunction publishRejection(promise) {\n  if (promise._onerror) {\n    promise._onerror(promise._result);\n  }\n\n  publish(promise);\n}\n\nfunction fulfill(promise, value) {\n  if (promise._state !== PENDING) { return; }\n\n  promise._result = value;\n  promise._state = FULFILLED;\n\n  if (promise._subscribers.length !== 0) {\n    asap(publish, promise);\n  }\n}\n\nfunction _reject(promise, reason) {\n  if (promise._state !== PENDING) { return; }\n  promise._state = REJECTED;\n  promise._result = reason;\n\n  asap(publishRejection, promise);\n}\n\nfunction subscribe(parent, child, onFulfillment, onRejection) {\n  var subscribers = parent._subscribers;\n  var length = subscribers.length;\n\n  parent._onerror = null;\n\n  subscribers[length] = child;\n  subscribers[length + FULFILLED] = onFulfillment;\n  subscribers[length + REJECTED]  = onRejection;\n\n  if (length === 0 && parent._state) {\n    asap(publish, parent);\n  }\n}\n\nfunction publish(promise) {\n  var subscribers = promise._subscribers;\n  var settled = promise._state;\n\n  if (subscribers.length === 0) { return; }\n\n  var child, callback, detail = promise._result;\n\n  for (var i = 0; i < subscribers.length; i += 3) {\n    child = subscribers[i];\n    callback = subscribers[i + settled];\n\n    if (child) {\n      invokeCallback(settled, child, callback, detail);\n    } else {\n      callback(detail);\n    }\n  }\n\n  promise._subscribers.length = 0;\n}\n\nfunction ErrorObject() {\n  this.error = null;\n}\n\nvar TRY_CATCH_ERROR = new ErrorObject();\n\nfunction tryCatch(callback, detail) {\n  try {\n    return callback(detail);\n  } catch(e) {\n    TRY_CATCH_ERROR.error = e;\n    return TRY_CATCH_ERROR;\n  }\n}\n\nfunction invokeCallback(settled, promise, callback, detail) {\n  var hasCallback = isFunction$1(callback),\n      value, error, succeeded, failed;\n\n  if (hasCallback) {\n    value = tryCatch(callback, detail);\n\n    if (value === TRY_CATCH_ERROR) {\n      failed = true;\n      error = value.error;\n      value = null;\n    } else {\n      succeeded = true;\n    }\n\n    if (promise === value) {\n      _reject(promise, cannotReturnOwn());\n      return;\n    }\n\n  } else {\n    value = detail;\n    succeeded = true;\n  }\n\n  if (promise._state !== PENDING) {\n    // noop\n  } else if (hasCallback && succeeded) {\n    _resolve(promise, value);\n  } else if (failed) {\n    _reject(promise, error);\n  } else if (settled === FULFILLED) {\n    fulfill(promise, value);\n  } else if (settled === REJECTED) {\n    _reject(promise, value);\n  }\n}\n\nfunction initializePromise(promise, resolver) {\n  try {\n    resolver(function resolvePromise(value){\n      _resolve(promise, value);\n    }, function rejectPromise(reason) {\n      _reject(promise, reason);\n    });\n  } catch(e) {\n    _reject(promise, e);\n  }\n}\n\nvar id = 0;\nfunction nextId() {\n  return id++;\n}\n\nfunction makePromise(promise) {\n  promise[PROMISE_ID] = id++;\n  promise._state = undefined;\n  promise._result = undefined;\n  promise._subscribers = [];\n}\n\nfunction Enumerator(Constructor, input) {\n  this._instanceConstructor = Constructor;\n  this.promise = new Constructor(noop);\n\n  if (!this.promise[PROMISE_ID]) {\n    makePromise(this.promise);\n  }\n\n  if (isArray$1(input)) {\n    this._input     = input;\n    this.length     = input.length;\n    this._remaining = input.length;\n\n    this._result = new Array(this.length);\n\n    if (this.length === 0) {\n      fulfill(this.promise, this._result);\n    } else {\n      this.length = this.length || 0;\n      this._enumerate();\n      if (this._remaining === 0) {\n        fulfill(this.promise, this._result);\n      }\n    }\n  } else {\n    _reject(this.promise, validationError());\n  }\n}\n\nfunction validationError() {\n  return new Error('Array Methods must be provided an Array');\n};\n\nEnumerator.prototype._enumerate = function() {\n  var length  = this.length;\n  var input   = this._input;\n\n  for (var i = 0; this._state === PENDING && i < length; i++) {\n    this._eachEntry(input[i], i);\n  }\n};\n\nEnumerator.prototype._eachEntry = function(entry, i) {\n  var c = this._instanceConstructor;\n  var resolve$$ = c.resolve;\n\n  if (resolve$$ === resolve) {\n    var then$$ = getThen(entry);\n\n    if (then$$ === then &&\n        entry._state !== PENDING) {\n      this._settledAt(entry._state, i, entry._result);\n    } else if (typeof then$$ !== 'function') {\n      this._remaining--;\n      this._result[i] = entry;\n    } else if (c === Promise$1) {\n      var promise = new c(noop);\n      handleMaybeThenable(promise, entry, then$$);\n      this._willSettleAt(promise, i);\n    } else {\n      this._willSettleAt(new c(function(resolve$$) { resolve$$(entry); }), i);\n    }\n  } else {\n    this._willSettleAt(resolve$$(entry), i);\n  }\n};\n\nEnumerator.prototype._settledAt = function(state, i, value) {\n  var promise = this.promise;\n\n  if (promise._state === PENDING) {\n    this._remaining--;\n\n    if (state === REJECTED) {\n      _reject(promise, value);\n    } else {\n      this._result[i] = value;\n    }\n  }\n\n  if (this._remaining === 0) {\n    fulfill(promise, this._result);\n  }\n};\n\nEnumerator.prototype._willSettleAt = function(promise, i) {\n  var enumerator = this;\n\n  subscribe(promise, undefined, function(value) {\n    enumerator._settledAt(FULFILLED, i, value);\n  }, function(reason) {\n    enumerator._settledAt(REJECTED, i, reason);\n  });\n};\n\n/**\n  `Promise.all` accepts an array of promises, and returns a new promise which\n  is fulfilled with an array of fulfillment values for the passed promises, or\n  rejected with the reason of the first passed promise to be rejected. It casts all\n  elements of the passed iterable to promises as it runs this algorithm.\n\n  Example:\n\n  ```javascript\n  var promise1 = resolve(1);\n  var promise2 = resolve(2);\n  var promise3 = resolve(3);\n  var promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // The array here would be [ 1, 2, 3 ];\n  });\n  ```\n\n  If any of the `promises` given to `all` are rejected, the first promise\n  that is rejected will be given as an argument to the returned promises's\n  rejection handler. For example:\n\n  Example:\n\n  ```javascript\n  var promise1 = resolve(1);\n  var promise2 = reject(new Error(\"2\"));\n  var promise3 = reject(new Error(\"3\"));\n  var promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // Code here never runs because there are rejected promises!\n  }, function(error) {\n    // error.message === \"2\"\n  });\n  ```\n\n  @method all\n  @static\n  @param {Array} entries array of promises\n  @param {String} label optional string for labeling the promise.\n  Useful for tooling.\n  @return {Promise} promise that is fulfilled when all `promises` have been\n  fulfilled, or rejected if any of them become rejected.\n  @static\n*/\nfunction all(entries) {\n  return new Enumerator(this, entries).promise;\n}\n\n/**\n  `Promise.race` returns a new promise which is settled in the same way as the\n  first passed promise to settle.\n\n  Example:\n\n  ```javascript\n  var promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  var promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 2');\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // result === 'promise 2' because it was resolved before promise1\n    // was resolved.\n  });\n  ```\n\n  `Promise.race` is deterministic in that only the state of the first\n  settled promise matters. For example, even if other promises given to the\n  `promises` array argument are resolved, but the first settled promise has\n  become rejected before the other promises became fulfilled, the returned\n  promise will become rejected:\n\n  ```javascript\n  var promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  var promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      reject(new Error('promise 2'));\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // Code here never runs\n  }, function(reason){\n    // reason.message === 'promise 2' because promise 2 became rejected before\n    // promise 1 became fulfilled\n  });\n  ```\n\n  An example real-world use case is implementing timeouts:\n\n  ```javascript\n  Promise.race([ajax('foo.json'), timeout(5000)])\n  ```\n\n  @method race\n  @static\n  @param {Array} promises array of promises to observe\n  Useful for tooling.\n  @return {Promise} a promise which settles in the same way as the first passed\n  promise to settle.\n*/\nfunction race(entries) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (!isArray$1(entries)) {\n    return new Constructor(function(resolve, reject) {\n      reject(new TypeError('You must pass an array to race.'));\n    });\n  } else {\n    return new Constructor(function(resolve, reject) {\n      var length = entries.length;\n      for (var i = 0; i < length; i++) {\n        Constructor.resolve(entries[i]).then(resolve, reject);\n      }\n    });\n  }\n}\n\n/**\n  `Promise.reject` returns a promise rejected with the passed `reason`.\n  It is shorthand for the following:\n\n  ```javascript\n  var promise = new Promise(function(resolve, reject){\n    reject(new Error('WHOOPS'));\n  });\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  var promise = Promise.reject(new Error('WHOOPS'));\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  @method reject\n  @static\n  @param {Any} reason value that the returned promise will be rejected with.\n  Useful for tooling.\n  @return {Promise} a promise rejected with the given `reason`.\n*/\nfunction reject(reason) {\n  /*jshint validthis:true */\n  var Constructor = this;\n  var promise = new Constructor(noop);\n  _reject(promise, reason);\n  return promise;\n}\n\nfunction needsResolver() {\n  throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');\n}\n\nfunction needsNew() {\n  throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");\n}\n\n/**\n  Promise objects represent the eventual result of an asynchronous operation. The\n  primary way of interacting with a promise is through its `then` method, which\n  registers callbacks to receive either a promise's eventual value or the reason\n  why the promise cannot be fulfilled.\n\n  Terminology\n  -----------\n\n  - `promise` is an object or function with a `then` method whose behavior conforms to this specification.\n  - `thenable` is an object or function that defines a `then` method.\n  - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).\n  - `exception` is a value that is thrown using the throw statement.\n  - `reason` is a value that indicates why a promise was rejected.\n  - `settled` the final resting state of a promise, fulfilled or rejected.\n\n  A promise can be in one of three states: pending, fulfilled, or rejected.\n\n  Promises that are fulfilled have a fulfillment value and are in the fulfilled\n  state.  Promises that are rejected have a rejection reason and are in the\n  rejected state.  A fulfillment value is never a thenable.\n\n  Promises can also be said to *resolve* a value.  If this value is also a\n  promise, then the original promise's settled state will match the value's\n  settled state.  So a promise that *resolves* a promise that rejects will\n  itself reject, and a promise that *resolves* a promise that fulfills will\n  itself fulfill.\n\n\n  Basic Usage:\n  ------------\n\n  ```js\n  var promise = new Promise(function(resolve, reject) {\n    // on success\n    resolve(value);\n\n    // on failure\n    reject(reason);\n  });\n\n  promise.then(function(value) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Advanced Usage:\n  ---------------\n\n  Promises shine when abstracting away asynchronous interactions such as\n  `XMLHttpRequest`s.\n\n  ```js\n  function getJSON(url) {\n    return new Promise(function(resolve, reject){\n      var xhr = new XMLHttpRequest();\n\n      xhr.open('GET', url);\n      xhr.onreadystatechange = handler;\n      xhr.responseType = 'json';\n      xhr.setRequestHeader('Accept', 'application/json');\n      xhr.send();\n\n      function handler() {\n        if (this.readyState === this.DONE) {\n          if (this.status === 200) {\n            resolve(this.response);\n          } else {\n            reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));\n          }\n        }\n      };\n    });\n  }\n\n  getJSON('/posts.json').then(function(json) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Unlike callbacks, promises are great composable primitives.\n\n  ```js\n  Promise.all([\n    getJSON('/posts'),\n    getJSON('/comments')\n  ]).then(function(values){\n    values[0] // => postsJSON\n    values[1] // => commentsJSON\n\n    return values;\n  });\n  ```\n\n  @class Promise\n  @param {function} resolver\n  Useful for tooling.\n  @constructor\n*/\nfunction Promise$1(resolver) {\n  this[PROMISE_ID] = nextId();\n  this._result = this._state = undefined;\n  this._subscribers = [];\n\n  if (noop !== resolver) {\n    typeof resolver !== 'function' && needsResolver();\n    this instanceof Promise$1 ? initializePromise(this, resolver) : needsNew();\n  }\n}\n\nPromise$1.all = all;\nPromise$1.race = race;\nPromise$1.resolve = resolve;\nPromise$1.reject = reject;\nPromise$1._setScheduler = setScheduler;\nPromise$1._setAsap = setAsap;\nPromise$1._asap = asap;\n\nPromise$1.prototype = {\n  constructor: Promise$1,\n\n/**\n  The primary way of interacting with a promise is through its `then` method,\n  which registers callbacks to receive either a promise's eventual value or the\n  reason why the promise cannot be fulfilled.\n\n  ```js\n  findUser().then(function(user){\n    // user is available\n  }, function(reason){\n    // user is unavailable, and you are given the reason why\n  });\n  ```\n\n  Chaining\n  --------\n\n  The return value of `then` is itself a promise.  This second, 'downstream'\n  promise is resolved with the return value of the first promise's fulfillment\n  or rejection handler, or rejected if the handler throws an exception.\n\n  ```js\n  findUser().then(function (user) {\n    return user.name;\n  }, function (reason) {\n    return 'default name';\n  }).then(function (userName) {\n    // If `findUser` fulfilled, `userName` will be the user's name, otherwise it\n    // will be `'default name'`\n  });\n\n  findUser().then(function (user) {\n    throw new Error('Found user, but still unhappy');\n  }, function (reason) {\n    throw new Error('`findUser` rejected and we're unhappy');\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.\n    // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.\n  });\n  ```\n  If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.\n\n  ```js\n  findUser().then(function (user) {\n    throw new PedagogicalException('Upstream error');\n  }).then(function (value) {\n    // never reached\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // The `PedgagocialException` is propagated all the way down to here\n  });\n  ```\n\n  Assimilation\n  ------------\n\n  Sometimes the value you want to propagate to a downstream promise can only be\n  retrieved asynchronously. This can be achieved by returning a promise in the\n  fulfillment or rejection handler. The downstream promise will then be pending\n  until the returned promise is settled. This is called *assimilation*.\n\n  ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // The user's comments are now available\n  });\n  ```\n\n  If the assimliated promise rejects, then the downstream promise will also reject.\n\n  ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // If `findCommentsByAuthor` fulfills, we'll have the value here\n  }, function (reason) {\n    // If `findCommentsByAuthor` rejects, we'll have the reason here\n  });\n  ```\n\n  Simple Example\n  --------------\n\n  Synchronous Example\n\n  ```javascript\n  var result;\n\n  try {\n    result = findResult();\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n\n  Errback Example\n\n  ```js\n  findResult(function(result, err){\n    if (err) {\n      // failure\n    } else {\n      // success\n    }\n  });\n  ```\n\n  Promise Example;\n\n  ```javascript\n  findResult().then(function(result){\n    // success\n  }, function(reason){\n    // failure\n  });\n  ```\n\n  Advanced Example\n  --------------\n\n  Synchronous Example\n\n  ```javascript\n  var author, books;\n\n  try {\n    author = findAuthor();\n    books  = findBooksByAuthor(author);\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n\n  Errback Example\n\n  ```js\n\n  function foundBooks(books) {\n\n  }\n\n  function failure(reason) {\n\n  }\n\n  findAuthor(function(author, err){\n    if (err) {\n      failure(err);\n      // failure\n    } else {\n      try {\n        findBoooksByAuthor(author, function(books, err) {\n          if (err) {\n            failure(err);\n          } else {\n            try {\n              foundBooks(books);\n            } catch(reason) {\n              failure(reason);\n            }\n          }\n        });\n      } catch(error) {\n        failure(err);\n      }\n      // success\n    }\n  });\n  ```\n\n  Promise Example;\n\n  ```javascript\n  findAuthor().\n    then(findBooksByAuthor).\n    then(function(books){\n      // found books\n  }).catch(function(reason){\n    // something went wrong\n  });\n  ```\n\n  @method then\n  @param {Function} onFulfilled\n  @param {Function} onRejected\n  Useful for tooling.\n  @return {Promise}\n*/\n  then: then,\n\n/**\n  `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same\n  as the catch block of a try/catch statement.\n\n  ```js\n  function findAuthor(){\n    throw new Error('couldn't find that author');\n  }\n\n  // synchronous\n  try {\n    findAuthor();\n  } catch(reason) {\n    // something went wrong\n  }\n\n  // async with promises\n  findAuthor().catch(function(reason){\n    // something went wrong\n  });\n  ```\n\n  @method catch\n  @param {Function} onRejection\n  Useful for tooling.\n  @return {Promise}\n*/\n  'catch': function(onRejection) {\n    return this.then(null, onRejection);\n  }\n};\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used for built-in method references. */\nvar objectProto$1 = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString$1 = objectProto$1.toString;\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString$1.call(value) == symbolTag);\n}\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\nvar nativeMin = Math.min;\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nvar requestAnimationFrame = function () {\n  var lastTime = 0;\n\n  return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function (callback) {\n    var currTime = new Date().getTime();\n    var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n    var id = window.setTimeout(function () {\n      callback(currTime + timeToCall);\n    }, timeToCall);\n    lastTime = currTime + timeToCall;\n    return id;\n  };\n}();\n\nvar cancelAnimationFrame = function () {\n  return window.cancelAnimationFrame || window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame || window.oCancelAnimationFrame || window.msCancelAnimationFrame || window.cancelAnimationFrame || window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame || window.oCancelAnimationFrame || window.msCancelAnimationFrame || function (id) {\n    window.clearTimeout(id);\n  };\n}();\n\nvar nextAnimationFrame = function () {\n  var ids = {};\n\n  function requestId() {\n    var id = void 0;\n    do {\n      id = Math.floor(Math.random() * 1E9);\n    } while (id in ids);\n    return id;\n  }\n\n  return {\n    request: window.requestNextAnimationFrame || function (callback, element) {\n      var id = requestId();\n\n      ids[id] = requestAnimationFrame(function () {\n        ids[id] = requestAnimationFrame(function (ts) {\n          delete ids[id];\n          callback(ts);\n        }, element);\n      }, element);\n\n      return id;\n    },\n    cancel: window.cancelNextAnimationFrame || function (id) {\n      if (ids[id]) {\n        cancelAnimationFrame(ids[id]);\n        delete ids[id];\n      }\n    }\n  };\n}();\n\nvar requestNextAnimationFrame = nextAnimationFrame.request;\n\n// External\n// eslint-disable-line import/no-unresolved\n// Internal\nvar CLASS_NAME = 'context-menu';\nvar CLASS_CHECKBOX = 'checkbox';\nvar ARROW_SIZE = 6;\nvar TRANSITION_SPEED = 125;\nvar BUTTON_QUERY_DEBOUNCE = 666;\nvar BUTTON_ROOT_DEBOUNCE = 500;\nvar BUTTON_DEFAULT_DEBOUNCE = 150;\nvar BUTTON_BAM_EFFECT_ANIMATION_TIME = 700;\n\nvar NodeContextMenu = function () {\n  function NodeContextMenu(vis, visData, baseEl, events, querying, infoFields) {\n    classCallCheck(this, NodeContextMenu);\n\n    var that = this;\n\n    this._x = 0;\n    this._y = 0;\n    this._yOffset = 0;\n    this._scale = 0;\n\n    this.vis = vis;\n    this.visData = visData;\n    this.baseEl = baseEl;\n    this.events = events;\n    this.querying = querying;\n    this.infoFields = infoFields;\n\n    this.numButtonRows = 1;\n    this.numButtonRows = this.querying ? ++this.numButtonRows : this.numButtonRows;\n    this.numButtonRows = this.infoFields && this.infoFields.length ? ++this.numButtonRows : this.numButtonRows;\n\n    this.height = this.visData.global.row.height * this.numButtonRows;\n    this.toBottom = false;\n\n    this.nodeInfoId = 0;\n\n    this.wrapper = this.baseEl.append('g').attr('class', CLASS_NAME);\n\n    this.updateAppearance();\n\n    this.bgBorder = this.wrapper.append('path').attr('class', 'bgBorder').attr('d', dropMenu({\n      x: -1,\n      y: -1,\n      width: this.visData.global.column.width + 2,\n      height: this.height + 2,\n      radius: ARROW_SIZE - 2,\n      arrowSize: ARROW_SIZE\n    }));\n\n    this.bg = this.wrapper.append('path').attr('class', 'bg').attr('d', dropMenu({\n      x: 0,\n      y: 0,\n      width: this.visData.global.column.width,\n      height: this.height,\n      radius: ARROW_SIZE - 1,\n      arrowSize: ARROW_SIZE\n    })).style('filter', 'url(#drop-shadow-context-menu)');\n\n    if (this.infoFields && this.infoFields.length) {\n      this.textNodeInfo = this.wrapper.append('g').call(this.createTextField.bind(this), {\n        alignRight: false,\n        classNames: [],\n        distanceFromCenter: this.querying ? 2 : 1,\n        fullWidth: true,\n        labels: this.infoFields\n      });\n\n      if (this.infoFields.length > 1) {\n        var toggler = this.textNodeInfo.append('g').attr('class', 'toggler').on('click', function () {\n          that.clickNodeInfo.call(that, this);\n        });\n\n        var togglerX = this.visData.global.column.width - this.visData.global.row.contentHeight - this.visData.global.row.padding + this.visData.global.cell.padding;\n\n        var togglerY = this.visData.global.row.padding + this.visData.global.cell.padding;\n\n        toggler.append('rect').attr('class', 'bg').attr('x', togglerX).attr('y', togglerY).attr('width', this.visData.global.row.contentHeight).attr('height', this.visData.global.row.contentHeight);\n\n        toggler.append('use').attr('x', togglerX + (this.visData.global.row.contentHeight - 10) / 2).attr('y', togglerY + (this.visData.global.row.contentHeight - 10) / 2).attr('width', 10).attr('height', 10).attr('xlink:href', this.vis.iconPath + '#arrow-right');\n      }\n    }\n\n    if (this.querying) {\n      this.buttonQuery = this.wrapper.append('g').call(this.createButton.bind(this), {\n        alignRight: false,\n        classNames: [],\n        distanceFromCenter: 1,\n        fullWidth: true,\n        label: 'Query',\n        labelTwo: true,\n        bamEffect: true\n      }).on('click', function () {\n        that.clickQueryHandler.call(that, this);\n      });\n      this.buttonQueryFill = this.buttonQuery.select('.bg-fill-effect');\n      this.buttonQueryBamEffect = this.buttonQuery.select('.bg-bam-effect');\n    }\n\n    this.buttonRoot = this.wrapper.append('g').call(this.createButton.bind(this), {\n      alignRight: false,\n      classNames: [],\n      distanceFromCenter: 0,\n      fullWidth: false,\n      label: 'Root'\n    }).on('click', function () {\n      that.clickRootHandler.call(that, this);\n    });\n    this.buttonRootFill = this.buttonRoot.select('.bg-fill-effect');\n    this.checkboxRoot = this.createCheckbox(this.buttonRoot);\n\n    this.buttonLock = this.wrapper.append('g').call(this.createButton.bind(this), {\n      alignRight: true,\n      classNames: [],\n      distanceFromCenter: 0,\n      fullWidth: false,\n      label: 'Lock',\n      bamEffect: true\n    }).on('click', function () {\n      that.clickLockHandler.call(that, this);\n    });\n    this.buttonLockFill = this.buttonLock.select('.bg-fill-effect');\n    this.buttonLockBamEffect = this.buttonLock.select('.bg-bam-effect');\n    this.checkboxLock = this.createCheckbox(this.buttonLock);\n\n    this.components = this.wrapper.selectAll('.component');\n\n    this.debouncedQueryHandler = debounce(this.queryHandler, BUTTON_QUERY_DEBOUNCE);\n    this.debouncedRootHandler = debounce(this.rootHandler, BUTTON_ROOT_DEBOUNCE);\n  }\n\n  /* ---------------------------------------------------------------------------\n   * Getter / Setter\n   * ------------------------------------------------------------------------ */\n\n  createClass(NodeContextMenu, [{\n    key: 'addLabel',\n\n\n    /* ---------------------------------------------------------------------------\n     * Methods\n     * ------------------------------------------------------------------------ */\n\n    /* ---------------------------------- A ----------------------------------- */\n\n    value: function addLabel(selection, fullWidth, label, labelTwo) {\n      var width = this.visData.global.column.width * (fullWidth ? 1 : 0.5) - this.visData.global.row.padding * 4;\n      var height = this.visData.global.row.contentHeight - this.visData.global.cell.padding * 2;\n\n      var div = selection.append('foreignObject').attr('x', this.visData.global.row.padding * 2).attr('y', this.visData.global.row.padding + this.visData.global.cell.padding).attr('width', width).attr('height', height).attr('class', 'label-wrapper').append('xhtml:div').style('line-height', height - 2 + 'px').style('width', width + 'px');\n\n      div.append('xhtml:span').attr('class', 'label').text(label);\n\n      if (labelTwo) {\n        div.append('xhtml:span').attr('class', 'separator').text(':');\n        div.append('xhtml:span').attr('class', 'label-two');\n      }\n    }\n\n    /* ---------------------------------- C ----------------------------------- */\n\n  }, {\n    key: 'checkLock',\n    value: function checkLock() {\n      var checked = this.node.datum().data.state.lock;\n      this.buttonLock.classed('semi-active', checked);\n      this.checkboxLock.style('transform', 'translateX(' + (checked ? this.checkBoxMovement : 0) + 'px)');\n      if (checked) {\n        this.fillButton(this.buttonLockFill);\n      } else {\n        this.emptyButton(this.buttonLockFill);\n      }\n      return checked;\n    }\n  }, {\n    key: 'checkOrientation',\n    value: function checkOrientation() {\n      if (this._y + this._yOffset >= 0) {\n        this.toBottom = false;\n      } else {\n        this.toBottom = true;\n      }\n      this.components.call(this.positionComponent.bind(this));\n      this.bgBorder.classed('is-mirrored-horizontally', this.toBottom);\n      this.bg.classed('is-mirrored-horizontally', this.toBottom).style('filter', 'url(#drop-shadow-context-menu' + (this.toBottom ? '-inverted' : '') + ')');\n    }\n  }, {\n    key: 'checkRoot',\n    value: function checkRoot(debounced, time) {\n      var state = this.node.datum().data.state.root;\n      var checked = state;\n\n      if (debounced) {\n        if (typeof this.currentRootState === 'undefined') {\n          this.currentRootState = !!state;\n        }\n        if (typeof this.tempRoot === 'undefined') {\n          this.tempRoot = this.currentRootState;\n        }\n        this.tempRoot = !this.tempRoot;\n        checked = this.tempRoot;\n      }\n\n      if (!state) {\n        if (debounced) {\n          if (checked) {\n            this.fillButton(this.buttonRootFill, time);\n          } else {\n            this.hideFillButton(this.buttonRootFill);\n          }\n        } else {\n          this.emptyButton(this.buttonRootFill, time);\n        }\n      } else {\n        if (debounced) {\n          if (!checked) {\n            this.emptyButton(this.buttonRootFill, time);\n          } else {\n            this.showFillButton(this.buttonRootFill);\n          }\n        } else {\n          this.fillButton(this.buttonRootFill, time);\n        }\n      }\n\n      this.buttonRoot.classed('semi-active', checked);\n      this.checkboxRoot.style('transform', 'translateX(' + (checked ? this.checkBoxMovement : 0) + 'px)');\n    }\n  }, {\n    key: 'clickLockHandler',\n    value: function clickLockHandler() {\n      var _this = this;\n\n      this.buttonLock.classed('fill-effect', true);\n      this.vis.nodes.lockHandler(this.node);\n      var checked = this.checkLock();\n      if (checked) {\n        this.buttonLock.classed('active', true);\n      } else {\n        this.buttonLock.classed('active', false);\n      }\n      setTimeout(function () {\n        if (checked) {\n          _this.triggerButtonBamEffect(_this.buttonLockBamEffect);\n        }\n        _this.buttonLock.classed('fill-effect', false);\n      }, BUTTON_DEFAULT_DEBOUNCE);\n    }\n  }, {\n    key: 'clickNodeInfo',\n    value: function clickNodeInfo() {\n      this.nodeInfoId = (this.nodeInfoId + 1) % this.infoFields.length;\n\n      this.textNodeInfo.select('.label').text(this.infoFields[this.nodeInfoId].label);\n\n      this.textNodeInfo.select('.label-two').text(this.getNodeProperty(this.infoFields[this.nodeInfoId].property));\n    }\n  }, {\n    key: 'clickQueryHandler',\n    value: function clickQueryHandler() {\n      this.buttonQuery.classed('fill-effect', true);\n      this.updateQuery(true, BUTTON_QUERY_DEBOUNCE);\n      if (!this.vis.disableDebouncedContextMenu) {\n        this.debouncedQueryHandler(true);\n      } else {\n        this.queryHandler();\n      }\n    }\n  }, {\n    key: 'clickRootHandler',\n    value: function clickRootHandler() {\n      this.buttonRoot.classed('fill-effect', true);\n      this.checkRoot(true, BUTTON_ROOT_DEBOUNCE);\n      if (!this.vis.disableDebouncedContextMenu) {\n        this.debouncedRootHandler(true);\n      } else {\n        this.rootHandler();\n      }\n    }\n  }, {\n    key: 'close',\n    value: function close() {\n      var _this2 = this;\n\n      if (!this.closing) {\n        this.closing = new Promise$1(function (resolve) {\n          _this2.opened = false;\n          _this2.updateAppearance();\n\n          setTimeout(function () {\n            _this2.visible = false;\n            _this2.updateAppearance();\n            resolve(_this2.node.datum().id);\n            _this2.node = undefined;\n          }, TRANSITION_SPEED);\n        });\n      }\n      return this.closing;\n    }\n  }, {\n    key: 'createButton',\n    value: function createButton(selection, properties) {\n      var classNames = 'component button';\n      if (properties.classNames && properties.classNames.length) {\n        classNames += ' ' + properties.classNames.join(' ');\n      }\n      selection.attr('class', classNames);\n\n      selection.datum(properties).call(this.createButtonBg.bind(this), {\n        bamEffect: properties.bamEffect,\n        fullWidth: properties.fullWidth\n      }).call(this.addLabel.bind(this), properties.fullWidth, properties.label, properties.labelTwo).call(this.positionComponent.bind(this), properties.distanceFromCenter, properties.alignRight);\n    }\n  }, {\n    key: 'createButtonBg',\n    value: function createButtonBg(selection, params) {\n      var _this3 = this;\n\n      selection.datum(function (data) {\n        data.x = _this3.visData.global.row.padding;\n        data.y = _this3.visData.global.row.padding;\n        data.width = _this3.visData.global.column.width * (params.fullWidth ? 1 : 0.5) - _this3.visData.global.row.padding * 2;\n        data.height = _this3.visData.global.row.contentHeight;\n        data.rx = 2;\n        data.ry = 2;\n\n        return data;\n      }).append('rect').attr('class', 'bg').attr('x', function (data) {\n        return data.x;\n      }).attr('y', function (data) {\n        return data.y;\n      }).attr('width', function (data) {\n        return data.width;\n      }).attr('height', function (data) {\n        return data.height;\n      }).attr('rx', function (data) {\n        return data.rx;\n      }).attr('ry', function (data) {\n        return data.ry;\n      });\n\n      selection.append('rect').attr('class', 'bg-fill-effect').attr('x', function (data) {\n        return data.x;\n      }).attr('y', function (data) {\n        return data.y;\n      }).attr('width', function (data) {\n        return data.width;\n      }).attr('height', 0).attr('rx', function (data) {\n        return data.rx;\n      }).attr('ry', function (data) {\n        return data.ry;\n      });\n\n      if (params.bamEffect) {\n        selection.append('rect').attr('class', 'bg-bam-effect').attr('x', function (data) {\n          return data.x;\n        }).attr('y', function (data) {\n          return data.y;\n        }).attr('width', function (data) {\n          return data.width;\n        }).attr('height', function (data) {\n          return data.height;\n        }).attr('rx', function (data) {\n          return data.rx;\n        }).attr('ry', function (data) {\n          return data.ry;\n        });\n      }\n    }\n  }, {\n    key: 'createCheckbox',\n    value: function createCheckbox(selection) {\n      var height = Math.round(selection.datum().height / 2);\n      var x = -1.75 * height + this.visData.global.row.padding;\n\n      var container = selection.append('g').attr('class', CLASS_CHECKBOX);\n\n      container.append('rect').attr('class', 'checkbox-bg').attr('x', function (data) {\n        return data.width + x;\n      }).attr('y', height / 2 + this.visData.global.row.padding).attr('width', height * 1.5).attr('height', height).attr('rx', height / 2).attr('ry', height / 2);\n\n      this.checkBoxMovement = (height - 2) / 2;\n\n      return container.append('rect').attr('class', 'checkbox-knob').attr('x', function (data) {\n        return data.width + x + 1;\n      }).attr('y', height / 2 + this.visData.global.row.padding + 1).attr('width', height - 2).attr('height', height - 2).attr('rx', height - 2);\n    }\n  }, {\n    key: 'createTextField',\n    value: function createTextField(selection, properties) {\n      var classNames = 'component text-field';\n      if (properties.classNames && properties.classNames.length) {\n        classNames += ' ' + properties.classNames.join(' ');\n      }\n      selection.attr('class', classNames);\n\n      selection.datum(properties).call(this.addLabel.bind(this), true, properties.labels[this.nodeInfoId].label, true).call(this.positionComponent.bind(this), properties.distanceFromCenter, properties.alignRight);\n    }\n\n    /* ---------------------------------- E ----------------------------------- */\n\n  }, {\n    key: 'emptyButton',\n    value: function emptyButton(selection, time) {\n      selection.transition().duration(0).attr('y', function (data) {\n        return data.y;\n      }).attr('height', function (data) {\n        return data.height;\n      }).call(allTransitionsEnded, function () {\n        selection.transition().duration(time || BUTTON_DEFAULT_DEBOUNCE).ease(d3.easeLinear).attr('y', function (data) {\n          return data.height;\n        }).attr('height', 0);\n      });\n    }\n\n    /* ---------------------------------- F ----------------------------------- */\n\n  }, {\n    key: 'fillButton',\n    value: function fillButton(selection, time) {\n      selection.transition().duration(0).attr('y', function (data) {\n        return data.y;\n      }).attr('height', 0).call(allTransitionsEnded, function () {\n        selection.transition().duration(time || BUTTON_DEFAULT_DEBOUNCE).ease(d3.easeLinear).attr('height', function (data) {\n          return data.height;\n        });\n      });\n    }\n\n    /* ---------------------------------- G ----------------------------------- */\n\n  }, {\n    key: 'getNodeProperty',\n    value: function getNodeProperty(property) {\n      try {\n        return property(this.node.datum());\n      } catch (e) {\n        return undefined;\n      }\n    }\n\n    /* ---------------------------------- H ----------------------------------- */\n\n  }, {\n    key: 'hideFillButton',\n    value: function hideFillButton(selection) {\n      selection.transition().duration(0).attr('height', 0);\n    }\n\n    /* ---------------------------------- I ----------------------------------- */\n\n  }, {\n    key: 'isOpenSameColumn',\n    value: function isOpenSameColumn(columnNum) {\n      return this.opened && this.node.datum().depth === columnNum;\n    }\n\n    /* ---------------------------------- O ----------------------------------- */\n\n  }, {\n    key: 'open',\n    value: function open(node) {\n      var _this4 = this;\n\n      return new Promise$1(function (resolve) {\n        _this4.node = node;\n        _this4.closing = undefined;\n\n        _this4.updateStates();\n\n        _this4._yOffset = _this4.visData.nodes[_this4.node.datum().depth].scrollTop;\n        _this4.translate = {\n          x: _this4.node.datum().x,\n          y: _this4.node.datum().y - _this4.height\n        };\n        _this4.checkOrientation();\n\n        _this4.updateAppearance();\n        _this4.opened = true;\n        _this4.visible = true;\n\n        requestNextAnimationFrame(function () {\n          _this4.updateAppearance();\n          setTimeout(function () {\n            resolve(true);\n          }, TRANSITION_SPEED);\n        });\n      });\n    }\n\n    /* ---------------------------------- P ----------------------------------- */\n\n  }, {\n    key: 'positionComponent',\n    value: function positionComponent(selection, distanceFromCenter, alignRight) {\n      var _this5 = this;\n\n      selection.datum(function (data) {\n        // Lets cache some values to make our lifes easier when checking the\n        // position again in `checkOrientation`.\n        if (distanceFromCenter) {\n          data.distanceFromCenter = distanceFromCenter;\n        }\n        if (alignRight) {\n          data.alignRight = alignRight;\n        }\n        return data;\n      }).attr('transform', function (data) {\n        var x = data.alignRight ? _this5.visData.global.column.width / 2 : 0;\n        // When the buttons are created I assume that the menu is positioned\n        // above the node; i.e. `distanceFromCenter` needs to be inverted.\n        var y = _this5.visData.global.row.height * (_this5.toBottom ? data.distanceFromCenter : _this5.numButtonRows - data.distanceFromCenter - 1) + (_this5.toBottom ? ARROW_SIZE : 0);\n\n        return 'translate(' + x + ', ' + y + ')';\n      });\n    }\n\n    /* ---------------------------------- Q ----------------------------------- */\n\n  }, {\n    key: 'queryHandler',\n    value: function queryHandler(debounced) {\n      if (debounced) {\n        if (this.tempQueryMode !== this.currentQueryMode) {\n          if (this.tempQueryMode) {\n            this.vis.nodes.queryHandler(this.node, 'query', this.tempQueryMode);\n            this.triggerButtonBamEffect(this.buttonQueryBamEffect);\n            this.buttonQuery.classed('active', true);\n          } else {\n            this.vis.nodes.queryHandler(this.node, 'unquery');\n            this.buttonQuery.classed('active', false);\n          }\n        }\n      } else {\n        this.vis.nodes.queryHandler(this.node);\n      }\n\n      // Reset temporary query modes.\n      this.tempQueryMode = undefined;\n      this.currentQueryMode = undefined;\n      this.buttonQuery.classed('fill-effect', false);\n    }\n\n    /* ---------------------------------- R ----------------------------------- */\n\n  }, {\n    key: 'rootHandler',\n    value: function rootHandler(debounced) {\n      if (!debounced || this.tempRoot !== this.currentRootState) {\n        this.close();\n        this.vis.nodes.rootHandler(this.node);\n      }\n\n      // Reset temporary root values.\n      this.tempRoot = undefined;\n      this.currentRootState = undefined;\n      this.buttonRoot.classed('fill-effect', false);\n\n      this.buttonRoot.classed('active', this.node.datum().data.state.root);\n    }\n\n    /* ---------------------------------- S ----------------------------------- */\n\n  }, {\n    key: 'scrollY',\n    value: function scrollY(offset) {\n      this._yOffset = offset;\n      this.updateAppearance();\n    }\n  }, {\n    key: 'showFillButton',\n    value: function showFillButton(selection) {\n      selection.transition().duration(0).attr('y', function (data) {\n        return data.y;\n      }).attr('height', function (data) {\n        return data.height;\n      });\n    }\n\n    /* ---------------------------------- T ----------------------------------- */\n\n  }, {\n    key: 'toggle',\n    value: function toggle(node) {\n      var _this6 = this;\n\n      return new Promise$1(function (resolve) {\n        var nodeId = node.datum().id;\n        var closed = Promise$1.resolve();\n\n        if (_this6.visible) {\n          closed = _this6.close();\n        }\n\n        closed.then(function (previousNodeId) {\n          if (nodeId !== previousNodeId) {\n            _this6.open(node).then(function () {\n              resolve(nodeId);\n            });\n          } else {\n            resolve(nodeId);\n          }\n        });\n      });\n    }\n  }, {\n    key: 'triggerButtonBamEffect',\n    value: function triggerButtonBamEffect(button) {\n      button.classed('active', true);\n      setTimeout(function () {\n        button.classed('active', false);\n      }, BUTTON_BAM_EFFECT_ANIMATION_TIME);\n    }\n\n    /* ---------------------------------- U ----------------------------------- */\n\n  }, {\n    key: 'updateAppearance',\n    value: function updateAppearance() {\n      var centerY = this.toBottom ? 0 : this.height + this.visData.global.row.height;\n\n      this.wrapper.classed('transitionable', this.visible).classed('open', this.opened).style('transform', this.translate + ' ' + this.scale).style('transform-origin', this.visData.global.column.width / 2 + 'px ' + centerY + 'px');\n    }\n  }, {\n    key: 'updateInfoText',\n    value: function updateInfoText() {\n      if (!this.infoFields || !this.infoFields.length) {\n        return;\n      }\n\n      this.textNodeInfo.select('.label').text(this.infoFields[this.nodeInfoId].label);\n\n      this.textNodeInfo.select('.label-two').text(this.getNodeProperty(this.infoFields[this.nodeInfoId].property));\n    }\n  }, {\n    key: 'updatePosition',\n    value: function updatePosition() {\n      if (this.node && this.opened) {\n        this.open(this.node);\n      }\n    }\n  }, {\n    key: 'updateQuery',\n    value: function updateQuery(debounced, time) {\n      if (!this.querying) {\n        return;\n      }\n\n      var state = this.node.datum().data.state.query;\n      var queryMode = state;\n\n      function nextQueryMode(mode) {\n        switch (mode) {\n          case 'or':\n            return 'and';\n          case 'and':\n            return 'not';\n          case 'not':\n            return null;\n          default:\n            return 'or';\n        }\n      }\n\n      if (debounced) {\n        if (typeof this.currentQueryMode === 'undefined') {\n          this.currentQueryMode = state;\n        }\n        if (typeof this.tempQueryMode === 'undefined') {\n          this.tempQueryMode = this.currentQueryMode;\n        }\n        this.tempQueryMode = nextQueryMode(this.tempQueryMode);\n        queryMode = this.tempQueryMode;\n      }\n\n      if (debounced) {\n        if (queryMode) {\n          if (queryMode === state) {\n            this.showFillButton(this.buttonQueryFill);\n          } else {\n            this.fillButton(this.buttonQueryFill, time);\n          }\n        } else {\n          if (state) {\n            this.emptyButton(this.buttonQueryFill, time);\n          } else {\n            this.hideFillButton(this.buttonQueryFill);\n          }\n        }\n      } else {\n        this.emptyButton(this.buttonQueryFill, time);\n      }\n\n      this.buttonQuery.classed('semi-active', !!queryMode).classed('active', !!state).select('.label-two').text(queryMode || 'not queried').classed('inactive', !queryMode);\n    }\n  }, {\n    key: 'updateStates',\n    value: function updateStates() {\n      if (this.node) {\n        this.checkLock();\n        this.checkRoot();\n        this.updateQuery();\n        this.updateInfoText();\n      }\n    }\n  }, {\n    key: 'scale',\n    get: function get() {\n      return 'scale(' + (this.opened ? 1 : 0.5) + ')';\n    }\n  }, {\n    key: 'translate',\n    get: function get() {\n      var y = this.toBottom ? this._y + this.height + this.visData.global.row.height - ARROW_SIZE : this._y;\n\n      return 'translate(' + this._x + 'px,' + (y + this._yOffset) + 'px)';\n    },\n    set: function set(position) {\n      this._x = position.x;\n      this._y = position.y;\n    }\n  }]);\n  return NodeContextMenu;\n}();\n\n/* eslint no-shadow: 0 */\n\n// External\n// Internal\nvar LimitsUnsupportedFormat = function (_ExtendableError) {\n  inherits(LimitsUnsupportedFormat, _ExtendableError);\n\n  function LimitsUnsupportedFormat(message) {\n    classCallCheck(this, LimitsUnsupportedFormat);\n    return possibleConstructorReturn(this, (LimitsUnsupportedFormat.__proto__ || Object.getPrototypeOf(LimitsUnsupportedFormat)).call(this, message || 'The limits are wrongly formatted. Please provide an ' + 'object of the following format: `{ x: { min: 0, max: 1 }, y: { min: ' + '0, max: 1 } }`'));\n  }\n\n  return LimitsUnsupportedFormat;\n}(ExtendableError);\n\n/**\n * Drap and drop event handler that works via translation.\n *\n * @method  onDragDrop\n * @author  Fritz Lekschas\n * @date    2016-04-04\n * @param   {Object}  selection        D3 selection to listen for the drag\n *   event.\n * @param   {Object}           dragMoveHandler         Handler for drag-move.\n * @param   {Object}           dropHandler             Handler for drag-end,\n *   i.e. drop.\n * @param   {Array}            elsToBeDragged          Array of D3 selections to\n *   be moved according to the drag event. If empty or undefined `selection`\n *   will be used.\n * @param   {String}           orientation             Can either be\n *   \"horizontal\", \"vertical\" or `undefined`, i.e. both directions.\n * @param   {Object|Function}  limits                  X and Y drag limits. E.g.\n *   `{ x: { min: 0, max: 10 } }`.\n * @param   {Array}             noDraggingWhenTrue     List if function\n *   returning a Boolean value which should prevent the dragMoveHandler from\n *   working.\n */\nfunction onDragDrop(selection, dragStartHandler, dragMoveHandler, dropHandler, elsToBeDragged, orientation, limits, noDraggingWhenTrue, dragData) {\n  var drag = d3.drag();\n  var checkWhenDragging = isFunction(noDraggingWhenTrue);\n\n  var appliedLimits = limits || {}; // eslint-disable-line no-param-reassign\n\n  var filter = function filter() {\n    return !(checkWhenDragging && noDraggingWhenTrue());\n  };\n\n  drag.filter(filter);\n\n  drag.on('start', function () {\n    if (typeof limits === 'function') {\n      appliedLimits = limits();\n    }\n  });\n\n  if (dragMoveHandler) {\n    drag.on('drag', function (data) {\n      if (checkWhenDragging && noDraggingWhenTrue()) {\n        return;\n      }\n      d3.event.sourceEvent.preventDefault();\n      dragStartHandler();\n      dragMoveHandler.call(this, data, elsToBeDragged, orientation, appliedLimits);\n    });\n  }\n\n  if (dropHandler) {\n    drag.on('end', dropHandler);\n  }\n\n  selection.each(function (data) {\n    var el = d3.select(this);\n\n    // Set default data if not available.\n    if (!data) {\n      data = { drag: dragData }; // eslint-disable-line no-param-reassign\n      el.datum(data);\n    }\n\n    // Add drag event handler\n    el.call(drag);\n  });\n}\n\nfunction dragMoveHandler(data, elsToBeDragged, orientation, limits) {\n  var els = d3.select(this);\n\n  if (elsToBeDragged && elsToBeDragged.length) {\n    els = mergeSelections(elsToBeDragged);\n  }\n\n  function withinLimits(value, applyingLimits) {\n    var restrictedValue = void 0;\n\n    if (applyingLimits) {\n      try {\n        restrictedValue = Math.min(applyingLimits.max, Math.max(applyingLimits.min, value));\n      } catch (e) {\n        throw new LimitsUnsupportedFormat();\n      }\n    }\n    return restrictedValue;\n  }\n\n  if (orientation === 'horizontal' || orientation === 'vertical') {\n    if (orientation === 'horizontal') {\n      data.drag.x += d3.event.dx;\n      data.drag.x = withinLimits(data.drag.x + d3.event.dx, limits.x);\n      els.style('transform', 'translateX(' + data.drag.x + 'px)');\n    }\n    if (orientation === 'vertical') {\n      data.drag.y += d3.event.dy;\n      data.drag.x = withinLimits(data.drag.y + d3.event.dy, limits.y);\n      els.style('transform', 'translateY(' + data.drag.y + 'px)');\n    }\n  } else {\n    data.drag.x += d3.event.dx;\n    data.drag.y += d3.event.dy;\n    els.style('transform', 'translate(' + data.drag.x + 'px,' + data.drag.y + 'px)');\n  }\n}\n\n// Adapted from: http://bl.ocks.org/cpbotha/5200394\nfunction dropShadow(el, name, dx, dy, blur, opacity) {\n  var defs = el.select('defs');\n\n  if (defs.empty()) {\n    defs = el.append('defs');\n  }\n\n  // create filter with id #drop-shadow\n  // height = 130% so that the shadow is not clipped\n  var filter = defs.append('filter').attr('id', 'drop-shadow' + (name ? '-' + name : '')).attr('height', '130%');\n\n  // SourceAlpha refers to opacity of graphic that this filter will be applied to\n  // convolve that with a Gaussian with standard deviation 3 and store result\n  // in blur\n  filter.append('feGaussianBlur').attr('in', 'SourceAlpha').attr('stdDeviation', blur);\n\n  // translate output of Gaussian blur to the right and downwards with 2px\n  // store result in offsetBlur\n  filter.append('feOffset').attr('dx', dx).attr('dy', dy).attr('result', 'offsetBlur');\n\n  filter.append('feComponentTransfer').append('feFuncA').attr('type', 'linear').attr('slope', opacity || 1);\n\n  // overlay original SourceGraphic over translated blurred opacity by using\n  // feMerge filter. Order of specifying inputs is important!\n  var feMerge = filter.append('feMerge');\n\n  feMerge.append('feMergeNode');\n  feMerge.append('feMergeNode').attr('in', 'SourceGraphic');\n}\n\n// External\n// eslint-disable-line import/no-unresolved\n// eslint-disable-line import/no-unresolved\n// Internal\n// Private Variables\nvar _d3 = d3;\n\nfunction setOption(value, defaultValue, noFalsyValue) {\n  if (noFalsyValue) {\n    return value || defaultValue;\n  }\n\n  return typeof value !== 'undefined' ? value : defaultValue;\n}\n\nvar ListGraph = function () {\n  function ListGraph(init) {\n    var _this = this;\n\n    classCallCheck(this, ListGraph);\n\n    if (init.d3) {\n      _d3 = init.d3;\n    }\n\n    if (_d3.version[0] !== '4') {\n      throw new D3VersionFourRequired(_d3.version);\n    }\n\n    if (!_d3.listGraph) {\n      throw new LayoutNotAvailable();\n    }\n\n    var that = this;\n\n    this.baseEl = init.element;\n    this.baseEl.__d3ListGraphBase__ = true;\n\n    this.baseElD3 = _d3.select(this.baseEl);\n    this.baseElJq = $(this.baseEl);\n    this.svgD3 = this.baseElD3.select('svg.base');\n    this.svgEl = this.svgD3.node();\n    this.outsideClickHandler = {};\n    this.outsideClickClassHandler = {};\n\n    if (this.svgD3.empty()) {\n      this.svgD3 = this.baseElD3.append('svg').attr('class', 'base');\n      this.svgJq = $(this.svgD3.node());\n    } else {\n      this.svgJq = $(this.svgD3.node());\n    }\n\n    // Array of root node IDs.\n    this.rootNodes = init.rootNodes;\n\n    // Width of the vis. If `undefined` the SVG's width will be used.\n    this.width = setOption(init.width, this.svgJq.width(), true);\n\n    // Height of the vis. If `undefined` the SVG's height will be used.\n    this.height = setOption(init.height, this.svgJq.height(), true);\n\n    // Refresh top and left position of the base `svg` everytime the user enters\n    // the element with his/her mouse cursor. This will avoid relying on complex\n    // browser resize events and other layout manipulations as they most likely\n    // won't happen when the user tries to interact with the visualization.\n    this.svgD3.on('mouseenter', this.getBoundingRect.bind(this));\n\n    // With of the column's scrollbars\n    this.scrollbarWidth = setOption(init.scrollbarWidth, SCROLLBAR_WIDTH, true);\n\n    // Number of visible columns\n    this.columns = setOption(init.columns, COLUMNS, true);\n\n    // Number of visible rows.\n    this.rows = setOption(init.rows, ROWS, true);\n\n    // Path to SVG icon file.\n    this.iconPath = setOption(init.iconPath, ICON_PATH, true);\n\n    // If `true` query icons and controls are enabled.\n    this.querying = setOption(init.querying, QUERYING);\n\n    // If `true` hide links that point to invisible nodes.\n    this.hideOutwardsLinks = setOption(init.hideOutwardsLinks, HIDE_OUTWARDS_LINKS);\n\n    // If `true` and `this.hideOutwardsLinks === true` indicates the location of\n    // target nodes of invisible nodes connected via links.\n    this.showLinkLocation = setOption(init.showLinkLocation, SHOW_LINK_LOCATION);\n\n    // The visual size of a location bucket. E.g. `3` pixel.\n    this.linkLocationBucketSize = init.linkLocationBucketSize;\n\n    // If `true` the currently rooted level will softly be highlighted.\n    this.highlightActiveLevel = setOption(init.highlightActiveLevel, HIGHLIGHT_ACTIVE_LEVEL);\n\n    // Determines which level from the rooted node will be regarded as active.\n    // Zero means that the level of the rooted node is regarded.\n    this.activeLevel = setOption(init.activeLevel, ACTIVE_LEVEL);\n\n    // When no manually rooted node is available the active level will be\n    // `this.activeLevel` minus `this.noRootActiveLevelDiff`.\n    // WAT?\n    // In some cases it makes sense to hide the original root node just to save\n    // a column, so having no manually set root node means that the invisible\n    // root node is active. Using this option it can be assured that the\n    // approriate column is being highlighted.\n    this.noRootActiveLevelDiff = setOption(init.noRootActiveLevelDiff, NO_ROOT_ACTIVE_LEVEL_DIFF);\n\n    // Determine the level of transitions\n    // - 0 [Default]: Show all transitions\n    // - 1: Show only CSS transitions\n    // - 2: Show no transitions\n    this.lessTransitionsJs = init.lessTransitions > 0;\n    this.lessTransitionsCss = init.lessTransitions > 1;\n\n    // Enable or disable\n    this.disableDebouncedContextMenu = setOption(init.disableDebouncedContextMenu, DISABLE_DEBOUNCED_CONTEXT_MENU);\n\n    this.baseElD3.classed('less-animations', this.lessTransitionsCss);\n\n    // Holds the key of the property to be sorted initially. E.g. `precision`.\n    this.sortBy = init.sortBy;\n\n    // Initial sort order. Anything other than `asc` will fall back to `desc`.\n    this.sortOrder = init.sortOrder === 'asc' ? 1 : DEFAULT_SORT_ORDER;\n\n    this.nodeInfoContextMenu = isArray(init.nodeInfoContextMenu) ? init.nodeInfoContextMenu : [];\n\n    this.events = new Events(this.baseEl, init.dispatcher);\n\n    this.baseElJq.addClass(CLASSNAME);\n\n    this.dragged = { x: 0, y: 0 };\n\n    if (init.forceWidth) {\n      this.baseElJq.width(this.width);\n    }\n\n    this.layout = new _d3.listGraph( // eslint-disable-line new-cap\n    [this.width, this.height], [this.columns, this.rows], _d3);\n\n    this.data = init.data;\n    this.visData = this.layout.process(this.data, this.rootNodes, {\n      showLinkLocation: this.showLinkLocation,\n      linkLocationBucketSize: this.linkLocationBucketSize,\n      sortBy: this.sortBy,\n      sortOrder: this.sortOrder\n    });\n\n    /**\n     * Stores current sorting, e.g. type, order and a reference to the element.\n     *\n     * @type  {Object}\n     */\n    this.currentSorting = {\n      global: {\n        type: this.sortBy,\n        order: this.sortOrder\n      },\n      local: {}\n    };\n\n    this.barMode = init.barMode || DEFAULT_BAR_MODE;\n    this.svgD3.classed(this.barMode + '-bar', true);\n\n    this.topbar = new Topbar(this, this.baseElD3, this.visData);\n\n    this.svgD3.attr('viewBox', '0 0 ' + this.width + ' ' + this.height);\n\n    this.container = this.svgD3.append('g').attr('class', 'main-container');\n\n    this.levels = new Levels(this.container, this, this.visData);\n\n    this.links = new Links(this, this.levels.groups, this.visData, this.layout);\n    this.nodes = new Nodes(this, this.levels.groups, this.visData, this.links, this.events);\n    this.levels.scrollPreparation(this, this.scrollbarWidth);\n    this.scrollbars = new Scrollbars(this.levels.groups, this.visData, this.scrollbarWidth);\n\n    this.nodeContextMenu = new NodeContextMenu(this, this.visData, this.container, this.events, this.querying, this.nodeInfoContextMenu);\n\n    this.nodeContextMenu.wrapper.on('mousedown', function () {\n      _this.mouseDownOnContextMenu = true;\n    });\n\n    dropShadow(this.svgD3, 'context-menu', 0, 1, 2, 0.2);\n    dropShadow(this.svgD3, 'context-menu-inverted', 0, -1, 2, 0.2);\n\n    // jQuery's mousewheel plugin is much nicer than D3's half-baked zoom event.\n    // We are using delegated event listeners to provide better scaling\n    this.svgJq.on('mousewheel', '.' + this.levels.className, function (event) {\n      if (!that.zoomedOut) {\n        that.mousewheelColumn(this, event);\n      }\n    });\n\n    this.svgJq.on('click', function (event) {\n      that.checkGlobalClick.call(that, event.target);\n    });\n\n    // Add jQuery delegated event listeners instead of direct listeners of D3.\n    this.svgJq.on('click', '.' + this.nodes.classNodeVisible, function () {\n      // Add a new global outside click listener using this node and the\n      // node context menu as the related elements.\n      requestNextAnimationFrame(function () {\n        that.registerOutSideClickHandler('nodeContextMenu', [that.nodeContextMenu.wrapper.node()], ['visible-node'], function () {\n          // The context of this method is the context of the outer click\n          // handler.\n          that.nodeContextMenu.close();\n          that.unregisterOutSideClickHandler.call(that, 'nodeContextMenu');\n        });\n      });\n\n      that.nodeContextMenu.toggle.call(that.nodeContextMenu, _d3.select(this.parentNode));\n    });\n\n    this.svgJq.on('click', '.' + this.nodes.classFocusControls + '.' + this.nodes.classRoot, function () {\n      that.nodes.rootHandler.call(that.nodes, _d3.select(this), true);\n    });\n\n    if (this.querying) {\n      this.svgJq.on('click', '.' + this.nodes.classFocusControls + '.' + this.nodes.classQuery, function () {\n        that.nodes.queryHandler.call(that.nodes, _d3.select(this.parentNode), 'unquery');\n        that.nodeContextMenu.updateStates();\n      });\n    }\n\n    this.svgJq.on('click', '.' + this.nodes.classFocusControls + '.' + this.nodes.classLock, function () {\n      that.nodes.lockHandler.call(that.nodes, this, _d3.select(this).datum());\n    });\n\n    this.svgJq.on('mouseenter', '.' + this.nodes.classNodeVisible, function () {\n      that.interactionWrapper.call(that, function (domEl, data) {\n        if (!this.vis.activeScrollbar) {\n          this.enterHandler.call(this, domEl, data);\n        }\n      }.bind(that.nodes), [this, _d3.select(this).datum()]);\n    });\n\n    this.svgJq.on('mouseleave', '.' + this.nodes.classNodeVisible, function () {\n      that.interactionWrapper.call(that, function (domEl, data) {\n        if (!this.vis.activeScrollbar) {\n          this.leaveHandler.call(this, domEl, data);\n        }\n      }.bind(that.nodes), [this, _d3.select(this).datum()]);\n    });\n\n    // Normally we would reference a named methods but since we need to access\n    // the class' `this` property instead of the DOM element we need to use an\n    // arrow function.\n    this.scrollbars.all.on('mousedown', function () {\n      that.scrollbarMouseDown(this, _d3.event);\n    });\n\n    // We need to listen to `mouseup` and `mousemove` globally otherwise\n    // scrolling will only work as long as the cursor hovers the actual\n    // scrollbar, which is super annoying.\n    _d3.select(document).on('mouseup', function () {\n      _this.globalMouseUp(_d3.event);\n    }).on('mousemove', function () {\n      _this.globalMouseMove(_d3.event);\n    });\n\n    // Enable dragging of the whole graph.\n    this.svgD3.call(onDragDrop, this.dragStartHandler.bind(this), this.dragMoveHandler.bind(this), this.dragEndHandler.bind(this), [this.container, this.topbar.localControlWrapper], 'horizontal', this.getDragLimits.bind(this), this.noDragging.bind(this), this.dragged);\n\n    this.events.on('d3ListGraphLevelFocus', function (levelId) {\n      return _this.levels.focus(levelId);\n    });\n\n    this.events.on('d3ListGraphNodeRoot', function () {\n      _this.nodes.bars.updateAll(_this.layout.updateBars(_this.data), _this.currentSorting.global.type);\n      _this.updateSorting();\n    });\n\n    this.events.on('d3ListGraphNodeUnroot', function () {\n      _this.nodes.bars.updateAll(_this.layout.updateBars(_this.data), _this.currentSorting.global.type);\n      _this.updateSorting();\n    });\n\n    this.events.on('d3ListGraphUpdateBars', function () {\n      _this.nodes.bars.updateAll(_this.layout.updateBars(_this.data), _this.currentSorting.global.type);\n      _this.updateSorting();\n    });\n\n    this.events.on('d3ListGraphActiveLevel', function (nextLevel) {\n      var oldLevel = _this.activeLevel;\n      _this.activeLevel = Math.max(nextLevel, 0);\n      if (_this.nodes.rootedNode) {\n        var rootNodeDepth = _this.nodes.rootedNode.datum().depth;\n        _this.levels.blur(rootNodeDepth + oldLevel);\n        _this.levels.focus(rootNodeDepth + _this.activeLevel);\n      } else {\n        _this.levels.blur(oldLevel - _this.noRootActiveLevelDiff);\n        _this.levels.focus(_this.activeLevel - _this.noRootActiveLevelDiff);\n      }\n    });\n\n    // Initialize `this.left` and `this.top`\n    this.getBoundingRect();\n  }\n\n  createClass(ListGraph, [{\n    key: 'dragMoveHandler',\n    value: function dragMoveHandler$$(data, elsToBeDragged, orientation, limits, notWhenTrue) {\n      dragMoveHandler(data, elsToBeDragged, orientation, limits, notWhenTrue);\n      this.checkNodeVisibility();\n    }\n  }, {\n    key: 'checkNodeVisibility',\n    value: function checkNodeVisibility(level, customScrollTop) {\n      var nodes = level ? this.nodes.nodes.filter(function (data) {\n        return data.depth === level;\n      }) : this.nodes.nodes;\n\n      nodes.call(this.nodes.isInvisible.bind(this.nodes), customScrollTop);\n    }\n  }, {\n    key: 'registerOutSideClickHandler',\n    value: function registerOutSideClickHandler(id, els, elClassNames, callback) {\n      // We need to register a unique property to be able to indentify that\n      // element later efficiently.\n      for (var i = els.length; i--;) {\n        if (els[i].__id__) {\n          els[i].__id__.push(id);\n        } else {\n          els[i].__id__ = [id];\n        }\n      }\n      var newLength = this.outsideClickHandler[id] = {\n        id: id, els: els, elClassNames: elClassNames, callback: callback\n      };\n      for (var _i = elClassNames.length; _i--;) {\n        this.outsideClickClassHandler[elClassNames[_i]] = this.outsideClickHandler[id];\n      }\n      return newLength;\n    }\n  }, {\n    key: 'unregisterOutSideClickHandler',\n    value: function unregisterOutSideClickHandler(id) {\n      var handler = this.outsideClickHandler[id];\n\n      // Remove element `__id__` property.\n      for (var i = handler.els.length; i--;) {\n        handler.els[i].__id__ = undefined;\n        delete handler.els[i].__id__;\n      }\n\n      // Remove handler.\n      this.outsideClickHandler[id] = undefined;\n      delete this.outsideClickHandler[id];\n    }\n  }, {\n    key: 'checkGlobalClick',\n    value: function checkGlobalClick(target) {\n      var found = {};\n      var checkClass = Object.keys(this.outsideClickClassHandler).length;\n\n      var el = target;\n      try {\n        while (!el.__d3ListGraphBase__) {\n          if (el.__id__) {\n            for (var i = el.__id__.length; i--;) {\n              found[el.__id__[i]] = true;\n            }\n          }\n          if (checkClass) {\n            var classNames = Object.keys(this.outsideClickClassHandler);\n            for (var _i2 = classNames.length; _i2--;) {\n              var className = el.getAttribute('class');\n              if (className && className.indexOf(classNames[_i2]) >= 0) {\n                found[this.outsideClickClassHandler[classNames[_i2]].id] = true;\n              }\n            }\n          }\n          el = el.parentNode;\n        }\n      } catch (e) {\n        return;\n      }\n\n      var handlerIds = Object.keys(this.outsideClickHandler);\n      for (var _i3 = handlerIds.length; _i3--;) {\n        if (!found[handlerIds[_i3]]) {\n          this.outsideClickHandler[handlerIds[_i3]].callback.call(this);\n        }\n      }\n    }\n  }, {\n    key: 'getDragLimits',\n    value: function getDragLimits() {\n      return {\n        x: {\n          min: this.dragMinX,\n          max: 0\n        }\n      };\n    }\n\n    /**\n     * Helper method to get the top and left position of the base `svg`.\n     *\n     * @Description\n     * Calling `getBoundingClientRect()` right at the beginning leads to errornous\n     * values, probably because the function is called because HTML has been fully\n     * rendered.\n     *\n     * @method  getBoundingRect\n     * @author  Fritz Lekschas\n     * @date    2016-02-24\n     */\n\n  }, {\n    key: 'getBoundingRect',\n    value: function getBoundingRect() {\n      this.left = this.svgEl.getBoundingClientRect().left;\n      this.top = this.svgEl.getBoundingClientRect().top;\n    }\n  }, {\n    key: 'interactionWrapper',\n    value: function interactionWrapper(callback, params) {\n      if (!this.noInteractions) {\n        callback.apply(this, params);\n      }\n    }\n  }, {\n    key: 'dragStartHandler',\n    value: function dragStartHandler() {\n      if (!this.dragging) {\n        this.noInteractions = this.dragging = true;\n      }\n    }\n  }, {\n    key: 'dragEndHandler',\n    value: function dragEndHandler() {\n      if (this.dragging) {\n        this.noInteractions = this.dragging = false;\n      }\n    }\n  }, {\n    key: 'noDragging',\n    value: function noDragging() {\n      return !!this.activeScrollbar || this.mouseDownOnContextMenu;\n    }\n  }, {\n    key: 'globalMouseUp',\n    value: function globalMouseUp(event) {\n      this.noInteractions = false;\n      this.mouseDownOnContextMenu = false;\n\n      if (this.activeScrollbar) {\n        var data = this.activeScrollbar.datum();\n        var deltaY = data.scrollbar.clientY - event.clientY;\n\n        // Save final vertical position\n        // Scrollbar\n        data.scrollbar.scrollTop = Math.min(Math.max(data.scrollbar.scrollTop - deltaY, 0), data.scrollbar.scrollHeight);\n\n        // Content\n        data.scrollTop = Math.max(Math.min(data.scrollTop + data.invertedHeightScale(deltaY), 0), -data.scrollHeight);\n\n        this.activeScrollbar.classed('active', false);\n\n        this.activeScrollbar = undefined;\n      }\n    }\n  }, {\n    key: 'globalMouseMove',\n    value: function globalMouseMove(event) {\n      if (this.activeScrollbar) {\n        event.preventDefault();\n        var data = this.activeScrollbar.datum();\n        var deltaY = data.scrollbar.clientY - event.clientY;\n\n        // Scroll scrollbar\n        ListGraph.scrollElVertically(this.activeScrollbar.node(), Math.min(Math.max(data.scrollbar.scrollTop - deltaY, 0), data.scrollbar.scrollHeight));\n\n        // Scroll content\n        var contentScrollTop = Math.max(Math.min(data.scrollTop + data.invertedHeightScale(deltaY), 0), -data.scrollHeight);\n\n        // Check if nodes are visible.\n        this.checkNodeVisibility(data.level, contentScrollTop);\n\n        ListGraph.scrollElVertically(data.nodes, contentScrollTop);\n\n        // Scroll Links\n        if (data.level !== this.visData.nodes.length) {\n          this.links.scroll(data.linkSelections.outgoing, this.layout.offsetLinks(data.level, contentScrollTop, 'source'));\n        }\n\n        if (data.level > 0) {\n          this.links.scroll(data.linkSelections.incoming, this.layout.offsetLinks(data.level - 1, contentScrollTop, 'target'));\n        }\n\n        if (this.showLinkLocation) {\n          this.nodes.updateLinkLocationIndicators(data.level - 1, data.level + 1);\n        }\n\n        if (this.nodeContextMenu.opened) {\n          this.nodeContextMenu.scrollY(contentScrollTop);\n        }\n      }\n    }\n  }, {\n    key: 'scrollbarMouseDown',\n    value: function scrollbarMouseDown(el, event) {\n      this.noInteractions = true;\n      this.activeScrollbar = _d3.select(el).classed('active', true);\n      this.activeScrollbar.datum().scrollbar.clientY = event.clientY;\n    }\n  }, {\n    key: 'mousewheelColumn',\n    value: function mousewheelColumn(el, event) {\n      event.preventDefault();\n\n      var data = _d3.select(el).datum();\n\n      this.checkNodeVisibility(data.level);\n\n      if (data.scrollHeight > 0) {\n        // Scroll nodes\n        data.scrollTop = Math.max(Math.min(data.scrollTop + event.deltaY, 0), -data.scrollHeight);\n\n        this.scrollY(data);\n      }\n    }\n  }, {\n    key: 'scrollY',\n    value: function scrollY(columnData, scrollbarDragging) {\n      ListGraph.scrollElVertically(columnData.nodes, columnData.scrollTop);\n\n      if (!scrollbarDragging) {\n        // Scroll scrollbar\n        columnData.scrollbar.scrollTop = columnData.scrollbar.heightScale(-columnData.scrollTop);\n\n        ListGraph.scrollElVertically(columnData.scrollbar.el, columnData.scrollbar.scrollTop);\n      }\n\n      // Scroll Links\n      if (columnData.level !== this.visData.nodes.length) {\n        this.links.scroll(columnData.linkSelections.outgoing, this.layout.offsetLinks(columnData.level, columnData.scrollTop, 'source'));\n      }\n\n      if (columnData.level > 0) {\n        this.links.scroll(columnData.linkSelections.incoming, this.layout.offsetLinks(columnData.level - 1, columnData.scrollTop, 'target'));\n      }\n\n      if (this.showLinkLocation) {\n        this.nodes.updateLinkLocationIndicators(columnData.level - 1, columnData.level + 1);\n      }\n\n      if (this.nodeContextMenu.isOpenSameColumn(columnData.level)) {\n        this.nodeContextMenu.scrollY(columnData.scrollTop);\n      }\n    }\n  }, {\n    key: 'scrollYTo',\n    value: function scrollYTo(selection, positionY) {\n      var _this2 = this;\n\n      return selection.transition().duration(TRANSITION_SEMI_FAST).tween('scrollY', function (data) {\n        var scrollPositionY = _d3.interpolateNumber(data.scrollTop, positionY);\n        return function (time) {\n          data.scrollTop = scrollPositionY(time);\n          _this2.scrollY(data);\n        };\n      });\n    }\n  }, {\n    key: 'resetAllScrollPositions',\n    value: function resetAllScrollPositions() {\n      return this.scrollYTo(this.levels.groups, 0);\n    }\n  }, {\n    key: 'selectByLevel',\n    value: function selectByLevel(level, selector) {\n      return _d3.select(this.levels.groups._groups[0][level]).selectAll(selector);\n    }\n  }, {\n    key: 'updateSorting',\n    value: function updateSorting() {\n      var levels = Object.keys(this.currentSorting.local);\n      for (var i = levels.length; i--;) {\n        this.sortColumn(i, this.currentSorting.local[levels[i]].type, this.currentSorting.local[levels[i]].order, this.currentSorting.local[levels[i]].type);\n      }\n    }\n  }, {\n    key: 'sortColumn',\n    value: function sortColumn(level, property, sortOrder, newSortType) {\n      this.nodes.sort(this.layout.sort(level, property, sortOrder).updateNodesVisibility().nodes(level), newSortType);\n      this.links.sort(this.layout.links(level - 1, level + 1));\n      this.nodeContextMenu.updatePosition();\n      this.checkNodeVisibility();\n    }\n  }, {\n    key: 'sortAllColumns',\n    value: function sortAllColumns(property, newSortType) {\n      this.currentSorting.global.order = this.currentSorting.global.order === -1 && !newSortType ? 1 : -1;\n\n      this.nodes.sort(this.layout.sort(undefined, property, this.currentSorting.global.order).updateNodesVisibility().nodes(), newSortType);\n\n      this.links.sort(this.layout.links());\n      this.nodeContextMenu.updatePosition();\n      this.checkNodeVisibility();\n    }\n  }, {\n    key: 'switchBarMode',\n    value: function switchBarMode(mode) {\n      this.svgD3.classed('one-bar', mode === 'one');\n      this.svgD3.classed('two-bar', mode === 'two');\n      this.nodes.bars.switchMode(mode, this.currentSorting);\n    }\n  }, {\n    key: 'trigger',\n    value: function trigger(event, data) {\n      this.events.trigger(event, data);\n    }\n\n    /**\n     * Update the scroll position and scroll-bar visibility.\n     *\n     * @description\n     * This method needs to be called after hiding or showing nodes.\n     *\n     * @method  updateScrolling\n     * @author  Fritz Lekschas\n     * @date    2016-02-21\n     */\n\n  }, {\n    key: 'updateScrolling',\n    value: function updateScrolling() {\n      var _this3 = this;\n\n      this.resetAllScrollPositions().call(allTransitionsEnded, function () {\n        _this3.levels.updateScrollProperties();\n        _this3.scrollbars.updateVisibility();\n      });\n    }\n  }, {\n    key: 'updateLevelsVisibility',\n    value: function updateLevelsVisibility() {\n      this.levels.updateVisibility();\n    }\n  }, {\n    key: 'globalView',\n    value: function globalView(selectionInterst) {\n      var _this4 = this;\n\n      if (!this.zoomedOut) {\n        (function () {\n          var x = 0;\n          var y = 0;\n          var width = 0;\n          var height = 0;\n          var cRect = void 0;\n          var contBBox = _this4.container.node().getBBox();\n\n          var globalCRect = _this4.svgD3.node().getBoundingClientRect();\n\n          if (selectionInterst && !selectionInterst.empty()) {\n            selectionInterst.each(function () {\n              cRect = this.getBoundingClientRect();\n              width = Math.max(width, cRect.left - (globalCRect.left + cRect.width));\n              height = Math.max(height, cRect.top - (globalCRect.top + cRect.height));\n            });\n            width = _this4.width > width ? _this4.width : width;\n            height = _this4.height > height ? _this4.height : height;\n          } else {\n            width = _this4.width > contBBox.width ? _this4.width : contBBox.width;\n            height = _this4.height > contBBox.height ? _this4.height : contBBox.height;\n          }\n\n          x = contBBox.x + _this4.dragged.x;\n          y = contBBox.y;\n\n          _this4.nodes.makeAllTempVisible();\n\n          _this4.svgD3.classed('zoomedOut', true).transition().duration(TRANSITION_SEMI_FAST).attr('viewBox', x + ' ' + y + ' ' + width + ' ' + height);\n        })();\n      }\n    }\n  }, {\n    key: 'zoomedView',\n    value: function zoomedView() {\n      if (!this.zoomedOut) {\n        this.nodes.makeAllTempVisible(true);\n\n        this.svgD3.classed('zoomedOut', false).transition().duration(TRANSITION_SEMI_FAST).attr('viewBox', '0 0 ' + this.width + ' ' + this.height);\n      }\n    }\n  }, {\n    key: 'toggleView',\n    value: function toggleView() {\n      if (this.zoomedOut) {\n        this.zoomedOut = false;\n        this.zoomedView();\n      } else {\n        this.globalView();\n        this.zoomedOut = true;\n      }\n    }\n\n    /**\n     * Check if an element is actually visible, i.e. within the boundaries of the\n     * SVG element.\n     *\n     * @method  isHidden\n     * @author  Fritz Lekschas\n     * @date    2016-02-24\n     * @param   {Object}    el  DOM element to be checked.\n     * @return  {Boolean}       If `true` element is not visible.\n     */\n\n  }, {\n    key: 'isHidden',\n    value: function isHidden(el) {\n      var boundingRect = el.getBoundingClientRect();\n      return boundingRect.top + boundingRect.height <= this.top || boundingRect.left + boundingRect.width <= this.left || boundingRect.top >= this.top + this.height || boundingRect.left >= this.left + this.width;\n    }\n\n    /**\n     * Assesses any of the two ends of a link points outwards.\n     *\n     * @description\n     * In order to be able to determine where a link points to the output of\n     * `linkPointsOutside` for the source and target location is shifted bitwise\n     * in such a way that this method return 9 unique numbers.\n     * - 0: link is completely inwards\n     * - 1: source is outwards to the top\n     * - 2: source is outwards to the bottom\n     * - 4: target is outwards to the top\n     * - 8: target is outwards to the bottom\n     * - 5: source and target are outwards to the top\n     * - 6: source is outwards to the bottom and target is outwards to the top\n     * - 9: source is outwards to the top and target is outwards to the bottom\n     * - 10: source and target are outwards to the bottom\n     *\n     * If you're asking yourself: \"WAT?!?!!\" Think of a 4x4 matrix:\n     * |    target    |    source    |\n     * | bottom | top | bottom | top |\n     * |    0   |  0  |    0   |  0  | (=0)\n     * |    0   |  0  |    0   |  1  | (=1)\n     * |    0   |  0  |    1   |  0  | (=2)\n     * |    0   |  1  |    0   |  0  | (=4)\n     * |    1   |  0  |    0   |  0  | (=8)\n     * |    0   |  1  |    0   |  1  | (=5)\n     * |    0   |  1  |    1   |  0  | (=6)\n     * |    1   |  0  |    0   |  1  | (=9)\n     * |    1   |  0  |    1   |  0  | (=10)\n     *\n     * Checker whether the source or target location is above, below or within the\n     * global SVG container is very simple. For example, to find out if the target\n     * location is above, all we need to do is `<VALUE> & 4 > 0`. This performs a\n     * bit-wise AND operation with only two possible outcomes: 4 and 0.\n     *\n     * @method  pointsOutside\n     * @author  Fritz Lekschas\n     * @date    2016-02-29\n     * @param   {Object}  data  Link data.\n     * @return  {Number}  Numberical represenation of the links constallation. See\n     *   description for details.\n     */\n\n  }, {\n    key: 'pointsOutside',\n    value: function pointsOutside(data) {\n      var source = this.linkPointsOutside(data.source);\n      var target = this.linkPointsOutside(data.target) << 2;\n      return source | target;\n    }\n\n    /**\n     * Assesses whether a link's end points outwards\n     *\n     * @method  linkPointsOutside\n     * @author  Fritz Lekschas\n     * @date    2016-02-29\n     * @param   {Object}  data  Link data.\n     * @return  {Number}  If link ends inwards returns `0`, if it points outwards\n     *   to the top returns `1` otherwise `2`.\n     */\n\n  }, {\n    key: 'linkPointsOutside',\n    value: function linkPointsOutside(data) {\n      var y = data.node.y + data.offsetY;\n      if (y + this.visData.global.row.height - this.visData.global.row.padding <= 0) {\n        return 1;\n      }\n      if (y + this.visData.global.row.padding >= this.height) {\n        return 2;\n      }\n      return 0;\n    }\n  }, {\n    key: 'area',\n    get: function get() {\n      return this.container.node().getBoundingClientRect();\n    }\n  }, {\n    key: 'dragMinX',\n    get: function get() {\n      return Math.min(0, this.width - this.area.width);\n    }\n  }, {\n    key: 'barMode',\n    get: function get() {\n      if (this.bars) {\n        return this.nodes.bars.mode;\n      }\n      return this._barMode;\n    },\n    set: function set(mode) {\n      if (this.bars) {\n        this.nodes.bars.mode = mode;\n      }\n      this._barMode = mode;\n    }\n  }], [{\n    key: 'scrollElVertically',\n    value: function scrollElVertically(el, offset) {\n      _d3.select(el).attr('transform', 'translate(0, ' + offset + ')');\n    }\n  }]);\n  return ListGraph;\n}();\n\nListGraph.version = '0.17.0';\n\nreturn ListGraph;\n\n})));"],"sourceRoot":"/source/"}