{"version":3,"sources":["listGraph.min.js"],"names":["ListGraph","$","d3","mergeSelections","selections","pushSelection","selection","each","mergedSelection","push","this","selectAll","i","length","allTransitionsEnded","transition","callback","size","n","apply","arguments","onDragDrop","dragMoveHandler","dropHandler","elsToBeDragged","orientation","limits","notWhenTrue","drag","behavior","appliedLimits","on","data","call","el","select","dragX","dragY","datum","withinLimits","value","applyingLimits","restrictedValue","undefined","Math","min","max","e","LimitsUnsupportedFormat","els","event","dx","x","style","dy","y","arrayToFakeObjs","arrayIds","fakeObjs","id","collectInclClones","node","originalNode","clone","clones","concat","isFinite","nativeIsFinite","up","depth","includeClones","child","nodesInclClones","parentsId","Object","keys","parents","j","down","childRefs","upAndDown","callbackUp","callbackDown","siblings","siblingsId","isObject","type","isFunction","objToString","funcTag","roundRect","width","height","radius","topLeft","topRight","bottomLeft","bottomRight","exponentialGradient","start","end","name","power","steps","scale","pow","exponent","stepSize","gradient","append","attr","offset","color","opacity","isObjectLike","isNative","reIsNative","test","fnToString","reIsHostCtor","getNative","object","key","isLength","MAX_SAFE_INTEGER","babelHelpers","classCallCheck","instance","Constructor","TypeError","createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","protoProps","staticProps","prototype","inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","possibleConstructorReturn","self","ReferenceError","CLASSNAME","SCROLLBAR_WIDTH","COLUMNS","ROWS","ICON_PATH","DEFAULT_SORT_ORDER","DEFAULT_BAR_MODE","HIGHLIGHT_ACTIVE_LEVEL","ACTIVE_LEVEL_NUMBER","NO_ROOTED_NODE_DIFFERENCE","TRANSITION_LIGHTNING_FAST","TRANSITION_SEMI_FAST","COLOR_NEGATIVE_RED","COLOR_POSITIVE_GREEN","ExtendableError","_Error","message","_this","getPrototypeOf","Error","captureStackTrace","_ExtendableError","SCROLLBAR_CLASS","Scrollbars","baseSelection","visData","all","parentNode","scrollbar","classed","duration","objectTypes","function","freeExports","exports","nodeType","freeModule","module","freeGlobal","global","freeSelf","freeWindow","window","root","objectProto","toString","BAR_CLASS","Bar","barGroup","barData","nodeData","bars","setupMagnitude","_this2","currentSorting","nodes","sortBy","generatePath","mode","setupBorder","row","padding","column","contentWidth","contentHeight","setupIndicatorBg","_this3","setupIndicator","class","level","cell","activeHeight","inactiveheight","enter","bind","referenceValue","indicator","adjustWidth","bottom","generateTwoBarsPath","generateOneBarPath","normValue","normIndicator","abs","BARS_CLASS","Bars","vis","that","update","barId","insertBefore","children","refBars","refBarsBg","currentBar","updateIndicator","lessAnimations","_this4","NODES_CLASS","NODE_CLASS","CLONE_CLASS","Nodes","links","events","drawFullSizeRect","className","shrinking","shrinkingAmount","currentLinks","iconDimension","groups","rows","activeScrollbar","enterHandler","leaveHandler","queryMode","nodeRooted","rootHandler","setUpFocusControls","iconPath","nodeQuery","toggleQueryMode","nodeLocks","lockHandler","barMode","clickHandler","text","focusNodes","blurNodes","nodeIds","eventHelper","highlightNodes","unhighlightNodes","toggleLock","toggleRoot","eventData","clonedFromId","broadcast","locked","unlocked","lock","unlock","rooted","unrooted","excludeClones","zoomOut","globalView","filter","hovering","zoomedView","zoomIn","optionalParams","subSelectionClass","indexOf","setFalse","d3El","lockedNode","active","inactive","unlockNode","lockNode","parseInt","query-and","query-or","query-not","queryBeforeRooting","rootedNode","updateVisibility","previousMode","queryNode","unqueryNode","levels","blur","unrootNode","focus","activeLevelNumber","noRootedNodeDifference","rootNode","hideNodes","showNodes","location","position","paddedDim","cx","cy","r","direction","nodesVisibility","show","hidden","restriction","nodeId","currentNodeData","includeParents","appliedClassName","includeChildren","currentActiveProperty","traverseCallbackUp","childData","traverseCallbackDown","highlight","traverseCallback","newSortType","svgD3","updateLevelsVisibility","updateScrollbarVisibility","local","layout","updateNodesVisibility","get","LINKS_CLASS","LINK_CLASS","Links","index","d","diagonal","_highlight","source","svg","offsetY","offsetX","projection","COLUMN_CLASS","SCROLL_CONTAINER_CLASS","Levels","highlightActiveLevel","scrollbarWidth","getBoundingClientRect","scrollHeight","scrollbarHeight","linkSelections","incoming","selectByLevel","outgoing","scrollTop","heightScale","linear","domain","range","invertedHeightScale","invert","group","empty","TOPBAR_EL","TOPBAR_CLASS","TOPBAR_CONTROL_EL","TOPBAR_CONTROL_CLASS","TOPBAR_GLOBAL_CONTROL_CLASS","Topbar","insert","controlSwitch","switchArrow","globalControls","globalPrecision","sortAllColumns","highlightBars","globalPrecisionWrapper","order","globalRecall","globalRecallWrapper","globalName","highlightLabels","globalNameWrapper","globalOneBar","switchBarMode","globalOneBarWrapper","globalTwoBars","globalTwoBarsWrapper","globalZoomOut","zoomedOut","toggleView","globalZoomOutWrapper","localControlWrapper","localControls","control","sortOrder","toggleColumn","left","controlData","sortColumn","html","toggleOptions","deHighlight","baseElD3","selectNodesLevel","semiActiveSortingEls","resetSemiActiveSortingEls","resetSortEl","columnKeys","len","newType","objectProto$2","Function","hasOwnProperty","RegExp","replace","arrayTag","objectProto$1","objToString$1","nativeIsArray","Array","isArray","LayoutNotAvailable","EventDispatcherNoFunction","_ExtendableError2","Events","_stack","dispatch","_dispatchEvent","eventName","document","createEvent","initCustomEvent","dispatchEvent","times","normTimes","Infinity","stack","splice","off","baseEl","rootNodes","options","listGraph","baseElJq","svgJq","columns","dispatcher","addClass","forceWidth","process","afterOffsetOpacity","beforeOffsetOpacity","topbar","container","scrollPreparation","scrollbars","$levels","mousewheelColumn","scrollbarMouseDown","globalMouseUp","globalMouseMove","getDragLimits","scrollbarDragging","levelId","updateAll","updateBars","updateSorting","nextLevel","oldLevel","rootNodeDepth","dragMinX","deltaY","clientY","scrollY","contentScrollTop","scroll","offsetLinks","preventDefault","selector","property","sort","switchMode","trigger","updateScrollProperties","selectionInterst","bBox","cRect","globalCRect","getBBox","top","area","_barMode","set"],"mappings":"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","file":"listGraph.min.js","sourcesContent":["/* Copyright Fritz Lekschas: D3 example visualization app using list-based graphs */\nvar ListGraph = (function ($,d3) { 'use strict';\n\n  var babelHelpers = {};\n\n  babelHelpers.classCallCheck = function (instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  };\n\n  babelHelpers.createClass = (function () {\n    function defineProperties(target, props) {\n      for (var i = 0; i < props.length; i++) {\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n      }\n    }\n\n    return function (Constructor, protoProps, staticProps) {\n      if (protoProps) defineProperties(Constructor.prototype, protoProps);\n      if (staticProps) defineProperties(Constructor, staticProps);\n      return Constructor;\n    };\n  })();\n\n  babelHelpers.inherits = function (subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n  };\n\n  babelHelpers.possibleConstructorReturn = function (self, call) {\n    if (!self) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n  };\n\n  babelHelpers;\n  var CLASSNAME = 'list-graph';\n\n  var SCROLLBAR_WIDTH = 6;\n  var COLUMNS = 5;\n  var ROWS = 5;\n\n  // An empty path is equal to inline SVG.\n  var ICON_PATH = '';\n\n  var DEFAULT_SORT_ORDER = 'desc';\n\n  var DEFAULT_BAR_MODE = 'one';\n\n  var HIGHLIGHT_ACTIVE_LEVEL = true;\n  var ACTIVE_LEVEL_NUMBER = 0;\n  var NO_ROOTED_NODE_DIFFERENCE = 0;\n\n  var TRANSITION_LIGHTNING_FAST = 150;\n  var TRANSITION_SEMI_FAST = 250;\n  // Gradient colors\n  var COLOR_NEGATIVE_RED = '#e0001c';\n  var COLOR_POSITIVE_GREEN = '#60bf00';\n\n  var ExtendableError = (function (_Error) {\n    babelHelpers.inherits(ExtendableError, _Error);\n\n    function ExtendableError(message) {\n      babelHelpers.classCallCheck(this, ExtendableError);\n\n      var _this = babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(ExtendableError).call(this, message));\n\n      _this.name = _this.constructor.name;\n      _this.message = message;\n      Error.captureStackTrace(_this, _this.constructor.name);\n      return _this;\n    }\n\n    return ExtendableError;\n  })(Error);\n\n  function mergeSelections(selections) {\n    // Create a new empty selection\n    var mergedSelection = d3.selectAll('.d3-list-graph-not-existent');\n\n    function pushSelection(selection) {\n      selection.each(function pushDomNode() {\n        mergedSelection[0].push(this);\n      });\n    }\n\n    for (var i = selections.length; i--;) {\n      pushSelection(selections[i]);\n    }\n\n    return mergedSelection;\n  }\n\n  function allTransitionsEnded(transition, callback) {\n    if (transition.size() === 0) {\n      callback();\n    }\n    var n = 0;\n    transition.each(function () {\n      return ++n;\n    }).each('end', function () {\n      if (! --n) callback.apply(this, arguments);\n    });\n  }\n\n  var LimitsUnsupportedFormat = (function (_ExtendableError) {\n    babelHelpers.inherits(LimitsUnsupportedFormat, _ExtendableError);\n\n    function LimitsUnsupportedFormat(message) {\n      babelHelpers.classCallCheck(this, LimitsUnsupportedFormat);\n      return babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(LimitsUnsupportedFormat).call(this, message || 'The limits are wrongly formatted. Please provide an ' + 'object of the following format: `{ x: { min: 0, max: 1 }, y: { min: ' + '0, max: 1 } }`'));\n    }\n\n    return LimitsUnsupportedFormat;\n  })(ExtendableError);\n\n  /**\n   * Drap and drop event handler that works via translation.\n   *\n   * @method  onDragDrop\n   * @author  Fritz Lekschas\n   * @date    2016-01-23\n   * @param   {Object}  selection        D3 selection to listen for the drag\n   *   event.\n   * @param   {Object}           dragMoveHandler  Handler for drag-move.\n   * @param   {Object}           dropHandler      Handler for drag-end, i.e. drop.\n   * @param   {Array}            elsToBeDragged   Array of D3 selections to be\n   *   moved according to the drag event. If empty or undefined `selection` will\n   *   be used.\n   * @param   {String}           orientation      Can either be \"horizontal\",\n   *   \"vertical\" or `undefined`, i.e. both directions.\n   * @param   {Object|Function}  limits           X and Y drag limits. E.g.\n   *   `{ x: { min: 0, max: 10 } }`.\n   * @param   {Array}             notWhenTrue     List if function returning a\n   *   Boolean value which should prevent the dragMoveHandler from working.\n   */\n  function onDragDrop(selection, dragMoveHandler, dropHandler, elsToBeDragged, orientation, limits, notWhenTrue) {\n    var drag = d3.behavior.drag();\n\n    var appliedLimits = limits || {}; // eslint-disable-line no-param-reassign\n\n    if (dragMoveHandler) {\n      drag.on('drag', function (data) {\n        if (typeof limits === 'function') {\n          appliedLimits = limits();\n        }\n        dragMoveHandler.call(this, data, elsToBeDragged, orientation, appliedLimits, notWhenTrue);\n      });\n    }\n\n    if (dropHandler) {\n      drag.on('dragend', function (data) {\n        dropHandler.call(this, data, elsToBeDragged, orientation, appliedLimits, notWhenTrue);\n      });\n    }\n\n    selection.each(function (data) {\n      var el = d3.select(this);\n\n      // Set default data if not available.\n      if (!data) {\n        data = { dragX: 0, dragY: 0 }; // eslint-disable-line no-param-reassign\n        el.datum(data);\n      }\n\n      // Add drag event handler\n      el.call(drag);\n    });\n  }\n\n  function dragMoveHandler(data, elsToBeDragged, orientation, limits, notWhenTrue) {\n    for (var i = notWhenTrue.length; i--;) {\n      if (notWhenTrue[i]()) {\n        return;\n      }\n    }\n\n    var els = d3.select(this);\n\n    if (elsToBeDragged && elsToBeDragged.length) {\n      els = mergeSelections(elsToBeDragged);\n    }\n\n    function withinLimits(value, applyingLimits) {\n      var restrictedValue = undefined;\n\n      if (applyingLimits) {\n        try {\n          restrictedValue = Math.min(applyingLimits.max, Math.max(applyingLimits.min, value));\n        } catch (e) {\n          throw new LimitsUnsupportedFormat();\n        }\n      }\n      return restrictedValue;\n    }\n\n    if (orientation === 'horizontal' || orientation === 'vertical') {\n      if (orientation === 'horizontal') {\n        data.dragX += d3.event.dx;\n        data.dragX = withinLimits(data.dragX + d3.event.dx, limits.x);\n        els.style('transform', 'translateX(' + data.dragX + 'px)');\n      }\n      if (orientation === 'vertical') {\n        data.dragY += d3.event.dy;\n        data.dragX = withinLimits(data.dragY + d3.event.dy, limits.y);\n        els.style('transform', 'translateY(' + data.dragY + 'px)');\n      }\n    } else {\n      data.dragX += d3.event.dx;\n      data.dragY += d3.event.dy;\n      els.style('transform', 'translate(' + data.dragX + 'px,' + data.dragY + 'px)');\n    }\n  }\n\n  var SCROLLBAR_CLASS = 'scrollbar';\n\n  var Scrollbars = (function () {\n    function Scrollbars(baseSelection, visData, width) {\n      babelHelpers.classCallCheck(this, Scrollbars);\n\n      this.visData = visData;\n      this.width = width;\n\n      // Add empty scrollbar element\n      this.all = baseSelection.append('rect').attr('class', SCROLLBAR_CLASS).call(function (selection) {\n        selection.each(function setScrollBarDomElement() {\n          d3.select(this.parentNode).datum().scrollbar.el = this;\n        });\n      }).attr('x', function (data) {\n        return data.scrollbar.x - 2;\n      }).attr('y', function (data) {\n        return data.scrollbar.y;\n      }).attr('width', this.width).attr('height', function (data) {\n        return data.scrollbar.height;\n      }).attr('rx', this.width / 2).attr('ry', this.width / 2).classed('ready', true);\n    }\n\n    babelHelpers.createClass(Scrollbars, [{\n      key: 'updateVisibility',\n      value: function updateVisibility() {\n        this.all.transition().duration(TRANSITION_LIGHTNING_FAST).attr({\n          x: function x(data) {\n            return data.scrollbar.x;\n          },\n          height: function height(data) {\n            return data.scrollbar.height;\n          }\n        });\n      }\n    }]);\n    return Scrollbars;\n  })();\n\n  /**\n   * Turns an array of IDs into an array of objects holding the ID.\n   *\n   * @description\n   * We need to translate the array of objects into an array of fake objects in\n   * order to easily match the links to be highlighted.\n   *\n   * Using this method selection can be matched easily via the array of fake\n   * objects:\n   *\n   * ```\n   * this.links\n   *   .data(arrayToFakeObjs([1, 2, 3]), data => data)\n   *   .classed('highlight', highlight === false ? false : true);\n   * ```\n   *\n   * @method  arrayToFakeObjs\n   * @author  Fritz Lekschas\n   * @date    2015-12-23\n   * @param   {Array}  arrayIds  Array of IDs.\n   * @return  {Array}            Array of objects holding the ID. E.g. `[1]` will\n   *   be translated into `[{ id: 1 }]`.\n   */\n  function arrayToFakeObjs(arrayIds) {\n    var fakeObjs = [];\n\n    for (var i = arrayIds.length; i--;) {\n      fakeObjs.push({ id: arrayIds[i] });\n    }\n\n    return fakeObjs;\n  }\n\n  /**\n   * Collect all cloned nodes, including the original node.\n   *\n   * @method  collectInclClones\n   * @author  Fritz Lekschas\n   * @date    2015-12-30\n   * @param   {Object}  node  Start node\n   * @return  {Array}         Array of original and cloned nodes.\n   */\n  function collectInclClones(node) {\n    var originalNode = node;\n\n    if (node.clone) {\n      originalNode = node.originalNode;\n    }\n\n    var clones = [originalNode];\n\n    if (originalNode.clones.length) {\n      clones = clones.concat(originalNode.clones);\n    }\n\n    return clones;\n  }\n\n  /** Used to determine if values are of the language type `Object`. */\n  var objectTypes = {\n    'function': true,\n    'object': true\n  };\n\n  /** Detect free variable `exports`. */\n  var freeExports = objectTypes[typeof exports] && exports && !exports.nodeType && exports;\n\n  /** Detect free variable `module`. */\n  var freeModule = objectTypes[typeof module] && module && !module.nodeType && module;\n\n  /** Detect free variable `global` from Node.js. */\n  var freeGlobal = freeExports && freeModule && typeof global == 'object' && global && global.Object && global;\n\n  /** Detect free variable `self`. */\n  var freeSelf = objectTypes[typeof self] && self && self.Object && self;\n\n  /** Detect free variable `window`. */\n  var freeWindow = objectTypes[typeof window] && window && window.Object && window;\n\n  /**\n   * Used as a reference to the global object.\n   *\n   * The `this` value is used if it's the global object to avoid Greasemonkey's\n   * restricted `window` object, otherwise the `window` object is used.\n   */\n  var root = freeGlobal || ((freeWindow !== (this && this.window)) && freeWindow) || freeSelf || this;\n\n  /* Native method references for those with the same name as other `lodash` methods. */\n  var nativeIsFinite = root.isFinite;\n\n  /**\n   * Checks if `value` is a finite primitive number.\n   *\n   * **Note:** This method is based on [`Number.isFinite`](http://ecma-international.org/ecma-262/6.0/#sec-number.isfinite).\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is a finite number, else `false`.\n   * @example\n   *\n   * _.isFinite(10);\n   * // => true\n   *\n   * _.isFinite('10');\n   * // => false\n   *\n   * _.isFinite(true);\n   * // => false\n   *\n   * _.isFinite(Object(10));\n   * // => false\n   *\n   * _.isFinite(Infinity);\n   * // => false\n   */\n  function isFinite(value) {\n    return typeof value == 'number' && nativeIsFinite(value);\n  }\n\n  function up(node, callback, depth, includeClones, child) {\n    var nodesInclClones = includeClones ? collectInclClones(node) : [node];\n\n    for (var i = nodesInclClones.length; i--;) {\n      if (child) {\n        callback(nodesInclClones[i], child);\n      }\n\n      if (!isFinite(depth) || depth > 0) {\n        var parentsId = Object.keys(nodesInclClones[i].parents);\n        for (var j = parentsId.length; j--;) {\n          up(nodesInclClones[i].parents[parentsId[j]], callback, depth - 1, includeClones, nodesInclClones[i]);\n        }\n      }\n    }\n  }\n\n  function down(node, callback, depth, includeClones) {\n    var nodesInclClones = includeClones ? collectInclClones(node) : [node];\n\n    for (var i = nodesInclClones.length; i--;) {\n      callback(nodesInclClones[i]);\n\n      if (!isFinite(depth) || depth > 0) {\n        for (var j = nodesInclClones[i].childRefs.length; j--;) {\n          down(nodesInclClones[i].childRefs[j], callback, depth - 1, includeClones);\n        }\n      }\n    }\n  }\n\n  function upAndDown(node, callbackUp, callbackDown, depth, includeClones) {\n    if (callbackDown) {\n      up(node, callbackUp, depth, includeClones);\n      down(node, callbackDown, depth, includeClones);\n    } else {\n      up(node, callbackUp, depth, includeClones);\n      down(node, callbackUp, depth, includeClones);\n    }\n  }\n\n  function siblings(node, callback) {\n    var parentsId = Object.keys(node.parents);\n    for (var i = parentsId.length; i--;) {\n      for (var j = node.parents[parentsId[i]].childRefs.length; j--;) {\n        callback(node.parents[parentsId[i]].childRefs[j]);\n      }\n    }\n    // The root node doesn't have a `parents` property but might have `siblings`.\n    if (node.siblings) {\n      var siblingsId = Object.keys(node.siblings);\n      for (var i = siblingsId.length; i--;) {\n        callback(node.siblings[siblingsId[i]]);\n      }\n    }\n  }\n\n  /**\n   * Checks if `value` is the [language type](https://es5.github.io/#x8) of `Object`.\n   * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n   * @example\n   *\n   * _.isObject({});\n   * // => true\n   *\n   * _.isObject([1, 2, 3]);\n   * // => true\n   *\n   * _.isObject(1);\n   * // => false\n   */\n  function isObject(value) {\n    // Avoid a V8 JIT bug in Chrome 19-20.\n    // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.\n    var type = typeof value;\n    return !!value && (type == 'object' || type == 'function');\n  }\n\n  /** `Object#toString` result references. */\n  var funcTag = '[object Function]';\n\n  /** Used for native method references. */\n  var objectProto = Object.prototype;\n\n  /**\n   * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n   * of values.\n   */\n  var objToString = objectProto.toString;\n\n  /**\n   * Checks if `value` is classified as a `Function` object.\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n   * @example\n   *\n   * _.isFunction(_);\n   * // => true\n   *\n   * _.isFunction(/abc/);\n   * // => false\n   */\n  function isFunction(value) {\n    // The use of `Object#toString` avoids issues with the `typeof` operator\n    // in older versions of Chrome and Safari which return 'function' for regexes\n    // and Safari 8 which returns 'object' for typed array constructors.\n    return isObject(value) && objToString.call(value) == funcTag;\n  }\n\n  // Credits go to Mike Bostock: http://bl.ocks.org/mbostock/3468167\n  function roundRect(x, y, width, height, radius) {\n    var topLeft = radius.topLeft || 0;\n    var topRight = radius.topRight || 0;\n    var bottomLeft = radius.bottomLeft || 0;\n    var bottomRight = radius.bottomRight || 0;\n\n    return 'M' + (x + topLeft) + ',' + y + 'h' + (width - topLeft - topRight) + 'a' + topRight + ',' + topRight + ' 0 0 1 ' + topRight + ',' + topRight + 'v' + (height - (topRight + bottomRight)) + 'a' + bottomRight + ',' + bottomRight + ' 0 0 1 ' + -bottomRight + ',' + bottomRight + 'h' + (bottomLeft - (width - bottomRight)) + 'a' + bottomLeft + ',' + bottomLeft + ' 0 0 1 ' + -bottomLeft + ',' + -bottomLeft + 'v' + (topLeft - (height - bottomLeft)) + 'a' + topLeft + ',' + topLeft + ' 0 0 1 ' + topLeft + ',' + -topLeft + 'z';\n  }\n\n  var BAR_CLASS = 'bar';\n\n  var Bar = (function () {\n    function Bar(barGroup, barData, nodeData, visData, bars) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Bar);\n\n      this.data = barData;\n      this.nodeData = nodeData;\n      this.visData = visData;\n      this.bars = bars;\n\n      this.data.x = nodeData.x;\n      this.data.level = nodeData.depth;\n\n      this.height = this.visData.global.row.contentHeight / (this.data.length * 2) - this.visData.global.cell.padding * 2;\n\n      this.activeHeight = this.visData.global.row.contentHeight - 2;\n\n      this.inactiveheight = this.visData.global.cell.padding * 2 - 1;\n\n      this.selection = barGroup.selectAll(BAR_CLASS).data(this.data).enter().append('g').attr('class', function (data) {\n        return BAR_CLASS + ' ' + data.id;\n      }).classed('active', function (data) {\n        return data.id === _this.visData.nodes[_this.nodeData.depth].sortBy;\n      });\n\n      // Local helper method to avoid code duplication.\n      // Calling a class method from within the consructor is possible but `this`\n      // is not available. Thus, we need to create local function and pass in\n      // `this` as `that`, which feels very hacky but it works.\n      function setupMagnitude(selection) {\n        var _this2 = this;\n\n        var currentSorting = this.visData.nodes[this.nodeData.depth].sortBy;\n\n        selection.attr('d', function (data) {\n          return Bar.generatePath(data, _this2.bars.mode, currentSorting, _this2.visData);\n        }).classed('bar-magnitude', true);\n      }\n\n      function setupBorder(selection) {\n        selection.attr('x', 0).attr('y', this.visData.global.row.padding).attr('width', this.visData.global.column.contentWidth).attr('height', this.visData.global.row.contentHeight).attr('rx', 2).attr('ry', 2).classed('bar-border', true);\n      }\n\n      function setupIndicatorBg(selection) {\n        var _this3 = this;\n\n        selection.attr('d', function (data) {\n          return Bar.generatePath(data, _this3.bars.mode, undefined, _this3.visData, data.value);\n        }).classed('bar-indicator-bg', true);\n      }\n\n      function setupIndicator(selection) {\n        selection.attr({\n          class: 'bar-indicator',\n          x: 0,\n          y: this.visData.global.row.padding,\n          width: 2,\n          height: this.visData.global.row.contentHeight\n        });\n      }\n\n      this.selection.append('rect').call(setupBorder.bind(this));\n\n      this.selection.append('path').call(setupMagnitude.bind(this));\n\n      this.selection.append('path').call(setupIndicatorBg.bind(this));\n\n      this.selection.append('rect').call(setupIndicator.bind(this));\n    }\n\n    babelHelpers.createClass(Bar, null, [{\n      key: 'updateIndicator',\n      value: function updateIndicator(selection, contentWidth, referenceValue) {\n        selection.attr('x', Math.min(contentWidth * Math.min(referenceValue, 1), contentWidth - 2)).classed('positive', function (data) {\n          return data.value >= referenceValue;\n        });\n      }\n    }, {\n      key: 'generatePath',\n      value: function generatePath(data, mode, currentSorting, visData, indicator, adjustWidth, bottom) {\n        if (mode === 'two') {\n          return Bar.generateTwoBarsPath(data, visData, bottom);\n        }\n        return Bar.generateOneBarPath(data, currentSorting, visData, indicator, adjustWidth);\n      }\n    }, {\n      key: 'generateOneBarPath',\n      value: function generateOneBarPath(data, currentSorting, visData, indicator, adjustWidth) {\n        var height = visData.global.row.contentHeight;\n        var normValue = Math.min(data.value, 1);\n        var normIndicator = Math.min(indicator, 1);\n\n        var x = 0;\n        var width = 2;\n\n        var radius = {\n          topLeft: 2,\n          bottomLeft: 2\n        };\n\n        if (indicator) {\n          radius = {};\n        }\n\n        if (data.id !== currentSorting && typeof indicator === 'undefined') {\n          x = normValue * visData.global.column.contentWidth - 3;\n          radius = {};\n        } else if (indicator) {\n          x = normIndicator * visData.global.column.contentWidth;\n          if (adjustWidth) {\n            if (normValue < normIndicator) {\n              x = normValue * visData.global.column.contentWidth;\n            }\n            width = Math.max(Math.abs(normIndicator - normValue) * visData.global.column.contentWidth, 2);\n          }\n        } else {\n          width = visData.global.column.contentWidth * normValue;\n        }\n\n        x = Math.min(x, visData.global.column.contentWidth - 2);\n\n        return roundRect(x, visData.global.row.padding, width, height, radius);\n      }\n    }, {\n      key: 'generateTwoBarsPath',\n      value: function generateTwoBarsPath(data, visData, bottom) {\n        var normValue = Math.min(data.value, 1);\n        var height = visData.global.row.contentHeight / 2;\n        var width = visData.global.column.contentWidth * normValue;\n\n        var y = visData.global.row.padding;\n        var radius = { topLeft: 2 };\n\n        if (bottom) {\n          radius = { bottomLeft: 2 };\n          y += height;\n        }\n\n        return roundRect(0, y, width, height, radius);\n      }\n    }]);\n    return Bar;\n  })();\n\n  var BARS_CLASS = 'bars';\n\n  var Bars = (function () {\n    function Bars(vis, selection, mode, visData) {\n      babelHelpers.classCallCheck(this, Bars);\n\n      var that = this;\n\n      this.vis = vis;\n      this.mode = mode;\n      this.visData = visData;\n\n      this.selection = selection.append('g').attr('class', BARS_CLASS);\n\n      this.selection.each(function (datum) {\n        new Bar(d3.select(this), datum.data.bars, datum, that.visData, that);\n      });\n    }\n\n    babelHelpers.createClass(Bars, [{\n      key: 'updateAll',\n      value: function updateAll(update, sortBy) {\n        var _this = this;\n\n        this.selection.selectAll('.bar-magnitude').data(update, function (data) {\n          return data.barId;\n        }).transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n          return Bar.generatePath(data, _this.mode, sortBy, _this.visData);\n        });\n      }\n    }, {\n      key: 'update',\n      value: function update(selection, sortBy) {\n        var _this2 = this;\n\n        selection.each(function (data) {\n          var el = d3.select(this);\n\n          if (data.id === sortBy && !el.classed('active')) {\n            el.classed('active', true);\n            // Ensure that the active bars we are places before any other bar,\n            // thus placing them in the background\n            this.parentNode.insertBefore(this, this.parentNode.children[0]);\n          }\n\n          if (data.id !== sortBy) {\n            el.classed('active', false);\n          }\n        });\n\n        selection.selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n          return Bar.generatePath(data, _this2.mode, sortBy, _this2.visData);\n        });\n      }\n    }, {\n      key: 'updateIndicator',\n      value: function updateIndicator(refBars, refBarsBg, currentBar, referenceValue) {\n        var _this3 = this;\n\n        Bar.updateIndicator(currentBar, this.visData.global.column.contentWidth, referenceValue);\n\n        Bar.updateIndicator(refBars, this.visData.global.column.contentWidth, referenceValue);\n\n        refBarsBg.attr('d', function (data) {\n          return Bar.generatePath(data, _this3.mode, undefined, _this3.visData, referenceValue);\n        }).classed('positive', function (data) {\n          return data.value >= referenceValue;\n        });\n\n        var transition = refBarsBg;\n\n        if (!this.vis.lessAnimations) {\n          transition = refBarsBg.transition().duration(TRANSITION_SEMI_FAST);\n        }\n\n        transition.attr('d', function (data) {\n          return Bar.generatePath(data, _this3.mode, undefined, _this3.visData, referenceValue, true);\n        });\n      }\n    }, {\n      key: 'switchMode',\n      value: function switchMode(mode, currentSorting) {\n        var _this4 = this;\n\n        if (this.mode !== mode) {\n          if (mode === 'one') {\n            if (currentSorting.global.type) {\n              this.selection.selectAll('.bar').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n                return Bar.generateOneBarPath(data, currentSorting.global.type, _this4.visData);\n              });\n            } else {\n              // console.error(\n              //   'Switching magnitude visualization after individual sorting is ' +\n              //   'not supported yet.'\n              // );\n            }\n          }\n\n          if (mode === 'two') {\n            this.selection.selectAll('.bar.precision').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n              return Bar.generateTwoBarsPath(data, _this4.visData);\n            });\n\n            this.selection.selectAll('.bar.recall').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n              return Bar.generateTwoBarsPath(data, _this4.visData, true);\n            });\n          }\n\n          this.mode = mode;\n        }\n      }\n    }]);\n    return Bars;\n  })();\n\n  var NODES_CLASS = 'nodes';\n  var NODE_CLASS = 'node';\n  var CLONE_CLASS = 'clone';\n\n  var Nodes = (function () {\n    function Nodes(vis, baseSelection, visData, links, events) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Nodes);\n\n      var that = this;\n\n      // Helper\n      function drawFullSizeRect(selection, className, shrinking) {\n        var shrinkingAmount = shrinking ? shrinking : 0;\n\n        selection.attr('x', shrinkingAmount).attr('y', that.visData.global.row.padding + shrinkingAmount).attr('width', that.visData.global.column.contentWidth - 2 * shrinkingAmount).attr('height', that.visData.global.row.contentHeight - 2 * shrinkingAmount).attr('rx', 2 - shrinkingAmount).attr('ry', 2 - shrinkingAmount).classed(className, true);\n      }\n\n      this.vis = vis;\n      this.visData = visData;\n      this.links = links;\n      this.events = events;\n      this.currentLinks = {};\n      this.iconDimension = Math.min(this.visData.global.row.contentHeight / 2 - this.visData.global.cell.padding * 2, this.visData.global.column.padding / 2 - 4);\n\n      this.groups = baseSelection.append('g').attr('class', NODES_CLASS).call(function (selection) {\n        selection.each(function storeLinkToGroupNode() {\n          d3.select(this.parentNode).datum().nodes = this;\n        });\n      });\n\n      this.nodes = this.groups.selectAll('.' + NODE_CLASS).data(function (data) {\n        return data.rows;\n      }).enter().append('g').classed(NODE_CLASS, true).classed(CLONE_CLASS, function (data) {\n        return data.clone;\n      }).attr('transform', function (data) {\n        return 'translate(' + (data.x + _this.visData.global.column.padding) + ', ' + data.y + ')';\n      }).on('mouseenter', function (data) {\n        var el = d3.select(this);\n\n        if (!!!that.vis.activeScrollbar) {\n          that.enterHandler.call(that, this, data);\n        }\n\n        if (!el.classed('rooted')) {\n          el.selectAll('.bg-extension').style('transform', 'translateX(' + -(that.iconDimension * 2 + 10) + 'px)');\n        }\n      }).on('mouseleave', function (data) {\n        var el = d3.select(this);\n\n        if (!!!that.vis.activeScrollbar) {\n          that.leaveHandler.call(that, this, data);\n        }\n\n        if (!el.classed('rooted')) {\n          if (data.data.queryMode) {\n            el.selectAll('.bg-extension').style('transform', 'translateX(' + (-that.iconDimension - 6) + 'px)');\n          } else {\n            el.selectAll('.bg-extension').style('transform', 'translateX(0px)');\n          }\n        }\n      });\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'bg-extension').attr('width', Math.max(this.visData.global.column.padding + this.visData.global.column.contentWidth / 2, this.visData.global.column.contentWidth));\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'bg-border');\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'bg', 1);\n\n      // Rooting icons\n      var nodeRooted = this.nodes.append('g').attr('class', 'focus-controls root inactive').on('click', function clickHandler(data) {\n        that.rootHandler.call(that, this, data);\n      });\n\n      nodeRooted.append('rect').call(this.setUpFocusControls.bind(this), 'left', 2, 'hover-helper', 'hover-helper');\n\n      nodeRooted.append('svg').call(this.setUpFocusControls.bind(this), 'left', 2, 'icon', 'ease-all state-inactive invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#unlocked');\n\n      nodeRooted.append('svg').call(this.setUpFocusControls.bind(this), 'left', 2, 'icon', 'ease-all state-active invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#locked');\n\n      // Rooting icons\n      var nodeQuery = this.nodes.append('g').attr('class', 'focus-controls query inactive').on('click', function (data) {\n        that.toggleQueryMode.call(that, this.parentNode, data);\n      });\n\n      nodeQuery.append('rect').call(this.setUpFocusControls.bind(this), 'left', 1, 'hover-helper', 'hover-helper');\n\n      nodeQuery.append('svg').call(this.setUpFocusControls.bind(this), 'left', 1, 'icon', 'ease-all state-inactive invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#set-inactive');\n\n      nodeQuery.append('svg').call(this.setUpFocusControls.bind(this), 'left', 1, 'icon', 'ease-all state-and-or invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#union');\n\n      nodeQuery.append('svg').call(this.setUpFocusControls.bind(this), 'left', 1, 'icon', 'ease-all state-not invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#not');\n\n      var nodeLocks = this.nodes.append('g').attr('class', 'focus-controls lock inactive').on('click', function clickHandler(data) {\n        that.lockHandler.call(that, this, data);\n      });\n\n      nodeLocks.append('circle').call(this.setUpFocusControls.bind(this), 'right', 0, 'bg', 'bg');\n\n      nodeLocks.append('svg').call(this.setUpFocusControls.bind(this), 'right', 0, 'icon', 'ease-all state-inactive invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#unlocked');\n\n      nodeLocks.append('svg').call(this.setUpFocusControls.bind(this), 'right', 0, 'icon', 'ease-all state-active invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#locked');\n\n      this.bars = new Bars(this.vis, this.nodes, this.vis.barMode, this.visData);\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'border');\n\n      // Add node label\n      this.nodes.call(function (selection) {\n        selection.append('foreignObject').attr('x', _this.visData.global.cell.padding).attr('y', _this.visData.global.row.padding + _this.visData.global.cell.padding).attr('width', _this.visData.global.column.contentWidth).attr('height', _this.visData.global.row.contentHeight - _this.visData.global.cell.padding * 2).attr('class', 'label-wrapper').on('click', function clickHandler(data) {\n          that.clickHandler.call(that, this, data);\n        }).append('xhtml:div').attr('class', 'label').attr('title', function (data) {\n          return data.data.name;\n        }).style('line-height', _this.visData.global.row.contentHeight - _this.visData.global.cell.padding * 2 + 'px').append('xhtml:span').text(function (data) {\n          return data.data.name;\n        });\n      });\n\n      if (isFunction(this.events.on)) {\n        // this.events.on('d3ListGraphNodeClick', dataSetIds => {\n        //   console.log('d3ListGraphNodeClick', dataSetIds);\n        // });\n\n        this.events.on('d3ListGraphFocusNodes', function (event) {\n          return _this.focusNodes(event);\n        });\n\n        this.events.on('d3ListGraphBlurNodes', function (event) {\n          return _this.blurNodes(event);\n        });\n\n        this.events.on('d3ListGraphNodeEnter', function (nodeIds) {\n          return _this.eventHelper(nodeIds, _this.highlightNodes);\n        });\n\n        this.events.on('d3ListGraphNodeLeave', function (nodeIds) {\n          return _this.eventHelper(nodeIds, _this.unhighlightNodes);\n        });\n\n        this.events.on('d3ListGraphNodeLock', function (nodeIds) {\n          return _this.eventHelper(nodeIds, _this.toggleLock, [], '.lock');\n        });\n\n        this.events.on('d3ListGraphNodeUnlock', function (nodeIds) {\n          return _this.eventHelper(nodeIds, _this.toggleLock, [true], '.lock');\n        });\n\n        this.events.on('d3ListGraphNodeRoot', function (data) {\n          return _this.eventHelper(data.nodeIds, _this.toggleRoot, [], '.root');\n        });\n\n        this.events.on('d3ListGraphNodeUnroot', function (data) {\n          return _this.eventHelper(data.nodeIds, _this.toggleRoot, [true], '.root');\n        });\n      }\n    }\n\n    babelHelpers.createClass(Nodes, [{\n      key: 'clickHandler',\n      value: function clickHandler(el, data) {\n        this.toggleQueryMode(el.parentNode, data);\n        // this.events.broadcast('d3ListGraphNodeClick', { id: data.id });\n      }\n    }, {\n      key: 'enterHandler',\n      value: function enterHandler(el, data) {\n        this.highlightNodes(el, data);\n\n        var eventData = {\n          id: data.id,\n          clone: false,\n          clonedFromId: undefined\n        };\n\n        if (data.clone) {\n          eventData.clone = true;\n          eventData.clonedFromId = data.originalNode.id;\n        }\n\n        this.events.broadcast('d3ListGraphNodeEnter', eventData);\n      }\n    }, {\n      key: 'leaveHandler',\n      value: function leaveHandler(el, data) {\n        this.unhighlightNodes(el, data);\n\n        var eventData = {\n          id: data.id,\n          clone: false,\n          clonedFromId: undefined\n        };\n\n        if (data.clone) {\n          eventData.clone = true;\n          eventData.clonedFromId = data.originalNode.id;\n        }\n\n        this.events.broadcast('d3ListGraphNodeLeave', eventData);\n      }\n    }, {\n      key: 'lockHandler',\n      value: function lockHandler(el) {\n        var events = this.toggleLock(el);\n\n        if (events.locked && events.unlocked) {\n          if (events.locked) {\n            this.events.broadcast('d3ListGraphNodeLockChange', {\n              lock: {\n                id: events.locked.id,\n                clone: events.locked.clone,\n                clonedFromId: events.locked.clone ? events.locked.originalNode.id : undefined\n              },\n              unlock: {\n                id: events.unlocked.id,\n                clone: events.unlocked.clone,\n                clonedFromId: events.unlocked.clone ? events.unlocked.originalNode.id : undefined\n              }\n            });\n          }\n        } else {\n          if (events.locked) {\n            this.events.broadcast('d3ListGraphNodeLock', {\n              id: events.locked.id,\n              clone: events.locked.clone,\n              clonedFromId: events.locked.clone ? events.locked.originalNode.id : undefined\n            });\n          }\n\n          if (events.unlocked) {\n            this.events.broadcast('d3ListGraphNodeUnlock', {\n              id: events.unlocked.id,\n              clone: events.unlocked.clone,\n              clonedFromId: events.unlocked.clone ? events.unlocked.originalNode.id : undefined\n            });\n          }\n        }\n      }\n    }, {\n      key: 'rootHandler',\n      value: function rootHandler(el) {\n        var events = this.toggleRoot(el);\n\n        if (events.rooted && events.unrooted) {\n          this.events.broadcast('d3ListGraphNodeReroot', {\n            rooted: {\n              id: events.rooted.id,\n              clone: events.rooted.clone,\n              clonedFromId: events.rooted.clone ? events.rooted.originalNode.id : undefined\n            },\n            unrooted: {\n              id: events.unrooted.id,\n              clone: events.unrooted.clone,\n              clonedFromId: events.unrooted.clone ? events.unrooted.originalNode.id : undefined\n            }\n          });\n        } else {\n          if (events.rooted) {\n            this.events.broadcast('d3ListGraphNodeRoot', {\n              id: events.rooted.id,\n              clone: events.rooted.clone,\n              clonedFromId: events.rooted.clone ? events.rooted.originalNode.id : undefined\n            });\n          }\n\n          if (events.unrooted) {\n            this.events.broadcast('d3ListGraphNodeUnroot', {\n              id: events.unrooted.id,\n              clone: events.unrooted.clone,\n              clonedFromId: events.unrooted.clone ? events.unrooted.originalNode.id : undefined\n            });\n          }\n        }\n\n        this.events.broadcast('d3ListGraphUpdateBarsRequest', {\n          id: events.rooted.id,\n          clone: events.rooted.clone,\n          clonedFromId: events.rooted.clone ? events.rooted.originalNode.id : undefined\n        });\n      }\n    }, {\n      key: 'focusNodes',\n      value: function focusNodes(event) {\n        this.eventHelper(event.nodeIds, this.highlightNodes, ['focus', 'directParentsOnly', !!event.excludeClones ? true : false]);\n        if (event.zoomOut) {\n          this.vis.globalView(this.nodes.filter(function (data) {\n            return data.hovering > 0;\n          }));\n        } else {\n          this.vis.zoomedView();\n        }\n      }\n    }, {\n      key: 'blurNodes',\n      value: function blurNodes(event) {\n        this.eventHelper(event.nodeIds, this.unhighlightNodes, ['focus', 'directParentsOnly', !!event.excludeClones ? true : false]);\n        if (event.zoomIn) {\n          this.vis.zoomedView();\n        }\n      }\n    }, {\n      key: 'eventHelper',\n      value: function eventHelper(nodeIds, callback, optionalParams, subSelectionClass) {\n        var that = this;\n\n        this.nodes\n        // Filter by node ID\n        .filter(function (data) {\n          return !! ~nodeIds.indexOf(data.id);\n        }).each(function triggerCallback(data) {\n          var el = this;\n\n          if (subSelectionClass) {\n            el = d3.select(this).select(subSelectionClass).node();\n          }\n\n          callback.apply(that, [el, data].concat(optionalParams ? optionalParams : []));\n        });\n      }\n    }, {\n      key: 'toggleLock',\n      value: function toggleLock(el, nodeData, setFalse) {\n        var d3El = d3.select(el);\n        var data = d3El.datum();\n        var events = { locked: false, unlocked: false };\n\n        if (this.lockedNode) {\n          if (this.lockedNode.datum().id === data.id) {\n            this.lockedNode.classed({ active: false, inactive: true });\n            this.unlockNode(this.lockedNode.datum().id);\n            events.unlocked = this.lockedNode.datum();\n            this.lockedNode = undefined;\n          } else {\n            // Reset previously locked node;\n            this.lockedNode.classed({ active: false, inactive: true });\n            this.unlockNode(this.lockedNode.datum().id);\n            events.unlocked = this.lockedNode.datum();\n\n            if (!setFalse) {\n              d3El.classed({ active: true, inactive: false });\n              this.lockNode(data.id);\n              events.locked = data;\n              this.lockedNode = d3El;\n            }\n          }\n        } else {\n          if (!setFalse) {\n            d3El.classed({ active: true, inactive: false });\n            this.lockNode(data.id);\n            events.locked = data;\n            this.lockedNode = d3El;\n          }\n        }\n\n        return events;\n      }\n    }, {\n      key: 'lockNode',\n      value: function lockNode(id) {\n        var that = this;\n        var els = this.nodes.filter(function (data) {\n          return data.id === id;\n        });\n\n        els.each(function triggerHighlighter(data) {\n          that.highlightNodes(this, data, 'lock', undefined);\n        });\n\n        els.selectAll('.bg-border').transition().duration(TRANSITION_SEMI_FAST).attr('width', function width() {\n          return parseInt(d3.select(this).attr('width'), 10) + that.visData.global.row.height / 2;\n        });\n      }\n    }, {\n      key: 'unlockNode',\n      value: function unlockNode(id) {\n        var that = this;\n        var els = this.nodes.filter(function (data) {\n          return data.id === id;\n        });\n        var start = function animationStart() {\n          d3.select(this.parentNode).classed('animating', true);\n        };\n        var end = function animationEnd() {\n          d3.select(this.parentNode).classed('animating', false);\n        };\n\n        els.selectAll('.bg-border').transition().duration(TRANSITION_SEMI_FAST).attr('width', this.visData.global.column.contentWidth).each('start', start).each('end', end);\n\n        els.each(function (data) {\n          that.unhighlightNodes(this, data, 'lock', undefined);\n        });\n      }\n    }, {\n      key: 'queryNode',\n      value: function queryNode(el, data, mode) {\n        data.data.queryMode = mode;\n        d3.select(el).classed({\n          active: true,\n          inactive: false,\n          'query-and': mode === 'and' ? true : false,\n          'query-or': mode === 'or' ? true : false,\n          'query-not': mode === 'not' ? true : false\n        });\n      }\n    }, {\n      key: 'unqueryNode',\n      value: function unqueryNode(el, data) {\n        data.data.queryMode = undefined;\n        data.data.queryBeforeRooting = undefined;\n        d3.select(el).classed({\n          active: false,\n          inactive: true,\n          'query-and': false,\n          'query-or': false,\n          'query-not': false\n        });\n        if (this.rootedNode) {\n          this.updateVisibility();\n        }\n      }\n    }, {\n      key: 'toggleQueryMode',\n      value: function toggleQueryMode(el, data) {\n        var previousMode = data.data.queryMode;\n\n        if (data.rooted) {\n          if (previousMode !== 'or') {\n            this.queryNode(el, data, 'or');\n          } else {\n            this.queryNode(el, data, 'and');\n          }\n        } else {\n          switch (previousMode) {\n            case 'or':\n              this.queryNode(el, data, 'and');\n              break;\n            case 'and':\n              this.queryNode(el, data, 'not');\n              break;\n            case 'not':\n              this.unqueryNode(el, data);\n              break;\n            default:\n              this.queryNode(el, data, 'or');\n              break;\n          }\n        }\n\n        if (data.data.queryMode) {\n          if (data.data.queryMode !== previousMode) {\n            this.events.broadcast('d3ListGraphNodeQuery', {\n              id: data.id,\n              clone: data.clone,\n              clonedFromId: data.clone ? data.originalNode.id : undefined,\n              mode: data.data.queryMode\n            });\n          }\n        } else {\n          this.events.broadcast('d3ListGraphNodeUnquery', {\n            id: data.id,\n            clone: data.clone,\n            clonedFromId: data.clone ? data.originalNode.id : undefined\n          });\n        }\n      }\n    }, {\n      key: 'progToggleQueryMode',\n      value: function progToggleQueryMode(el, data) {\n        this.toggleQueryMode(d3.select(el).selectAll('.focus-controls.query')[0].node(), data);\n      }\n    }, {\n      key: 'toggleRoot',\n      value: function toggleRoot(el, setFalse) {\n        var d3El = d3.select(el);\n        var data = d3El.datum();\n        var events = { rooted: false, unrooted: false };\n\n        // Blur current levels\n        this.vis.levels.blur();\n\n        if (this.rootedNode) {\n          // Reset current root node\n          this.rootedNode.classed({ active: false, inactive: true });\n          this.unrootNode(this.rootedNode.node(), this.rootedNode.datum());\n          events.unrooted = this.rootedNode.datum();\n\n          // Activate new root\n          if (this.rootedNode.datum().id !== data.id && !setFalse) {\n            d3El.classed({ active: true, inactive: false });\n            this.rootNode(el, data);\n            this.rootedNode = d3El;\n            events.rooted = data;\n          } else {\n            this.rootedNode = undefined;\n            // Highlight first level\n            this.vis.levels.focus(this.vis.activeLevelNumber - this.vis.noRootedNodeDifference);\n          }\n        } else {\n          if (!setFalse) {\n            d3El.classed({ active: true, inactive: false });\n            this.rootNode(el, data);\n            events.rooted = data;\n            this.rootedNode = d3El;\n          }\n        }\n\n        return events;\n      }\n    }, {\n      key: 'rootNode',\n      value: function rootNode(el, data) {\n        var d3El = d3.select(el.parentNode);\n\n        data.rooted = true;\n        d3El.classed('rooted', true);\n        this.hideNodes(d3El.node(), data, 'downStream');\n\n        d3El.selectAll('.bg-extension').style('transform', 'translateX(' + -(this.iconDimension * 2 + 10) + 'px)');\n\n        // Highlight level\n        this.vis.levels.focus(data.depth + this.vis.activeLevelNumber);\n\n        if (!data.data.queryMode || data.data.queryMode === 'not') {\n          this.toggleQueryMode(d3El.node(), data);\n          data.data.queryBeforeRooting = false;\n        } else {\n          data.data.queryBeforeRooting = true;\n        }\n      }\n    }, {\n      key: 'unrootNode',\n      value: function unrootNode(el, data) {\n        var d3El = d3.select(el.parentNode);\n\n        var x = 0;\n\n        if (data.data.queryMode) {\n          x = -this.iconDimension - 6;\n        }\n\n        d3El.selectAll('.bg-extension').style('transform', 'translateX(' + x + 'px)');\n\n        data.rooted = false;\n        d3El.classed('rooted', false);\n        this.showNodes(d3El.node(), data, 'downStream');\n\n        if (!data.data.queryBeforeRooting) {\n          this.unqueryNode(d3El.node(), data);\n        }\n      }\n    }, {\n      key: 'setUpFocusControls',\n      value: function setUpFocusControls(selection, location, position, mode, className) {\n        // const height = (this.visData.global.row.contentHeight / 2 -\n        //   this.visData.global.cell.padding * 2);\n\n        var paddedDim = this.iconDimension + 4;\n\n        var x = location === 'left' ? -paddedDim * (position ? position : 1) : this.visData.global.column.contentWidth + 2;\n        var y = this.visData.global.row.padding + (this.visData.global.row.contentHeight - 2 * this.visData.global.cell.padding) / 4;\n\n        if (mode === 'bg') {\n          selection.attr({\n            class: className,\n            cx: x + this.iconDimension / 2,\n            cy: y + this.iconDimension / 2,\n            r: this.iconDimension * 3 / 4\n          });\n        } else if (mode === 'hover-helper') {\n          selection.attr({\n            class: className,\n            x: x - 2,\n            y: y - 2,\n            width: this.iconDimension + 4,\n            height: this.iconDimension + 4\n          });\n        } else {\n          selection.attr({\n            class: className,\n            x: x,\n            y: y,\n            width: this.iconDimension,\n            height: this.iconDimension\n          });\n        }\n      }\n    }, {\n      key: 'hideNodes',\n      value: function hideNodes(el, data, direction) {\n        return this.nodesVisibility(el, data, direction);\n      }\n    }, {\n      key: 'showNodes',\n      value: function showNodes(el, data, direction) {\n        return this.nodesVisibility(el, data, direction, true);\n      }\n    }, {\n      key: 'nodesVisibility',\n      value: function nodesVisibility(el, data, direction, show) {\n        if (show) {\n          this.nodes.classed('hidden', false).each(function (nodeData) {\n            return nodeData.hidden = false;\n          });\n        } else {\n          // First we set all nodes to `hidden`.\n          this.nodes.each(function (nodeData) {\n            return nodeData.hidden = true;\n          });\n\n          // Then we set direct child and parent nodes of the current node visible.\n          upAndDown(data, function (nodeData) {\n            return nodeData.hidden = false;\n          });\n\n          // We also show sibling nodes.\n          siblings(data, function (nodeData) {\n            return nodeData.hidden = false;\n          });\n\n          this.nodes.classed('hidden', function (nodeData) {\n            return nodeData.hidden && !nodeData.data.queryMode;\n          });\n        }\n        this.updateVisibility();\n      }\n    }, {\n      key: 'highlightNodes',\n      value: function highlightNodes(el, data, className, restriction, excludeClones) {\n        var _this2 = this;\n\n        var that = this;\n        var nodeId = data.id;\n        var currentNodeData = data;\n        var includeParents = true;\n        var appliedClassName = className ? className : 'hovering';\n        var includeClones = excludeClones ? false : true;\n        var includeChildren = restriction === 'directParentsOnly' ? false : true;\n\n        // Store link IDs\n        if (!this.currentLinks[appliedClassName]) {\n          this.currentLinks[appliedClassName] = {};\n        }\n        this.currentLinks[appliedClassName][nodeId] = [];\n\n        var currentActiveProperty = d3.select(el).selectAll('.bar.active .bar-magnitude').datum();\n\n        var traverseCallbackUp = function traverseCallbackUp(nodeData, childData) {\n          nodeData.hovering = 2;\n          for (var i = nodeData.links.length; i--;) {\n            // Only push direct parent child connections. E.g.\n            // Store: (parent)->(child)\n            // Ignore: (parent)->(siblings of child)\n            if (nodeData.links[i].target.node.id === childData.id) {\n              _this2.currentLinks[appliedClassName][nodeId].push(nodeData.links[i].id);\n            }\n          }\n        };\n\n        var traverseCallbackDown = function traverseCallbackDown(nodeData) {\n          nodeData.hovering = 2;\n          for (var i = nodeData.links.length; i--;) {\n            _this2.currentLinks[appliedClassName][nodeId].push(nodeData.links[i].id);\n          }\n        };\n\n        if (includeParents && includeChildren) {\n          upAndDown(data, traverseCallbackUp, traverseCallbackDown, undefined, includeClones);\n        }\n        if (includeParents && !includeChildren) {\n          up(data, traverseCallbackUp, undefined, includeClones);\n        }\n        if (!includeParents && includeChildren) {\n          down(data, traverseCallbackUp, undefined, includeClones);\n        }\n\n        if (data.clone) {\n          data.originalNode.hovering = 1;\n        } else {\n          if (includeClones) {\n            for (var i = data.clones.length; i--;) {\n              data.clones[i].hovering = 1;\n            }\n          }\n        }\n\n        data.hovering = 1;\n\n        this.nodes.each(function (nodeData) {\n          var node = d3.select(this);\n\n          if (nodeData.hovering === 1) {\n            node.classed(appliedClassName + '-directly', true);\n          } else if (nodeData.hovering === 2) {\n            node.classed(appliedClassName + '-indirectly', true);\n            node.selectAll('.bar.' + currentActiveProperty.id).classed('copy', function (barData) {\n              var id = barData.id;\n\n              if (barData.clone) {\n                id = barData.originalNode.id;\n              }\n\n              if (id !== currentNodeData.id) {\n                return true;\n              }\n            });\n\n            var currentBar = d3.select(el).selectAll('.bar.' + currentActiveProperty.id).classed('reference', true);\n\n            that.bars.updateIndicator(node.selectAll('.bar.copy .bar-indicator'), node.selectAll('.bar.copy .bar-indicator-bg'), currentBar.selectAll('.bar-indicator'), currentActiveProperty.value);\n          }\n        });\n\n        this.links.highlight(arrayToFakeObjs(this.currentLinks[appliedClassName][data.id]), true, appliedClassName);\n      }\n    }, {\n      key: 'unhighlightNodes',\n      value: function unhighlightNodes(el, data, className, restriction, excludeClones) {\n        var traverseCallback = function traverseCallback(nodeData) {\n          return nodeData.hovering = 0;\n        };\n        var includeParents = true;\n        var appliedClassName = className ? className : 'hovering';\n        var includeClones = excludeClones ? false : true;\n        var includeChildren = restriction === 'directParentsOnly' ? false : true;\n\n        data.hovering = 0;\n        if (includeParents && includeChildren) {\n          upAndDown(data, traverseCallback, undefined, undefined, includeClones);\n        }\n        if (includeParents && !includeChildren) {\n          up(data, traverseCallback, undefined, includeClones);\n        }\n        if (!includeParents && includeChildren) {\n          down(data, traverseCallback, undefined, includeClones);\n        }\n\n        if (data.clone) {\n          data.originalNode.hovering = 0;\n        } else {\n          if (includeClones) {\n            for (var i = data.clones.length; i--;) {\n              data.clones[i].hovering = 0;\n            }\n          }\n        }\n\n        this.nodes.classed(appliedClassName + '-directly', false);\n        this.nodes.classed(appliedClassName + '-indirectly', false);\n\n        if (this.currentLinks[appliedClassName][data.id]) {\n          this.links.highlight(arrayToFakeObjs(this.currentLinks[appliedClassName][data.id]), false, appliedClassName);\n        }\n      }\n    }, {\n      key: 'sort',\n      value: function sort(update, newSortType) {\n        var _this3 = this;\n\n        for (var i = update.length; i--;) {\n          var selection = this.nodes.data(update[i].rows, function (data) {\n            return data.id;\n          });\n\n          this.vis.svgD3.classed('sorting', true);\n          selection.transition().duration(TRANSITION_SEMI_FAST).attr('transform', function (data) {\n            return 'translate(' + (data.x + _this3.visData.global.column.padding) + ', ' + data.y + ')';\n          }).call(allTransitionsEnded, function () {\n            _this3.vis.svgD3.classed('sorting', false);\n            _this3.vis.updateLevelsVisibility();\n            _this3.vis.updateScrollbarVisibility();\n          });\n\n          if (newSortType && this.vis.currentSorting.local[update[i].level].type !== 'name') {\n            this.bars.update(selection.selectAll('.bar'), update[i].sortBy);\n          }\n        }\n      }\n    }, {\n      key: 'updateVisibility',\n      value: function updateVisibility() {\n        var _this4 = this;\n\n        this.vis.layout.updateNodesVisibility();\n\n        this.nodes.transition().duration(TRANSITION_SEMI_FAST).attr('transform', function (data) {\n          return 'translate(' + (data.x + _this4.visData.global.column.padding) + ', ' + data.y + ')';\n        }).call(allTransitionsEnded, function () {\n          _this4.vis.updateLevelsVisibility();\n          _this4.vis.updateScrollbarVisibility();\n        });\n\n        this.vis.links.updateVisibility();\n      }\n    }, {\n      key: 'barMode',\n      get: function get() {\n        return this.bars.mode;\n      }\n    }]);\n    return Nodes;\n  })();\n\n  var LINKS_CLASS = 'links';\n  var LINK_CLASS = 'link';\n\n  var Links = (function () {\n    function Links(levels, visData, layout) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Links);\n\n      this.visData = visData;\n      this.layout = layout;\n\n      this.groups = levels.append('g').attr('class', LINKS_CLASS).call(function (selection) {\n        selection.each(function () {\n          d3.select(this.parentNode).datum().links = this;\n        });\n      });\n\n      this.links = this.groups.selectAll(LINK_CLASS + '-bg').data(function (data, index) {\n        return _this.layout.links(index);\n      }).enter().append('g').attr('class', LINK_CLASS);\n\n      this.links.append('path').attr({\n        class: LINK_CLASS + '-bg',\n        d: this.diagonal\n      });\n\n      this.links.append('path').attr({\n        class: LINK_CLASS + '-direct',\n        d: this.diagonal\n      });\n    }\n\n    babelHelpers.createClass(Links, [{\n      key: 'highlight',\n      value: function highlight(nodeIds, _highlight, className) {\n        this.links.data(nodeIds, function (data) {\n          return data.id;\n        }).classed(className ? className : 'hovering', _highlight === false ? false : true);\n      }\n    }, {\n      key: 'scroll',\n      value: function scroll(selection, data) {\n        // Update data of `g`.\n        selection.data(data);\n\n        // Next update all paths according to the new data.\n        selection.selectAll('path').attr('d', this.diagonal);\n      }\n    }, {\n      key: 'sort',\n      value: function sort(update) {\n        var start = function start() {\n          d3.select(this).classed('sorting', true);\n        };\n        var end = function end() {\n          d3.select(this).classed('sorting', false);\n        };\n\n        // Update data of `g`.\n        this.links.data(update, function (data) {\n          return data.id;\n        });\n\n        // Next update all paths according to the new data.\n        this.links.selectAll('path').transition().duration(TRANSITION_SEMI_FAST).attr('d', this.diagonal).each('start', start).each('end', end);\n      }\n    }, {\n      key: 'updateVisibility',\n      value: function updateVisibility() {\n        this.links.selectAll('path').classed('hidden', function (data) {\n          return data.target.node.hidden || data.source.node.hidden;\n        }).transition().duration(TRANSITION_SEMI_FAST).attr('d', this.diagonal);\n      }\n    }, {\n      key: 'diagonal',\n      get: function get() {\n        var _this2 = this;\n\n        return d3.svg.diagonal().source(function (data) {\n          return {\n            x: data.source.node.y + data.source.offsetY + _this2.visData.global.row.height / 2,\n            y: data.source.node.x + data.source.offsetX + _this2.visData.global.column.contentWidth + _this2.visData.global.column.padding\n          };\n        }).target(function (data) {\n          return {\n            x: data.target.node.y + data.target.offsetY + _this2.visData.global.row.height / 2,\n            y: data.target.node.x + data.target.offsetX + _this2.visData.global.column.padding\n          };\n        }).projection(function (data) {\n          return [data.y, data.x];\n        });\n      }\n    }]);\n    return Links;\n  })();\n\n  var COLUMN_CLASS = 'column';\n  var SCROLL_CONTAINER_CLASS = 'scroll-container';\n\n  var Levels = (function () {\n    function Levels(selection, vis, visData) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Levels);\n\n      this.vis = vis;\n      this.visData = visData;\n      this.groups = selection.selectAll('g').data(this.visData.nodes).enter().append('g').attr('class', COLUMN_CLASS).classed('active', function (data, index) {\n        if (_this.vis.highlightActiveLevel) {\n          if (!_this.vis.nodes || !_this.vis.nodes.rootedNode) {\n            return index === _this.vis.activeLevelNumber - _this.vis.noRootedNodeDifference;\n          }\n          return index === _this.vis.activeLevelNumber;\n        }\n      });\n\n      // We need to add an empty rectangle that fills up the whole column to ensure\n      // that the `g`'s size is at a maximum, otherwise scrolling will be halted\n      // when the cursor leaves an actually drawn element.\n      this.groups.append('rect').attr('class', SCROLL_CONTAINER_CLASS).attr('x', function (data) {\n        return data.x;\n      }).attr('y', function (data) {\n        return data.y;\n      }).attr('width', this.visData.global.column.width + 1).attr('height', this.visData.global.column.height);\n    }\n\n    babelHelpers.createClass(Levels, [{\n      key: 'scrollPreparation',\n      value: function scrollPreparation(vis, scrollbarWidth) {\n        var _this2 = this;\n\n        this.groups.each(function (data, index) {\n          var contentHeight = data.nodes.getBoundingClientRect().height + 2 * _this2.visData.global.row.padding;\n          var scrollHeight = contentHeight - _this2.visData.global.column.height;\n          var scrollbarHeight = scrollHeight > 0 ? Math.max(_this2.visData.global.column.height * _this2.visData.global.column.height / contentHeight, 10) : 0;\n\n          data.height = contentHeight;\n          data.linkSelections = {\n            incoming: index > 0 ? vis.selectByLevel(index - 1, '.link') : null,\n            outgoing: vis.selectByLevel(index, '.link')\n          };\n          data.scrollHeight = scrollHeight;\n          data.scrollTop = 0;\n          data.scrollbar = {\n            el: undefined,\n            x: data.x + _this2.visData.global.column.width - scrollbarWidth,\n            y: 0,\n            width: scrollbarWidth,\n            height: scrollbarHeight,\n            scrollHeight: _this2.visData.global.column.height - scrollbarHeight,\n            scrollTop: 0,\n            heightScale: d3.scale.linear().domain([0, scrollHeight]).range([0, _this2.visData.global.column.height - scrollbarHeight])\n          };\n          data.invertedHeightScale = data.scrollbar.heightScale.invert;\n        });\n      }\n    }, {\n      key: 'updateScrollProperties',\n      value: function updateScrollProperties() {\n        var _this3 = this;\n\n        this.groups.each(function (data) {\n          var contentHeight = data.nodes.getBoundingClientRect().height + 2 * _this3.visData.global.row.padding;\n          var scrollHeight = contentHeight - _this3.visData.global.column.height;\n          var scrollbarHeight = scrollHeight > 0 ? Math.max(_this3.visData.global.column.height * _this3.visData.global.column.height / contentHeight, 10) : 0;\n\n          data.height = contentHeight;\n          data.scrollHeight = scrollHeight;\n          data.scrollTop = 0;\n          data.scrollbar.y = 0;\n          data.scrollbar.height = scrollbarHeight;\n          data.scrollbar.scrollHeight = _this3.visData.global.column.height - scrollbarHeight;\n          data.scrollbar.scrollTop = 0;\n          data.scrollbar.heightScale = d3.scale.linear().domain([0, scrollHeight]).range([0, _this3.visData.global.column.height - scrollbarHeight]);\n        });\n      }\n    }, {\n      key: 'updateVisibility',\n      value: function updateVisibility() {\n        this.groups.each(function () {\n          var group = d3.select(this);\n\n          group.classed('hidden', group.selectAll('.node').filter(function (data) {\n            return !data.hidden;\n          }).empty());\n        });\n      }\n    }, {\n      key: 'focus',\n      value: function focus(level) {\n        if (this.vis.highlightActiveLevel) {\n          this.groups.filter(function (data) {\n            return data.level === level;\n          }).classed('active', true);\n        }\n      }\n    }, {\n      key: 'blur',\n      value: function blur(level) {\n        if (this.vis.highlightActiveLevel) {\n          if (level) {\n            this.groups.filter(function (data) {\n              return data.level === level;\n            }).classed('active', false);\n          } else {\n            this.groups.classed('active', false);\n          }\n        }\n      }\n    }, {\n      key: 'height',\n      get: function get() {\n        return this.visData.global.column.height;\n      }\n    }]);\n    return Levels;\n  })();\n\n  var TOPBAR_EL = 'div';\n  var TOPBAR_CLASS = 'top-bar';\n\n  var TOPBAR_CONTROL_EL = 'ul';\n  var TOPBAR_CONTROL_CLASS = 'controls';\n  var TOPBAR_GLOBAL_CONTROL_CLASS = 'global-controls';\n\n  var Topbar = (function () {\n    function Topbar(vis, selection, visData) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Topbar);\n\n      var that = this;\n\n      this.vis = vis;\n      this.visData = visData;\n      // Add base topbar element\n      this.el = selection.select('.' + TOPBAR_CLASS);\n\n      if (this.el.empty()) {\n        this.el = selection.insert(TOPBAR_EL, ':first-child').attr('class', TOPBAR_CLASS);\n      }\n\n      this.controlSwitch = this.el.append('div').attr('title', 'Toggle global / local topbar').style('width', this.visData.global.column.padding + 'px').classed('control-switch', true).on('click', this.switch.bind(this));\n\n      this.switchArrow = this.controlSwitch.append('svg').append('use').attr('xlink:href', this.vis.iconPath + '#arrow-down').attr('class', 'switch-arrow');\n\n      this.globalControls = this.el.append(TOPBAR_CONTROL_EL).classed(TOPBAR_GLOBAL_CONTROL_CLASS, true);\n\n      // Add button for sorting by precision\n      this.globalPrecision = this.globalControls.append('li').attr('class', 'control-btn sort-precision').classed('active', function () {\n        if (that.vis.currentSorting.global.type === 'precision') {\n          // Save currently active element. Needed when when re-sorting for the\n          // first time, to be able to de-highlight this element.\n          that.vis.currentSorting.global.el = d3.select(this);\n          return true;\n        }\n      }).on('click', function () {\n        that.sortAllColumns(this, 'precision');\n      }).on('mouseenter', function () {\n        return _this.highlightBars(undefined, 'precision');\n      }).on('mouseleave', function () {\n        return _this.highlightBars(undefined, 'precision', true);\n      });\n\n      this.globalPrecisionWrapper = this.globalPrecision.append('div').attr('class', 'wrapper');\n\n      this.globalPrecisionWrapper.append('span').attr('class', 'label').text('Precision');\n\n      this.globalPrecisionWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'precision').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n      this.globalPrecisionWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'precision' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-asc');\n\n      this.globalPrecisionWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'precision' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-desc');\n\n      // Add button for sorting by recall\n      this.globalRecall = this.globalControls.append('li').attr('class', 'control-btn sort-recall').classed('active', function () {\n        if (that.vis.currentSorting.global.type === 'recall') {\n          // See precision\n          that.vis.currentSorting.global.el = d3.select(this);\n          return true;\n        }\n      }).on('click', function () {\n        that.sortAllColumns(this, 'recall');\n      }).on('mouseenter', function () {\n        return _this.highlightBars(undefined, 'recall');\n      }).on('mouseleave', function () {\n        return _this.highlightBars(undefined, 'recall', true);\n      });\n\n      this.globalRecallWrapper = this.globalRecall.append('div').attr('class', 'wrapper');\n\n      this.globalRecallWrapper.append('span').attr('class', 'label').text('Recall');\n\n      this.globalRecallWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'recall').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n      this.globalRecallWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'recall' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-asc');\n\n      this.globalRecallWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'recall' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-desc');\n\n      // Add button for sorting by name\n      this.globalName = this.globalControls.append('li').attr('class', 'control-btn sort-name').classed('active', function () {\n        if (that.vis.currentSorting.global.type === 'name') {\n          // See precision\n          that.vis.currentSorting.global.el = d3.select(this);\n          return true;\n        }\n      }).on('click', function () {\n        that.sortAllColumns(this, 'name');\n      }).on('mouseenter', function () {\n        return _this.highlightLabels();\n      }).on('mouseleave', function () {\n        return _this.highlightLabels(true);\n      });\n\n      this.globalNameWrapper = this.globalName.append('div').attr('class', 'wrapper');\n\n      this.globalNameWrapper.append('span').attr('class', 'label').text('Name');\n\n      this.globalNameWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'name').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n      this.globalNameWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'name' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-alpha-asc');\n\n      this.globalNameWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'name' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-alpha-desc');\n\n      // Add button for switching to 'one bar'\n      this.globalOneBar = this.globalControls.append('li').attr('class', 'control-btn one-bar').classed('active', this.vis.barMode === 'one').on('click', function () {\n        that.switchBarMode(this, 'one');\n      });\n\n      this.globalOneBarWrapper = this.globalOneBar.append('div').attr('class', 'wrapper').text('One bar');\n\n      this.globalOneBarWrapper.append('svg').attr('class', 'icon-one-bar').append('use').attr('xlink:href', this.vis.iconPath + '#one-bar');\n\n      // Add button for switching to 'two bars'\n      this.globalTwoBars = this.globalControls.append('li').attr('class', 'control-btn two-bars').classed('active', this.vis.barMode === 'two').on('click', function () {\n        that.switchBarMode(this, 'two');\n      });\n\n      this.globalTwoBarsWrapper = this.globalTwoBars.append('div').attr('class', 'wrapper').text('Two bars');\n\n      this.globalTwoBarsWrapper.append('svg').attr('class', 'icon-two-bars').append('use').attr('xlink:href', this.vis.iconPath + '#two-bars');\n\n      // Add button for zoom-out\n      this.globalZoomOut = this.globalControls.append('li').attr('class', 'control-btn zoom-out').classed('active', this.vis.zoomedOut).on('mouseenter', this.vis.globalView.bind(this.vis)).on('mouseleave', this.vis.zoomedView.bind(this.vis)).on('click', function () {\n        that.vis.toggleView.call(that.vis);\n        d3.select(this).classed('active', that.vis.zoomedOut);\n      });\n\n      this.globalZoomOutWrapper = this.globalZoomOut.append('div').attr('class', 'wrapper').text('Zoom Out').style('margin-right', this.visData.global.column.padding + 'px');\n\n      this.globalZoomOutWrapper.append('svg').attr('class', 'icon-zoom-out').append('use').attr('xlink:href', this.vis.iconPath + '#zoom-out');\n\n      this.localControlWrapper = this.el.append('div').classed('local-controls', true);\n\n      this.localControls = this.localControlWrapper.selectAll(TOPBAR_CONTROL_CLASS).data(visData.nodes).enter().append(TOPBAR_CONTROL_EL).classed(TOPBAR_CONTROL_CLASS, true).style('width', this.visData.global.column.width + 'px');\n\n      this.localControls.each(function (data, index) {\n        var control = d3.select(this);\n\n        /*\n         * Order:\n         * 0 = unsorted\n         * 1 = asc\n         * -1 = desc\n         */\n        that.vis.currentSorting.local[index] = {\n          type: data.sortBy,\n          order: data.sortOrder,\n          el: undefined\n        };\n\n        control.append('li').attr('class', 'control-btn toggle').style('width', that.visData.global.column.padding + 'px').on('click', that.toggleColumn);\n\n        control.append('li').attr('class', 'control-btn sort-precision ease-all').classed('active', function () {\n          if (that.vis.currentSorting.local[index].type === 'precision') {\n            // See precision\n            that.vis.currentSorting.local[index].el = d3.select(this);\n            return true;\n          }\n        }).style({\n          width: that.visData.global.column.contentWidth / 2 + 'px',\n          left: that.visData.global.column.padding + 'px'\n        }).on('click', function (controlData) {\n          that.sortColumn(this, controlData.level, 'precision');\n        }).on('mouseenter', function () {\n          that.highlightBars(this.parentNode, 'precision');\n          d3.select(this).style('width', that.visData.global.column.contentWidth - 16 + 'px');\n        }).on('mouseleave', function () {\n          that.highlightBars(this.parentNode, 'precision', true);\n          d3.select(this).style('width', that.visData.global.column.contentWidth / 2 + 'px');\n        }).html('<div class=\"expandable-label\">' + '  <span class=\"letter abbr\">P</span>' + '  <span class=\"letter abbr\">r</span>' + '  <span class=\"letter\">e</span>' + '  <span class=\"letter abbr\">c</span>' + '  <span class=\"letter\">i</span>' + '  <span class=\"letter\">s</span>' + '  <span class=\"letter\">i</span>' + '  <span class=\"letter\">o</span>' + '  <span class=\"letter\">n</span>' + '</div>' + '<svg class=\"icon-unsort invisible-default ' + (that.vis.currentSorting.local[index].type !== 'precision' ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#unsort\"></use>' + '</svg>' + '<svg class=\"icon-sort-asc invisible-default ' + (that.vis.currentSorting.local[index].type === 'precision' && that.vis.currentSorting.local[index].order === 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#sort-asc\"></use>' + '</svg>' + '<svg class=\"icon-sort-desc invisible-default ' + (that.vis.currentSorting.local[index].type === 'precision' && that.vis.currentSorting.local[index].order !== 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#sort-desc\"></use>' + '</svg>');\n\n        control.append('li').attr('class', 'control-btn sort-recall ease-all').classed('active', function () {\n          if (that.vis.currentSorting.local[index].type === 'recall') {\n            // See recall\n            that.vis.currentSorting.local[index].el = d3.select(this);\n            return true;\n          }\n        }).style({\n          width: that.visData.global.column.contentWidth / 2 + 'px',\n          left: that.visData.global.column.contentWidth / 2 + that.visData.global.column.padding + 'px'\n        }).on('click', function (controlData) {\n          that.sortColumn(this, controlData.level, 'recall');\n        }).on('mouseenter', function () {\n          that.highlightBars(this.parentNode, 'recall');\n          d3.select(this).style({\n            width: that.visData.global.column.contentWidth - 16 + 'px',\n            left: that.visData.global.column.padding + 16 + 'px'\n          });\n        }).on('mouseleave', function () {\n          that.highlightBars(this.parentNode, 'recall', true);\n          d3.select(this).style({\n            width: that.visData.global.column.contentWidth / 2 + 'px',\n            left: that.visData.global.column.contentWidth / 2 + that.visData.global.column.padding + 'px'\n          });\n        }).html('<div class=\"expandable-label\">' + '  <span class=\"letter abbr\">R</span>' + '  <span class=\"letter\">e</span>' + '  <span class=\"letter abbr\">c</span>' + '  <span class=\"letter\">a</span>' + '  <span class=\"letter abbr\">l</span>' + '  <span class=\"letter\">l</span>' + '</div>' + '<svg class=\"icon-unsort invisible-default ' + (that.vis.currentSorting.local[index].type !== 'recall' ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#unsort\"></use>' + '</svg>' + '<svg class=\"icon-sort-asc invisible-default ' + (that.vis.currentSorting.local[index].type === 'recall' && that.vis.currentSorting.local[index].order === 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#sort-asc\"></use>' + '</svg>' + '<svg class=\"icon-sort-desc invisible-default ' + (that.vis.currentSorting.local[index].type === 'recall' && that.vis.currentSorting.local[index].order !== 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#sort-desc\"></use>' + '</svg>');\n\n        control.append('li').attr('class', 'control-btn options').style('width', that.visData.global.column.padding + 'px').on('click', that.toggleOptions).html('<svg class=\"icon-gear\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#gear\"></use>' + '</svg>');\n\n        if (that.vis.currentSorting.local[index].type) {\n          that.vis.currentSorting.local[index].el = control.select('.sort-' + that.vis.currentSorting.local[index].type);\n        }\n      });\n    }\n\n    // toggleColumn () {\n    //   console.log('Toggle column');\n    // }\n\n    babelHelpers.createClass(Topbar, [{\n      key: 'selectNodesLevel',\n      value: function selectNodesLevel(el) {\n        return this.vis.selectByLevel(d3.select(el).datum().level, '.node');\n      }\n    }, {\n      key: 'highlightLabels',\n      value: function highlightLabels(deHighlight) {\n        this.vis.baseElD3.selectAll('.node').classed('highlight-label', !deHighlight);\n      }\n    }, {\n      key: 'highlightBars',\n      value: function highlightBars(el, type, deHighlight) {\n        var nodes = el ? this.selectNodesLevel(el) : this.vis.baseElD3.selectAll('.node');\n\n        nodes.classed('highlight-bar', !deHighlight).selectAll('.bar.' + type).classed('highlight', !deHighlight);\n      }\n    }, {\n      key: 'sortAllColumns',\n      value: function sortAllColumns(el, type) {\n        if (this.semiActiveSortingEls) {\n          this.resetSemiActiveSortingEls();\n        }\n\n        if (this.vis.currentSorting.global.type !== type) {\n          // Unset class of previous global sorting element\n          if (this.vis.currentSorting.global.el) {\n            this.resetSortEl(this.vis.currentSorting.global.el, type);\n          }\n        }\n\n        this.vis.currentSorting.global.el = d3.select(el);\n        this.vis.currentSorting.global.el.classed('active', true);\n        this.vis.currentSorting.global.type = type;\n\n        var columnKeys = Object.keys(this.vis.currentSorting.local);\n        for (var i = 0, len = columnKeys.length; i < len; i++) {\n          this.sortColumn(el, columnKeys[i], type, true);\n        }\n\n        this.vis.sortAllColumns(type, this.vis.currentSorting.global.order, true);\n      }\n    }, {\n      key: 'sortColumn',\n      value: function sortColumn(el, index, type, global) {\n        // Reset global sorting\n        if (!global) {\n          if (this.semiActiveSortingEls) {\n            this.resetSemiActiveSortingEls();\n          }\n          if (this.vis.currentSorting.global.type) {\n            this.resetSortEl(this.vis.currentSorting.global.el, type);\n          }\n          this.vis.currentSorting.global.type = undefined;\n        }\n\n        var newSortType = false;\n\n        if (this.vis.currentSorting.local[index].el) {\n          if (this.vis.currentSorting.local[index].type !== type) {\n            this.resetSortEl(this.vis.currentSorting.local[index].el, type);\n          }\n        }\n\n        if (this.vis.currentSorting.local[index].type !== type) {\n          newSortType = true;\n          // Reset sort order\n          this.vis.currentSorting.local[index].order = 0;\n        }\n\n        this.vis.currentSorting.local[index].el = d3.select(el);\n        this.vis.currentSorting.local[index].type = type;\n\n        // -1 = desc, 1 = asc\n        if (this.vis.currentSorting.local[index].order === -1) {\n          this.vis.currentSorting.local[index].order = 1;\n          this.vis.currentSorting.local[index].el.select('.icon-sort-desc').classed('visible', false);\n          this.vis.currentSorting.local[index].el.select('.icon-sort-asc').classed('visible', true);\n        } else {\n          this.vis.currentSorting.local[index].order = -1;\n          this.vis.currentSorting.local[index].el.select('.icon-sort-asc').classed('visible', false);\n          this.vis.currentSorting.local[index].el.select('.icon-sort-desc').classed('visible', true);\n        }\n\n        this.vis.currentSorting.local[index].el.select('.icon-unsort').classed('visible', false);\n\n        this.vis.currentSorting.local[index].el.classed('active', true);\n\n        if (!global) {\n          this.vis.sortColumn(index, type, this.vis.currentSorting.local[index].order, newSortType);\n        }\n      }\n    }, {\n      key: 'resetSortEl',\n      value: function resetSortEl(el, newType) {\n        el.classed('active', false);\n        el.select('.icon-sort-desc').classed('visible', false);\n        el.select('.icon-sort-asc').classed('visible', false);\n        el.select('.icon-unsort').classed('visible', true);\n        if (newType === 'name') {\n          el.classed('semi-active', true);\n          this.semiActiveSortingEls = true;\n        }\n      }\n    }, {\n      key: 'resetSemiActiveSortingEls',\n      value: function resetSemiActiveSortingEls() {\n        this.el.selectAll('.semi-active').classed('semi-active', false);\n      }\n\n      // toggleOptions () {\n      //   console.log('Toggle options');\n      // }\n\n    }, {\n      key: 'switch',\n      value: function _switch() {\n        this.el.classed('details', !this.el.classed('details'));\n      }\n    }, {\n      key: 'switchBarMode',\n      value: function switchBarMode(el, mode) {\n        if (this.vis.nodes.barMode !== mode) {\n          if (mode === 'one') {\n            this.globalOneBar.classed('active', true);\n            this.globalTwoBars.classed('active', false);\n          } else {\n            this.globalOneBar.classed('active', false);\n            this.globalTwoBars.classed('active', true);\n          }\n          this.vis.switchBarMode(mode);\n        }\n      }\n    }]);\n    return Topbar;\n  })();\n\n  /**\n   * Creates and adds an interpolated exponential SVG gradient to an SVG element.\n   *\n   * @example\n   * ```\n   * exponentialGradient(\n   *   d3.select('svg'),\n   *   {\n   *     color: #fff,\n   *     offset: 10,\n   *     opacity: 0.5,\n   *     x: 0,\n   *     y: 0\n   *   },\n   *   {\n   *     color: #000,\n   *     offset: 10,\n   *     opacity: 1,\n   *     x: 1,\n   *     y: 1\n   *   },\n   *   'myFancyGradient',\n   *   3,\n   *   5\n   * );\n   * ```\n   *\n   * @method  exponentialGradient\n   * @author  Fritz Lekschas\n   * @date    2015-12-30\n   * @param   {Object}  el     Element to which the `def` gradient should be\n   *   added to.\n   * @param   {Object}  start  Start properies.\n   * @param   {Object}  end    End properies.\n   * @param   {String}  name   Name of the gradient.\n   * @param   {Number}  power  Exponential power.\n   * @param   {Number}  steps  Interpolation steps.\n   */\n  function exponentialGradient(el, start, end, name, power, steps) {\n    var scale = d3.scale.pow().exponent(power || 2);\n    var stepSize = 1 / ((steps || 0) + 1);\n\n    var gradient = el.append('defs').append('linearGradient').attr('id', name).attr('x1', start.x).attr('y1', start.y).attr('x2', end.x).attr('y2', end.y).attr('spreadMethod', 'pad');\n\n    gradient.append('stop').attr('offset', start.offset + '%').attr('stop-color', start.color).attr('stop-opacity', start.opacity);\n\n    for (var i = 0; i < steps; i++) {\n      gradient.append('stop').attr('offset', start.offset + i * stepSize * (end.offset - start.offset) + '%').attr('stop-color', end.color).attr('stop-opacity', start.opacity + scale(i * stepSize) * (end.opacity - start.opacity));\n    }\n\n    gradient.append('stop').attr('offset', end.offset + '%').attr('stop-color', end.color).attr('stop-opacity', end.opacity);\n  }\n\n  /**\n   * Checks if `value` is object-like.\n   *\n   * @private\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n   */\n  function isObjectLike(value) {\n    return !!value && typeof value == 'object';\n  }\n\n  /** Used to detect host constructors (Safari > 5). */\n  var reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n  /** Used for native method references. */\n  var objectProto$2 = Object.prototype;\n\n  /** Used to resolve the decompiled source of functions. */\n  var fnToString = Function.prototype.toString;\n\n  /** Used to check objects for own properties. */\n  var hasOwnProperty = objectProto$2.hasOwnProperty;\n\n  /** Used to detect if a method is native. */\n  var reIsNative = RegExp('^' +\n    fnToString.call(hasOwnProperty).replace(/[\\\\^$.*+?()[\\]{}|]/g, '\\\\$&')\n    .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n  );\n\n  /**\n   * Checks if `value` is a native function.\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is a native function, else `false`.\n   * @example\n   *\n   * _.isNative(Array.prototype.push);\n   * // => true\n   *\n   * _.isNative(_);\n   * // => false\n   */\n  function isNative(value) {\n    if (value == null) {\n      return false;\n    }\n    if (isFunction(value)) {\n      return reIsNative.test(fnToString.call(value));\n    }\n    return isObjectLike(value) && reIsHostCtor.test(value);\n  }\n\n  /**\n   * Gets the native function at `key` of `object`.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @param {string} key The key of the method to get.\n   * @returns {*} Returns the function if it's native, else `undefined`.\n   */\n  function getNative(object, key) {\n    var value = object == null ? undefined : object[key];\n    return isNative(value) ? value : undefined;\n  }\n\n  /**\n   * Used as the [maximum length](http://ecma-international.org/ecma-262/6.0/#sec-number.max_safe_integer)\n   * of an array-like value.\n   */\n  var MAX_SAFE_INTEGER = 9007199254740991;\n\n  /**\n   * Checks if `value` is a valid array-like length.\n   *\n   * **Note:** This function is based on [`ToLength`](http://ecma-international.org/ecma-262/6.0/#sec-tolength).\n   *\n   * @private\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n   */\n  function isLength(value) {\n    return typeof value == 'number' && value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n  }\n\n  /** `Object#toString` result references. */\n  var arrayTag = '[object Array]';\n\n  /** Used for native method references. */\n  var objectProto$1 = Object.prototype;\n\n  /**\n   * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n   * of values.\n   */\n  var objToString$1 = objectProto$1.toString;\n\n  /* Native method references for those with the same name as other `lodash` methods. */\n  var nativeIsArray = getNative(Array, 'isArray');\n\n  /**\n   * Checks if `value` is classified as an `Array` object.\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n   * @example\n   *\n   * _.isArray([1, 2, 3]);\n   * // => true\n   *\n   * _.isArray(function() { return arguments; }());\n   * // => false\n   */\n  var isArray = nativeIsArray || function(value) {\n    return isObjectLike(value) && isLength(value.length) && objToString$1.call(value) == arrayTag;\n  };\n\n  var LayoutNotAvailable = (function (_ExtendableError) {\n    babelHelpers.inherits(LayoutNotAvailable, _ExtendableError);\n\n    function LayoutNotAvailable(message) {\n      babelHelpers.classCallCheck(this, LayoutNotAvailable);\n      return babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(LayoutNotAvailable).call(this, message || 'D3.layout.listGraph.js has not been loaded yet.'));\n    }\n\n    return LayoutNotAvailable;\n  })(ExtendableError);\n\n  var EventDispatcherNoFunction = (function (_ExtendableError2) {\n    babelHelpers.inherits(EventDispatcherNoFunction, _ExtendableError2);\n\n    function EventDispatcherNoFunction(message) {\n      babelHelpers.classCallCheck(this, EventDispatcherNoFunction);\n      return babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(EventDispatcherNoFunction).call(this, message || 'Dispatcher needs to be a function.'));\n    }\n\n    return EventDispatcherNoFunction;\n  })(ExtendableError);\n\n  var Events = (function () {\n    function Events(el, broadcast) {\n      babelHelpers.classCallCheck(this, Events);\n\n      if (broadcast && !isFunction(broadcast)) {\n        throw new EventDispatcherNoFunction();\n      }\n\n      this.el = el;\n      this._stack = {};\n      this.dispatch = broadcast ? broadcast : this._dispatchEvent;\n    }\n\n    babelHelpers.createClass(Events, [{\n      key: '_dispatchEvent',\n      value: function _dispatchEvent(eventName, data) {\n        var event = document.createEvent('CustomEvent');\n        event.initCustomEvent(eventName, false, false, data);\n        this.el.dispatchEvent(event);\n      }\n    }, {\n      key: 'broadcast',\n      value: function broadcast(event, data) {\n        this.dispatch(event, data);\n      }\n\n      /**\n       * Add a callback function to an event stack.\n       *\n       * @method  on\n       * @author  Fritz Lekschas\n       * @date    2016-01-07\n       *\n       * @param   {String}    event     Event identifier.\n       * @param   {Function}  callback  Function which is called when the event\n       *   stack is triggered.\n       * @param   {Number}    times     Number of times the callback function should\n       *   be triggered before it is removed from the event stack. This is useful\n       *   when an event happens only a certain number of times.\n       * @return  {Number}              Index of callback, which is needed to\n       *   manually remove the callback from the event stack.\n       */\n\n    }, {\n      key: 'on',\n      value: function on(event, callback, times) {\n        if (!isFunction(callback)) {\n          return false;\n        }\n\n        var normTimes = isFinite(times) ? parseInt(times, 10) : Infinity;\n\n        if (isArray(this.stack[event])) {\n          return this.stack[event].push({ callback: callback, times: normTimes }) - 1;\n        }\n        this.stack[event] = [{ callback: callback, times: normTimes }];\n        return 0;\n      }\n\n      /**\n       * Removes a callback function from an event stack given its index.\n       *\n       * @method  off\n       * @author  Fritz Lekschas\n       * @date    2016-01-07\n       *\n       * @param   {String}   event  Event identifier.\n       * @param   {Number}   index  Index of the callback to be removed.\n       * @return  {Boolean}         Returns `true` if event callback was found and\n       *   successfully removed.\n       */\n\n    }, {\n      key: 'off',\n      value: function off(event, index) {\n        try {\n          this.stack[event].splice(index, 1);\n          return true;\n        } catch (e) {\n          return false;\n        }\n      }\n\n      /**\n       * Trigger an event stack\n       *\n       * @method  trigger\n       * @author  Fritz Lekschas\n       * @date    2016-01-07\n       *\n       * @param   {String}   event  Event identifier.\n       * @return  {Boolean}         Returns `true` if an event stack was found.\n       */\n\n    }, {\n      key: 'trigger',\n      value: function trigger(event, data) {\n        if (isArray(this.stack[event])) {\n          // Traversing from the end to the start, which has the advantage that\n          // deletion of events, i.e. calling `Event.off()` doesn't affect the index\n          // of event listeners in the next step.\n          for (var i = this.stack[event].length; i--;) {\n            // Instead of checking whether `stack[event][i]` is a function here,\n            // we do it just once when we add the function to the stack.\n            if (this.stack[event][i].times--) {\n              this.stack[event][i].callback(data);\n            } else {\n              this.off(event, i);\n            }\n          }\n          return true;\n        }\n        return false;\n      }\n    }, {\n      key: 'stack',\n      get: function get() {\n        return this._stack;\n      }\n    }]);\n    return Events;\n  })();\n\n  var ListGraph = (function () {\n    function ListGraph(baseEl, data, rootNodes, options) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, ListGraph);\n\n      if (!d3.layout.listGraph) {\n        throw new LayoutNotAvailable();\n      }\n\n      if (!isObject(options)) {\n        options = {}; // eslint-disable-line no-param-reassign\n      }\n\n      var that = this;\n\n      this.baseEl = baseEl;\n      this.baseElD3 = d3.select(baseEl);\n      this.baseElJq = $(baseEl);\n      this.svgD3 = this.baseElD3.select('svg.base');\n\n      if (this.svgD3.empty()) {\n        this.svgD3 = this.baseElD3.append('svg').attr('class', 'base');\n        this.svgJq = $(this.svgD3[0]);\n      } else {\n        this.svgJq = $(this.svgD3[0]);\n      }\n\n      this.rootNodes = rootNodes;\n\n      this.width = options.width || this.svgJq.width();\n      this.height = options.height || this.svgJq.height();\n      this.scrollbarWidth = options.scrollbarWidth || SCROLLBAR_WIDTH;\n      this.columns = options.columns || COLUMNS;\n      this.rows = options.rows || ROWS;\n      this.iconPath = options.iconPath || ICON_PATH;\n      this.highlightActiveLevel = HIGHLIGHT_ACTIVE_LEVEL;\n      if (typeof options.highlightActiveLevel !== 'undefined') {\n        this.highlightActiveLevel = options.highlightActiveLevel;\n      }\n\n      // Determines which level from the rooted node will be regarded as active.\n      // Zero means that the level of the rooted node is regarded.\n      this.activeLevelNumber = ACTIVE_LEVEL_NUMBER;\n      if (typeof options.activeLevelNumber !== 'undefined') {\n        this.activeLevelNumber = options.activeLevelNumber;\n      }\n\n      this.noRootedNodeDifference = NO_ROOTED_NODE_DIFFERENCE;\n      if (typeof options.noRootedNodeDifference !== 'undefined') {\n        this.noRootedNodeDifference = options.noRootedNodeDifference;\n      }\n\n      this.lessAnimations = !!options.lessAnimations;\n      this.baseElD3.classed('less-animations', this.lessAnimations);\n\n      this.sortBy = options.sortBy;\n      this.sortOrder = options.sortOrder || DEFAULT_SORT_ORDER;\n\n      this.events = new Events(this.baseEl, options.dispatcher);\n\n      this.baseElJq.addClass(CLASSNAME);\n\n      if (options.forceWidth) {\n        this.baseElJq.width(this.width);\n      }\n\n      this.layout = new d3.layout.listGraph( // eslint-disable-line new-cap\n      [this.width, this.height], [this.columns, this.rows]);\n\n      this.data = data;\n      this.visData = this.layout.process(this.data, this.rootNodes, {\n        sortBy: this.sortBy,\n        sortOrder: this.sortOrder\n      });\n\n      /**\n       * Stores current sorting, e.g. type, order and a reference to the element.\n       *\n       * @type  {Object}\n       */\n      this.currentSorting = {\n        global: {\n          type: this.sortBy,\n          order: this.sortOrder\n        },\n        local: {}\n      };\n\n      exponentialGradient(this.svgD3, {\n        color: COLOR_NEGATIVE_RED,\n        offset: 0,\n        opacity: 0.2,\n        x: 0,\n        y: 0\n      }, {\n        afterOffsetOpacity: 1,\n        color: COLOR_NEGATIVE_RED,\n        offset: 99,\n        opacity: 1,\n        x: 1,\n        y: 0\n      }, 'negativeRed', 4, 10);\n\n      exponentialGradient(this.svgD3, {\n        beforeOffsetOpacity: 1,\n        color: COLOR_POSITIVE_GREEN,\n        offset: 1,\n        opacity: 1,\n        x: 0,\n        y: 0\n      }, {\n        color: COLOR_POSITIVE_GREEN,\n        offset: 100,\n        opacity: 0.2,\n        x: 1,\n        y: 0\n      }, 'positiveGreen', 0.25, 10);\n\n      this.barMode = options.barMode || DEFAULT_BAR_MODE;\n      this.svgD3.classed(this.barMode + '-bar', true);\n\n      this.topbar = new Topbar(this, this.baseElD3, this.visData);\n\n      this.svgD3.attr('viewBox', '0 0 ' + this.width + ' ' + this.height);\n\n      this.container = this.svgD3.append('g').attr('class', 'main-container');\n\n      this.levels = new Levels(this.container, this, this.visData);\n\n      this.links = new Links(this.levels.groups, this.visData, this.layout);\n      this.nodes = new Nodes(this, this.levels.groups, this.visData, this.links, this.events);\n      this.levels.scrollPreparation(this, this.scrollbarWidth);\n      this.scrollbars = new Scrollbars(this.levels.groups, this.visData, this.scrollbarWidth);\n\n      // jQuery's mousewheel plugin is much nicer than D3's half-baked zoom event.\n      this.$levels = $(this.levels.groups[0]).on('mousewheel', function (event) {\n        if (!that.zoomedOut) {\n          that.mousewheelColumn(this, event);\n        }\n      });\n\n      // Normally we would reference a named methods but since we need to aceess\n      // the class' `this` property instead of the DOM element we need to use an\n      // arrow function.\n      this.scrollbars.all.on('mousedown', function () {\n        that.scrollbarMouseDown(this, d3.event);\n      });\n\n      // We need to listen to `mouseup` and `mousemove` globally otherwise\n      // scrolling will only work as long as the cursor hovers the actual\n      // scrollbar, which is super annoying.\n      d3.select(document).on('mouseup', function () {\n        _this.globalMouseUp(d3.event);\n      }).on('mousemove', function () {\n        _this.globalMouseMove(d3.event);\n      });\n\n      // Enable dragging of the whole graph.\n      this.svgD3.call(onDragDrop, dragMoveHandler, undefined, [this.container, this.topbar.localControlWrapper], 'horizontal', this.getDragLimits.bind(this), [this.scrollbarDragging.bind(this)]);\n\n      this.events.on('d3ListGraphLevelFocus', function (levelId) {\n        return _this.levels.focus(levelId);\n      });\n\n      this.events.on('d3ListGraphNodeRoot', function () {\n        _this.nodes.bars.updateAll(_this.layout.updateBars(_this.data), _this.currentSorting.global.type);\n        _this.updateSorting();\n      });\n\n      this.events.on('d3ListGraphNodeUnroot', function () {\n        _this.nodes.bars.updateAll(_this.layout.updateBars(_this.data), _this.currentSorting.global.type);\n        _this.updateSorting();\n      });\n\n      this.events.on('d3ListGraphUpdateBars', function () {\n        _this.nodes.bars.updateAll(_this.layout.updateBars(_this.data), _this.currentSorting.global.type);\n        _this.updateSorting();\n      });\n\n      this.events.on('d3ListGraphActiveLevel', function (nextLevel) {\n        var oldLevel = _this.activeLevelNumber;\n        _this.activeLevelNumber = Math.max(nextLevel, 0);\n        if (_this.nodes.rootedNode) {\n          var rootNodeDepth = _this.nodes.rootedNode.datum().depth;\n          _this.levels.blur(rootNodeDepth + oldLevel);\n          _this.levels.focus(rootNodeDepth + _this.activeLevelNumber);\n        } else {\n          _this.levels.blur(oldLevel - _this.noRootedNodeDifference);\n          _this.levels.focus(_this.activeLevelNumber - _this.noRootedNodeDifference);\n        }\n      });\n    }\n\n    babelHelpers.createClass(ListGraph, [{\n      key: 'getDragLimits',\n      value: function getDragLimits() {\n        return {\n          x: {\n            min: this.dragMinX,\n            max: 0\n          }\n        };\n      }\n    }, {\n      key: 'scrollbarDragging',\n      value: function scrollbarDragging() {\n        return !!this.activeScrollbar;\n      }\n    }, {\n      key: 'globalMouseUp',\n      value: function globalMouseUp(event) {\n        if (this.activeScrollbar) {\n          var data = this.activeScrollbar.datum();\n          var deltaY = data.scrollbar.clientY - event.clientY;\n\n          // Save final vertical position\n          // Scrollbar\n          data.scrollbar.scrollTop = Math.min(Math.max(data.scrollbar.scrollTop - deltaY, 0), data.scrollbar.scrollHeight);\n\n          // Content\n          data.scrollTop = Math.max(Math.min(data.scrollTop + data.invertedHeightScale(deltaY), 0), -data.scrollHeight);\n\n          this.activeScrollbar.classed('active', false);\n\n          this.activeScrollbar = undefined;\n        }\n      }\n    }, {\n      key: 'globalMouseMove',\n      value: function globalMouseMove(event) {\n        if (this.activeScrollbar) {\n          var data = this.activeScrollbar.datum();\n          var deltaY = data.scrollbar.clientY - event.clientY;\n\n          // Scroll scrollbar\n          ListGraph.scrollY(this.activeScrollbar.node(), Math.min(Math.max(data.scrollbar.scrollTop - deltaY, 0), data.scrollbar.scrollHeight));\n\n          // Scroll content\n          var contentScrollTop = Math.max(Math.min(data.scrollTop + data.invertedHeightScale(deltaY), 0), -data.scrollHeight);\n\n          ListGraph.scrollY(data.nodes, contentScrollTop);\n\n          // Scroll Links\n          this.links.scroll(data.linkSelections.outgoing, this.layout.offsetLinks(data.level, contentScrollTop, 'source'));\n\n          this.links.scroll(data.linkSelections.incoming, this.layout.offsetLinks(data.level - 1, contentScrollTop, 'target'));\n        }\n      }\n    }, {\n      key: 'scrollbarMouseDown',\n      value: function scrollbarMouseDown(el, event) {\n        this.activeScrollbar = d3.select(el).classed('active', true);\n        this.activeScrollbar.datum().scrollbar.clientY = event.clientY;\n      }\n    }, {\n      key: 'mousewheelColumn',\n      value: function mousewheelColumn(el, event) {\n        event.preventDefault();\n\n        var data = d3.select(el).datum();\n\n        if (data.scrollHeight > 0) {\n          // Scroll nodes\n          data.scrollTop = Math.max(Math.min(data.scrollTop + event.deltaY, 0), -data.scrollHeight);\n\n          ListGraph.scrollY(data.nodes, data.scrollTop);\n\n          // Scroll scrollbar\n          data.scrollbar.scrollTop = data.scrollbar.heightScale(-data.scrollTop);\n\n          ListGraph.scrollY(data.scrollbar.el, data.scrollbar.scrollTop);\n\n          // Scroll Links\n          this.links.scroll(data.linkSelections.outgoing, this.layout.offsetLinks(data.level, data.scrollTop, 'source'));\n\n          this.links.scroll(data.linkSelections.incoming, this.layout.offsetLinks(data.level - 1, data.scrollTop, 'target'));\n        }\n      }\n    }, {\n      key: 'selectByLevel',\n      value: function selectByLevel(level, selector) {\n        return d3.select(this.levels.groups[0][level]).selectAll(selector);\n      }\n    }, {\n      key: 'updateSorting',\n      value: function updateSorting() {\n        var levels = Object.keys(this.currentSorting.local);\n        for (var i = levels.length; i--;) {\n          this.sortColumn(i, this.currentSorting.local[levels[i]].type, this.currentSorting.local[levels[i]].order, this.currentSorting.local[levels[i]].type);\n        }\n      }\n    }, {\n      key: 'sortColumn',\n      value: function sortColumn(level, property, sortOrder, newSortType) {\n        this.nodes.sort(this.layout.sort(level, property, sortOrder).updateNodesVisibility().nodes(level), newSortType);\n        this.links.sort(this.layout.links(level - 1, level + 1));\n      }\n    }, {\n      key: 'sortAllColumns',\n      value: function sortAllColumns(property, sortOrder, newSortType) {\n        this.nodes.sort(this.layout.sort(undefined, property, sortOrder).updateNodesVisibility().nodes(), newSortType);\n        this.links.sort(this.layout.links());\n      }\n    }, {\n      key: 'switchBarMode',\n      value: function switchBarMode(mode) {\n        this.svgD3.classed('one-bar', mode === 'one');\n        this.svgD3.classed('two-bar', mode === 'two');\n        this.nodes.bars.switchMode(mode, this.currentSorting);\n      }\n    }, {\n      key: 'trigger',\n      value: function trigger(event, data) {\n        this.events.trigger(event, data);\n      }\n    }, {\n      key: 'updateScrollbarVisibility',\n      value: function updateScrollbarVisibility() {\n        this.levels.updateScrollProperties();\n        this.scrollbars.updateVisibility();\n      }\n    }, {\n      key: 'updateLevelsVisibility',\n      value: function updateLevelsVisibility() {\n        this.levels.updateVisibility();\n      }\n    }, {\n      key: 'globalView',\n      value: function globalView(selectionInterst) {\n        var _this2 = this;\n\n        if (!this.zoomedOut) {\n          (function () {\n            var x = 0;\n            var y = 0;\n            var width = 0;\n            var height = 0;\n            var bBox = undefined;\n            var cRect = undefined;\n\n            var globalCRect = _this2.svgD3.node().getBoundingClientRect();\n\n            if (selectionInterst && !selectionInterst.empty()) {\n              selectionInterst.each(function () {\n                bBox = this.getBBox();\n                cRect = this.getBoundingClientRect();\n                width = Math.max(width, cRect.left - globalCRect.left + cRect.width);\n                height = Math.max(height, cRect.top - globalCRect.top + cRect.height);\n              });\n              width = _this2.width > width ? _this2.width : width;\n              height = _this2.height > height ? _this2.height : height;\n            } else {\n              bBox = _this2.container.node().getBBox();\n              width = _this2.width > bBox.width ? _this2.width : bBox.width;\n              height = _this2.height > bBox.height ? _this2.height : bBox.height;\n            }\n\n            x = bBox.x;\n            y = bBox.y;\n\n            _this2.svgD3.classed('zoomedOut', true).transition().duration(TRANSITION_SEMI_FAST).attr('viewBox', x + ' ' + y + ' ' + width + ' ' + height);\n          })();\n        }\n      }\n    }, {\n      key: 'zoomedView',\n      value: function zoomedView() {\n        if (!this.zoomedOut) {\n          this.svgD3.classed('zoomedOut', false).transition().duration(TRANSITION_SEMI_FAST).attr('viewBox', '0 0 ' + this.width + ' ' + this.height);\n        }\n      }\n    }, {\n      key: 'toggleView',\n      value: function toggleView() {\n        if (this.zoomedOut) {\n          this.zoomedOut = false;\n          this.zoomedView();\n        } else {\n          this.globalView();\n          this.zoomedOut = true;\n        }\n      }\n    }, {\n      key: 'area',\n      get: function get() {\n        return this.container.node().getBoundingClientRect();\n      }\n    }, {\n      key: 'dragMinX',\n      get: function get() {\n        return Math.min(0, this.width - this.area.width);\n      }\n    }, {\n      key: 'barMode',\n      get: function get() {\n        if (this.bars) {\n          return this.nodes.bars.mode;\n        }\n        return this._barMode;\n      },\n      set: function set(mode) {\n        if (this.bars) {\n          this.nodes.bars.mode = mode;\n        }\n        this._barMode = mode;\n      }\n    }], [{\n      key: 'scrollY',\n      value: function scrollY(el, offset) {\n        d3.select(el).attr('transform', 'translate(0, ' + offset + ')');\n      }\n    }]);\n    return ListGraph;\n  })();\n\n  return ListGraph;\n\n})($,d3);"],"sourceRoot":"/source/"}