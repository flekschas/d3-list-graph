{"version":3,"sources":["listGraph.min.js"],"names":["global","factory","exports","module","require","define","amd","ListGraph","$","d3","this","isObject","value","type","isFunction","tag","objectToString","call","funcTag","genTag","isFinite","nativeIsFinite","collectInclClones","node","onlyForOriginalNode","originalNode","clone","clones","length","concat","_up","callback","depth","includeClones","child","visitedNodes","id","nodes","i","parentsId","Object","keys","parents","j","up","undefined","_down","childRefs","down","upAndDown","callbackUp","callbackDown","siblings","siblingsId","_i","roundRect","x","y","width","height","radius","topLeft","topRight","bottomLeft","bottomRight","dropMenu","c","arrowSize","mergeSelections","selections","mergedSelection","selectAll","_groups","allTransitionsEnded","transition","size","n","each","on","_len","arguments","args","Array","_key","apply","objectOrFunction","isFunction$1","setScheduler","scheduleFn","customSchedulerFn","setAsap","asapFn","asap","useNextTick","process","nextTick","flush","useVertxTimer","vertxNext","useMutationObserver","iterations","observer","BrowserMutationObserver","document","createTextNode","observe","characterData","data","useMessageChannel","channel","MessageChannel","port1","onmessage","port2","postMessage","useSetTimeout","setTimeout","len","queue","arg","attemptVertx","r","vertx","runOnLoop","runOnContext","e","then","onFulfillment","onRejection","parent","constructor","noop","PROMISE_ID","makePromise","state","_state","invokeCallback","_result","subscribe","resolve","object","Constructor","promise","_resolve","selfFulfillment","TypeError","cannotReturnOwn","getThen","error","GET_THEN_ERROR","tryThen","fulfillmentHandler","rejectionHandler","handleForeignThenable","thenable","sealed","fulfill","reason","_reject","_label","handleOwnThenable","FULFILLED","REJECTED","handleMaybeThenable","maybeThenable","then$$","publishRejection","_onerror","publish","PENDING","_subscribers","subscribers","settled","detail","ErrorObject","tryCatch","TRY_CATCH_ERROR","succeeded","failed","hasCallback","initializePromise","resolver","nextId","Enumerator","input","_instanceConstructor","isArray$1","_input","_remaining","_enumerate","validationError","Error","all","entries","race","reject","needsResolver","needsNew","Promise$1","isObjectLike","isSymbol","objectToString$1","symbolTag","toNumber","NAN","other","valueOf","replace","reTrim","isBinary","reIsBinary","test","reIsOctal","freeParseInt","slice","reIsBadHex","debounce","func","wait","options","invokeFunc","time","lastArgs","thisArg","lastThis","lastInvokeTime","result","leadingEdge","timerId","timerExpired","leading","remainingWait","timeSinceLastCall","lastCallTime","timeSinceLastInvoke","maxing","nativeMin","maxWait","shouldInvoke","now","trailingEdge","trailing","cancel","clearTimeout","debounced","isInvoking","FUNC_ERROR_TEXT","nativeMax","onDragDrop","selection","dragStartHandler","dragMoveHandler","dropHandler","elsToBeDragged","orientation","limits","noDraggingWhenTrue","dragData","clickTolerance","drag","checkWhenDragging","appliedLimits","filter","d2","event","sourceEvent","preventDefault","dx","dy","select","window","el","datum","withinLimits","applyingLimits","restrictedValue","Math","min","max","LimitsUnsupportedFormat","els","style","dropShadow","name","blur","opacity","defs","empty","append","attr","feMerge","setOption","defaultValue","noFalsyValue","_isArray","isArray","classCallCheck","instance","createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","protoProps","staticProps","prototype","inherits","subClass","superClass","create","setPrototypeOf","__proto__","possibleConstructorReturn","self","ReferenceError","ExtendableError","_Error","message","_this","getPrototypeOf","captureStackTrace","D3VersionFourRequired","_ExtendableError","versionFound","LayoutNotAvailable","_ExtendableError2","NoObject","variableName","EventDispatcherNoFunction","CLASSNAME","SCROLLBAR_WIDTH","COLUMNS","ROWS","ICON_PATH","DEFAULT_SORT_ORDER","DEFAULT_BAR_MODE","HIGHLIGHT_ACTIVE_LEVEL","ACTIVE_LEVEL","NO_ROOT_ACTIVE_LEVEL_DIFF","QUERYING","HIDE_OUTWARDS_LINKS","SHOW_LINK_LOCATION","DISABLE_DEBOUNCED_CONTEXT_MENU","TRANSITION_LIGHTNING_FAST","TRANSITION_SEMI_FAST","LINK_BUNDLING_STRENGTH","TOPBAR_EL","TOPBAR_CLASS","TOPBAR_CONTROL_EL","TOPBAR_CONTROL_CLASS","TOPBAR_GLOBAL_CONTROL_CLASS","Topbar","vis","visData","insert","controlSwitch","column","padding","classed","switch","bind","switchArrow","iconPath","globalControls","globalPrecision","currentSorting","sortAllColumns","interactionWrapper","highlightBars","globalPrecisionWrapper","text","order","globalRecall","globalRecallWrapper","globalName","highlightLabels","globalNameWrapper","globalOneBar","barMode","switchBarMode","globalOneBarWrapper","globalTwoBars","globalTwoBarsWrapper","globalZoomOut","zoomedOut","globalView","zoomedView","toggleView","globalZoomOutWrapper","localControlWrapper","localControls","enter","index","control","local","sortBy","sortOrder","toggleColumn","contentWidth","controlData","sortColumn","level","parentNode","html","toggleOptions","selectByLevel","deHighlight","baseElD3","selectNodesLevel","newSortType","semiActiveSortingEls","resetSemiActiveSortingEls","resetSortEl","columnKeys","newType","mode","COLUMN_CLASS","SCROLL_CONTAINER_CLASS","Levels","groups","highlightActiveLevel","rootedNode","activeLevel","noRootActiveLevelDiff","scrollTop","scrollbarWidth","_this2","contentHeight","getBoundingClientRect","row","scrollHeight","scrollbarHeight","linkSelections","incoming","outgoing","scrollbar","heightScale","scaleLinear","domain","range","invertedHeightScale","invert","_this3","group","hidden","get","LINKS_CLASS","LINK_CLASS","Links","levels","layout","links","hideOutwardsLinks","linkVisibility","diagonal","pointsOutside","nodeIds","_highlight","className","unset","update","start","end","duration","source","getSourceX","offsetX","getTargetX","getY","offsetY","extraOffsetX","showLinkLocation","getLine","line","curve","curveBundle","beta","points","sourceX","sourceY","targetX","targetY","middleX","relMiddleX","push","objectProto","toString","freeGlobal","freeSelf","root","Function","BAR_CLASS","Bar","baseEl","barData","nodeData","bars","setupMagnitude","generatePath","setupBorder","cell","activeHeight","inactiveheight","BARS_CLASS","Bars","xScale","barId","insertBefore","children","generateOneBarPath","generateTwoBarsPath","normValue","isBottom","CLASS_NODES","CLASS_NODE","CLASS_NODE_VISIBLE","CLASS_CLONE","CLASS_LABEL_WRAPPER","CLASS_FOCUS_CONTROLS","CLASS_ROOT","CLASS_QUERY","CLASS_LOCK","CLASS_INACTIVE","CLASS_INDICATOR_BAR","CLASS_INDICATOR_LOCATION","CLASS_INDICATOR_INCOMING","CLASS_INDICATOR_OUTGOING","CLASS_INDICATOR_ABOVE","CLASS_INDICATOR_BELOW","Nodes","baseSelection","events","drawLinkIndicator","direction","linkDensityBg","refs","drawLinkLocationIndicator","position","above","drawFullSizeRect","shrinking","noRoundBorder","shrinkingAmount","drawMaxSizedRect","currentLinks","iconDimension","rows","visNodes","calcHeightLinkLocationIndicator","nodeRooted","setUpFocusControls","querying","nodeQuery","focusNodes","blurNodes","eventHelper","highlightNodes","unhighlightNodes","toggleLock","toggleRoot","isInvisible","left","right","below","total","updateHeightLinkLocationIndicatorBars","barRefHeight","barAboveRefTop","baseClassName","eventData","clonedFromId","broadcast","d3El","locked","unlocked","lock","unlock","unroot","rooted","unrooted","same","checkNodeFocusEventSame","nodeFocusId","excludeClones","zoomOut","hideUnrelatedNodes","hovering","tempHidingUnrelatedNodes","showUnrelatedNodes","zoomIn","_hidden","updateVisibility","optionalParams","subSelectionClass","indexOf","setFalse","lockedNode","unlockNode","lockNode","query","active","inactive","query-and","query-or","query-not","queryBeforeRooting","previousMode","queryByNode","unqueryByNode","noNotification","actions","queryHandler","action","returnNoNotification","toggleQueryByNode","queries","unrootNode","unquery","focus","rootNode","batchQueryHandler","hideNodes","showNodes","location","paddedDim","nodesVisibility","show","customScrollTop","dragged","invisible","prevInvisible","_invisible","restriction","noVisibilityCheck","checkNodeVisibility","_el","_data","isHidden","checkNodeDirect","checkNodeIndirect","nodeId","currentNodeData","includeParents","appliedClassName","includeChildren","currentlyActiveBar","traverseCallbackUp","childData","traverseCallbackDown","highlight","traverseCallback","_this4","svgD3","updateLevelsVisibility","updateScrolling","_this5","updateNodesVisibility","SCROLLBAR_CLASS","Scrollbars","Events","_stack","dispatch","_dispatchEvent","eventName","createEvent","initCustomEvent","dispatchEvent","times","normTimes","parseInt","Infinity","stack","splice","off","scheduleFlush","browserWindow","browserGlobal","MutationObserver","WebKitMutationObserver","isNode","isWorker","Uint8ClampedArray","importScripts","random","substring","_eachEntry","entry","resolve$$","_settledAt","_willSettleAt","enumerator","_setScheduler","_setAsap","_asap","catch","Date","objectProto$1","requestAnimationFrame","lastTime","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","currTime","getTime","timeToCall","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","oCancelAnimationFrame","msCancelAnimationFrame","nextAnimationFrame","requestId","floor","ids","request","requestNextAnimationFrame","element","ts","cancelNextAnimationFrame","CLASS_NAME","CLASS_CHECKBOX","ARROW_SIZE","TRANSITION_SPEED","BUTTON_QUERY_DEBOUNCE","BUTTON_ROOT_DEBOUNCE","BUTTON_DEFAULT_DEBOUNCE","BUTTON_BAM_EFFECT_ANIMATION_TIME","NodeContextMenu","init","_x","_y","_yOffset","_scale","isQueryable","infoFields","isDebounced","numButtonRows","toBottom","nodeInfoId","wrapper","updateAppearance","bgWrapper","bgBorder","bg","textNodeInfo","createTextField","alignRight","classNames","distanceFromCenter","fullWidth","labels","toggler","clickNodeInfo","togglerX","togglerY","buttonQuery","createButton","label","labelTwo","bamEffect","clickQueryHandler","buttonQueryFill","buttonQueryBamEffect","buttonRoot","clickRootHandler","buttonRootFill","checkboxRoot","createCheckbox","buttonLock","clickLockHandler","buttonLockFill","buttonLockBamEffect","checkboxLock","components","debouncedQueryHandler","debouncedRootHandler","rootHandler","isToggable","div","checked","checkBoxMovement","fillButton","emptyButton","positionComponent","translate","currentRootState","tempRoot","showElement","hideElement","lockHandler","checkLock","triggerButtonBamEffect","getNodeProperty","property","updateQuery","checkRoot","closing","opened","visible","properties","join","createButtonBg","addLabel","rx","ry","round","container","ease","easeLinear","columnNum","updateStates","checkOrientation","tempQueryMode","currentQueryMode","close","offset","_this6","closed","previousNodeId","open","button","centerY","scale","nextQueryMode","queryMode","updateInfoText","set","_d3","version","listGraph","__d3ListGraphBase__","baseElJq","svgEl","outsideClickHandler","outsideClickClassHandler","svgJq","rootNodes","getBoundingRect","columns","linkLocationBucketSize","lessTransitionsJs","lessTransitions","lessTransitionsCss","disableDebouncedContextMenu","nodeInfoContextMenu","dispatcher","addClass","forceWidth","grid","topbar","scrollPreparation","scrollbars","nodeContextMenu","mouseDownOnContextMenu","mousewheelColumn","checkGlobalClick","classNodeVisible","registerOutSideClickHandler","unregisterOutSideClickHandler","toggle","classFocusControls","classRoot","classQuery","classLock","domEl","activeScrollbar","enterHandler","leaveHandler","scrollbarMouseDown","globalMouseUp","dragEndHandler","getDragLimits","noDragging","levelId","updateAll","updateBars","updateSorting","nextLevel","oldLevel","rootNodeDepth","notWhenTrue","elClassNames","__id__","newLength","handler","found","checkClass","_i2","getAttribute","handlerIds","_i3","dragMinX","top","params","noInteractions","dragging","deltaY","clientY","stopScrollBarMouseMove","dragScrollbar","scrollElVertically","contentScrollTop","scroll","offsetLinks","updateLinkLocationIndicators","scrollY","startScrollBarMouseMove","columnData","scrollbarDragging","isOpenSameColumn","positionY","tween","scrollPositionY","interpolateNumber","scrollYTo","selector","sort","updatePosition","switchMode","trigger","resetAllScrollPositions","updateScrollProperties","selectionInterst","cRect","contBBox","getBBox","globalCRect","makeAllTempVisible","boundingRect","linkPointsOutside","area","_barMode"],"mappings":"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","file":"listGraph.min.js","sourcesContent":["/* Copyright Fritz Lekschas: D3 example visualization app using the list-like graph layout */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('$'), require('d3')) :\n  typeof define === 'function' && define.amd ? define(['$', 'd3'], factory) :\n  (global.ListGraph = factory(global.$,global.d3));\n}(this, (function ($,d3) { 'use strict';\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nvar createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar inherits = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\nvar possibleConstructorReturn = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n};\n\n/**\n * Base error class.\n */\nvar ExtendableError = function (_Error) {\n  inherits(ExtendableError, _Error);\n\n  /**\n   * Constructor.\n   *\n   * @method  constructor\n   * @author  Fritz Lekschas\n   * @date    2016-09-12\n   * @param   {String}  message  Custom error message.\n   */\n  function ExtendableError(message) {\n    classCallCheck(this, ExtendableError);\n\n    var _this = possibleConstructorReturn(this, (ExtendableError.__proto__ || Object.getPrototypeOf(ExtendableError)).call(this, message));\n\n    _this.name = _this.constructor.name;\n    _this.message = message;\n    Error.captureStackTrace(_this, _this.constructor.name);\n    return _this;\n  }\n\n  return ExtendableError;\n}(Error);\n\n/**\n * D3 version 4 not found error.\n */\nvar D3VersionFourRequired = function (_ExtendableError) {\n  inherits(D3VersionFourRequired, _ExtendableError);\n\n  /**\n   * Constructor\n   *\n   * @method  constructor\n   * @author  Fritz Lekschas\n   * @date    2016-09-12\n   * @param   {String}  versionFound  D3 version string.\n   */\n  function D3VersionFourRequired(versionFound) {\n    classCallCheck(this, D3VersionFourRequired);\n    return possibleConstructorReturn(this, (D3VersionFourRequired.__proto__ || Object.getPrototypeOf(D3VersionFourRequired)).call(this, 'D3 version 4 is required to run the code. Found version ' + versionFound));\n  }\n\n  return D3VersionFourRequired;\n}(ExtendableError);\n\n/**\n * When varible is no object\n */\nvar NoObject = function (_ExtendableError2) {\n  inherits(NoObject, _ExtendableError2);\n\n  /**\n   * Constructor\n   *\n   * @method  constructor\n   * @author  Fritz Lekschas\n   * @date    2016-09-12\n   * @param   {String}  variableName  Name of the variable that ought to be an\n   *   object.\n   */\n  function NoObject(variableName) {\n    classCallCheck(this, NoObject);\n    return possibleConstructorReturn(this, (NoObject.__proto__ || Object.getPrototypeOf(NoObject)).call(this, 'The \"' + variableName + '\" must be an object.'));\n  }\n\n  return NoObject;\n}(ExtendableError);\n\n// Internal\nvar LayoutNotAvailable = function (_ExtendableError) {\n  inherits(LayoutNotAvailable, _ExtendableError);\n\n  function LayoutNotAvailable(message) {\n    classCallCheck(this, LayoutNotAvailable);\n    return possibleConstructorReturn(this, (LayoutNotAvailable.__proto__ || Object.getPrototypeOf(LayoutNotAvailable)).call(this, message || 'D3.layout.listGraph.js has not been loaded yet.'));\n  }\n\n  return LayoutNotAvailable;\n}(ExtendableError);\n\nvar EventDispatcherNoFunction = function (_ExtendableError2) {\n  inherits(EventDispatcherNoFunction, _ExtendableError2);\n\n  function EventDispatcherNoFunction(message) {\n    classCallCheck(this, EventDispatcherNoFunction);\n    return possibleConstructorReturn(this, (EventDispatcherNoFunction.__proto__ || Object.getPrototypeOf(EventDispatcherNoFunction)).call(this, message || 'Dispatcher needs to be a function.'));\n  }\n\n  return EventDispatcherNoFunction;\n}(ExtendableError);\n\nvar CLASSNAME = 'list-graph';\n\n/**\n * Width of the scrollbar in pixel.\n *\n * @type  {Number}\n */\nvar SCROLLBAR_WIDTH = 6;\n\n/**\n * Default number of columns\n *\n * @type  {Number}\n */\nvar COLUMNS = 5;\n\n/**\n * Default number of rows.\n *\n * @type  {Number}\n */\nvar ROWS = 5;\n\n/**\n * Path to the icon file. An empty path is equal to inline SVG.\n *\n * @type  {String}\n */\nvar ICON_PATH = '';\n\n/**\n * Default sort order.\n *\n * @description\n * -1 = desc, 1 = asc\n *\n * @type  {Number}\n */\nvar DEFAULT_SORT_ORDER = -1;\n\n/**\n * Default bar display mode.\n *\n * @type  {String}\n */\nvar DEFAULT_BAR_MODE = 'one';\n\n/**\n * Default highlighting of the active level.\n *\n * @type  {Boolean}\n */\nvar HIGHLIGHT_ACTIVE_LEVEL = true;\n\n/**\n * Default active level.\n *\n * @type  {Number}\n */\nvar ACTIVE_LEVEL = 0;\n\n/**\n * Default difference when no custom root is queried for.\n *\n * @type  {Number}\n */\nvar NO_ROOT_ACTIVE_LEVEL_DIFF = 0;\n\n/**\n * Default querying.\n *\n * @type  {Boolean}\n */\nvar QUERYING = false;\n\n/**\n * Default value for hiding links pointing to nodes outside the visible area.\n *\n * @type  {Boolean}\n */\nvar HIDE_OUTWARDS_LINKS = false;\n\n/**\n * Default value for showing the link indicator bar when links to hidden nodes\n * are hidden.\n *\n * @type  {Boolean}\n */\nvar SHOW_LINK_LOCATION = false;\n\n/**\n * Default for disabling debouncing of the node context menu.\n *\n * @type  {Boolean}\n */\nvar DISABLE_DEBOUNCED_CONTEXT_MENU = false;\n\n/**\n * Default transition speed in milliseconds for super fast transition.\n *\n * @type  {Number}\n */\nvar TRANSITION_LIGHTNING_FAST = 150;\n\n/**\n * Default transition speed in milliseconds for semi-fast transition.\n *\n * @type  {Number}\n */\nvar TRANSITION_SEMI_FAST = 250;\n/**\n * Strength of how much links should be bundled.\n *\n * @description\n * The value ranges from 0 (no bundling at all) to 1 (move line through every\n * controll point).\n *\n * @type  {Number}\n */\nvar LINK_BUNDLING_STRENGTH = 0.95;\n\n// External\n// eslint-disable-line import/no-unresolved\n\nvar TOPBAR_EL = 'div';\nvar TOPBAR_CLASS = 'top-bar';\n\nvar TOPBAR_CONTROL_EL = 'ul';\nvar TOPBAR_CONTROL_CLASS = 'controls';\nvar TOPBAR_GLOBAL_CONTROL_CLASS = 'global-controls';\n\nvar Topbar = function () {\n  function Topbar(vis, selection, visData) {\n    var _this = this;\n\n    classCallCheck(this, Topbar);\n\n    var self = this;\n\n    this.vis = vis;\n    this.visData = visData;\n    // Add base topbar element\n    this.el = selection.select('.' + TOPBAR_CLASS);\n\n    if (this.el.empty()) {\n      this.el = selection.insert(TOPBAR_EL, ':first-child').attr('class', TOPBAR_CLASS);\n    }\n\n    this.controlSwitch = this.el.append('div').attr('title', 'Toggle global / local topbar').style('width', this.visData.global.column.padding + 'px').classed('control-switch', true).on('click', this.switch.bind(this));\n\n    this.switchArrow = this.controlSwitch.append('svg').append('use').attr('xlink:href', this.vis.iconPath + '#arrow-down').attr('class', 'switch-arrow');\n\n    this.globalControls = this.el.append(TOPBAR_CONTROL_EL).classed(TOPBAR_GLOBAL_CONTROL_CLASS, true);\n\n    // Add button for sorting by precision\n    this.globalPrecision = this.globalControls.append('li').attr('class', 'control-btn sort-precision').classed('active', function () {\n      if (self.vis.currentSorting.global.type === 'precision') {\n        // Save currently active element. Needed when when re-sorting for the\n        // first time, to be able to de-highlight this element.\n        self.vis.currentSorting.global.el = d3.select(this);\n        return true;\n      }\n      return false;\n    }).on('click', function () {\n      self.sortAllColumns(this, 'precision');\n    }).on('mouseenter', function () {\n      _this.vis.interactionWrapper.call(_this.vis, function () {\n        _this.highlightBars(undefined, 'precision');\n      }, []);\n    }).on('mouseleave', function () {\n      _this.vis.interactionWrapper.call(_this.vis, function () {\n        _this.highlightBars(undefined, 'precision', true);\n      }, []);\n    });\n\n    this.globalPrecisionWrapper = this.globalPrecision.append('div').attr('class', 'wrapper');\n\n    this.globalPrecisionWrapper.append('span').attr('class', 'label').text('Precision');\n\n    this.globalPrecisionWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'precision').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n    this.globalPrecisionWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'precision' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-asc');\n\n    this.globalPrecisionWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'precision' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-desc');\n\n    // Add button for sorting by recall\n    this.globalRecall = this.globalControls.append('li').attr('class', 'control-btn sort-recall').classed('active', function () {\n      if (self.vis.currentSorting.global.type === 'recall') {\n        // See precision\n        self.vis.currentSorting.global.el = d3.select(this);\n        return true;\n      }\n      return false;\n    }).on('click', function () {\n      self.sortAllColumns(this, 'recall');\n    }).on('mouseenter', function () {\n      _this.vis.interactionWrapper.call(_this.vis, function () {\n        _this.highlightBars(undefined, 'recall');\n      }, []);\n    }).on('mouseleave', function () {\n      _this.vis.interactionWrapper.call(_this.vis, function () {\n        _this.highlightBars(undefined, 'recall', true);\n      }, []);\n    });\n\n    this.globalRecallWrapper = this.globalRecall.append('div').attr('class', 'wrapper');\n\n    this.globalRecallWrapper.append('span').attr('class', 'label').text('Recall');\n\n    this.globalRecallWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'recall').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n    this.globalRecallWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'recall' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-asc');\n\n    this.globalRecallWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'recall' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-desc');\n\n    // Add button for sorting by name\n    this.globalName = this.globalControls.append('li').attr('class', 'control-btn sort-name').classed('active', function () {\n      if (self.vis.currentSorting.global.type === 'name') {\n        // See precision\n        self.vis.currentSorting.global.el = d3.select(this);\n        return true;\n      }\n      return false;\n    }).on('click', function () {\n      self.sortAllColumns(this, 'name');\n    }).on('mouseenter', function () {\n      _this.vis.interactionWrapper.call(_this.vis, function () {\n        _this.highlightLabels();\n      }, []);\n    }).on('mouseleave', function () {\n      _this.vis.interactionWrapper.call(_this.vis, function () {\n        _this.highlightLabels(true);\n      }, []);\n    });\n\n    this.globalNameWrapper = this.globalName.append('div').attr('class', 'wrapper');\n\n    this.globalNameWrapper.append('span').attr('class', 'label').text('Name');\n\n    this.globalNameWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'name').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n    this.globalNameWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'name' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-alpha-asc');\n\n    this.globalNameWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'name' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-alpha-desc');\n\n    // Add button for switching to 'one bar'\n    this.globalOneBar = this.globalControls.append('li').attr('class', 'control-btn one-bar').classed('active', this.vis.barMode === 'one').on('click', function () {\n      self.switchBarMode(this, 'one');\n    });\n\n    this.globalOneBarWrapper = this.globalOneBar.append('div').attr('class', 'wrapper').text('One bar');\n\n    this.globalOneBarWrapper.append('svg').attr('class', 'icon-one-bar').append('use').attr('xlink:href', this.vis.iconPath + '#one-bar');\n\n    // Add button for switching to 'two bars'\n    this.globalTwoBars = this.globalControls.append('li').attr('class', 'control-btn two-bars').classed('active', this.vis.barMode === 'two').on('click', function () {\n      self.switchBarMode(this, 'two');\n    });\n\n    this.globalTwoBarsWrapper = this.globalTwoBars.append('div').attr('class', 'wrapper').text('Two bars');\n\n    this.globalTwoBarsWrapper.append('svg').attr('class', 'icon-two-bars').append('use').attr('xlink:href', this.vis.iconPath + '#two-bars');\n\n    // Add button for zoom-out\n    this.globalZoomOut = this.globalControls.append('li').attr('class', 'control-btn zoom-out').classed('active', this.vis.zoomedOut).on('mouseenter', function () {\n      _this.vis.interactionWrapper.call(_this.vis, function () {\n        _this.vis.globalView.call(_this.vis);\n      }, []);\n    }).on('mouseleave', function () {\n      _this.vis.interactionWrapper.call(_this.vis, function () {\n        _this.vis.zoomedView.call(_this.vis);\n      }, []);\n    }).on('click', function () {\n      self.vis.toggleView.call(self.vis);\n      d3.select(this).classed('active', self.vis.zoomedOut);\n    });\n\n    this.globalZoomOutWrapper = this.globalZoomOut.append('div').attr('class', 'wrapper').text('Zoom Out');\n\n    this.globalZoomOutWrapper.append('svg').attr('class', 'icon-zoom-out').append('use').attr('xlink:href', this.vis.iconPath + '#zoom-out');\n\n    this.localControlWrapper = this.el.append('div').classed('local-controls', true);\n\n    this.localControls = this.localControlWrapper.selectAll(TOPBAR_CONTROL_CLASS).data(visData.nodes).enter().append(TOPBAR_CONTROL_EL).classed(TOPBAR_CONTROL_CLASS, true).style('width', this.visData.global.column.width + 'px');\n\n    this.localControls.each(function (data, index) {\n      var control = d3.select(this);\n\n      /*\n       * Order:\n       * 0 = unsorted\n       * 1 = asc\n       * -1 = desc\n       */\n      self.vis.currentSorting.local[index] = {\n        type: data.sortBy,\n        order: data.sortOrder,\n        el: undefined\n      };\n\n      control.append('li').attr('class', 'control-btn toggle').style('width', self.visData.global.column.padding + 'px').on('click', self.toggleColumn);\n\n      control.append('li').attr('class', 'control-btn sort-precision ease-all').classed('active', function () {\n        if (self.vis.currentSorting.local[index].type === 'precision') {\n          // See precision\n          self.vis.currentSorting.local[index].el = d3.select(this);\n          return true;\n        }\n        return false;\n      }).style('width', self.visData.global.column.contentWidth / 2 + 'px').style('left', self.visData.global.column.padding + 'px').on('click', function (controlData) {\n        self.sortColumn(this, controlData.level, 'precision');\n      }).on('mouseenter', function () {\n        self.highlightBars(this.parentNode, 'precision');\n        d3.select(this).style('width', self.visData.global.column.contentWidth - 16 + 'px');\n      }).on('mouseleave', function () {\n        self.highlightBars(this.parentNode, 'precision', true);\n        d3.select(this).style('width', self.visData.global.column.contentWidth / 2 + 'px');\n      }).html('<div class=\"expandable-label\">' + '  <span class=\"letter abbr\">P</span>' + '  <span class=\"letter abbr\">r</span>' + '  <span class=\"letter\">e</span>' + '  <span class=\"letter abbr\">c</span>' + '  <span class=\"letter\">i</span>' + '  <span class=\"letter\">s</span>' + '  <span class=\"letter\">i</span>' + '  <span class=\"letter\">o</span>' + '  <span class=\"letter\">n</span>' + '</div>' + '<svg class=\"icon-unsort invisible-default ' + (self.vis.currentSorting.local[index].type !== 'precision' ? 'visible' : '') + '\">' + // eslint-disable-line\n      '  <use xlink:href=\"' + self.vis.iconPath + '#unsort\"></use>' + '</svg>' + '<svg class=\"icon-sort-asc invisible-default ' + (self.vis.currentSorting.local[index].type === 'precision' && self.vis.currentSorting.local[index].order === 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n      '  <use xlink:href=\"' + self.vis.iconPath + '#sort-asc\"></use>' + '</svg>' + '<svg class=\"icon-sort-desc invisible-default ' + (self.vis.currentSorting.local[index].type === 'precision' && self.vis.currentSorting.local[index].order !== 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n      '  <use xlink:href=\"' + self.vis.iconPath + '#sort-desc\"></use>' + '</svg>');\n\n      control.append('li').attr('class', 'control-btn sort-recall ease-all').classed('active', function () {\n        if (self.vis.currentSorting.local[index].type === 'recall') {\n          // See recall\n          self.vis.currentSorting.local[index].el = d3.select(this);\n          return true;\n        }\n        return false;\n      }).style('width', self.visData.global.column.contentWidth / 2 + 'px').style('left', self.visData.global.column.contentWidth / 2 + self.visData.global.column.padding + 'px').on('click', function (controlData) {\n        self.sortColumn(this, controlData.level, 'recall');\n      }).on('mouseenter', function () {\n        self.highlightBars(this.parentNode, 'recall');\n        d3.select(this).style('width', self.visData.global.column.contentWidth - 16 + 'px').style('left', self.visData.global.column.padding + 16 + 'px');\n      }).on('mouseleave', function () {\n        self.highlightBars(this.parentNode, 'recall', true);\n        d3.select(this).style('width', self.visData.global.column.contentWidth / 2 + 'px').style('left', self.visData.global.column.contentWidth / 2 + self.visData.global.column.padding + 'px');\n      }).html('<div class=\"expandable-label\">' + '  <span class=\"letter abbr\">R</span>' + '  <span class=\"letter\">e</span>' + '  <span class=\"letter abbr\">c</span>' + '  <span class=\"letter\">a</span>' + '  <span class=\"letter abbr\">l</span>' + '  <span class=\"letter\">l</span>' + '</div>' + '<svg class=\"icon-unsort invisible-default ' + (self.vis.currentSorting.local[index].type !== 'recall' ? 'visible' : '') + '\">' + // eslint-disable-line\n      '  <use xlink:href=\"' + self.vis.iconPath + '#unsort\"></use>' + '</svg>' + '<svg class=\"icon-sort-asc invisible-default ' + (self.vis.currentSorting.local[index].type === 'recall' && self.vis.currentSorting.local[index].order === 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n      '  <use xlink:href=\"' + self.vis.iconPath + '#sort-asc\"></use>' + '</svg>' + '<svg class=\"icon-sort-desc invisible-default ' + (self.vis.currentSorting.local[index].type === 'recall' && self.vis.currentSorting.local[index].order !== 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n      '  <use xlink:href=\"' + self.vis.iconPath + '#sort-desc\"></use>' + '</svg>');\n\n      control.append('li').attr('class', 'control-btn options').style('width', self.visData.global.column.padding + 'px').on('click', self.toggleOptions).html('<svg class=\"icon-gear\">' + '  <use xlink:href=\"' + self.vis.iconPath + '#gear\"></use>' + '</svg>');\n\n      if (self.vis.currentSorting.local[index].type) {\n        self.vis.currentSorting.local[index].el = control.select('.sort-' + self.vis.currentSorting.local[index].type);\n      }\n    });\n  }\n\n  // toggleColumn () {\n  //   console.log('Toggle column');\n  // }\n\n  createClass(Topbar, [{\n    key: 'selectNodesLevel',\n    value: function selectNodesLevel(el) {\n      return this.vis.selectByLevel(d3.select(el).datum().level, '.node');\n    }\n  }, {\n    key: 'highlightLabels',\n    value: function highlightLabels(deHighlight) {\n      this.vis.baseElD3.selectAll('.node').classed('highlight-label', !deHighlight);\n    }\n  }, {\n    key: 'highlightBars',\n    value: function highlightBars(el, type, deHighlight) {\n      var nodes = el ? this.selectNodesLevel(el) : this.vis.baseElD3.selectAll('.node');\n\n      nodes.classed('highlight-bar', !deHighlight).selectAll('.bar.' + type).classed('highlight', !deHighlight);\n    }\n  }, {\n    key: 'sortAllColumns',\n    value: function sortAllColumns(el, type) {\n      var newSortType = this.vis.currentSorting.global.type !== type;\n\n      if (newSortType) {\n        if (this.semiActiveSortingEls) {\n          this.resetSemiActiveSortingEls();\n        }\n        // Unset class of previous global sorting element\n        if (this.vis.currentSorting.global.el) {\n          this.resetSortEl(this.vis.currentSorting.global.el, type);\n        }\n      }\n\n      this.vis.currentSorting.global.el = d3.select(el);\n      this.vis.currentSorting.global.el.classed('active', true);\n      this.vis.currentSorting.global.type = type;\n\n      var columnKeys = Object.keys(this.vis.currentSorting.local);\n      for (var i = 0, len = columnKeys.length; i < len; i++) {\n        // Update local sorting properties and buttons but do **not** sort\n        // locally!\n        this.sortColumn(el, columnKeys[i], type, true);\n      }\n\n      this.vis.sortAllColumns(type, newSortType);\n    }\n  }, {\n    key: 'sortColumn',\n    value: function sortColumn(el, index, type, global) {\n      // Reset global sorting\n      if (!global) {\n        if (this.semiActiveSortingEls) {\n          this.resetSemiActiveSortingEls();\n        }\n        if (this.vis.currentSorting.global.type) {\n          this.resetSortEl(this.vis.currentSorting.global.el, type);\n        }\n        this.vis.currentSorting.global.type = undefined;\n      }\n\n      var newSortType = false;\n\n      if (this.vis.currentSorting.local[index].el) {\n        if (this.vis.currentSorting.local[index].type !== type) {\n          this.resetSortEl(this.vis.currentSorting.local[index].el, type);\n        }\n      }\n\n      if (this.vis.currentSorting.local[index].type !== type) {\n        newSortType = true;\n        // Reset sort order\n        this.vis.currentSorting.local[index].order = 0;\n      }\n\n      this.vis.currentSorting.local[index].el = d3.select(el);\n      this.vis.currentSorting.local[index].type = type;\n\n      // -1 = desc, 1 = asc\n      if (this.vis.currentSorting.local[index].order === -1) {\n        this.vis.currentSorting.local[index].order = 1;\n        this.vis.currentSorting.local[index].el.select('.icon-sort-desc').classed('visible', false);\n        this.vis.currentSorting.local[index].el.select('.icon-sort-asc').classed('visible', true);\n      } else {\n        this.vis.currentSorting.local[index].order = -1;\n        this.vis.currentSorting.local[index].el.select('.icon-sort-asc').classed('visible', false);\n        this.vis.currentSorting.local[index].el.select('.icon-sort-desc').classed('visible', true);\n      }\n\n      this.vis.currentSorting.local[index].el.select('.icon-unsort').classed('visible', false);\n\n      this.vis.currentSorting.local[index].el.classed('active', true);\n\n      if (!global) {\n        this.vis.sortColumn(index, type, this.vis.currentSorting.local[index].order, newSortType);\n      }\n    }\n  }, {\n    key: 'resetSortEl',\n    value: function resetSortEl(el, newType) {\n      el.classed('active', false);\n      el.select('.icon-sort-desc').classed('visible', false);\n      el.select('.icon-sort-asc').classed('visible', false);\n      el.select('.icon-unsort').classed('visible', true);\n      if (newType === 'name') {\n        el.classed('semi-active', true);\n        this.semiActiveSortingEls = true;\n      }\n    }\n  }, {\n    key: 'resetSemiActiveSortingEls',\n    value: function resetSemiActiveSortingEls() {\n      this.el.selectAll('.semi-active').classed('semi-active', false);\n    }\n  }, {\n    key: 'switch',\n    value: function _switch() {\n      this.el.classed('details', !this.el.classed('details'));\n    }\n  }, {\n    key: 'switchBarMode',\n    value: function switchBarMode(el, mode) {\n      if (this.vis.nodes.barMode !== mode) {\n        if (mode === 'one') {\n          this.globalOneBar.classed('active', true);\n          this.globalTwoBars.classed('active', false);\n        } else {\n          this.globalOneBar.classed('active', false);\n          this.globalTwoBars.classed('active', true);\n        }\n        this.vis.switchBarMode(mode);\n      }\n    }\n  }]);\n  return Topbar;\n}();\n\n// External\n// eslint-disable-line import/no-unresolved\n\n/**\n * Class name of columns.\n *\n * @type  {String}\n */\nvar COLUMN_CLASS = 'column';\n\n/**\n * Class name of scroll containers.\n *\n * @type  {String}\n */\nvar SCROLL_CONTAINER_CLASS = 'scroll-container';\n\nvar Levels = function () {\n  /**\n   * Level / column constructor.\n   *\n   * @method  constructor\n   * @author  Fritz Lekschas\n   * @date    2016-09-14\n   * @param   {Object}  selection  D3 selection of element the levels should be\n   *   appended to.\n   * @param   {Object}  vis        List Graph App.\n   * @param   {Object}  visData    List Graph App data.\n   */\n  function Levels(selection, vis, visData) {\n    var _this = this;\n\n    classCallCheck(this, Levels);\n\n    this.vis = vis;\n    this.visData = visData;\n    this.groups = selection.selectAll('g').data(this.visData.nodes).enter().append('g').attr('class', COLUMN_CLASS).classed('active', function (data, index) {\n      if (_this.vis.highlightActiveLevel) {\n        if (!_this.vis.nodes || !_this.vis.nodes.rootedNode) {\n          return index === _this.vis.activeLevel - _this.vis.noRootActiveLevelDiff;\n        }\n        return index === _this.vis.activeLevel;\n      }\n      return false;\n    }).each(function (data) {\n      data.scrollTop = 0;\n    });\n\n    // We need to add an empty rectangle that fills up the whole column to ensure\n    // that the `g`'s size is at a maximum, otherwise scrolling will be halted\n    // when the cursor leaves an actually drawn element.\n    this.groups.append('rect').attr('class', SCROLL_CONTAINER_CLASS).attr('x', function (data) {\n      return data.x;\n    }).attr('y', function (data) {\n      return data.y;\n    }).attr('width', this.visData.global.column.width + 1).attr('height', this.visData.global.column.height);\n  }\n\n  /**\n   * Prepare column for scrolling.\n   *\n   * @method  scrollPreparation\n   * @author  Fritz Lekschas\n   * @date    2016-09-14\n   * @param   {Number}  scrollbarWidth  Width of the scrollbar in pixel.\n   */\n\n\n  createClass(Levels, [{\n    key: 'scrollPreparation',\n    value: function scrollPreparation(scrollbarWidth) {\n      var _this2 = this;\n\n      this.groups.each(function (data, index) {\n        var contentHeight = data.nodes.getBoundingClientRect().height + 2 * _this2.visData.global.row.padding;\n        var scrollHeight = contentHeight - _this2.visData.global.column.height;\n        var scrollbarHeight = scrollHeight > 0 ? Math.max(_this2.visData.global.column.height * _this2.visData.global.column.height / contentHeight, 10) : 0;\n\n        data.height = contentHeight;\n        data.linkSelections = {\n          incoming: index > 0 ? _this2.vis.selectByLevel(index - 1, '.link') : null,\n          outgoing: _this2.vis.selectByLevel(index, '.link')\n        };\n        data.scrollHeight = scrollHeight;\n        data.scrollTop = 0;\n        data.scrollbar = {\n          el: undefined,\n          x: data.x + (_this2.visData.global.column.width - scrollbarWidth),\n          y: 0,\n          width: scrollbarWidth,\n          height: scrollbarHeight,\n          scrollHeight: _this2.visData.global.column.height - scrollbarHeight,\n          scrollTop: 0,\n          heightScale: d3.scaleLinear().domain([0, scrollHeight]).range([0, _this2.visData.global.column.height - scrollbarHeight])\n        };\n        data.invertedHeightScale = data.scrollbar.heightScale.invert;\n      });\n    }\n\n    /**\n     * Update the properties for column scrolling.\n     *\n     * @method  updateScrollProperties\n     * @author  Fritz Lekschas\n     * @date    2016-09-14\n     */\n\n  }, {\n    key: 'updateScrollProperties',\n    value: function updateScrollProperties() {\n      var _this3 = this;\n\n      this.groups.each(function (data) {\n        var contentHeight = data.nodes.getBoundingClientRect().height + 2 * _this3.visData.global.row.padding;\n        var scrollHeight = contentHeight - _this3.visData.global.column.height;\n        var scrollbarHeight = scrollHeight > 0 ? Math.max(_this3.visData.global.column.height * _this3.visData.global.column.height / contentHeight, 10) : 0;\n\n        data.height = contentHeight;\n        data.scrollHeight = scrollHeight;\n        data.scrollTop = 0;\n        data.scrollbar.y = 0;\n        data.scrollbar.height = scrollbarHeight;\n        data.scrollbar.scrollHeight = _this3.visData.global.column.height - scrollbarHeight;\n        data.scrollbar.scrollTop = 0;\n        data.scrollbar.heightScale = d3.scaleLinear().domain([0, scrollHeight]).range([0, _this3.visData.global.column.height - scrollbarHeight]);\n      });\n    }\n\n    /**\n     * Check if column should be hidden when it's not in the visible area.\n     *\n     * @method  updateVisibility\n     * @author  Fritz Lekschas\n     * @date    2016-09-14\n     */\n\n  }, {\n    key: 'updateVisibility',\n    value: function updateVisibility() {\n      this.groups.each(function () {\n        var group = d3.select(this);\n\n        group.classed('hidden', group.selectAll('.node').filter(function (data) {\n          return !data.hidden;\n        }).empty());\n      });\n    }\n\n    /**\n     * Get the column's class name.\n     *\n     * @method  className\n     * @author  Fritz Lekschas\n     * @date    2016-09-14\n     * @return  {String}  Class name of the column.\n     */\n\n  }, {\n    key: 'focus',\n\n\n    /**\n     * Focus a level.\n     *\n     * @method  focus\n     * @author  Fritz Lekschas\n     * @date    2016-09-14\n     * @param   {Number}  level  ID of the column.\n     */\n    value: function focus(level) {\n      if (this.vis.highlightActiveLevel) {\n        this.groups.filter(function (data) {\n          return data.level === level;\n        }).classed('active', true);\n      }\n    }\n\n    /**\n     * Blur a level.\n     *\n     * @method  blur\n     * @author  Fritz Lekschas\n     * @date    2016-09-14\n     * @param   {Number}  level  ID of the column.\n     */\n\n  }, {\n    key: 'blur',\n    value: function blur(level) {\n      if (this.vis.highlightActiveLevel) {\n        if (level) {\n          this.groups.filter(function (data) {\n            return data.level === level;\n          }).classed('active', false);\n        } else {\n          this.groups.classed('active', false);\n        }\n      }\n    }\n  }, {\n    key: 'className',\n    get: function get() {\n      return COLUMN_CLASS;\n    }\n\n    /**\n     * Get the column's height.\n     *\n     * @method  height\n     * @author  Fritz Lekschas\n     * @date    2016-09-14\n     * @return  {Number}  Column height in pixel.\n     */\n\n  }, {\n    key: 'height',\n    get: function get() {\n      return this.visData.global.column.height;\n    }\n  }]);\n  return Levels;\n}();\n\n// External\n// eslint-disable-line import/no-unresolved\n\n// Internal\n/**\n * Class name of the group of link container.\n *\n * @type  {String}\n */\nvar LINKS_CLASS = 'links';\n\n/**\n * Class name of a link element.\n *\n * @type  {String}\n */\nvar LINK_CLASS = 'link';\n\nvar Links = function () {\n  /**\n   * [constructor description]\n   *\n   * @method  constructor\n   * @author  Fritz Lekschas\n   * @date    2016-09-14\n   * @param   {Object}   vis      List Graph App.\n   * @param   {Object}   levels   List Graph App's levels.\n   * @param   {Object}   visData  List Graph App's data.\n   * @param   {Object}   layout   List Graph Layout.\n   */\n  function Links(vis, levels, visData, layout) {\n    var _this = this;\n\n    classCallCheck(this, Links);\n\n    this.vis = vis;\n    this.visData = visData;\n    this.layout = layout;\n\n    this.groups = levels.append('g').attr('class', LINKS_CLASS).call(function (selection) {\n      selection.each(function () {\n        d3.select(this.parentNode).datum().links = this;\n      });\n    });\n\n    this.links = this.groups.selectAll(LINK_CLASS).data(function (data, index) {\n      return _this.layout.links(index);\n    }).enter().append('g').attr('class', LINK_CLASS).classed('visible', !this.vis.hideOutwardsLinks || this.linkVisibility.bind(this));\n\n    this.links.append('path').attr('class', LINK_CLASS + '-bg').attr('d', this.diagonal.bind(this));\n\n    this.links.append('path').attr('class', LINK_CLASS + '-direct').attr('d', this.diagonal.bind(this));\n  }\n\n  /**\n   * Creates a SVG path string for links based on B-splines.\n   *\n   * @method  diagonal\n   * @author  Fritz Lekschas\n   * @date    2016-09-22\n   * @return  {String}  SVG path string.\n   */\n\n\n  createClass(Links, [{\n    key: 'linkVisibility',\n\n\n    /**\n     * Assess link visibility\n     *\n     * @method  linkVisibility\n     * @author  Fritz Lekschas\n     * @date    2016-09-14\n     * @param   {Object}  data  D3 selection data object of links.\n     */\n    value: function linkVisibility(data) {\n      // Cache visibility.\n      data.hidden = this.vis.pointsOutside.call(this.vis, data);\n      return data.hidden === 0;\n    }\n\n    /**\n     * [highlight description]\n     *\n     * @method  highlight\n     * @author  Fritz Lekschas\n     * @date    2016-09-14\n     * @param   {Array}    nodeIds    Array of Node IDs.\n     * @param   {Boolean}  highlight  If `true` highlights links.\n     * @param   {String}   className  Class name added for CSS-based highlighting.\n     */\n\n  }, {\n    key: 'highlight',\n    value: function highlight(nodeIds, _highlight, className) {\n      this.links.filter(function (data) {\n        return nodeIds[data.id];\n      }).classed(className, _highlight);\n    }\n\n    /**\n     * Make links temporarily visible.\n     *\n     * @method  makeAllTempVisible\n     * @author  Fritz Lekschas\n     * @date    2016-09-22\n     * @param   {Boolean}  unset  If `true` reverts the temporal visibility.\n     */\n\n  }, {\n    key: 'makeAllTempVisible',\n    value: function makeAllTempVisible(unset) {\n      if (unset) {\n        this.links.classed('visible', this.linkVisibility.bind(this));\n      } else {\n        this.links.classed('visible', true);\n      }\n    }\n\n    /**\n     * Scroll links when the container is scrolled.\n     *\n     * @method  scroll\n     * @author  Fritz Lekschas\n     * @date    2016-09-14\n     * @param   {Object}  selection  D3 selection of links.\n     * @param   {Object}  data       Updated link data depending on scroll\n     *   position.\n     */\n\n  }, {\n    key: 'scroll',\n    value: function scroll(selection, data) {\n      // Update data of `g`.\n      selection.data(data);\n\n      if (this.vis.hideOutwardsLinks) {\n        // Check if links point outwards.\n        selection.classed('visible', this.linkVisibility.bind(this));\n      }\n\n      // Next, update all paths according to the new data.\n      selection.selectAll('path').attr('d', this.diagonal);\n    }\n\n    /**\n     * Sort links by applying updated data and transitioning to the new position.\n     *\n     * @method  sort\n     * @author  Fritz Lekschas\n     * @date    2016-09-14\n     * @param   {[type]}    update  [description]\n     * @return  {[type]}            [description]\n     */\n\n  }, {\n    key: 'sort',\n    value: function sort(update) {\n      var start = function start() {\n        d3.select(this).classed('sorting', true);\n      };\n      var end = function end() {\n        d3.select(this).classed('sorting', false);\n      };\n\n      // Update data of `g`.\n      this.links.data(update, function (data) {\n        return data.id;\n      });\n\n      // Next update all paths according to the new data.\n      this.links.selectAll('path').transition().duration(TRANSITION_SEMI_FAST).attr('d', this.diagonal).on('start', start).on('end', end);\n    }\n\n    /**\n     * Update the visual state of the link according to the current state of data.\n     *\n     * @description\n     * This method differs from checking whether a source or target node is\n     * visible as it purely depends on the `hidden` property of the node data. It\n     * is primarily used to hide links of hidden nodes, e.g., when nodes are\n     * hidden manually.\n     *\n     * @method  updateVisibility\n     * @author  Fritz Lekschas\n     * @date    2016-09-14\n     */\n\n  }, {\n    key: 'updateVisibility',\n    value: function updateVisibility() {\n      this.links.classed('hidden', function (data) {\n        return data.target.node.hidden || data.source.node.hidden;\n      }).transition().duration(TRANSITION_SEMI_FAST).attr('d', this.diagonal);\n    }\n  }, {\n    key: 'diagonal',\n    get: function get() {\n      var _this2 = this;\n\n      var extraOffsetX = this.vis.showLinkLocation ? 6 : 0;\n\n      function getSourceX(source) {\n        return source.node.x + source.offsetX + this.visData.global.column.contentWidth + this.visData.global.column.padding;\n      }\n\n      function getTargetX(source) {\n        return source.node.x + source.offsetX + this.visData.global.column.padding;\n      }\n\n      function getY(source) {\n        return source.node.y + source.offsetY + this.visData.global.row.height / 2;\n      }\n\n      var getLine = d3.line().x(function (data) {\n        return data.x;\n      }).y(function (data) {\n        return data.y;\n      }).curve(d3.curveBundle.beta(LINK_BUNDLING_STRENGTH));\n\n      return function (data) {\n        var points = [];\n\n        var sourceX = getSourceX.call(_this2, data.source);\n        var sourceY = getY.call(_this2, data.source);\n\n        var targetX = getTargetX.call(_this2, data.target);\n        var targetY = getY.call(_this2, data.target);\n\n        var middleX = (sourceX + targetX) / 2;\n        var relMiddleX = (targetX - (sourceX + targetX) / 2) * 2 / 3;\n\n        // Push the start point\n        points.push({\n          x: sourceX + extraOffsetX,\n          y: sourceY\n        });\n\n        points.push({\n          x: middleX,\n          y: sourceY\n        });\n\n        // Push a control point\n        points.push({\n          x: targetX - relMiddleX,\n          y: targetY\n        });\n\n        // Push a control point\n        points.push({\n          x: targetX - extraOffsetX,\n          y: targetY\n        });\n\n        return getLine(points);\n      };\n    }\n  }]);\n  return Links;\n}();\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\nvar funcTag = '[object Function]';\nvar genTag = '[object GeneratorFunction]';\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n  var tag = isObject(value) ? objectToString.call(value) : '';\n  return tag == funcTag || tag == genTag;\n}\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsFinite = root.isFinite;\n\n/**\n * Checks if `value` is a finite primitive number.\n *\n * **Note:** This method is based on\n * [`Number.isFinite`](https://mdn.io/Number/isFinite).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a finite number, else `false`.\n * @example\n *\n * _.isFinite(3);\n * // => true\n *\n * _.isFinite(Number.MIN_VALUE);\n * // => true\n *\n * _.isFinite(Infinity);\n * // => false\n *\n * _.isFinite('3');\n * // => false\n */\nfunction isFinite(value) {\n  return typeof value == 'number' && nativeIsFinite(value);\n}\n\n/**\n * Collect all cloned nodes, including the original node.\n *\n * @method  collectInclClones\n * @author  Fritz Lekschas\n * @date    2016-03-20\n * @param   {Object}   node                 Start node\n * @param   {Boolean}  onlyForOriginalNode  If `true` only collect clones when\n *   `node` is not a clone itself.\n * @return  {Array}                         Array of original and cloned nodes.\n */\nfunction collectInclClones(node, onlyForOriginalNode) {\n  var originalNode = node;\n\n  if (node.clone) {\n    originalNode = node.originalNode;\n    if (onlyForOriginalNode) {\n      return [];\n    }\n  }\n\n  var clones = [originalNode];\n\n  if (originalNode.clones.length) {\n    clones = clones.concat(originalNode.clones);\n  }\n\n  return clones;\n}\n\n// External\n// Internal\nfunction _up(node, callback, depth, includeClones, child, visitedNodes) {\n  if (visitedNodes[node.id]) {\n    if (!visitedNodes[node.id][child.id]) {\n      callback(node, child);\n    }\n    return;\n  }\n\n  var nodes = includeClones ? collectInclClones(node) : [node];\n\n  for (var i = nodes.length; i--;) {\n    visitedNodes[nodes[i].id] = {};\n\n    if (child) {\n      callback(nodes[i], child);\n      visitedNodes[nodes[i].id][child.id] = true;\n    }\n\n    if (!isFinite(depth) || depth > 0) {\n      var parentsId = Object.keys(nodes[i].parents);\n      for (var j = parentsId.length; j--;) {\n        _up(nodes[i].parents[parentsId[j]], callback, depth - 1, includeClones, nodes[i], visitedNodes);\n      }\n    }\n  }\n}\n\n/**\n * Traverse the graph upwards from a given node until a certain depth.\n *\n * @method  up\n * @author  Fritz Lekschas\n * @date    2016-09-12\n * @param   {Object}    node           D3 data object of a selected DOM element.\n * @param   {Function}  callback       Method to be called on every traversed\n *   node.\n * @param   {Number}    depth          Max steps to traverse upwards. If\n *   `undefined` will traverse till the root node.\n * @param   {Boolean}   includeClones  If `true` cloned nodes will be traversed\n *   as well.\n */\nfunction up(node, callback, depth, includeClones) {\n  var visitedNodes = {};\n  _up(node, callback, depth, includeClones, undefined, visitedNodes);\n}\n\nfunction _down(node, callback, depth, includeClones, visitedNodes) {\n  if (visitedNodes[node.id]) {\n    return;\n  }\n\n  var nodes = includeClones ? collectInclClones(node) : [node];\n\n  for (var i = nodes.length; i--;) {\n    callback(nodes[i]);\n\n    visitedNodes[nodes[i].id] = true;\n\n    // We only need to recursivly traverse the graph for the original node as\n    // the clones do not have any children (i.e. the have the same children as\n    // the original node)\n    if (i === 0 && (!isFinite(depth) || depth > 0)) {\n      for (var j = nodes[i].childRefs.length; j--;) {\n        _down(nodes[i].childRefs[j], callback, depth - 1, includeClones, visitedNodes);\n      }\n    }\n  }\n}\n\n/**\n * Traverse the graph downwards from a given node until a certain depth.\n *\n * @method  down\n * @author  Fritz Lekschas\n * @date    2016-09-12\n * @param   {Object}    node           D3 data object of a selected DOM element.\n * @param   {Function}  callback       Method to be called on every traversed\n *   node.\n * @param   {Number}    depth          Max steps to traverse downwards. If\n *   `undefined` will traverse till leaf nodes.\n * @param   {Boolean}   includeClones  If `true` cloned nodes will be traversed\n *   as well.\n */\nfunction down(node, callback, depth, includeClones) {\n  var visitedNodes = {};\n  _down(node, callback, depth, includeClones, visitedNodes);\n}\n\n/**\n * Traverse the graph up- and downwards from a given node until a certain depth.\n *\n * @method  upAndDown\n * @author  Fritz Lekschas\n * @date    2016-09-12\n * @param   {Object}    node           D3 data object of a selected DOM element.\n * @param   {Function}  callback       Method to be called on every upwards\n *   traversed node.\n * @param   {Function}  callback       Method to be called on every downwards\n *   traversed node.\n * @param   {Number}    depth          Max steps to traverse downwards. If\n *   `undefined` will traverse till leaf nodes.\n * @param   {Boolean}   includeClones  If `true` cloned nodes will be traversed\n *   as well.\n */\nfunction upAndDown(node, callbackUp, callbackDown, depth, includeClones) {\n  if (callbackDown) {\n    up(node, callbackUp, depth, includeClones);\n    down(node, callbackDown, depth, includeClones);\n  } else {\n    var visitedNodes = {};\n    up(node, callbackUp, depth, includeClones, visitedNodes);\n    down(node, callbackUp, depth, includeClones, visitedNodes);\n  }\n}\n\n/**\n * Traverse siblings from a given nodes.\n *\n * @method  siblings\n * @author  Fritz Lekschas\n * @date    2016-09-12\n * @param   {Object}    node      D3 data object of a selected DOM element.\n * @param   {Function}  callback   Method to be called on every visited node.\n */\nfunction siblings(node, callback) {\n  var parentsId = Object.keys(node.parents);\n  for (var i = parentsId.length; i--;) {\n    for (var j = node.parents[parentsId[i]].childRefs.length; j--;) {\n      callback(node.parents[parentsId[i]].childRefs[j]);\n    }\n  }\n  // The root node doesn't have a `parents` property but might have `siblings`.\n  if (node.siblings) {\n    var siblingsId = Object.keys(node.siblings);\n    for (var _i = siblingsId.length; _i--;) {\n      callback(node.siblings[siblingsId[_i]]);\n    }\n  }\n}\n\nvar BAR_CLASS = 'bar';\n\nvar Bar =\n/**\n * Bar constructor\n *\n * @method  constructor\n * @author  Fritz Lekschas\n * @date    2016-09-14\n * @param   {Object}  baseEl    D3 selection of the base element where bars\n *   should be appended to.\n * @param   {Object}  barData   Object with the bar properties.\n * @param   {Object}  nodeData  Object with the node properties.\n * @param   {Object}  visData   Object with the list graph app properties.\n * @param   {Object}  bars      Bars class.\n */\nfunction Bar(baseEl, barData, nodeData, visData, bars) {\n  var _this = this;\n\n  classCallCheck(this, Bar);\n\n  this.data = barData;\n  this.nodeData = nodeData;\n  this.visData = visData;\n  this.bars = bars;\n\n  this.data.x = nodeData.x;\n  this.data.level = nodeData.depth;\n\n  this.height = this.visData.global.row.contentHeight / (this.data.length * 2) - this.visData.global.cell.padding * 2;\n\n  this.activeHeight = this.visData.global.row.contentHeight - 2;\n\n  this.inactiveheight = this.visData.global.cell.padding * 2 - 1;\n\n  this.selection = baseEl.selectAll(BAR_CLASS).data(this.data).enter().append('g').attr('class', function (data) {\n    return BAR_CLASS + ' ' + data.id;\n  }).classed('active', function (data) {\n    return data.id === _this.visData.nodes[_this.nodeData.depth].sortBy;\n  });\n\n  // Local helper method to avoid code duplication.\n  function setupMagnitude(selection) {\n    var _this2 = this;\n\n    var currentSorting = this.visData.nodes[this.nodeData.depth].sortBy;\n\n    selection.attr('d', function (data) {\n      return _this2.bars.generatePath(data, currentSorting);\n    }).classed('bar-magnitude', true);\n  }\n\n  function setupBorder(selection) {\n    selection.attr('x', 0).attr('y', this.visData.global.row.padding).attr('width', this.visData.global.column.contentWidth).attr('height', this.visData.global.row.contentHeight).attr('rx', 2).attr('ry', 2).classed('bar-border', true);\n  }\n\n  this.selection.append('rect').call(setupBorder.bind(this));\n\n  this.selection.append('path').call(setupMagnitude.bind(this));\n};\n\n/**\n * Returns the path for a rounded rectangle\n *\n * Credits go to Mike Bostock: http://bl.ocks.org/mbostock/3468167\n *\n * @method  roundRect\n * @author  Fritz Lekschas\n * @date    2016-09-12\n * @param   {Number}    x       X coordinate.\n * @param   {Number}    y       Y coordinate.\n * @param   {Number}    width   Width of the rectangle.\n * @param   {Number}    height  Height of the rectangle.\n * @param   {Number}    radius  Radius.\n * @return  {String}            Path string of the rounded rectangle.\n */\nfunction roundRect(x, y, width, height, radius) {\n  var topLeft = radius.topLeft || 0;\n  var topRight = radius.topRight || 0;\n  var bottomLeft = radius.bottomLeft || 0;\n  var bottomRight = radius.bottomRight || 0;\n\n  return 'M' + (x + topLeft) + ',' + y + 'h' + (width - topLeft - topRight) + 'a' + topRight + ',' + topRight + ' 0 0 1 ' + topRight + ',' + topRight + 'v' + (height - (topRight + bottomRight)) + 'a' + bottomRight + ',' + bottomRight + ' 0 0 1 ' + -bottomRight + ',' + bottomRight + 'h' + (bottomLeft - (width - bottomRight)) + 'a' + bottomLeft + ',' + bottomLeft + ' 0 0 1 ' + -bottomLeft + ',' + -bottomLeft + 'v' + (topLeft - (height - bottomLeft)) + 'a' + topLeft + ',' + topLeft + ' 0 0 1 ' + topLeft + ',' + -topLeft + 'z';\n}\n\n/**\n * Creates a path that looks like a drop menu\n *\n * @example\n * The following is an example how to create a drop menu path:\n * ```javascript\n * import { dropMenu } from './charts';\n * const dropMenuPath = dropMenu({\n *   x: 0,\n *   y: 0,\n *   width: 50,\n *   height: 100,\n *   radius: 5,\n *   arrowSize: 5\n * });\n * ```\n *\n * @method  dropMenu\n * @author  Fritz Lekschas\n * @date    2016-03-03\n * @param   {Object}  c  Config object that needs to contain the following\n *   properties: x, y, width, height, radius and arrowSize.\n */\nfunction dropMenu(c) {\n  return 'M' + (c.x + c.radius) + ',' + c.y + 'h' + (c.width - c.radius * 2) + 'a' + c.radius + ',' + c.radius + ' 0 0 1 ' + c.radius + ',' + c.radius + 'v' + (c.height - c.radius * 2) + 'a' + c.radius + ',' + c.radius + ' 0 0 1 ' + -c.radius + ',' + c.radius + 'h' + -(c.width - c.radius * 2 - c.arrowSize * 2) / 2 + 'l' + -c.arrowSize + ',' + c.arrowSize + 'l' + -c.arrowSize + ',' + -c.arrowSize + 'h' + -(c.width - c.radius * 2 - c.arrowSize * 2) / 2 + 'a' + c.radius + ',' + c.radius + ' 0 0 1 ' + -c.radius + ',' + -c.radius + 'v' + (c.radius - (c.height - c.radius)) + 'a' + c.radius + ',' + c.radius + ' 0 0 1 ' + c.radius + ',' + -c.radius + 'z';\n}\n\n// External\n// eslint-disable-line import/no-unresolved\n\n// Internal\nvar BARS_CLASS = 'bars';\n\nvar Bars = function () {\n  /**\n   * [constructor description]\n   *\n   * @method  constructor\n   * @author  Fritz Lekschas\n   * @date    2016-09-14\n   * @param   {Object}  baseEl   D3 selection where the group of bars should be\n   *   appended to.\n   * @param   {String}  mode     Display more. Can be either `one` or `two`.\n   * @param   {Object}  visData  Object with the list graph app data.\n   */\n  function Bars(baseEl, mode, visData) {\n    classCallCheck(this, Bars);\n\n    var self = this;\n\n    this.mode = mode;\n    this.visData = visData;\n\n    this.xScale = d3.scaleLinear().domain([0, 1]).range([1, this.visData.global.column.contentWidth - 3]);\n\n    this.baseEl = baseEl.append('g').attr('class', BARS_CLASS);\n\n    this.baseEl.each(function (datum) {\n      new Bar(d3.select(this), datum.data.bars, datum, self.visData, self);\n    });\n  }\n\n  /**\n   * Updates all bar magnitude elements.\n   *\n   * @method  updateAll\n   * @author  Fritz Lekschas\n   * @date    2016-09-14\n   * @param   {Object}  update  Object with the current data.\n   * @param   {String}  sortBy  Name of the poperty to be sorted by.\n   */\n\n\n  createClass(Bars, [{\n    key: 'updateAll',\n    value: function updateAll(update, sortBy) {\n      var _this = this;\n\n      this.baseEl.selectAll('.bar-magnitude').data(update, function (data) {\n        return data.barId;\n      }).transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n        return _this.generatePath(data, sortBy);\n      });\n    }\n\n    /**\n     * Update bars when switching the bar mode.\n     *\n     * @method  update\n     * @author  Fritz Lekschas\n     * @date    2016-09-14\n     * @param   {Object}  selection  D3 selection\n     * @param   {String}  sortBy     Name of the poperty to be sorted by.\n     */\n\n  }, {\n    key: 'update',\n    value: function update(selection, sortBy) {\n      var _this2 = this;\n\n      selection.each(function (data) {\n        var el = d3.select(this);\n\n        if (data.id === sortBy && !el.classed('active')) {\n          el.classed('active', true);\n          // Ensure that the active bars we are places before any other bar,\n          // thus placing them in the background\n          this.parentNode.insertBefore(this, this.parentNode.children[0]);\n        }\n\n        if (data.id !== sortBy) {\n          el.classed('active', false);\n        }\n      });\n\n      selection.selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n        return _this2.generatePath(data, sortBy);\n      });\n    }\n\n    /**\n     * Switch one and two-bar display mode.\n     *\n     * @method  switchMode\n     * @author  Fritz Lekschas\n     * @date    2016-09-14\n     * @param   {String}  mode            Name of the display mode. Can either be\n     *   `one` or `two`.\n     * @param   {String}  currentSorting  Name if the property currently sorted\n     *   by.\n     */\n\n  }, {\n    key: 'switchMode',\n    value: function switchMode(mode, currentSorting) {\n      var _this3 = this;\n\n      if (this.mode !== mode) {\n        if (mode === 'one') {\n          if (currentSorting.global.type) {\n            this.baseEl.selectAll('.bar').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n              return _this3.generateOneBarPath(data, currentSorting.global.type);\n            });\n          } else {\n            // console.error(\n            //   'Switching magnitude visualization after individual sorting is ' +\n            //   'not supported yet.'\n            // );\n          }\n        }\n\n        if (mode === 'two') {\n          this.baseEl.selectAll('.bar.precision').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n            return _this3.generateTwoBarsPath(data);\n          });\n\n          this.baseEl.selectAll('.bar.recall').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n            return _this3.generateTwoBarsPath(data, true);\n          });\n        }\n\n        this.mode = mode;\n      }\n    }\n\n    /**\n     * Helper method to generate path used as a bar.\n     *\n     * @method  generatePath\n     * @author  Fritz Lekschas\n     * @date    2016-09-14\n     * @param   {Object}   data             Data object.\n     * @param   {String}   sortBy           Name of the property currently sorted\n     *   by.\n     */\n\n  }, {\n    key: 'generatePath',\n    value: function generatePath(data, sortBy) {\n      if (this.mode === 'two') {\n        return this.generateTwoBarsPath(data);\n      }\n      return this.generateOneBarPath(data, sortBy);\n    }\n\n    /**\n     * Generates a bar when one-bar display mode is active.\n     *\n     * @method  generateOneBarPath\n     * @author  Fritz Lekschas\n     * @date    2016-09-14\n     * @param   {Object}   data    Data object.\n     * @param   {String}   sortBy  Name of the property currently sorted by.\n     */\n\n  }, {\n    key: 'generateOneBarPath',\n    value: function generateOneBarPath(data, sortBy) {\n      var height = this.visData.global.row.contentHeight;\n      var normValue = Math.min(data.value, 1) || 0;\n\n      var x = 0;\n      var width = 2;\n\n      var radius = {\n        topLeft: 2,\n        bottomLeft: 2\n      };\n\n      if (data.id !== sortBy) {\n        x = this.xScale(normValue);\n        radius = {};\n      } else {\n        width = this.visData.global.column.contentWidth * normValue;\n      }\n\n      x = Math.min(x, this.visData.global.column.contentWidth - 2);\n\n      return roundRect(x, this.visData.global.row.padding, width, height, radius);\n    }\n\n    /**\n     * Generates a bar when two-bar display mode is active.\n     *\n     * @method  generateTwoBarsPath\n     * @author  Fritz Lekschas\n     * @date    2016-09-14\n     * @param   {Object}   data      Data object.\n     * @param   {Boolean}  isBottom  If `true` then the bottom bar should be\n     *   generated.\n     */\n\n  }, {\n    key: 'generateTwoBarsPath',\n    value: function generateTwoBarsPath(data, isBottom) {\n      var normValue = Math.min(data.value, 1);\n      var height = this.visData.global.row.contentHeight / 2;\n      var width = this.visData.global.column.contentWidth * normValue;\n\n      var y = this.visData.global.row.padding;\n      var radius = { topLeft: 2 };\n\n      if (isBottom) {\n        radius = { bottomLeft: 2 };\n        y += height;\n      }\n\n      return roundRect(0, y, width, height, radius);\n    }\n  }]);\n  return Bars;\n}();\n\n// External\n/**\n * Merges multiple distinct D3 selection objects.\n *\n * @description\n * First an empty selection is created by querying for a non-existing element.\n *\n * @method  mergeSelections\n * @author  Fritz Lekschas\n * @date    2016-09-12\n * @param   {Array}   selections  Array of multiple D3 selection objects.\n * @return  {Object}              Single D3 selection object containing all the\n *   selected elements from `selections`.\n */\nfunction mergeSelections(selections) {\n  // Create a new empty selection\n  var mergedSelection = d3.selectAll('.d3-list-graph-not-existent');\n\n  for (var i = selections.length; i--;) {\n    mergedSelection._groups = mergedSelection._groups.concat(selections[i]._groups);\n  }\n\n  return mergedSelection;\n}\n\n/**\n * Detects when an array of transitions has ended.\n *\n * @method  allTransitionsEnded\n * @author  Fritz Lekschas\n * @date    2016-09-12\n * @param   {Object}    transition  D3 transition object.\n * @param   {Function}  callback    Callback function to be triggered when all\n *   transitions have ended.\n */\nfunction allTransitionsEnded(transition, callback) {\n  if (transition.size() === 0) {\n    callback();\n  }\n  var n = 0;\n  transition.each(function () {\n    return ++n;\n  }).on('end', function () {\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    if (! --n) callback.apply(this, args);\n  });\n}\n\n// External\n// eslint-disable-line import/no-unresolved\n// Internal\nvar CLASS_NODES = 'nodes';\nvar CLASS_NODE = 'node';\nvar CLASS_NODE_VISIBLE = 'visible-node';\nvar CLASS_CLONE = 'clone';\nvar CLASS_LABEL_WRAPPER = 'label-wrapper';\nvar CLASS_FOCUS_CONTROLS = 'focus-controls';\nvar CLASS_ROOT = 'root';\nvar CLASS_QUERY = 'query';\nvar CLASS_LOCK = 'lock';\nvar CLASS_INACTIVE = 'inactive';\nvar CLASS_INDICATOR_BAR = 'link-indicator';\nvar CLASS_INDICATOR_LOCATION = 'link-location-indicator';\nvar CLASS_INDICATOR_INCOMING = 'incoming';\nvar CLASS_INDICATOR_OUTGOING = 'outgoing';\nvar CLASS_INDICATOR_ABOVE = 'above';\nvar CLASS_INDICATOR_BELOW = 'below';\n\nvar Nodes = function () {\n  function Nodes(vis, baseSelection, visData, links, events) {\n    var _this = this;\n\n    classCallCheck(this, Nodes);\n\n    var self = this;\n\n    this.vis = vis;\n    this.visData = visData;\n    this.links = links;\n    this.events = events;\n    this.currentLinks = {};\n    this.iconDimension = Math.min(this.visData.global.row.contentHeight / 2 - this.visData.global.cell.padding * 2, this.visData.global.column.padding / 2 - 4);\n\n    var linkDensityBg = d3.scaleLinear().domain([1, this.vis.rows]).range(['#ccc', '#000']);\n\n    function drawLinkIndicator(selection, direction) {\n      var incoming = direction === 'incoming';\n\n      selection.attr('class', CLASS_INDICATOR_BAR + ' ' + (incoming ? CLASS_INDICATOR_INCOMING : CLASS_INDICATOR_OUTGOING)).attr('d', roundRect(incoming ? -7 : this.visData.global.column.contentWidth, this.visData.global.row.height / 2 - 1, 7, 2, {\n        topLeft: incoming ? 1 : 0,\n        topRight: incoming ? 0 : 1,\n        bottomLeft: incoming ? 1 : 0,\n        bottomRight: incoming ? 0 : 1\n      })).attr('fill', function (data) {\n        return linkDensityBg(data.links[direction].refs.length);\n      }).classed('visible', function (data) {\n        return data.links[direction].refs.length > 0;\n      }).style('transform-origin', (incoming ? 0 : this.visData.global.column.contentWidth) + 'px ' + this.visData.global.row.height / 2 + 'px');\n    }\n\n    function drawLinkLocationIndicator(selection, direction, position) {\n      var above = position === 'above';\n      var incoming = direction === 'incoming';\n\n      var className = CLASS_INDICATOR_LOCATION + ' ' + (incoming ? CLASS_INDICATOR_INCOMING : CLASS_INDICATOR_OUTGOING) + ' ' + (above ? CLASS_INDICATOR_ABOVE : CLASS_INDICATOR_BELOW);\n\n      selection.datum(function (data) {\n        return data.links[direction];\n      }).attr('class', className).attr('x', incoming ? -5 : this.visData.global.column.contentWidth + 2).attr('y', above ? this.visData.global.row.height / 2 - 1 : this.visData.global.row.height / 2 + 1).attr('width', 3).attr('height', 3).attr('fill', function (data) {\n        return linkDensityBg(data.refs.length);\n      });\n    }\n\n    // Helper\n    function drawFullSizeRect(selection, className, shrinking, noRoundBorder) {\n      var shrinkingAmount = shrinking || 0;\n\n      selection.attr('x', shrinkingAmount).attr('y', self.visData.global.row.padding + shrinkingAmount).attr('width', self.visData.global.column.contentWidth - 2 * shrinkingAmount).attr('height', self.visData.global.row.contentHeight - 2 * shrinkingAmount).attr('rx', noRoundBorder ? 0 : 2 - shrinkingAmount).attr('ry', noRoundBorder ? 0 : 2 - shrinkingAmount).classed(className, true);\n    }\n\n    function drawMaxSizedRect(selection) {\n      selection.attr('x', 0).attr('y', 0).attr('width', self.visData.global.column.contentWidth).attr('height', self.visData.global.row.height).attr('class', 'invisible-container');\n    }\n\n    this.groups = baseSelection.append('g').attr('class', CLASS_NODES).call(function (selection) {\n      selection.each(function storeLinkToGroupNode() {\n        d3.select(this.parentNode).datum().nodes = this;\n      });\n    });\n\n    this.nodes = this.groups.selectAll('.' + CLASS_NODE).data(function (data) {\n      return data.rows;\n    }).enter().append('g').classed(CLASS_NODE, true).classed(CLASS_CLONE, function (data) {\n      return data.clone;\n    }).attr('transform', function (data) {\n      return 'translate(' + (data.x + _this.visData.global.column.padding) + ', ' + data.y + ')';\n    });\n\n    this.nodes.append('rect').call(drawMaxSizedRect);\n\n    this.visNodes = this.nodes.append('g').attr('class', CLASS_NODE_VISIBLE);\n\n    this.visNodes.append('rect').call(drawFullSizeRect, 'bg-border');\n\n    this.visNodes.append('rect').call(drawFullSizeRect, 'bg', 1, true);\n\n    if (this.vis.showLinkLocation) {\n      this.nodes.append('rect').call(drawLinkLocationIndicator.bind(this), 'incoming', 'above');\n      this.nodes.append('rect').call(drawLinkLocationIndicator.bind(this), 'incoming', 'bottom');\n      this.nodes.append('rect').call(drawLinkLocationIndicator.bind(this), 'outgoing', 'above');\n      this.nodes.append('rect').call(drawLinkLocationIndicator.bind(this), 'outgoing', 'bottom');\n\n      this.nodes.append('path').call(drawLinkIndicator.bind(this), 'incoming');\n      this.nodes.append('path').call(drawLinkIndicator.bind(this), 'outgoing');\n\n      // Set all the link location indicator bars.\n      this.groups.each(function (data, index) {\n        _this.calcHeightLinkLocationIndicator(index, true, true);\n      });\n    }\n\n    // Rooting icons\n    var nodeRooted = this.nodes.append('g').attr('class', CLASS_FOCUS_CONTROLS + ' ' + CLASS_ROOT + ' ' + CLASS_INACTIVE);\n\n    nodeRooted.append('rect').call(this.setUpFocusControls.bind(this), 'left', 0.6, 'hover-helper', 'hover-helper');\n\n    nodeRooted.append('svg').call(this.setUpFocusControls.bind(this), 'left', 0.6, 'icon', 'ease-all state-inactive invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#unlocked');\n\n    nodeRooted.append('svg').call(this.setUpFocusControls.bind(this), 'left', 0.6, 'icon', 'ease-all state-active invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#locked');\n\n    // Querying icons\n    if (this.vis.querying) {\n      var nodeQuery = this.nodes.append('g').attr('class', CLASS_FOCUS_CONTROLS + ' ' + CLASS_QUERY + ' ' + CLASS_INACTIVE);\n\n      nodeQuery.append('rect').call(this.setUpFocusControls.bind(this), 'right', 0.6, 'hover-helper', 'hover-helper');\n\n      nodeQuery.append('svg').call(this.setUpFocusControls.bind(this), 'right', 0.6, 'icon', 'ease-all state-and-or invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#union');\n\n      nodeQuery.append('svg').call(this.setUpFocusControls.bind(this), 'right', 0.6, 'icon', 'ease-all state-not invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#not');\n    }\n\n    this.bars = new Bars(this.visNodes, this.vis.barMode, this.visData);\n\n    this.visNodes.append('rect').call(drawFullSizeRect, 'border');\n\n    // Add node label\n    this.visNodes.append('foreignObject').attr('x', this.visData.global.cell.padding).attr('y', this.visData.global.row.padding + this.visData.global.cell.padding).attr('width', this.visData.global.column.contentWidth).attr('height', this.visData.global.row.contentHeight - this.visData.global.cell.padding * 2).attr('class', CLASS_LABEL_WRAPPER).append('xhtml:div').attr('class', 'label').attr('title', function (data) {\n      return data.data.name;\n    }).style('line-height', this.visData.global.row.contentHeight - this.visData.global.cell.padding * 2 + 'px').append('xhtml:span').text(function (data) {\n      return data.data.name;\n    });\n\n    if (isFunction(this.events.on)) {\n      this.events.on('d3ListGraphFocusNodes', function (event) {\n        return _this.focusNodes(event);\n      });\n\n      this.events.on('d3ListGraphBlurNodes', function (event) {\n        return _this.blurNodes(event);\n      });\n\n      this.events.on('d3ListGraphNodeEnter', function (nodeIds) {\n        return _this.eventHelper(nodeIds, _this.highlightNodes);\n      });\n\n      this.events.on('d3ListGraphNodeLeave', function (nodeIds) {\n        return _this.eventHelper(nodeIds, _this.unhighlightNodes);\n      });\n\n      this.events.on('d3ListGraphNodeLock', function (nodeIds) {\n        return _this.eventHelper(nodeIds, _this.toggleLock, []);\n      });\n\n      this.events.on('d3ListGraphNodeUnlock', function (nodeIds) {\n        return _this.eventHelper(nodeIds, _this.toggleLock, [true]);\n      });\n\n      this.events.on('d3ListGraphNodeRoot', function (data) {\n        return _this.eventHelper(data.nodeIds, _this.toggleRoot, [false, true]);\n      });\n\n      this.events.on('d3ListGraphNodeUnroot', function (data) {\n        return _this.eventHelper(data.nodeIds, _this.toggleRoot, [true, true]);\n      });\n    }\n\n    this.nodes.call(this.isInvisible.bind(this));\n  }\n\n  createClass(Nodes, [{\n    key: 'updateLinkLocationIndicators',\n    value: function updateLinkLocationIndicators(left, right) {\n      this.calcHeightLinkLocationIndicator(left, false, true);\n      this.calcHeightLinkLocationIndicator(right, true, false);\n    }\n  }, {\n    key: 'calcHeightLinkLocationIndicator',\n    value: function calcHeightLinkLocationIndicator(level, incoming, outgoing) {\n      var nodes = this.nodes.filter(function (data) {\n        return data.depth === level;\n      });\n      nodes.each(function (data) {\n        if (incoming) {\n          data.links.incoming.above = 0;\n          data.links.incoming.below = 0;\n          for (var i = data.links.incoming.total; i--;) {\n            // We are checking the source location of the incoming link. The\n            // source location is the location of the node of the column being\n            // scrolled.\n            if ((data.links.incoming.refs[i].hidden & 1) > 0) {\n              data.links.incoming.above++;\n            }\n            if ((data.links.incoming.refs[i].hidden & 2) > 0) {\n              data.links.incoming.below++;\n            }\n          }\n        }\n        if (outgoing) {\n          data.links.outgoing.above = 0;\n          data.links.outgoing.below = 0;\n          for (var _i = data.links.outgoing.total; _i--;) {\n            // We are checking the target location of the outgoing link. The\n            // source location is the location of the node of the column being\n            // scrolled.\n            if ((data.links.outgoing.refs[_i].hidden & 4) > 0) {\n              data.links.outgoing.above++;\n            }\n            if ((data.links.outgoing.refs[_i].hidden & 8) > 0) {\n              data.links.outgoing.below++;\n            }\n          }\n        }\n      });\n\n      if (incoming) {\n        this.updateHeightLinkLocationIndicatorBars(nodes);\n      }\n\n      if (outgoing) {\n        this.updateHeightLinkLocationIndicatorBars(nodes, true);\n      }\n    }\n  }, {\n    key: 'updateHeightLinkLocationIndicatorBars',\n    value: function updateHeightLinkLocationIndicatorBars(selection, outgoing) {\n      var barRefHeight = this.visData.global.row.contentHeight / 2 - 1;\n      var barAboveRefTop = this.visData.global.row.height / 2 - 1;\n\n      var baseClassName = '.' + CLASS_INDICATOR_LOCATION + '.' + (outgoing ? CLASS_INDICATOR_OUTGOING : CLASS_INDICATOR_INCOMING);\n\n      selection.selectAll(baseClassName + '.' + CLASS_INDICATOR_ABOVE).attr('y', function (data) {\n        return data.total ? barAboveRefTop - data.above / data.total * barRefHeight : barAboveRefTop;\n      }).attr('height', function (data) {\n        return data.total ? data.above / data.total * barRefHeight : 0;\n      });\n\n      selection.selectAll(baseClassName + '.' + CLASS_INDICATOR_BELOW).attr('height', function (data) {\n        return data.total ? data.below / data.total * barRefHeight : 0;\n      });\n    }\n  }, {\n    key: 'enterHandler',\n    value: function enterHandler(el, data) {\n      this.highlightNodes(d3.select(el));\n\n      var eventData = {\n        id: data.id,\n        clone: false,\n        clonedFromId: undefined\n      };\n\n      if (data.clone) {\n        eventData.clone = true;\n        eventData.clonedFromId = data.originalNode.id;\n      }\n\n      this.events.broadcast('d3ListGraphNodeEnter', eventData);\n    }\n  }, {\n    key: 'leaveHandler',\n    value: function leaveHandler(el, data) {\n      this.unhighlightNodes(d3.select(el));\n\n      var eventData = {\n        id: data.id,\n        clone: false,\n        clonedFromId: undefined\n      };\n\n      if (data.clone) {\n        eventData.clone = true;\n        eventData.clonedFromId = data.originalNode.id;\n      }\n\n      this.events.broadcast('d3ListGraphNodeLeave', eventData);\n    }\n  }, {\n    key: 'lockHandler',\n    value: function lockHandler(d3El) {\n      var events = this.toggleLock(d3El);\n\n      if (events.locked && events.unlocked) {\n        this.events.broadcast('d3ListGraphNodeLockChange', {\n          lock: {\n            id: events.locked.id,\n            clone: events.locked.clone,\n            clonedFromId: events.locked.clone ? events.locked.originalNode.id : undefined\n          },\n          unlock: {\n            id: events.unlocked.id,\n            clone: events.unlocked.clone,\n            clonedFromId: events.unlocked.clone ? events.unlocked.originalNode.id : undefined\n          }\n        });\n      } else {\n        if (events.locked) {\n          this.events.broadcast('d3ListGraphNodeLock', {\n            id: events.locked.id,\n            clone: events.locked.clone,\n            clonedFromId: events.locked.clone ? events.locked.originalNode.id : undefined\n          });\n        }\n\n        if (events.unlocked) {\n          this.events.broadcast('d3ListGraphNodeUnlock', {\n            id: events.unlocked.id,\n            clone: events.unlocked.clone,\n            clonedFromId: events.unlocked.clone ? events.unlocked.originalNode.id : undefined\n          });\n        }\n      }\n    }\n  }, {\n    key: 'rootHandler',\n    value: function rootHandler(d3El, unroot) {\n      if (!d3El.datum().data.state.root && unroot) {\n        // The node is not rooted so there's no point in unrooting.\n        return;\n      }\n      var events = this.toggleRoot(d3El, unroot);\n\n      if (events.rooted && events.unrooted) {\n        this.events.broadcast('d3ListGraphNodeReroot', {\n          rooted: {\n            id: events.rooted.id,\n            clone: events.rooted.clone,\n            clonedFromId: events.rooted.clone ? events.rooted.originalNode.id : undefined\n          },\n          unrooted: {\n            id: events.unrooted.id,\n            clone: events.unrooted.clone,\n            clonedFromId: events.unrooted.clone ? events.unrooted.originalNode.id : undefined\n          }\n        });\n      } else {\n        if (events.rooted) {\n          this.events.broadcast('d3ListGraphNodeRoot', {\n            id: events.rooted.id,\n            clone: events.rooted.clone,\n            clonedFromId: events.rooted.clone ? events.rooted.originalNode.id : undefined\n          });\n        }\n\n        if (events.unrooted) {\n          this.events.broadcast('d3ListGraphNodeUnroot', {\n            id: events.unrooted.id,\n            clone: events.unrooted.clone,\n            clonedFromId: events.unrooted.clone ? events.unrooted.originalNode.id : undefined\n          });\n        }\n      }\n    }\n  }, {\n    key: 'focusNodes',\n    value: function focusNodes(event) {\n      var same = this.checkNodeFocusEventSame(event.nodeIds);\n      if (this.nodeFocusId && !same) {\n        // Show unrelated nodes first before we hide them again.\n        this.blurNodes({\n          nodeIds: this.nodeFocusId\n        });\n      }\n\n      this.nodeFocusId = event.nodeIds;\n\n      this.eventHelper(event.nodeIds, this.highlightNodes, ['focus', 'directParentsOnly', !!event.excludeClones, event.zoomOut || event.hideUnrelatedNodes]);\n\n      if (event.zoomOut) {\n        this.vis.globalView(this.nodes.filter(function (data) {\n          return data.hovering > 0;\n        }));\n      } else {\n        this.vis.zoomedView();\n      }\n\n      if (event.hideUnrelatedNodes) {\n        if (!same || !this.tempHidingUnrelatedNodes) {\n          this.hideUnrelatedNodes(event.nodeIds);\n        }\n      } else if (this.tempHidingUnrelatedNodes) {\n        this.showUnrelatedNodes();\n      }\n    }\n  }, {\n    key: 'blurNodes',\n    value: function blurNodes(event) {\n      this.eventHelper(event.nodeIds, this.unhighlightNodes, ['focus', 'directParentsOnly', !!event.excludeClones]);\n\n      if (event.zoomIn) {\n        this.vis.zoomedView();\n      }\n\n      if (this.tempHidingUnrelatedNodes) {\n        this.showUnrelatedNodes();\n      }\n    }\n  }, {\n    key: 'checkNodeFocusEventSame',\n    value: function checkNodeFocusEventSame(nodeIds) {\n      if (!this.nodeFocusId) {\n        return false;\n      }\n      if (nodeIds.length !== this.nodeFocusId.length) {\n        return false;\n      }\n      for (var i = nodeIds.length; i--;) {\n        if (nodeIds[i] !== this.nodeFocusId[i]) {\n          return false;\n        }\n      }\n      return true;\n    }\n  }, {\n    key: 'hideUnrelatedNodes',\n    value: function hideUnrelatedNodes(nodeIds) {\n      this.tempHidingUnrelatedNodes = nodeIds;\n\n      this.nodes.filter(function (data) {\n        return !data.hovering;\n      }).classed('hidden', true).each(function (data) {\n        // Store old value for `hidden` temporarily\n        data._hidden = data.hidden;\n        data.hidden = true;\n      });\n\n      this.updateVisibility();\n    }\n  }, {\n    key: 'showUnrelatedNodes',\n    value: function showUnrelatedNodes() {\n      this.tempHidingUnrelatedNodes = undefined;\n\n      this.nodes.filter(function (data) {\n        return !data.hovering;\n      }).classed('hidden', function (data) {\n        return data._hidden;\n      }).each(function (data) {\n        data.hidden = data._hidden;\n        data._hidden = undefined;\n      });\n\n      this.updateVisibility();\n    }\n  }, {\n    key: 'eventHelper',\n    value: function eventHelper(nodeIds, callback, optionalParams, subSelectionClass) {\n      var self = this;\n\n      this.nodes\n      // Filter by node ID\n      .filter(function (data) {\n        return !!~nodeIds.indexOf(data.id);\n      }).each(function triggerCallback() {\n        var d3El = d3.select(this);\n\n        if (subSelectionClass) {\n          d3El = d3El.select(subSelectionClass);\n        }\n\n        callback.apply(self, [d3El].concat(optionalParams || []));\n      });\n    }\n  }, {\n    key: 'toggleLock',\n    value: function toggleLock(d3El, setFalse) {\n      var data = d3El.datum();\n      var events = { locked: false, unlocked: false };\n\n      if (this.lockedNode) {\n        if (this.lockedNode.datum().id === data.id) {\n          this.unlockNode(this.lockedNode.datum().id);\n          events.unlocked = this.lockedNode.datum();\n          this.lockedNode = undefined;\n        } else {\n          // Reset previously locked node;\n          this.unlockNode(this.lockedNode.datum().id);\n          events.unlocked = this.lockedNode.datum();\n\n          if (!setFalse) {\n            this.lockNode(data.id);\n            events.locked = data;\n            this.lockedNode = d3El;\n          }\n        }\n      } else {\n        if (!setFalse) {\n          this.lockNode(data.id);\n          events.locked = data;\n          this.lockedNode = d3El;\n        }\n      }\n\n      return events;\n    }\n  }, {\n    key: 'lockNode',\n    value: function lockNode(id) {\n      var self = this;\n      var els = this.nodes.filter(function (data) {\n        return data.id === id;\n      });\n\n      els.each(function (data) {\n        self.highlightNodes(d3.select(this), 'lock', undefined);\n        data.data.state.lock = true;\n      });\n    }\n  }, {\n    key: 'unlockNode',\n    value: function unlockNode(id) {\n      var self = this;\n      var els = this.nodes.filter(function (data) {\n        return data.id === id;\n      });\n\n      els.each(function (data) {\n        self.unhighlightNodes(d3.select(this), 'lock', undefined);\n        data.data.state.lock = undefined;\n      });\n    }\n  }, {\n    key: 'queryByNode',\n    value: function queryByNode(d3El, mode) {\n      d3El.datum().data.state.query = mode;\n      d3El.classed({\n        active: true,\n        inactive: false,\n        'query-and': mode === 'and',\n        'query-or': mode === 'or',\n        'query-not': mode === 'not'\n      });\n    }\n  }, {\n    key: 'unqueryByNode',\n    value: function unqueryByNode(d3El) {\n      var data = d3El.datum();\n\n      data.data.state.query = undefined;\n      data.data.queryBeforeRooting = undefined;\n\n      d3El.classed({\n        active: false,\n        inactive: true,\n        'query-and': false,\n        'query-or': false,\n        'query-not': false\n      });\n\n      if (this.rootedNode) {\n        this.updateVisibility();\n      }\n    }\n  }, {\n    key: 'toggleQueryByNode',\n    value: function toggleQueryByNode(d3El) {\n      var data = d3El.datum();\n      var previousMode = data.data.state.query;\n\n      if (data.data.state.root) {\n        if (previousMode !== 'or') {\n          this.queryByNode(d3El, 'or');\n        } else {\n          this.queryByNode(d3El, 'and');\n        }\n      } else {\n        switch (previousMode) {\n          case 'or':\n            this.queryByNode(d3El, 'and');\n            break;\n          case 'and':\n            this.queryByNode(d3El, 'not');\n            break;\n          case 'not':\n            this.unqueryByNode(d3El);\n            break;\n          default:\n            this.queryByNode(d3El, 'or');\n            break;\n        }\n      }\n    }\n  }, {\n    key: 'batchQueryHandler',\n    value: function batchQueryHandler(els, noNotification) {\n      var actions = [];\n      for (var i = els.length; i--;) {\n        actions.push(this.queryHandler(els[i].d3El, els[i].action, els[i].mode, true));\n      }\n\n      if (!noNotification) {\n        this.events.broadcast('d3ListGraphBatchQuery', actions);\n      }\n    }\n  }, {\n    key: 'queryHandler',\n    value: function queryHandler(d3El, action, mode, returnNoNotification) {\n      var data = d3El.datum();\n      var previousMode = data.data.state.query;\n      var event = {};\n\n      if (!previousMode && action === 'unquery') {\n        // We haven't queried anything so there's nothing to unquery.\n        return undefined;\n      }\n\n      switch (action) {\n        case 'query':\n          this.queryByNode(d3El, mode);\n          break;\n        case 'unquery':\n          this.unqueryByNode(d3El);\n          break;\n        default:\n          this.toggleQueryByNode(d3El);\n          break;\n      }\n\n      if (data.data.state.query) {\n        if (data.data.state.query !== previousMode) {\n          event.name = 'd3ListGraphNodeQuery';\n          event.data = {\n            id: data.id,\n            clone: data.clone,\n            clonedFromId: data.clone ? data.originalNode.id : undefined,\n            mode: data.data.state.query\n          };\n        }\n      } else {\n        event.name = 'd3ListGraphNodeUnquery';\n        event.data = {\n          id: data.id,\n          clone: data.clone,\n          clonedFromId: data.clone ? data.originalNode.id : undefined\n        };\n      }\n\n      if (event.name && !returnNoNotification) {\n        this.events.broadcast(event.name, event.data);\n      }\n\n      return event.name ? event : undefined;\n    }\n  }, {\n    key: 'toggleRoot',\n    value: function toggleRoot(d3El, setFalse, noNotification) {\n      var data = d3El.datum();\n      var events = { rooted: false, unrooted: false };\n      var queries = [];\n\n      // Blur current levels\n      this.vis.levels.blur();\n\n      if (this.rootedNode) {\n        // Reset current root node\n        this.rootedNode.classed({ active: false, inactive: true });\n        events.unrooted = this.rootedNode.datum();\n        if (this.unrootNode(this.rootedNode).unquery) {\n          queries.push({\n            d3El: this.rootedNode,\n            action: 'unquery'\n          });\n        }\n\n        // Activate new root\n        if (this.rootedNode.datum().id !== data.id && !setFalse) {\n          d3El.classed({ active: true, inactive: false });\n          this.rootedNode = d3El;\n          events.rooted = d3El.datum();\n          if (this.rootNode(d3El).query) {\n            queries.push({\n              d3El: d3El,\n              action: 'query',\n              mode: 'or'\n            });\n          }\n        } else {\n          this.rootedNode = undefined;\n          // Highlight first level\n          this.vis.levels.focus(this.vis.activeLevel - this.vis.noRootActiveLevelDiff);\n        }\n      } else {\n        if (!setFalse) {\n          d3El.classed({ active: true, inactive: false });\n          this.rootedNode = d3El;\n          events.rooted = d3El.datum();\n          if (this.rootNode(d3El).query) {\n            queries.push({\n              d3El: d3El,\n              action: 'query',\n              mode: 'or'\n            });\n          }\n        }\n      }\n\n      if (queries.length) {\n        this.batchQueryHandler(queries, noNotification);\n      }\n\n      return events;\n    }\n  }, {\n    key: 'rootNode',\n    value: function rootNode(d3El) {\n      var data = d3El.datum();\n\n      data.data.state.root = true;\n      d3El.classed('rooted', true);\n      this.hideNodes(data);\n\n      // Highlight level\n      this.vis.levels.focus(data.depth + this.vis.activeLevel);\n\n      if (!data.data.state.query || data.data.state.query === 'not') {\n        data.data.queryBeforeRooting = false;\n        return {\n          query: true\n        };\n      }\n\n      data.data.queryBeforeRooting = true;\n\n      return {\n        query: false\n      };\n    }\n  }, {\n    key: 'unrootNode',\n    value: function unrootNode(d3El) {\n      var data = d3El.datum();\n\n      data.data.state.root = false;\n      d3El.classed('rooted', false);\n      this.showNodes();\n\n      if (!data.data.queryBeforeRooting) {\n        return {\n          unquery: true\n        };\n      }\n\n      return {\n        unquery: false\n      };\n    }\n  }, {\n    key: 'setUpFocusControls',\n    value: function setUpFocusControls(selection, location, position, mode, className) {\n      var paddedDim = this.iconDimension + 4;\n\n      var x = 0 - paddedDim * (position + 1);\n\n      if (location === 'right') {\n        x = this.visData.global.column.contentWidth + 2 + paddedDim * position;\n      }\n\n      var y = this.visData.global.row.padding + (this.visData.global.row.contentHeight - 2 * this.visData.global.cell.padding) / 4;\n\n      if (mode === 'bg') {\n        selection.attr('class', className).attr('cx', x + this.iconDimension / 2).attr('cy', y + this.iconDimension / 2).attr('r', this.iconDimension * 3 / 4);\n      } else if (mode === 'hover-helper') {\n        selection.attr('class', className).attr('x', x - 4).attr('y', y - 4).attr('width', this.iconDimension + 8).attr('height', this.iconDimension + 8).attr('rx', this.iconDimension).attr('ry', this.iconDimension);\n      } else {\n        selection.attr('class', className).attr('x', x).attr('y', y).attr('width', this.iconDimension).attr('height', this.iconDimension);\n      }\n    }\n\n    /**\n     * Helper method to hide nodes.\n     *\n     * @method  hideNodes\n     * @author  Fritz Lekschas\n     * @date    2016-02-21\n     * @param   {Object}   data        Node data object.\n     */\n\n  }, {\n    key: 'hideNodes',\n    value: function hideNodes(data) {\n      this.nodesVisibility(data);\n    }\n\n    /**\n     * Helper method to show nodes.\n     *\n     * @method  showNodes\n     * @author  Fritz Lekschas\n     * @date    2016-02-21\n     * @param   {Object}  data       Node data object.\n     */\n\n  }, {\n    key: 'showNodes',\n    value: function showNodes() {\n      this.nodesVisibility(undefined, true);\n    }\n\n    /**\n     * Sets the nodes' visibility\n     *\n     * @method  nodesVisibility\n     * @author  Fritz Lekschas\n     * @date    2016-02-21\n     * @param   {Object}   data        Node data object.\n     * @param   {Boolean}  show        If `true` nodes will be shown.\n     */\n\n  }, {\n    key: 'nodesVisibility',\n    value: function nodesVisibility(data, show) {\n      if (show) {\n        this.nodes.classed('hidden', false).each(function (nodeData) {\n          nodeData.hidden = false;\n        });\n      } else {\n        // First we set all nodes to `hidden`.\n        this.nodes.each(function (nodeData) {\n          nodeData.hidden = true;\n        });\n\n        // Then we set direct child and parent nodes of the current node visible.\n        upAndDown(data, function (nodeData) {\n          nodeData.hidden = false;\n        });\n\n        // We also show sibling nodes.\n        siblings(data, function (nodeData) {\n          nodeData.hidden = false;\n        });\n\n        this.nodes.classed('hidden', function (nodeData) {\n          return nodeData.hidden && !nodeData.data.state.query;\n        });\n      }\n      this.updateVisibility();\n    }\n\n    /**\n     * Marks nodes as being invisible via assigning a class depending on the\n     * custom scroll top position or the columns scroll top position.\n     *\n     * @method  isInvisible\n     * @author  Fritz Lekschas\n     * @date    2016-09-12\n     * @param   {Object}  selection        D3 selection of nodes to be checked.\n     * @param   {Number}  customScrollTop  Custom scroll top position. Used when\n     *   column is actively scrolled.\n     */\n\n  }, {\n    key: 'isInvisible',\n    value: function isInvisible(selection, customScrollTop) {\n      var _this2 = this;\n\n      selection.classed('invisible', function (data) {\n        var scrollTop = customScrollTop || _this2.visData.nodes[data.depth].scrollTop;\n\n        // Node is right to the visible container\n        if (data.x + _this2.vis.dragged.x >= _this2.vis.width) {\n          return data.invisible = true;\n        }\n        // Node is below the visible container\n        if (data.y + scrollTop >= _this2.vis.height) {\n          return data.invisible = true;\n        }\n        // Node is above the visible container\n        if (data.y + _this2.visData.global.row.height + scrollTop <= 0) {\n          return data.invisible = true;\n        }\n        // Node is left to the visible container\n        if (data.x + _this2.vis.dragged.x + _this2.visData.global.column.width <= 0) {\n          return data.invisible = true;\n        }\n        return data.invisible = false;\n      });\n    }\n  }, {\n    key: 'makeAllTempVisible',\n    value: function makeAllTempVisible(unset) {\n      if (unset) {\n        this.nodes.classed('invisible', function (data) {\n          var prevInvisible = data._invisible;\n          data._invisible = undefined;\n\n          return prevInvisible;\n        });\n      } else {\n        this.nodes.classed('invisible', function (data) {\n          data._invisible = data.invisible;\n          return false;\n        });\n      }\n    }\n  }, {\n    key: 'highlightNodes',\n    value: function highlightNodes(d3El, className, restriction, excludeClones, noVisibilityCheck) {\n      var _this3 = this;\n\n      var self = this;\n      var data = d3El.datum();\n      var nodeId = data.id;\n      var currentNodeData = data.clone ? data.originalNode : data;\n      var includeParents = true;\n      var appliedClassName = className || 'hovering';\n      var includeClones = !excludeClones;\n      var includeChildren = restriction !== 'directParentsOnly';\n\n      // Store link IDs\n      if (!this.currentLinks[appliedClassName]) {\n        this.currentLinks[appliedClassName] = {};\n      }\n      this.currentLinks[appliedClassName][nodeId] = {};\n\n      var currentlyActiveBar = d3El.selectAll('.bar.active .bar-magnitude');\n      if (!currentlyActiveBar.empty()) {\n        currentlyActiveBar = currentlyActiveBar.datum();\n      } else {\n        currentlyActiveBar = undefined;\n      }\n\n      var traverseCallbackUp = function traverseCallbackUp(nodeData, childData) {\n        nodeData.hovering = 2;\n        for (var i = nodeData.links.outgoing.refs.length; i--;) {\n          // Only push direct parent child connections. E.g.\n          // Store: (parent)->(child)\n          // Ignore: (parent)->(siblings of child)\n          if (nodeData.links.outgoing.refs[i].target.node.id === childData.id) {\n            _this3.currentLinks[appliedClassName][nodeId][nodeData.links.outgoing.refs[i].id] = true;\n          }\n        }\n      };\n\n      var traverseCallbackDown = function traverseCallbackDown(nodeData) {\n        nodeData.hovering = 2;\n        for (var i = nodeData.links.outgoing.refs.length; i--;) {\n          _this3.currentLinks[appliedClassName][nodeId][nodeData.links.outgoing.refs[i].id] = true;\n        }\n      };\n\n      if (includeParents && includeChildren) {\n        upAndDown(data.clone ? data.originalNode : data, traverseCallbackUp, traverseCallbackDown, undefined, includeClones);\n      }\n      if (includeParents && !includeChildren) {\n        up(data, traverseCallbackUp, undefined, includeClones);\n      }\n      if (!includeParents && includeChildren) {\n        down(data.clone ? data.originalNode : data, traverseCallbackUp, undefined, includeClones);\n      }\n\n      currentNodeData.hovering = 1;\n\n      if (includeClones) {\n        for (var i = currentNodeData.clones.length; i--;) {\n          currentNodeData.clones[i].hovering = 1;\n        }\n      }\n\n      /**\n       * Helper method to assess the node visibility.\n       *\n       * @method  checkNodeVisibility\n       * @author  Fritz Lekschas\n       * @date    2016-02-25\n       * @param   {Object}  _el    [description]\n       * @param   {Object}  _data  [description]\n       * @return  {Boolean}        If `true` element is hidden.\n       */\n      function checkNodeVisibility(_el, _data) {\n        return noVisibilityCheck || !_data.hidden && !self.vis.isHidden.call(self.vis, _el);\n      }\n\n      /**\n       * Helper method to filter out directly hovered nodes.\n       *\n       * @method  checkNodeDirect\n       * @author  Fritz Lekschas\n       * @date    2016-02-25\n       * @param   {Object}  nodeData  The node's data object.\n       * @return  {Boolean}           If `true` element will not be filtered out.\n       */\n      function checkNodeDirect(nodeData) {\n        return nodeData.hovering === 1 && checkNodeVisibility(this, nodeData);\n      }\n\n      /**\n       * Helper method to filter out indirectly hovered nodes.\n       *\n       * @method  checkNodeIndirect\n       * @author  Fritz Lekschas\n       * @date    2016-02-25\n       * @param   {Object}  nodeData  The node's data object.\n       * @return  {Boolean}           If `true` element will not be filtered out.\n       */\n      function checkNodeIndirect(nodeData) {\n        return nodeData.hovering === 2 && checkNodeVisibility(this, nodeData);\n      }\n\n      this.nodes.filter(checkNodeDirect).classed(appliedClassName + '-directly', true);\n      this.nodes.filter(checkNodeIndirect).classed(appliedClassName + '-indirectly', true);\n\n      this.links.highlight(this.currentLinks[appliedClassName][data.id], true, appliedClassName);\n    }\n  }, {\n    key: 'unhighlightNodes',\n    value: function unhighlightNodes(d3El, className, restriction, excludeClones) {\n      var data = d3El.datum();\n      var traverseCallback = function traverseCallback(nodeData) {\n        nodeData.hovering = 0;\n      };\n      var includeParents = true;\n      var appliedClassName = className || 'hovering';\n      var includeClones = !excludeClones;\n      var includeChildren = restriction !== 'directParentsOnly';\n\n      data.hovering = 0;\n      if (includeParents && includeChildren) {\n        upAndDown(data, traverseCallback, undefined, undefined, includeClones);\n      }\n      if (includeParents && !includeChildren) {\n        up(data, traverseCallback, undefined, includeClones);\n      }\n      if (!includeParents && includeChildren) {\n        down(data, traverseCallback, undefined, includeClones);\n      }\n\n      if (data.clone) {\n        data.originalNode.hovering = 0;\n      } else {\n        if (includeClones) {\n          for (var i = data.clones.length; i--;) {\n            data.clones[i].hovering = 0;\n          }\n        }\n      }\n\n      this.nodes.classed(appliedClassName + '-directly', false);\n      this.nodes.classed(appliedClassName + '-indirectly', false);\n\n      if (this.currentLinks[appliedClassName] && this.currentLinks[appliedClassName][data.id]) {\n        this.links.highlight(this.currentLinks[appliedClassName][data.id], false, appliedClassName);\n      }\n    }\n  }, {\n    key: 'sort',\n    value: function sort(update, newSortType) {\n      var _this4 = this;\n\n      for (var i = update.length; i--;) {\n        var selection = this.nodes.data(update[i].rows, function (data) {\n          return data.id;\n        });\n\n        this.vis.svgD3.classed('sorting', true);\n        selection.transition().duration(TRANSITION_SEMI_FAST).attr('transform', function (data) {\n          return 'translate(' + (data.x + _this4.visData.global.column.padding) + ', ' + data.y + ')';\n        }).call(allTransitionsEnded, function () {\n          _this4.vis.svgD3.classed('sorting', false);\n          _this4.vis.updateLevelsVisibility();\n          _this4.vis.updateScrolling();\n        });\n\n        if (newSortType && this.vis.currentSorting.local[update[i].level].type !== 'name') {\n          this.bars.update(selection.selectAll('.bar'), update[i].sortBy);\n        }\n      }\n    }\n\n    /**\n     * Updates the nodes' visibility visually.\n     *\n     * @method  updateVisibility\n     * @author  Fritz Lekschas\n     * @date    2016-02-21\n     */\n\n  }, {\n    key: 'updateVisibility',\n    value: function updateVisibility() {\n      var _this5 = this;\n\n      // Calls the D3 list graph layout method to update the nodes position.\n      this.vis.layout.updateNodesVisibility();\n\n      // Transition to the updated position\n      this.nodes.transition().duration(TRANSITION_SEMI_FAST).attr('transform', function (data) {\n        return 'translate(' + (data.x + _this5.visData.global.column.padding) + ', ' + data.y + ')';\n      }).call(allTransitionsEnded, function () {\n        _this5.vis.updateLevelsVisibility();\n        _this5.vis.updateScrolling();\n        _this5.nodes.call(_this5.isInvisible.bind(_this5));\n      });\n\n      this.vis.links.updateVisibility();\n    }\n  }, {\n    key: 'classNnodes',\n    get: function get() {\n      return CLASS_NODES;\n    }\n  }, {\n    key: 'classNode',\n    get: function get() {\n      return CLASS_NODE;\n    }\n  }, {\n    key: 'classNodeVisible',\n    get: function get() {\n      return CLASS_NODE_VISIBLE;\n    }\n  }, {\n    key: 'classClone',\n    get: function get() {\n      return CLASS_CLONE;\n    }\n  }, {\n    key: 'classLabelWrapper',\n    get: function get() {\n      return CLASS_LABEL_WRAPPER;\n    }\n  }, {\n    key: 'classFocusControls',\n    get: function get() {\n      return CLASS_FOCUS_CONTROLS;\n    }\n  }, {\n    key: 'classRoot',\n    get: function get() {\n      return CLASS_ROOT;\n    }\n  }, {\n    key: 'classQuery',\n    get: function get() {\n      return CLASS_QUERY;\n    }\n  }, {\n    key: 'classLock',\n    get: function get() {\n      return CLASS_LOCK;\n    }\n  }, {\n    key: 'barMode',\n    get: function get() {\n      return this.bars.mode;\n    }\n  }]);\n  return Nodes;\n}();\n\n// External\n// eslint-disable-line import/no-unresolved\n\n// Internal\n/**\n * Class name of scrollbar elements.\n *\n * @type  {String}\n */\nvar SCROLLBAR_CLASS = 'scrollbar';\n\nvar Scrollbars = function () {\n  /**\n   * [constructor description]\n   *\n   * @method  constructor\n   * @author  Fritz Lekschas\n   * @date    2016-09-14\n   * @param   {Object}  baseEl   D3 selection of the element where the\n   *   scrollbars should be appended to.\n   * @param   {Object}  visData  List Graph App's data.\n   * @param   {Number}  width    Width of the scrollbar in pixels.\n   */\n  function Scrollbars(baseEl, visData, width) {\n    classCallCheck(this, Scrollbars);\n\n    this.visData = visData;\n    this.width = width;\n\n    // Add empty scrollbar element\n    this.all = baseEl.append('rect').attr('class', SCROLLBAR_CLASS).call(function (selection) {\n      selection.each(function setScrollBarDomElement() {\n        d3.select(this.parentNode).datum().scrollbar.el = this;\n      });\n    }).attr('x', function (data) {\n      return data.scrollbar.x - 2;\n    }).attr('y', function (data) {\n      return data.scrollbar.y;\n    }).attr('width', this.width).attr('height', function (data) {\n      return data.scrollbar.height;\n    }).attr('rx', this.width / 2).attr('ry', this.width / 2).classed('ready', true);\n  }\n\n  /**\n   * Update the viisual state of the scrollbar given the current data.\n   *\n   * @method  updateVisibility\n   * @author  Fritz Lekschas\n   * @date    2016-09-14\n   */\n\n\n  createClass(Scrollbars, [{\n    key: 'updateVisibility',\n    value: function updateVisibility() {\n      this.all.transition().duration(TRANSITION_LIGHTNING_FAST).attr('x', function (data) {\n        return data.scrollbar.x;\n      }).attr('height', function (data) {\n        return data.scrollbar.height;\n      });\n    }\n  }]);\n  return Scrollbars;\n}();\n\n// External\n// Internal\nvar Events = function () {\n  function Events(el, broadcast) {\n    classCallCheck(this, Events);\n\n    if (broadcast && !isFunction(broadcast)) {\n      throw new EventDispatcherNoFunction();\n    }\n\n    this.el = el;\n    this._stack = {};\n    this.dispatch = broadcast || this._dispatchEvent;\n  }\n\n  createClass(Events, [{\n    key: '_dispatchEvent',\n    value: function _dispatchEvent(eventName, data) {\n      var event = document.createEvent('CustomEvent');\n      event.initCustomEvent(eventName, false, false, data);\n      this.el.dispatchEvent(event);\n    }\n  }, {\n    key: 'broadcast',\n    value: function broadcast(event, data) {\n      this.dispatch(event, data);\n    }\n\n    /**\n     * Add a callback function to an event stack.\n     *\n     * @method  on\n     * @author  Fritz Lekschas\n     * @date    2016-01-07\n     *\n     * @param   {String}    event     Event identifier.\n     * @param   {Function}  callback  Function which is called when the event\n     *   stack is triggered.\n     * @param   {Number}    times     Number of times the callback function should\n     *   be triggered before it is removed from the event stack. This is useful\n     *   when an event happens only a certain number of times.\n     * @return  {Number}              Index of callback, which is needed to\n     *   manually remove the callback from the event stack.\n     */\n\n  }, {\n    key: 'on',\n    value: function on(event, callback, times) {\n      if (!isFunction(callback)) {\n        return false;\n      }\n\n      var normTimes = isFinite(times) ? parseInt(times, 10) : Infinity;\n\n      if (isArray(this.stack[event])) {\n        return this.stack[event].push({ callback: callback, times: normTimes }) - 1;\n      }\n      this.stack[event] = [{ callback: callback, times: normTimes }];\n      return 0;\n    }\n\n    /**\n     * Removes a callback function from an event stack given its index.\n     *\n     * @method  off\n     * @author  Fritz Lekschas\n     * @date    2016-01-07\n     *\n     * @param   {String}   event  Event identifier.\n     * @param   {Number}   index  Index of the callback to be removed.\n     * @return  {Boolean}         Returns `true` if event callback was found and\n     *   successfully removed.\n     */\n\n  }, {\n    key: 'off',\n    value: function off(event, index) {\n      try {\n        this.stack[event].splice(index, 1);\n        return true;\n      } catch (e) {\n        return false;\n      }\n    }\n\n    /**\n     * Trigger an event stack\n     *\n     * @method  trigger\n     * @author  Fritz Lekschas\n     * @date    2016-01-07\n     *\n     * @param   {String}   event  Event identifier.\n     * @return  {Boolean}         Returns `true` if an event stack was found.\n     */\n\n  }, {\n    key: 'trigger',\n    value: function trigger(event, data) {\n      if (isArray(this.stack[event])) {\n        // Traversing from the end to the start, which has the advantage that\n        // deletion of events, i.e. calling `Event.off()` doesn't affect the index\n        // of event listeners in the next step.\n        for (var i = this.stack[event].length; i--;) {\n          // Instead of checking whether `stack[event][i]` is a function here,\n          // we do it just once when we add the function to the stack.\n          if (this.stack[event][i].times--) {\n            this.stack[event][i].callback(data);\n          } else {\n            this.off(event, i);\n          }\n        }\n        return true;\n      }\n      return false;\n    }\n  }, {\n    key: 'stack',\n    get: function get() {\n      return this._stack;\n    }\n  }]);\n  return Events;\n}();\n\nfunction objectOrFunction(x) {\n  return typeof x === 'function' || (typeof x === 'object' && x !== null);\n}\n\nfunction isFunction$1(x) {\n  return typeof x === 'function';\n}\n\nvar _isArray;\nif (!Array.isArray) {\n  _isArray = function (x) {\n    return Object.prototype.toString.call(x) === '[object Array]';\n  };\n} else {\n  _isArray = Array.isArray;\n}\n\nvar isArray$1 = _isArray;\n\nvar len = 0;\nvar vertxNext;\nvar customSchedulerFn;\n\nvar asap = function asap(callback, arg) {\n  queue[len] = callback;\n  queue[len + 1] = arg;\n  len += 2;\n  if (len === 2) {\n    // If len is 2, that means that we need to schedule an async flush.\n    // If additional callbacks are queued before the queue is flushed, they\n    // will be processed by this flush that we are scheduling.\n    if (customSchedulerFn) {\n      customSchedulerFn(flush);\n    } else {\n      scheduleFlush();\n    }\n  }\n}\n\nfunction setScheduler(scheduleFn) {\n  customSchedulerFn = scheduleFn;\n}\n\nfunction setAsap(asapFn) {\n  asap = asapFn;\n}\n\nvar browserWindow = (typeof window !== 'undefined') ? window : undefined;\nvar browserGlobal = browserWindow || {};\nvar BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;\nvar isNode = typeof self === 'undefined' && typeof process !== 'undefined' && {}.toString.call(process) === '[object process]';\n\n// test for web worker but not in IE10\nvar isWorker = typeof Uint8ClampedArray !== 'undefined' &&\n  typeof importScripts !== 'undefined' &&\n  typeof MessageChannel !== 'undefined';\n\n// node\nfunction useNextTick() {\n  // node version 0.10.x displays a deprecation warning when nextTick is used recursively\n  // see https://github.com/cujojs/when/issues/410 for details\n  return function() {\n    process.nextTick(flush);\n  };\n}\n\n// vertx\nfunction useVertxTimer() {\n  return function() {\n    vertxNext(flush);\n  };\n}\n\nfunction useMutationObserver() {\n  var iterations = 0;\n  var observer = new BrowserMutationObserver(flush);\n  var node = document.createTextNode('');\n  observer.observe(node, { characterData: true });\n\n  return function() {\n    node.data = (iterations = ++iterations % 2);\n  };\n}\n\n// web worker\nfunction useMessageChannel() {\n  var channel = new MessageChannel();\n  channel.port1.onmessage = flush;\n  return function () {\n    channel.port2.postMessage(0);\n  };\n}\n\nfunction useSetTimeout() {\n  return function() {\n    setTimeout(flush, 1);\n  };\n}\n\nvar queue = new Array(1000);\nfunction flush() {\n  for (var i = 0; i < len; i+=2) {\n    var callback = queue[i];\n    var arg = queue[i+1];\n\n    callback(arg);\n\n    queue[i] = undefined;\n    queue[i+1] = undefined;\n  }\n\n  len = 0;\n}\n\nfunction attemptVertx() {\n  try {\n    var r = require;\n    var vertx = r('vertx');\n    vertxNext = vertx.runOnLoop || vertx.runOnContext;\n    return useVertxTimer();\n  } catch(e) {\n    return useSetTimeout();\n  }\n}\n\nvar scheduleFlush;\n// Decide what async method to use to triggering processing of queued callbacks:\nif (isNode) {\n  scheduleFlush = useNextTick();\n} else if (BrowserMutationObserver) {\n  scheduleFlush = useMutationObserver();\n} else if (isWorker) {\n  scheduleFlush = useMessageChannel();\n} else if (browserWindow === undefined && typeof require === 'function') {\n  scheduleFlush = attemptVertx();\n} else {\n  scheduleFlush = useSetTimeout();\n}\n\nfunction then(onFulfillment, onRejection) {\n  var parent = this;\n\n  var child = new this.constructor(noop);\n\n  if (child[PROMISE_ID] === undefined) {\n    makePromise(child);\n  }\n\n  var state = parent._state;\n\n  if (state) {\n    var callback = arguments[state - 1];\n    asap(function(){\n      invokeCallback(state, child, callback, parent._result);\n    });\n  } else {\n    subscribe(parent, child, onFulfillment, onRejection);\n  }\n\n  return child;\n}\n\n/**\n  `Promise.resolve` returns a promise that will become resolved with the\n  passed `value`. It is shorthand for the following:\n\n  ```javascript\n  var promise = new Promise(function(resolve, reject){\n    resolve(1);\n  });\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  var promise = Promise.resolve(1);\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  @method resolve\n  @static\n  @param {Any} value value that the returned promise will be resolved with\n  Useful for tooling.\n  @return {Promise} a promise that will become fulfilled with the given\n  `value`\n*/\nfunction resolve(object) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (object && typeof object === 'object' && object.constructor === Constructor) {\n    return object;\n  }\n\n  var promise = new Constructor(noop);\n  _resolve(promise, object);\n  return promise;\n}\n\nvar PROMISE_ID = Math.random().toString(36).substring(16);\n\nfunction noop() {}\n\nvar PENDING   = void 0;\nvar FULFILLED = 1;\nvar REJECTED  = 2;\n\nvar GET_THEN_ERROR = new ErrorObject();\n\nfunction selfFulfillment() {\n  return new TypeError(\"You cannot resolve a promise with itself\");\n}\n\nfunction cannotReturnOwn() {\n  return new TypeError('A promises callback cannot return that same promise.');\n}\n\nfunction getThen(promise) {\n  try {\n    return promise.then;\n  } catch(error) {\n    GET_THEN_ERROR.error = error;\n    return GET_THEN_ERROR;\n  }\n}\n\nfunction tryThen(then, value, fulfillmentHandler, rejectionHandler) {\n  try {\n    then.call(value, fulfillmentHandler, rejectionHandler);\n  } catch(e) {\n    return e;\n  }\n}\n\nfunction handleForeignThenable(promise, thenable, then) {\n   asap(function(promise) {\n    var sealed = false;\n    var error = tryThen(then, thenable, function(value) {\n      if (sealed) { return; }\n      sealed = true;\n      if (thenable !== value) {\n        _resolve(promise, value);\n      } else {\n        fulfill(promise, value);\n      }\n    }, function(reason) {\n      if (sealed) { return; }\n      sealed = true;\n\n      _reject(promise, reason);\n    }, 'Settle: ' + (promise._label || ' unknown promise'));\n\n    if (!sealed && error) {\n      sealed = true;\n      _reject(promise, error);\n    }\n  }, promise);\n}\n\nfunction handleOwnThenable(promise, thenable) {\n  if (thenable._state === FULFILLED) {\n    fulfill(promise, thenable._result);\n  } else if (thenable._state === REJECTED) {\n    _reject(promise, thenable._result);\n  } else {\n    subscribe(thenable, undefined, function(value) {\n      _resolve(promise, value);\n    }, function(reason) {\n      _reject(promise, reason);\n    });\n  }\n}\n\nfunction handleMaybeThenable(promise, maybeThenable, then$$) {\n  if (maybeThenable.constructor === promise.constructor &&\n      then$$ === then &&\n      constructor.resolve === resolve) {\n    handleOwnThenable(promise, maybeThenable);\n  } else {\n    if (then$$ === GET_THEN_ERROR) {\n      _reject(promise, GET_THEN_ERROR.error);\n    } else if (then$$ === undefined) {\n      fulfill(promise, maybeThenable);\n    } else if (isFunction$1(then$$)) {\n      handleForeignThenable(promise, maybeThenable, then$$);\n    } else {\n      fulfill(promise, maybeThenable);\n    }\n  }\n}\n\nfunction _resolve(promise, value) {\n  if (promise === value) {\n    _reject(promise, selfFulfillment());\n  } else if (objectOrFunction(value)) {\n    handleMaybeThenable(promise, value, getThen(value));\n  } else {\n    fulfill(promise, value);\n  }\n}\n\nfunction publishRejection(promise) {\n  if (promise._onerror) {\n    promise._onerror(promise._result);\n  }\n\n  publish(promise);\n}\n\nfunction fulfill(promise, value) {\n  if (promise._state !== PENDING) { return; }\n\n  promise._result = value;\n  promise._state = FULFILLED;\n\n  if (promise._subscribers.length !== 0) {\n    asap(publish, promise);\n  }\n}\n\nfunction _reject(promise, reason) {\n  if (promise._state !== PENDING) { return; }\n  promise._state = REJECTED;\n  promise._result = reason;\n\n  asap(publishRejection, promise);\n}\n\nfunction subscribe(parent, child, onFulfillment, onRejection) {\n  var subscribers = parent._subscribers;\n  var length = subscribers.length;\n\n  parent._onerror = null;\n\n  subscribers[length] = child;\n  subscribers[length + FULFILLED] = onFulfillment;\n  subscribers[length + REJECTED]  = onRejection;\n\n  if (length === 0 && parent._state) {\n    asap(publish, parent);\n  }\n}\n\nfunction publish(promise) {\n  var subscribers = promise._subscribers;\n  var settled = promise._state;\n\n  if (subscribers.length === 0) { return; }\n\n  var child, callback, detail = promise._result;\n\n  for (var i = 0; i < subscribers.length; i += 3) {\n    child = subscribers[i];\n    callback = subscribers[i + settled];\n\n    if (child) {\n      invokeCallback(settled, child, callback, detail);\n    } else {\n      callback(detail);\n    }\n  }\n\n  promise._subscribers.length = 0;\n}\n\nfunction ErrorObject() {\n  this.error = null;\n}\n\nvar TRY_CATCH_ERROR = new ErrorObject();\n\nfunction tryCatch(callback, detail) {\n  try {\n    return callback(detail);\n  } catch(e) {\n    TRY_CATCH_ERROR.error = e;\n    return TRY_CATCH_ERROR;\n  }\n}\n\nfunction invokeCallback(settled, promise, callback, detail) {\n  var hasCallback = isFunction$1(callback),\n      value, error, succeeded, failed;\n\n  if (hasCallback) {\n    value = tryCatch(callback, detail);\n\n    if (value === TRY_CATCH_ERROR) {\n      failed = true;\n      error = value.error;\n      value = null;\n    } else {\n      succeeded = true;\n    }\n\n    if (promise === value) {\n      _reject(promise, cannotReturnOwn());\n      return;\n    }\n\n  } else {\n    value = detail;\n    succeeded = true;\n  }\n\n  if (promise._state !== PENDING) {\n    // noop\n  } else if (hasCallback && succeeded) {\n    _resolve(promise, value);\n  } else if (failed) {\n    _reject(promise, error);\n  } else if (settled === FULFILLED) {\n    fulfill(promise, value);\n  } else if (settled === REJECTED) {\n    _reject(promise, value);\n  }\n}\n\nfunction initializePromise(promise, resolver) {\n  try {\n    resolver(function resolvePromise(value){\n      _resolve(promise, value);\n    }, function rejectPromise(reason) {\n      _reject(promise, reason);\n    });\n  } catch(e) {\n    _reject(promise, e);\n  }\n}\n\nvar id = 0;\nfunction nextId() {\n  return id++;\n}\n\nfunction makePromise(promise) {\n  promise[PROMISE_ID] = id++;\n  promise._state = undefined;\n  promise._result = undefined;\n  promise._subscribers = [];\n}\n\nfunction Enumerator(Constructor, input) {\n  this._instanceConstructor = Constructor;\n  this.promise = new Constructor(noop);\n\n  if (!this.promise[PROMISE_ID]) {\n    makePromise(this.promise);\n  }\n\n  if (isArray$1(input)) {\n    this._input     = input;\n    this.length     = input.length;\n    this._remaining = input.length;\n\n    this._result = new Array(this.length);\n\n    if (this.length === 0) {\n      fulfill(this.promise, this._result);\n    } else {\n      this.length = this.length || 0;\n      this._enumerate();\n      if (this._remaining === 0) {\n        fulfill(this.promise, this._result);\n      }\n    }\n  } else {\n    _reject(this.promise, validationError());\n  }\n}\n\nfunction validationError() {\n  return new Error('Array Methods must be provided an Array');\n};\n\nEnumerator.prototype._enumerate = function() {\n  var length  = this.length;\n  var input   = this._input;\n\n  for (var i = 0; this._state === PENDING && i < length; i++) {\n    this._eachEntry(input[i], i);\n  }\n};\n\nEnumerator.prototype._eachEntry = function(entry, i) {\n  var c = this._instanceConstructor;\n  var resolve$$ = c.resolve;\n\n  if (resolve$$ === resolve) {\n    var then$$ = getThen(entry);\n\n    if (then$$ === then &&\n        entry._state !== PENDING) {\n      this._settledAt(entry._state, i, entry._result);\n    } else if (typeof then$$ !== 'function') {\n      this._remaining--;\n      this._result[i] = entry;\n    } else if (c === Promise$1) {\n      var promise = new c(noop);\n      handleMaybeThenable(promise, entry, then$$);\n      this._willSettleAt(promise, i);\n    } else {\n      this._willSettleAt(new c(function(resolve$$) { resolve$$(entry); }), i);\n    }\n  } else {\n    this._willSettleAt(resolve$$(entry), i);\n  }\n};\n\nEnumerator.prototype._settledAt = function(state, i, value) {\n  var promise = this.promise;\n\n  if (promise._state === PENDING) {\n    this._remaining--;\n\n    if (state === REJECTED) {\n      _reject(promise, value);\n    } else {\n      this._result[i] = value;\n    }\n  }\n\n  if (this._remaining === 0) {\n    fulfill(promise, this._result);\n  }\n};\n\nEnumerator.prototype._willSettleAt = function(promise, i) {\n  var enumerator = this;\n\n  subscribe(promise, undefined, function(value) {\n    enumerator._settledAt(FULFILLED, i, value);\n  }, function(reason) {\n    enumerator._settledAt(REJECTED, i, reason);\n  });\n};\n\n/**\n  `Promise.all` accepts an array of promises, and returns a new promise which\n  is fulfilled with an array of fulfillment values for the passed promises, or\n  rejected with the reason of the first passed promise to be rejected. It casts all\n  elements of the passed iterable to promises as it runs this algorithm.\n\n  Example:\n\n  ```javascript\n  var promise1 = resolve(1);\n  var promise2 = resolve(2);\n  var promise3 = resolve(3);\n  var promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // The array here would be [ 1, 2, 3 ];\n  });\n  ```\n\n  If any of the `promises` given to `all` are rejected, the first promise\n  that is rejected will be given as an argument to the returned promises's\n  rejection handler. For example:\n\n  Example:\n\n  ```javascript\n  var promise1 = resolve(1);\n  var promise2 = reject(new Error(\"2\"));\n  var promise3 = reject(new Error(\"3\"));\n  var promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // Code here never runs because there are rejected promises!\n  }, function(error) {\n    // error.message === \"2\"\n  });\n  ```\n\n  @method all\n  @static\n  @param {Array} entries array of promises\n  @param {String} label optional string for labeling the promise.\n  Useful for tooling.\n  @return {Promise} promise that is fulfilled when all `promises` have been\n  fulfilled, or rejected if any of them become rejected.\n  @static\n*/\nfunction all(entries) {\n  return new Enumerator(this, entries).promise;\n}\n\n/**\n  `Promise.race` returns a new promise which is settled in the same way as the\n  first passed promise to settle.\n\n  Example:\n\n  ```javascript\n  var promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  var promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 2');\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // result === 'promise 2' because it was resolved before promise1\n    // was resolved.\n  });\n  ```\n\n  `Promise.race` is deterministic in that only the state of the first\n  settled promise matters. For example, even if other promises given to the\n  `promises` array argument are resolved, but the first settled promise has\n  become rejected before the other promises became fulfilled, the returned\n  promise will become rejected:\n\n  ```javascript\n  var promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  var promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      reject(new Error('promise 2'));\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // Code here never runs\n  }, function(reason){\n    // reason.message === 'promise 2' because promise 2 became rejected before\n    // promise 1 became fulfilled\n  });\n  ```\n\n  An example real-world use case is implementing timeouts:\n\n  ```javascript\n  Promise.race([ajax('foo.json'), timeout(5000)])\n  ```\n\n  @method race\n  @static\n  @param {Array} promises array of promises to observe\n  Useful for tooling.\n  @return {Promise} a promise which settles in the same way as the first passed\n  promise to settle.\n*/\nfunction race(entries) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (!isArray$1(entries)) {\n    return new Constructor(function(resolve, reject) {\n      reject(new TypeError('You must pass an array to race.'));\n    });\n  } else {\n    return new Constructor(function(resolve, reject) {\n      var length = entries.length;\n      for (var i = 0; i < length; i++) {\n        Constructor.resolve(entries[i]).then(resolve, reject);\n      }\n    });\n  }\n}\n\n/**\n  `Promise.reject` returns a promise rejected with the passed `reason`.\n  It is shorthand for the following:\n\n  ```javascript\n  var promise = new Promise(function(resolve, reject){\n    reject(new Error('WHOOPS'));\n  });\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  var promise = Promise.reject(new Error('WHOOPS'));\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  @method reject\n  @static\n  @param {Any} reason value that the returned promise will be rejected with.\n  Useful for tooling.\n  @return {Promise} a promise rejected with the given `reason`.\n*/\nfunction reject(reason) {\n  /*jshint validthis:true */\n  var Constructor = this;\n  var promise = new Constructor(noop);\n  _reject(promise, reason);\n  return promise;\n}\n\nfunction needsResolver() {\n  throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');\n}\n\nfunction needsNew() {\n  throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");\n}\n\n/**\n  Promise objects represent the eventual result of an asynchronous operation. The\n  primary way of interacting with a promise is through its `then` method, which\n  registers callbacks to receive either a promise's eventual value or the reason\n  why the promise cannot be fulfilled.\n\n  Terminology\n  -----------\n\n  - `promise` is an object or function with a `then` method whose behavior conforms to this specification.\n  - `thenable` is an object or function that defines a `then` method.\n  - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).\n  - `exception` is a value that is thrown using the throw statement.\n  - `reason` is a value that indicates why a promise was rejected.\n  - `settled` the final resting state of a promise, fulfilled or rejected.\n\n  A promise can be in one of three states: pending, fulfilled, or rejected.\n\n  Promises that are fulfilled have a fulfillment value and are in the fulfilled\n  state.  Promises that are rejected have a rejection reason and are in the\n  rejected state.  A fulfillment value is never a thenable.\n\n  Promises can also be said to *resolve* a value.  If this value is also a\n  promise, then the original promise's settled state will match the value's\n  settled state.  So a promise that *resolves* a promise that rejects will\n  itself reject, and a promise that *resolves* a promise that fulfills will\n  itself fulfill.\n\n\n  Basic Usage:\n  ------------\n\n  ```js\n  var promise = new Promise(function(resolve, reject) {\n    // on success\n    resolve(value);\n\n    // on failure\n    reject(reason);\n  });\n\n  promise.then(function(value) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Advanced Usage:\n  ---------------\n\n  Promises shine when abstracting away asynchronous interactions such as\n  `XMLHttpRequest`s.\n\n  ```js\n  function getJSON(url) {\n    return new Promise(function(resolve, reject){\n      var xhr = new XMLHttpRequest();\n\n      xhr.open('GET', url);\n      xhr.onreadystatechange = handler;\n      xhr.responseType = 'json';\n      xhr.setRequestHeader('Accept', 'application/json');\n      xhr.send();\n\n      function handler() {\n        if (this.readyState === this.DONE) {\n          if (this.status === 200) {\n            resolve(this.response);\n          } else {\n            reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));\n          }\n        }\n      };\n    });\n  }\n\n  getJSON('/posts.json').then(function(json) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Unlike callbacks, promises are great composable primitives.\n\n  ```js\n  Promise.all([\n    getJSON('/posts'),\n    getJSON('/comments')\n  ]).then(function(values){\n    values[0] // => postsJSON\n    values[1] // => commentsJSON\n\n    return values;\n  });\n  ```\n\n  @class Promise\n  @param {function} resolver\n  Useful for tooling.\n  @constructor\n*/\nfunction Promise$1(resolver) {\n  this[PROMISE_ID] = nextId();\n  this._result = this._state = undefined;\n  this._subscribers = [];\n\n  if (noop !== resolver) {\n    typeof resolver !== 'function' && needsResolver();\n    this instanceof Promise$1 ? initializePromise(this, resolver) : needsNew();\n  }\n}\n\nPromise$1.all = all;\nPromise$1.race = race;\nPromise$1.resolve = resolve;\nPromise$1.reject = reject;\nPromise$1._setScheduler = setScheduler;\nPromise$1._setAsap = setAsap;\nPromise$1._asap = asap;\n\nPromise$1.prototype = {\n  constructor: Promise$1,\n\n/**\n  The primary way of interacting with a promise is through its `then` method,\n  which registers callbacks to receive either a promise's eventual value or the\n  reason why the promise cannot be fulfilled.\n\n  ```js\n  findUser().then(function(user){\n    // user is available\n  }, function(reason){\n    // user is unavailable, and you are given the reason why\n  });\n  ```\n\n  Chaining\n  --------\n\n  The return value of `then` is itself a promise.  This second, 'downstream'\n  promise is resolved with the return value of the first promise's fulfillment\n  or rejection handler, or rejected if the handler throws an exception.\n\n  ```js\n  findUser().then(function (user) {\n    return user.name;\n  }, function (reason) {\n    return 'default name';\n  }).then(function (userName) {\n    // If `findUser` fulfilled, `userName` will be the user's name, otherwise it\n    // will be `'default name'`\n  });\n\n  findUser().then(function (user) {\n    throw new Error('Found user, but still unhappy');\n  }, function (reason) {\n    throw new Error('`findUser` rejected and we're unhappy');\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.\n    // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.\n  });\n  ```\n  If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.\n\n  ```js\n  findUser().then(function (user) {\n    throw new PedagogicalException('Upstream error');\n  }).then(function (value) {\n    // never reached\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // The `PedgagocialException` is propagated all the way down to here\n  });\n  ```\n\n  Assimilation\n  ------------\n\n  Sometimes the value you want to propagate to a downstream promise can only be\n  retrieved asynchronously. This can be achieved by returning a promise in the\n  fulfillment or rejection handler. The downstream promise will then be pending\n  until the returned promise is settled. This is called *assimilation*.\n\n  ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // The user's comments are now available\n  });\n  ```\n\n  If the assimliated promise rejects, then the downstream promise will also reject.\n\n  ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // If `findCommentsByAuthor` fulfills, we'll have the value here\n  }, function (reason) {\n    // If `findCommentsByAuthor` rejects, we'll have the reason here\n  });\n  ```\n\n  Simple Example\n  --------------\n\n  Synchronous Example\n\n  ```javascript\n  var result;\n\n  try {\n    result = findResult();\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n\n  Errback Example\n\n  ```js\n  findResult(function(result, err){\n    if (err) {\n      // failure\n    } else {\n      // success\n    }\n  });\n  ```\n\n  Promise Example;\n\n  ```javascript\n  findResult().then(function(result){\n    // success\n  }, function(reason){\n    // failure\n  });\n  ```\n\n  Advanced Example\n  --------------\n\n  Synchronous Example\n\n  ```javascript\n  var author, books;\n\n  try {\n    author = findAuthor();\n    books  = findBooksByAuthor(author);\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n\n  Errback Example\n\n  ```js\n\n  function foundBooks(books) {\n\n  }\n\n  function failure(reason) {\n\n  }\n\n  findAuthor(function(author, err){\n    if (err) {\n      failure(err);\n      // failure\n    } else {\n      try {\n        findBoooksByAuthor(author, function(books, err) {\n          if (err) {\n            failure(err);\n          } else {\n            try {\n              foundBooks(books);\n            } catch(reason) {\n              failure(reason);\n            }\n          }\n        });\n      } catch(error) {\n        failure(err);\n      }\n      // success\n    }\n  });\n  ```\n\n  Promise Example;\n\n  ```javascript\n  findAuthor().\n    then(findBooksByAuthor).\n    then(function(books){\n      // found books\n  }).catch(function(reason){\n    // something went wrong\n  });\n  ```\n\n  @method then\n  @param {Function} onFulfilled\n  @param {Function} onRejected\n  Useful for tooling.\n  @return {Promise}\n*/\n  then: then,\n\n/**\n  `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same\n  as the catch block of a try/catch statement.\n\n  ```js\n  function findAuthor(){\n    throw new Error('couldn't find that author');\n  }\n\n  // synchronous\n  try {\n    findAuthor();\n  } catch(reason) {\n    // something went wrong\n  }\n\n  // async with promises\n  findAuthor().catch(function(reason){\n    // something went wrong\n  });\n  ```\n\n  @method catch\n  @param {Function} onRejection\n  Useful for tooling.\n  @return {Promise}\n*/\n  'catch': function(onRejection) {\n    return this.then(null, onRejection);\n  }\n};\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used for built-in method references. */\nvar objectProto$1 = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString$1 = objectProto$1.toString;\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString$1.call(value) == symbolTag);\n}\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\nvar nativeMin = Math.min;\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Polyfill-safe method for requesting an animation frame\n *\n * @method  requestAnimationFrame\n * @author  Fritz Lekschas\n * @date    2016-09-12\n * @param   {Function}  callback  Function to be called after a animation frame\n *   has been delivered.\n * @return  {Integer}             ID of the request.\n */\nvar requestAnimationFrame = function () {\n  var lastTime = 0;\n\n  return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function (callback) {\n    var currTime = new Date().getTime();\n    var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n    var id = window.setTimeout(function () {\n      callback(currTime + timeToCall);\n    }, timeToCall);\n    lastTime = currTime + timeToCall;\n    return id;\n  };\n}();\n\n/**\n * Polyfill-safe method for canceling a requested animation frame\n *\n * @method  cancelAnimationFrame\n * @author  Fritz Lekschas\n * @date    2016-09-12\n * @param   {Integer}  id  ID of the animation frame request to be canceled.\n */\nvar cancelAnimationFrame = function () {\n  return window.cancelAnimationFrame || window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame || window.oCancelAnimationFrame || window.msCancelAnimationFrame || window.cancelAnimationFrame || window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame || window.oCancelAnimationFrame || window.msCancelAnimationFrame || function (id) {\n    window.clearTimeout(id);\n  };\n}();\n\n/**\n * Requests the next animation frame.\n *\n * @method  nextAnimationFrame\n * @author  Fritz Lekschas\n * @date    2016-09-12\n * @return  {Object}  Object holding the _request_ and _cancel_ method for\n *   requesting the next animation frame.\n */\nvar nextAnimationFrame = function () {\n  var ids = {};\n\n  function requestId() {\n    var id = void 0;\n    do {\n      id = Math.floor(Math.random() * 1E9);\n    } while (id in ids);\n    return id;\n  }\n\n  return {\n    request: window.requestNextAnimationFrame || function (callback, element) {\n      var id = requestId();\n\n      ids[id] = requestAnimationFrame(function () {\n        ids[id] = requestAnimationFrame(function (ts) {\n          delete ids[id];\n          callback(ts);\n        }, element);\n      }, element);\n\n      return id;\n    },\n    cancel: window.cancelNextAnimationFrame || function (id) {\n      if (ids[id]) {\n        cancelAnimationFrame(ids[id]);\n        delete ids[id];\n      }\n    }\n  };\n}();\n\nvar requestNextAnimationFrame = nextAnimationFrame.request;\n\n// External\n// eslint-disable-line import/no-unresolved\n// Internal\n/**\n * Class name assigned to the context menu's root element\n *\n * @type  {String}\n */\nvar CLASS_NAME = 'context-menu';\n\n/**\n * Class name assigned to checkboxes.\n *\n * @type  {String}\n */\nvar CLASS_CHECKBOX = 'checkbox';\n\n/**\n * Size of the dialog arrow in pixel.\n *\n * @type  {Number}\n */\nvar ARROW_SIZE = 6;\n\n/**\n * General transition speed.\n *\n * @type  {Number}\n */\nvar TRANSITION_SPEED = 125;\n\n/**\n * Time in milliseconds before the query button click actially triggers its\n * action.\n *\n * The time is resetted every time the user clicks on the button again within\n * the time interval.\n *\n * @type  {Number}\n */\nvar BUTTON_QUERY_DEBOUNCE = 666;\n\n/**\n * Time in milliseconds before the root button click actially triggers its\n * action.\n *\n * The time is resetted every time the user clicks on the button again within\n * the time interval.\n *\n * @type  {Number}\n */\nvar BUTTON_ROOT_DEBOUNCE = 500;\n\n/**\n * Default time in milliseconds before a button click actially triggers its\n * action.\n *\n * The time is resetted every time the user clicks on the button again within\n * the time interval.\n *\n * @type  {Number}\n */\nvar BUTTON_DEFAULT_DEBOUNCE = 150;\n\n/**\n * [BUTTON_BAM_EFFECT_ANIMATION_TIME description]\n *\n * @type  {Number}\n */\nvar BUTTON_BAM_EFFECT_ANIMATION_TIME = 700;\n\nvar NodeContextMenu = function () {\n  /**\n   * Node context menu constructor\n   *\n   * @description\n   * The `init` object must contain the follow properties:\n   *  - visData: the List Graph App's data. [Object]\n   *  - baseEl: D3 selection of the base element. [Object]\n   *  - events: the List Graph App's event library. [Object]\n   *  - nodes: the List Graph App's nodes. [Object]\n   *  - infoFields: the List Graph App's info field definition. [Object]\n   *  - iconPath: the List Graph App's `iconPath`. [String]\n   *  - isQueryable: If `true` the query button will be shown. [Boolean]\n   *  - isDebounced: If `true` the menu will be debounced. [Boolean]\n   *\n   * @example\n   * ```\n   *  const nodeContextMenu = new NodeContextMenu({\n   *   visData: {...},\n   *   baseEl: {...},\n   *   events: {...},\n   *   nodes: {...},\n   *   infoFields: {...},\n   *   iconPath: '...',\n   *   isQueryable: true,\n   *   isDebounced: true\n   * });\n   * ```\n   *\n   * @method  constructor\n   * @author  Fritz Lekschas\n   * @date    2016-09-13\n   * @param   {Object}   init  Initialization object. See example.\n   */\n  function NodeContextMenu(init) {\n    classCallCheck(this, NodeContextMenu);\n\n    var self = this;\n\n    this._x = 0;\n    this._y = 0;\n    this._yOffset = 0;\n    this._scale = 0;\n\n    this.visData = init.visData;\n    this.baseEl = init.baseEl;\n    this.events = init.events;\n    this.nodes = init.nodes;\n    this.isQueryable = init.isQueryable;\n    this.infoFields = init.infoFields;\n    this.isDebounced = init.isDebounced;\n    this.iconPath = init.iconPath;\n\n    this.numButtonRows = 1;\n    this.numButtonRows = this.isQueryable ? ++this.numButtonRows : this.numButtonRows;\n    this.numButtonRows = this.infoFields && this.infoFields.length ? ++this.numButtonRows : this.numButtonRows;\n\n    this.height = this.visData.global.row.height * this.numButtonRows;\n    this.toBottom = false;\n\n    this.nodeInfoId = 0;\n\n    this.wrapper = this.baseEl.append('g').attr('class', CLASS_NAME);\n\n    this.updateAppearance();\n\n    this.bgWrapper = this.wrapper.append('g').classed('bgOuterWrapper', true).attr('transform', 'translate(' + this.visData.global.column.width / 2 + ' ' + this.height / 2 + ')').append('g').classed('bgInnerWrapper', true);\n\n    this.bgBorder = this.bgWrapper.append('path').attr('class', 'bgBorder').attr('d', dropMenu({\n      x: -1,\n      y: -1,\n      width: this.visData.global.column.width + 2,\n      height: this.height + 2,\n      radius: ARROW_SIZE - 2,\n      arrowSize: ARROW_SIZE\n    })).attr('transform', 'translate(' + -this.visData.global.column.width / 2 + ' ' + -this.height / 2 + ')');\n\n    this.bg = this.bgWrapper.append('path').attr('class', 'bg').attr('d', dropMenu({\n      x: 0,\n      y: 0,\n      width: this.visData.global.column.width,\n      height: this.height,\n      radius: ARROW_SIZE - 1,\n      arrowSize: ARROW_SIZE\n    })).style('filter', 'url(#drop-shadow-context-menu)').attr('transform', 'translate(' + -this.visData.global.column.width / 2 + ' ' + -this.height / 2 + ')');\n\n    if (this.infoFields && this.infoFields.length) {\n      this.textNodeInfo = this.wrapper.append('g').call(this.createTextField.bind(this), {\n        alignRight: false,\n        classNames: [],\n        distanceFromCenter: this.isQueryable ? 2 : 1,\n        fullWidth: true,\n        labels: this.infoFields\n      }, this.infoFields.length > 1);\n\n      if (this.infoFields.length > 1) {\n        var toggler = this.textNodeInfo.append('g').attr('class', 'toggler').on('click', function () {\n          self.clickNodeInfo.call(self, this);\n        });\n\n        var togglerX = this.visData.global.column.width - this.visData.global.row.contentHeight - this.visData.global.row.padding + this.visData.global.cell.padding;\n\n        var togglerY = this.visData.global.row.padding + this.visData.global.cell.padding;\n\n        toggler.append('rect').attr('class', 'bg').attr('x', togglerX).attr('y', togglerY).attr('width', this.visData.global.row.contentHeight).attr('height', this.visData.global.row.contentHeight);\n\n        toggler.append('use').attr('x', togglerX + (this.visData.global.row.contentHeight - 10) / 2).attr('y', togglerY + (this.visData.global.row.contentHeight - 10) / 2).attr('width', 10).attr('height', 10).attr('xlink:href', this.iconPath + '#arrow-right');\n      }\n    }\n\n    if (this.isQueryable) {\n      this.buttonQuery = this.wrapper.append('g').call(this.createButton.bind(this), {\n        alignRight: false,\n        classNames: [],\n        distanceFromCenter: 1,\n        fullWidth: true,\n        label: 'Query',\n        labelTwo: true,\n        bamEffect: true\n      }).on('click', function () {\n        self.clickQueryHandler.call(self, this);\n      });\n      this.buttonQueryFill = this.buttonQuery.select('.bg-fill-effect');\n      this.buttonQueryBamEffect = this.buttonQuery.select('.bg-bam-effect');\n    }\n\n    this.buttonRoot = this.wrapper.append('g').call(this.createButton.bind(this), {\n      alignRight: false,\n      classNames: [],\n      distanceFromCenter: 0,\n      fullWidth: false,\n      label: 'Root'\n    }).on('click', function () {\n      self.clickRootHandler.call(self, this);\n    });\n    this.buttonRootFill = this.buttonRoot.select('.bg-fill-effect');\n    this.checkboxRoot = this.createCheckbox(this.buttonRoot);\n\n    this.buttonLock = this.wrapper.append('g').call(this.createButton.bind(this), {\n      alignRight: true,\n      classNames: [],\n      distanceFromCenter: 0,\n      fullWidth: false,\n      label: 'Lock',\n      bamEffect: true\n    }).on('click', function () {\n      self.clickLockHandler.call(self, this);\n    });\n    this.buttonLockFill = this.buttonLock.select('.bg-fill-effect');\n    this.buttonLockBamEffect = this.buttonLock.select('.bg-bam-effect');\n    this.checkboxLock = this.createCheckbox(this.buttonLock);\n\n    this.components = this.wrapper.selectAll('.component');\n\n    this.debouncedQueryHandler = debounce(this.queryHandler, BUTTON_QUERY_DEBOUNCE);\n    this.debouncedRootHandler = debounce(this.rootHandler, BUTTON_ROOT_DEBOUNCE);\n  }\n\n  /* ---------------------------------------------------------------------------\n   * Getter / Setter\n   * ------------------------------------------------------------------------ */\n\n  /**\n   * Generates CSS string for scaling.\n   *\n   * @method  scale\n   * @author  Fritz Lekschas\n   * @date    2016-09-13\n   * @return  {String}  CSS formatted string containing the scale.\n   */\n\n\n  createClass(NodeContextMenu, [{\n    key: 'addLabel',\n\n\n    /* ---------------------------------------------------------------------------\n     * Methods\n     * ------------------------------------------------------------------------ */\n\n    /* ---------------------------------- A ----------------------------------- */\n\n    /**\n     * Adds a XHTML-based text elements for labelling.\n     *\n     * @method  addLabel\n     * @author  Fritz Lekschas\n     * @date    2016-09-15\n     * @param   {Object}   selection   D3 selection where the label should be\n     *   added to.\n     * @param   {Boolean}  fullWidth   If `true` the label is drawn over the full\n     *   width.\n     * @param   {String}   label       First label text.\n     * @param   {String}   labelTwo    Second label text.\n     * @param   {Boolean}  isToggable  If `true` substracts the toggler width.\n     *   This is only needed because the because Firefox's layering system seems\n     *   to be buggy when it comes to `foreignObject`s. For whatever reason the\n     *   `foreignObject` is drawn on top of the following `g` even though in SVG\n     *   it should be the other way around.\n     */\n    value: function addLabel(selection, fullWidth, label, labelTwo, isToggable) {\n      var width = this.visData.global.column.width * (fullWidth ? 1 : 0.5) - this.visData.global.row.padding * 4 - (isToggable ? this.visData.global.row.contentHeight : 0);\n\n      var height = this.visData.global.row.contentHeight - this.visData.global.cell.padding * 2;\n\n      var div = selection.append('foreignObject').attr('x', this.visData.global.row.padding * 2).attr('y', this.visData.global.row.padding + this.visData.global.cell.padding).attr('width', width).attr('height', height).attr('class', 'label-wrapper').append('xhtml:div').style('line-height', height - 2 + 'px').style('width', width + 'px');\n\n      div.append('xhtml:span').attr('class', 'label').text(label);\n\n      if (labelTwo) {\n        div.append('xhtml:span').attr('class', 'separator').text(':');\n        div.append('xhtml:span').attr('class', 'label-two');\n      }\n    }\n\n    /* ---------------------------------- C ----------------------------------- */\n\n    /**\n     * Check the state of the lock button and alter its appearance accordingly.\n     *\n     * @method  checkLock\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @return  {Boolean}  If `true` the lock button is active.\n     */\n\n  }, {\n    key: 'checkLock',\n    value: function checkLock() {\n      var checked = this.node.datum().data.state.lock;\n      this.buttonLock.classed('semi-active', checked);\n      this.checkboxLock.style('transform', 'translateX(' + (checked ? this.checkBoxMovement : 0) + 'px)');\n      if (checked) {\n        this.fillButton(this.buttonLockFill);\n      } else {\n        this.emptyButton(this.buttonLockFill);\n      }\n      return checked;\n    }\n\n    /**\n     * Check how the menu needs to be oriented, i.e., above or below the node.\n     *\n     * @method  checkOrientation\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     */\n\n  }, {\n    key: 'checkOrientation',\n    value: function checkOrientation() {\n      if (this._y + this._yOffset >= 0) {\n        this.toBottom = false;\n      } else {\n        this.toBottom = true;\n      }\n      this.components.call(this.positionComponent.bind(this));\n      this.bgWrapper.classed('is-mirrored-horizontally', this.toBottom);\n\n      var translate = 'translate(' + -this.visData.global.column.width / 2 + ' ' + -(this.height / 2 + (this.toBottom ? ARROW_SIZE : 0)) + ')';\n\n      this.bg.attr('transform', translate).style('filter', 'url(#drop-shadow-context-menu' + (this.toBottom ? '-inverted' : '') + ')');\n\n      this.bgBorder.attr('transform', translate);\n    }\n\n    /**\n     * Check state of the root button and alter appearance accordingly.\n     *\n     * @method  checkRoot\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Boolean}  debounced  If `true` the root button will be debounced\n     *   by `time`.\n     * @param   {Number}   time       Debounce time in milliseconds.\n     */\n\n  }, {\n    key: 'checkRoot',\n    value: function checkRoot(debounced, time) {\n      var state = this.node.datum().data.state.root;\n      var checked = state;\n\n      if (debounced) {\n        if (typeof this.currentRootState === 'undefined') {\n          this.currentRootState = !!state;\n        }\n        if (typeof this.tempRoot === 'undefined') {\n          this.tempRoot = this.currentRootState;\n        }\n        this.tempRoot = !this.tempRoot;\n        checked = this.tempRoot;\n      }\n\n      if (!state) {\n        if (debounced) {\n          if (checked) {\n            this.fillButton(this.buttonRootFill, time);\n          } else {\n            this.hideElement(this.buttonRootFill);\n          }\n        } else {\n          this.emptyButton(this.buttonRootFill, time);\n        }\n      } else {\n        if (debounced) {\n          if (!checked) {\n            this.emptyButton(this.buttonRootFill, time);\n          } else {\n            this.showElement(this.buttonRootFill);\n          }\n        } else {\n          this.fillButton(this.buttonRootFill, time);\n        }\n      }\n\n      this.buttonRoot.classed('semi-active', checked);\n      this.checkboxRoot.style('transform', 'translateX(' + (checked ? this.checkBoxMovement : 0) + 'px)');\n    }\n\n    /**\n     * Click handler of the lock button.\n     *\n     * @method  clickLockHandler\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     */\n\n  }, {\n    key: 'clickLockHandler',\n    value: function clickLockHandler() {\n      var _this = this;\n\n      this.buttonLock.classed('fill-effect', true);\n      this.nodes.lockHandler(this.node);\n      var checked = this.checkLock();\n      if (checked) {\n        this.buttonLock.classed('active', true);\n      } else {\n        this.buttonLock.classed('active', false);\n      }\n      setTimeout(function () {\n        if (checked) {\n          _this.triggerButtonBamEffect(_this.buttonLockBamEffect);\n        }\n        _this.buttonLock.classed('fill-effect', false);\n      }, BUTTON_DEFAULT_DEBOUNCE);\n    }\n\n    /**\n     * Click handler of the info button.\n     *\n     * @method  clickNodeInfo\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     */\n\n  }, {\n    key: 'clickNodeInfo',\n    value: function clickNodeInfo() {\n      this.nodeInfoId = (this.nodeInfoId + 1) % this.infoFields.length;\n\n      this.textNodeInfo.select('.label').text(this.infoFields[this.nodeInfoId].label);\n\n      this.textNodeInfo.select('.label-two').text(this.getNodeProperty(this.infoFields[this.nodeInfoId].property));\n    }\n\n    /**\n     * Click handler of the query button.\n     *\n     * @method  clickQueryHandler\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     */\n\n  }, {\n    key: 'clickQueryHandler',\n    value: function clickQueryHandler() {\n      this.buttonQuery.classed('fill-effect', true);\n      this.updateQuery(true, BUTTON_QUERY_DEBOUNCE);\n      if (this.isDebounced) {\n        this.debouncedQueryHandler(true);\n      } else {\n        this.queryHandler();\n      }\n    }\n\n    /**\n     * Click handler of the root button.\n     *\n     * @method  clickRootHandler\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     */\n\n  }, {\n    key: 'clickRootHandler',\n    value: function clickRootHandler() {\n      this.buttonRoot.classed('fill-effect', true);\n      this.checkRoot(true, BUTTON_ROOT_DEBOUNCE);\n      if (this.isDebounced) {\n        this.debouncedRootHandler(true);\n      } else {\n        this.rootHandler();\n      }\n    }\n\n    /**\n     * Closes the menu.\n     *\n     * @method  close\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @return  {Object}  Promise resolving to `true` when the menu is closed.\n     */\n\n  }, {\n    key: 'close',\n    value: function close() {\n      var _this2 = this;\n\n      if (!this.closing) {\n        this.closing = new Promise$1(function (resolve) {\n          _this2.opened = false;\n          _this2.updateAppearance();\n\n          setTimeout(function () {\n            _this2.visible = false;\n            _this2.updateAppearance();\n            resolve(_this2.node.datum().id);\n            _this2.node = undefined;\n          }, TRANSITION_SPEED);\n        });\n      }\n      return this.closing;\n    }\n\n    /**\n     * Helper method to create and append a button.\n     *\n     * @description\n     * The `properties` variable needs to contain the following properties:\n     *  - fullWidth: If `true` draws the button over the full width. [Boolean]\n     *  - label: The first label. Considered the main label if `labelTwo` is\n     *    `undefined`. [String]\n     *  - labelTwo: Second label. Considered the main label when given.\n     *\n     * @method  createButton\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Object}  selection   D3 selection where the button should be\n     *   appended to.\n     * @param   {Object}  properties  The button's properties.\n     */\n\n  }, {\n    key: 'createButton',\n    value: function createButton(selection, properties) {\n      var classNames = 'component button';\n      if (properties.classNames && properties.classNames.length) {\n        classNames += ' ' + properties.classNames.join(' ');\n      }\n      selection.attr('class', classNames);\n\n      selection.datum(properties).call(this.createButtonBg.bind(this), {\n        bamEffect: properties.bamEffect,\n        fullWidth: properties.fullWidth\n      }).call(this.addLabel.bind(this), properties.fullWidth, properties.label, properties.labelTwo).call(this.positionComponent.bind(this), properties.distanceFromCenter, properties.alignRight);\n    }\n\n    /**\n     * Helper method to create and append a button background.\n     *\n     * @description\n     * The `properties` variable needs to contain the following properties:\n     *  - fullWidth: If `true` draws the button over the full width. [Boolean]\n     *  - bamEffect: If `true` adds an extra element for the click-bam-effect.\n     *\n     * @method  createButtonBg\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Object}  selection   D3 selection where the background element\n     *   should be appended to.\n     * @param   {Object}  properties  The background element's properties.\n     */\n\n  }, {\n    key: 'createButtonBg',\n    value: function createButtonBg(selection, properties) {\n      var _this3 = this;\n\n      selection.datum(function (data) {\n        data.x = _this3.visData.global.row.padding;\n        data.y = _this3.visData.global.row.padding;\n        data.width = _this3.visData.global.column.width * (properties.fullWidth ? 1 : 0.5) - _this3.visData.global.row.padding * 2;\n        data.height = _this3.visData.global.row.contentHeight;\n        data.rx = 2;\n        data.ry = 2;\n\n        return data;\n      }).append('rect').attr('class', 'bg').attr('x', function (data) {\n        return data.x;\n      }).attr('y', function (data) {\n        return data.y;\n      }).attr('width', function (data) {\n        return data.width;\n      }).attr('height', function (data) {\n        return data.height;\n      }).attr('rx', function (data) {\n        return data.rx;\n      }).attr('ry', function (data) {\n        return data.ry;\n      });\n\n      selection.append('rect').attr('class', 'bg-fill-effect').attr('x', function (data) {\n        return data.x;\n      }).attr('y', function (data) {\n        return data.y;\n      }).attr('width', function (data) {\n        return data.width;\n      }).attr('height', 0).attr('rx', function (data) {\n        return data.rx;\n      }).attr('ry', function (data) {\n        return data.ry;\n      });\n\n      if (properties.bamEffect) {\n        selection.append('g').attr('transform', function (data) {\n          return 'translate(' + data.width / 2 + ' ' + data.height / 2 + ')';\n        }).append('g').attr('class', 'bam-effect').append('rect').attr('class', 'bam-effect-bg').attr('x', function (data) {\n          return data.x;\n        }).attr('y', function (data) {\n          return data.y;\n        }).attr('width', function (data) {\n          return data.width;\n        }).attr('height', function (data) {\n          return data.height;\n        }).attr('rx', function (data) {\n          return data.rx;\n        }).attr('ry', function (data) {\n          return data.ry;\n        }).attr('transform', function (data) {\n          return 'translate(' + -data.width / 2 + ' ' + -data.height / 2 + ')';\n        });\n      }\n    }\n\n    /**\n     * Helper method to create and append a checkbox-like button.\n     *\n     * @method  createCheckbox\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Object}  selection  D3 selection where the checkbox element\n     *   should be appended to.\n     */\n\n  }, {\n    key: 'createCheckbox',\n    value: function createCheckbox(selection) {\n      var height = Math.round(selection.datum().height / 2);\n      var x = -1.75 * height + this.visData.global.row.padding;\n\n      var container = selection.append('g').attr('class', CLASS_CHECKBOX);\n\n      container.append('rect').attr('class', 'checkbox-bg').attr('x', function (data) {\n        return data.width + x;\n      }).attr('y', height / 2 + this.visData.global.row.padding).attr('width', height * 1.5).attr('height', height).attr('rx', height / 2).attr('ry', height / 2);\n\n      this.checkBoxMovement = (height - 2) / 2;\n\n      return container.append('rect').attr('class', 'checkbox-knob').attr('x', function (data) {\n        return data.width + x + 1;\n      }).attr('y', height / 2 + this.visData.global.row.padding + 1).attr('width', height - 2).attr('height', height - 2).attr('rx', height - 2);\n    }\n\n    /**\n     * Helper method to create and append a text field.\n     *\n     * @method  createTextField\n     * @author  Fritz Lekschas\n     * @date    2016-09-15\n     * @param   {Object}  selection   D3 selection where the text field should be\n     *   appended to.\n     * @param   {Object}  properties  The text field's properties.\n     * @param   {Boolean}  isToggable  If `true` substracts the toggler width.\n     *   This is only needed because the because Firefox's layering system seems\n     *   to be buggy when it comes to `foreignObject`s. For whatever reason the\n     *   `foreignObject` is drawn on top of the following `g` even though in SVG\n     *   it should be the other way around.\n     */\n\n  }, {\n    key: 'createTextField',\n    value: function createTextField(selection, properties, isToggable) {\n      var classNames = 'component text-field';\n      if (properties.classNames && properties.classNames.length) {\n        classNames += ' ' + properties.classNames.join(' ');\n      }\n      selection.attr('class', classNames);\n\n      selection.datum(properties).call(this.addLabel.bind(this), true, properties.labels[this.nodeInfoId].label, true, isToggable).call(this.positionComponent.bind(this), properties.distanceFromCenter, properties.alignRight);\n    }\n\n    /* ---------------------------------- E ----------------------------------- */\n\n    /**\n     * Transitions out an element top down.\n     *\n     * @method  emptyButton\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Object}  selection   D3 selection of the element to be\n     *   transitioned.\n     * @param   {Number}  time       Transition time in milliseconds.\n     */\n\n  }, {\n    key: 'emptyButton',\n    value: function emptyButton(selection, time) {\n      selection.transition().duration(0).attr('y', function (data) {\n        return data.y;\n      }).attr('height', function (data) {\n        return data.height;\n      }).call(allTransitionsEnded, function () {\n        selection.transition().duration(time || BUTTON_DEFAULT_DEBOUNCE).ease(d3.easeLinear).attr('y', function (data) {\n          return data.height;\n        }).attr('height', 0);\n      });\n    }\n\n    /* ---------------------------------- F ----------------------------------- */\n\n    /**\n     * Transitions in an element top down.\n     *\n     * @method  fillButton\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Object}  selection   D3 selection of the element to be\n     *   transitioned.\n     * @param   {Number}  time       Transition time in milliseconds.\n     */\n\n  }, {\n    key: 'fillButton',\n    value: function fillButton(selection, time) {\n      selection.transition().duration(0).attr('y', function (data) {\n        return data.y;\n      }).attr('height', 0).call(allTransitionsEnded, function () {\n        selection.transition().duration(time || BUTTON_DEFAULT_DEBOUNCE).ease(d3.easeLinear).attr('height', function (data) {\n          return data.height;\n        });\n      });\n    }\n\n    /* ---------------------------------- G ----------------------------------- */\n\n    /**\n     * Helper method to access a node property.\n     *\n     * @method  getNodeProperty\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Function}  callback  Callback returning a property of the node.\n     * @return  {*}                   The value returned by the callback.\n     */\n\n  }, {\n    key: 'getNodeProperty',\n    value: function getNodeProperty(callback) {\n      try {\n        return callback(this.node.datum());\n      } catch (e) {\n        return undefined;\n      }\n    }\n\n    /* ---------------------------------- H ----------------------------------- */\n\n    /**\n     * Hide an element by setting the height to zero.\n     *\n     * @method  hideElement\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Object}  selection  D3 selection of element to be hidden.\n     */\n\n  }, {\n    key: 'hideElement',\n    value: function hideElement(selection) {\n      selection.transition().duration(0).attr('height', 0);\n    }\n\n    /* ---------------------------------- I ----------------------------------- */\n\n    /**\n     * Check if menu is opened in the same column already.\n     *\n     * @method  isOpenSameColumn\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Number}   columnNum  Column number.\n     * @return  {Boolean}             If `true` menu is opened and in the same\n     *   column.\n     */\n\n  }, {\n    key: 'isOpenSameColumn',\n    value: function isOpenSameColumn(columnNum) {\n      return this.opened && this.node.datum().depth === columnNum;\n    }\n\n    /* ---------------------------------- O ----------------------------------- */\n\n    /**\n     * Opens the menu.\n     *\n     * @method  open\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Object}  node  D3 selection of the node the menu relates to.\n     */\n\n  }, {\n    key: 'open',\n    value: function open(node) {\n      var _this4 = this;\n\n      return new Promise$1(function (resolve) {\n        _this4.node = node;\n        _this4.closing = undefined;\n\n        _this4.updateStates();\n\n        _this4._yOffset = _this4.visData.nodes[_this4.node.datum().depth].scrollTop;\n        _this4.translate = {\n          x: _this4.node.datum().x,\n          y: _this4.node.datum().y - _this4.height\n        };\n        _this4.checkOrientation();\n\n        _this4.updateAppearance();\n        _this4.opened = true;\n        _this4.visible = true;\n\n        requestNextAnimationFrame(function () {\n          _this4.updateAppearance();\n          setTimeout(function () {\n            resolve(true);\n          }, TRANSITION_SPEED);\n        });\n      });\n    }\n\n    /* ---------------------------------- P ----------------------------------- */\n\n    /**\n     * Positions component.\n     *\n     * @method  positionComponent\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Object}   selection           D3 selection of the element to be\n     *   positioned.\n     * @param   {Boolean}  distanceFromCenter  If `true` positions component from\n     *   the center.\n     * @param   {Boolean}  alignRight          If `true` aligns component to the\n     *   right.\n     * @return  {String}                       CSS-formatted translation string.\n     */\n\n  }, {\n    key: 'positionComponent',\n    value: function positionComponent(selection, distanceFromCenter, alignRight) {\n      var _this5 = this;\n\n      selection.datum(function (data) {\n        // Lets cache some values to make our lives easier when checking the\n        // position again in `checkOrientation`.\n        if (distanceFromCenter) {\n          data.distanceFromCenter = distanceFromCenter;\n        }\n        if (alignRight) {\n          data.alignRight = alignRight;\n        }\n        return data;\n      }).attr('transform', function (data) {\n        var x = data.alignRight ? _this5.visData.global.column.width / 2 : 0;\n        // When the buttons are created I assume self the menu is positioned\n        // above the node; i.e. `distanceFromCenter` needs to be inverted.\n        var y = _this5.visData.global.row.height * (_this5.toBottom ? data.distanceFromCenter : _this5.numButtonRows - data.distanceFromCenter - 1) + (_this5.toBottom ? ARROW_SIZE : 0);\n\n        return 'translate(' + x + ', ' + y + ')';\n      });\n    }\n\n    /* ---------------------------------- Q ----------------------------------- */\n\n    /**\n     * Handle the four different query states: none, or, and, and not.\n     *\n     * @method  queryHandler\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Boolean}  debounced  If `true` the handler will debounce.\n     */\n\n  }, {\n    key: 'queryHandler',\n    value: function queryHandler(debounced) {\n      if (debounced) {\n        if (this.tempQueryMode !== this.currentQueryMode) {\n          if (this.tempQueryMode) {\n            this.nodes.queryHandler(this.node, 'query', this.tempQueryMode);\n            this.triggerButtonBamEffect(this.buttonQueryBamEffect);\n            this.buttonQuery.classed('active', true);\n          } else {\n            this.nodes.queryHandler(this.node, 'unquery');\n            this.buttonQuery.classed('active', false);\n          }\n        }\n      } else {\n        this.nodes.queryHandler(this.node);\n      }\n\n      // Reset temporary query modes.\n      this.tempQueryMode = undefined;\n      this.currentQueryMode = undefined;\n      this.buttonQuery.classed('fill-effect', false);\n    }\n\n    /* ---------------------------------- R ----------------------------------- */\n\n    /**\n     * Handle re-rooting of the graph.\n     *\n     * @method  rootHandler\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Boolean}  debounced  If `true` the handler will debounce.\n     */\n\n  }, {\n    key: 'rootHandler',\n    value: function rootHandler(debounced) {\n      if (!debounced || this.tempRoot !== this.currentRootState) {\n        this.close();\n        this.nodes.rootHandler(this.node);\n      }\n\n      // Reset temporary root values.\n      this.tempRoot = undefined;\n      this.currentRootState = undefined;\n      this.buttonRoot.classed('fill-effect', false);\n\n      this.buttonRoot.classed('active', this.node.datum().data.state.root);\n    }\n\n    /* ---------------------------------- S ----------------------------------- */\n\n    /**\n     * Scrolls the menu vertically.\n     *\n     * @method  scrollY\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Number}  offset  Scroll related offset.\n     */\n\n  }, {\n    key: 'scrollY',\n    value: function scrollY(offset) {\n      this._yOffset = offset;\n      this.updateAppearance();\n    }\n\n    /**\n     * Transition element in by resetting its original height.\n     *\n     * @method  showElement\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Object}  selection  D3 selection to be transitioned in.\n     */\n\n  }, {\n    key: 'showElement',\n    value: function showElement(selection) {\n      selection.transition().duration(0).attr('y', function (data) {\n        return data.y;\n      }).attr('height', function (data) {\n        return data.height;\n      });\n    }\n\n    /* ---------------------------------- T ----------------------------------- */\n\n    /**\n     * Toggle menu visibility\n     *\n     * @method  toggle\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Object}  node  D3 selection of the related node.\n     */\n\n  }, {\n    key: 'toggle',\n    value: function toggle(node) {\n      var _this6 = this;\n\n      return new Promise$1(function (resolve) {\n        var nodeId = node.datum().id;\n        var closed = Promise$1.resolve();\n\n        if (_this6.visible) {\n          closed = _this6.close();\n        }\n\n        closed.then(function (previousNodeId) {\n          if (nodeId !== previousNodeId) {\n            _this6.open(node).then(function () {\n              resolve(nodeId);\n            });\n          } else {\n            resolve(nodeId);\n          }\n        });\n      });\n    }\n\n    /**\n     * Call button BAM effect.\n     *\n     * @method  triggerButtonBamEffect\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Object}  node  D3 selection of the button to be BAM-effected.\n     */\n\n  }, {\n    key: 'triggerButtonBamEffect',\n    value: function triggerButtonBamEffect(button) {\n      button.classed('active', true);\n      setTimeout(function () {\n        button.classed('active', false);\n      }, BUTTON_BAM_EFFECT_ANIMATION_TIME);\n    }\n\n    /* ---------------------------------- U ----------------------------------- */\n\n    /**\n     * Update appearance of the menu.\n     *\n     * @method  updateAppearance\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     */\n\n  }, {\n    key: 'updateAppearance',\n    value: function updateAppearance() {\n      var centerY = this.toBottom ? 0 : this.height + this.visData.global.row.height;\n\n      this.wrapper.classed('transitionable', this.visible).classed('open', this.opened).style('transform', this.translate + ' ' + this.scale).style('transform-origin', this.visData.global.column.width / 2 + 'px ' + centerY + 'px');\n    }\n\n    /**\n     * Toggle through the info text fields.\n     *\n     * @method  updateInfoText\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     */\n\n  }, {\n    key: 'updateInfoText',\n    value: function updateInfoText() {\n      if (!this.infoFields || !this.infoFields.length) {\n        return;\n      }\n\n      this.textNodeInfo.select('.label').text(this.infoFields[this.nodeInfoId].label);\n\n      this.textNodeInfo.select('.label-two').text(this.getNodeProperty(this.infoFields[this.nodeInfoId].property));\n    }\n\n    /**\n     * Open menu on another node.\n     *\n     * @description\n     * Updates the position of the menu and its content.\n     *\n     * @method  updatePosition\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     */\n\n  }, {\n    key: 'updatePosition',\n    value: function updatePosition() {\n      if (this.node && this.opened) {\n        this.open(this.node);\n      }\n    }\n\n    /**\n     * Update querying when toggling through different query options.\n     *\n     * @method  updateQuery\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Boolean}  debounced  If `true` debounces querying.\n     * @param   {Number}   time       Debounce time in milliseconds.\n     */\n\n  }, {\n    key: 'updateQuery',\n    value: function updateQuery(debounced, time) {\n      if (!this.isQueryable) {\n        return;\n      }\n\n      var state = this.node.datum().data.state.query;\n      var queryMode = state;\n\n      function nextQueryMode(mode) {\n        switch (mode) {\n          case 'or':\n            return 'and';\n          case 'and':\n            return 'not';\n          case 'not':\n            return null;\n          default:\n            return 'or';\n        }\n      }\n\n      if (debounced) {\n        if (typeof this.currentQueryMode === 'undefined') {\n          this.currentQueryMode = state;\n        }\n        if (typeof this.tempQueryMode === 'undefined') {\n          this.tempQueryMode = this.currentQueryMode;\n        }\n        this.tempQueryMode = nextQueryMode(this.tempQueryMode);\n        queryMode = this.tempQueryMode;\n      }\n\n      if (debounced) {\n        if (queryMode) {\n          if (queryMode === state) {\n            this.showElement(this.buttonQueryFill);\n          } else {\n            this.fillButton(this.buttonQueryFill, time);\n          }\n        } else {\n          if (state) {\n            this.emptyButton(this.buttonQueryFill, time);\n          } else {\n            this.hideElement(this.buttonQueryFill);\n          }\n        }\n      } else {\n        this.emptyButton(this.buttonQueryFill, time);\n      }\n\n      this.buttonQuery.classed('semi-active', !!queryMode).classed('active', !!state).select('.label-two').text(queryMode || 'not queried').classed('inactive', !queryMode);\n    }\n\n    /**\n     * Helper method to trigger a check of all buttons and text fields.\n     *\n     * @method  updateStates\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     */\n\n  }, {\n    key: 'updateStates',\n    value: function updateStates() {\n      if (this.node) {\n        this.checkLock();\n        this.checkRoot();\n        this.updateQuery();\n        this.updateInfoText();\n      }\n    }\n  }, {\n    key: 'scale',\n    get: function get() {\n      return 'scale(' + (this.opened ? 1 : 0.5) + ')';\n    }\n\n    /**\n     * Generates a CSS string for translation\n     *\n     * @method  translate\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @return  {String}  CSS formatted string containing the translate.\n     */\n\n  }, {\n    key: 'translate',\n    get: function get() {\n      var y = this.toBottom ? this._y + this.height + this.visData.global.row.height - ARROW_SIZE : this._y;\n\n      return 'translate(' + this._x + 'px,' + (y + this._yOffset) + 'px)';\n    }\n\n    /**\n     * Set x and y values.\n     *\n     * @method  translate\n     * @author  Fritz Lekschas\n     * @date    2016-09-13\n     * @param   {Object}  position  Object containing x and y coordinates.\n     */\n    ,\n    set: function set(position) {\n      this._x = position.x;\n      this._y = position.y;\n    }\n  }]);\n  return NodeContextMenu;\n}();\n\n/* eslint no-shadow: 0 */\n\n// External\n// Internal\nvar LimitsUnsupportedFormat = function (_ExtendableError) {\n  inherits(LimitsUnsupportedFormat, _ExtendableError);\n\n  function LimitsUnsupportedFormat(message) {\n    classCallCheck(this, LimitsUnsupportedFormat);\n    return possibleConstructorReturn(this, (LimitsUnsupportedFormat.__proto__ || Object.getPrototypeOf(LimitsUnsupportedFormat)).call(this, message || 'The limits are wrongly formatted. Please provide an ' + 'object of the following format: `{ x: { min: 0, max: 1 }, y: { min: ' + '0, max: 1 } }`'));\n  }\n\n  return LimitsUnsupportedFormat;\n}(ExtendableError);\n\n/**\n * Drap and drop event handler that works via translation.\n *\n * @method  onDragDrop\n * @author  Fritz Lekschas\n * @date    2016-09-12\n * @param   {Object}  selection        D3 selection to listen for the drag\n *   event.\n * @param   {Object}           dragMoveHandler         Handler for drag-move.\n * @param   {Object}           dropHandler             Handler for drag-end,\n *   i.e. drop.\n * @param   {Array}            elsToBeDragged          Array of D3 selections to\n *   be moved according to the drag event. If empty or undefined `selection`\n *   will be used.\n * @param   {String}           orientation             Can either be\n *   \"horizontal\", \"vertical\" or `undefined`, i.e. both directions.\n * @param   {Object|Function}  limits                  X and Y drag limits. E.g.\n *   `{ x: { min: 0, max: 10 } }`.\n * @param   {Array}             noDraggingWhenTrue     List if function\n *   returning a Boolean value which should prevent the dragMoveHandler from\n *   working.\n * @param   {String}           clickTolerance          Specify the number of\n *   pixel that are allowed to move but still trigger a click event. Sometimes\n *   it is useful to allow the user to move 1 or 2 pixel, especially in high\n *   res environments. [Default is 0]\n */\nfunction onDragDrop(selection, dragStartHandler, dragMoveHandler, dropHandler, elsToBeDragged, orientation, limits, noDraggingWhenTrue, dragData, clickTolerance) {\n  var drag = d3.drag();\n  var checkWhenDragging = isFunction(noDraggingWhenTrue);\n\n  var appliedLimits = limits || {}; // eslint-disable-line no-param-reassign\n\n  var filter = function filter() {\n    return !(checkWhenDragging && noDraggingWhenTrue());\n  };\n\n  drag.filter(filter);\n\n  var d2 = void 0;\n\n  drag.on('start', function () {\n    d2 = 0;\n    if (typeof limits === 'function') {\n      appliedLimits = limits();\n    }\n  });\n\n  if (dragMoveHandler) {\n    drag.on('drag', function (data) {\n      if (checkWhenDragging && noDraggingWhenTrue()) {\n        return;\n      }\n      d3.event.sourceEvent.preventDefault();\n      dragStartHandler();\n      dragMoveHandler.call(this, data, elsToBeDragged, orientation, appliedLimits);\n\n      d2 += d3.event.dx * d3.event.dx + d3.event.dy * d3.event.dy;\n    });\n  }\n\n  if (dropHandler) {\n    drag.on('end', function () {\n      dropHandler.call(this);\n\n      if (d2 <= (clickTolerance || 0)) {\n        // Don't supress the click event for minor mouse movements.\n        d3.select(window).on('click.drag', null);\n      }\n    });\n  }\n\n  selection.each(function (data) {\n    var el = d3.select(this);\n\n    // Set default data if not available.\n    if (!data) {\n      data = { drag: dragData }; // eslint-disable-line no-param-reassign\n      el.datum(data);\n    }\n\n    // Add drag event handler\n    el.call(drag);\n  });\n}\n\n/**\n * Custom drag-move handler used by the custom drag-drop handler.\n *\n * @method  dragMoveHandler\n * @author  Fritz Lekschas\n * @date    2016-09-12\n * @param   {Object}           data            D3's drag event object.\n * @param   {Array}            elsToBeDragged  Array of D3 selections.\n * @param   {String}           orientation     Can either be \"horizontal\",\n *   \"vertical\" or `undefined`, i.e. both directions.\n * @param   {Object|Function}  limits          X and Y drag limits. E.g.\n *   `{ x: { min: 0, max: 10 } }`.\n */\nfunction dragMoveHandler(data, elsToBeDragged, orientation, limits) {\n  var els = d3.select(this);\n\n  if (elsToBeDragged && elsToBeDragged.length) {\n    els = mergeSelections(elsToBeDragged);\n  }\n\n  function withinLimits(value, applyingLimits) {\n    var restrictedValue = void 0;\n\n    if (applyingLimits) {\n      try {\n        restrictedValue = Math.min(applyingLimits.max, Math.max(applyingLimits.min, value));\n      } catch (e) {\n        throw new LimitsUnsupportedFormat();\n      }\n    }\n    return restrictedValue;\n  }\n\n  if (orientation === 'horizontal' || orientation === 'vertical') {\n    if (orientation === 'horizontal') {\n      data.drag.x += d3.event.dx;\n      data.drag.x = withinLimits(data.drag.x + d3.event.dx, limits.x);\n      els.style('transform', 'translateX(' + data.drag.x + 'px)');\n    }\n    if (orientation === 'vertical') {\n      data.drag.y += d3.event.dy;\n      data.drag.x = withinLimits(data.drag.y + d3.event.dy, limits.y);\n      els.style('transform', 'translateY(' + data.drag.y + 'px)');\n    }\n  } else {\n    data.drag.x += d3.event.dx;\n    data.drag.y += d3.event.dy;\n    els.style('transform', 'translate(' + data.drag.x + 'px,' + data.drag.y + 'px)');\n  }\n}\n\n/**\n * Creates SVG filter element for simulating drop shadow.\n *\n * @description\n * Adapted from: http://bl.ocks.org/cpbotha/5200394\n *\n * @method  dropShadow\n * @author  Fritz Lekschas\n * @date    2016-09-12\n * @param   {Object}  el       D3 selection.\n * @param   {String}  name     Filter name.\n * @param   {Number}  dx       Shadow x-distance.\n * @param   {Number}  dy       Shadow y-distance.\n * @param   {Number}  blur     Blurness.\n * @param   {Number}  opacity  Opacity of the shadow with in [0,1].\n */\nfunction dropShadow(el, name, dx, dy, blur, opacity) {\n  var defs = el.select('defs');\n\n  if (defs.empty()) {\n    defs = el.append('defs');\n  }\n\n  // create filter with id #drop-shadow\n  // height = 130% so that the shadow is not clipped\n  var filter = defs.append('filter').attr('id', 'drop-shadow' + (name ? '-' + name : '')).attr('height', '130%');\n\n  // SourceAlpha refers to opacity of graphic that this filter will be applied to\n  // convolve that with a Gaussian with standard deviation 3 and store result\n  // in blur\n  filter.append('feGaussianBlur').attr('in', 'SourceAlpha').attr('stdDeviation', blur);\n\n  // translate output of Gaussian blur to the right and downwards with 2px\n  // store result in offsetBlur\n  filter.append('feOffset').attr('dx', dx).attr('dy', dy).attr('result', 'offsetBlur');\n\n  filter.append('feComponentTransfer').append('feFuncA').attr('type', 'linear').attr('slope', opacity || 1);\n\n  // overlay original SourceGraphic over translated blurred opacity by using\n  // feMerge filter. Order of specifying inputs is important!\n  var feMerge = filter.append('feMerge');\n\n  feMerge.append('feMergeNode');\n  feMerge.append('feMergeNode').attr('in', 'SourceGraphic');\n}\n\n/**\n * Helper method to set a value if available and otherwise fall back to a\n * default value\n *\n * @method  setOption\n * @author  Fritz Lekschas\n * @date    2016-09-12\n * @param   {*}        value  Value to be set if available.\n * @param   {*}        defaultValue  Default value to be set when `value` is\n *   not available.\n * @param   {Boolean}  noFalsyValue  No falsy values are allowed. E.g., an empty\n *   string or the number zero are regarded as falsy.\n */\nfunction setOption(value, defaultValue, noFalsyValue) {\n  if (noFalsyValue) {\n    return value || defaultValue;\n  }\n\n  return typeof value !== 'undefined' ? value : defaultValue;\n}\n\n// External\n// eslint-disable-line import/no-unresolved\n// eslint-disable-line import/no-unresolved\n// Internal\n// Private Variables\nvar _d3 = d3;\n\nvar ListGraph = function () {\n  function ListGraph(init) {\n    var _this = this;\n\n    classCallCheck(this, ListGraph);\n\n    if (init.d3) {\n      _d3 = init.d3;\n    }\n\n    if (_d3.version[0] !== '4') {\n      throw new D3VersionFourRequired(_d3.version);\n    }\n\n    if (!_d3.listGraph) {\n      throw new LayoutNotAvailable();\n    }\n\n    var self = this;\n\n    this.baseEl = init.element;\n    this.baseEl.__d3ListGraphBase__ = true;\n\n    this.baseElD3 = _d3.select(this.baseEl);\n    this.baseElJq = $(this.baseEl);\n    this.svgD3 = this.baseElD3.select('svg.base');\n    this.svgEl = this.svgD3.node();\n    this.outsideClickHandler = {};\n    this.outsideClickClassHandler = {};\n\n    if (this.svgD3.empty()) {\n      this.svgD3 = this.baseElD3.append('svg').attr('class', 'base');\n      this.svgJq = $(this.svgD3.node());\n    } else {\n      this.svgJq = $(this.svgD3.node());\n    }\n\n    // Array of root node IDs.\n    this.rootNodes = init.rootNodes;\n\n    // Width of the vis. If `undefined` the SVG's width will be used.\n    this.width = setOption(init.width, this.svgJq.width(), true);\n\n    // Height of the vis. If `undefined` the SVG's height will be used.\n    this.height = setOption(init.height, this.svgJq.height(), true);\n\n    // Refresh top and left position of the base `svg` everytime the user enters\n    // the element with his/her mouse cursor. This will avoid relying on complex\n    // browser resize events and other layout manipulations as they most likely\n    // won't happen when the user tries to interact with the visualization.\n    this.svgD3.on('mouseenter', this.getBoundingRect.bind(this));\n\n    // With of the column's scrollbars\n    this.scrollbarWidth = setOption(init.scrollbarWidth, SCROLLBAR_WIDTH, true);\n\n    // Number of visible columns\n    this.columns = setOption(init.columns, COLUMNS, true);\n\n    // Number of visible rows.\n    this.rows = setOption(init.rows, ROWS, true);\n\n    // Path to SVG icon file.\n    this.iconPath = setOption(init.iconPath, ICON_PATH, true);\n\n    // If `true` query icons and controls are enabled.\n    this.querying = setOption(init.querying, QUERYING);\n\n    // If `true` hide links that point to invisible nodes.\n    this.hideOutwardsLinks = setOption(init.hideOutwardsLinks, HIDE_OUTWARDS_LINKS);\n\n    // If `true` and `this.hideOutwardsLinks === true` indicates the location of\n    // target nodes of invisible nodes connected via links.\n    this.showLinkLocation = setOption(init.showLinkLocation, SHOW_LINK_LOCATION);\n\n    // The visual size of a location bucket. E.g. `3` pixel.\n    this.linkLocationBucketSize = init.linkLocationBucketSize;\n\n    // If `true` the currently rooted level will softly be highlighted.\n    this.highlightActiveLevel = setOption(init.highlightActiveLevel, HIGHLIGHT_ACTIVE_LEVEL);\n\n    // Determines which level from the rooted node will be regarded as active.\n    // Zero means that the level of the rooted node is regarded.\n    this.activeLevel = setOption(init.activeLevel, ACTIVE_LEVEL);\n\n    // When no manually rooted node is available the active level will be\n    // `this.activeLevel` minus `this.noRootActiveLevelDiff`.\n    // WAT?\n    // In some cases it makes sense to hide the original root node just to save\n    // a column, so having no manually set root node means that the invisible\n    // root node is active. Using this option it can be assured that the\n    // approriate column is being highlighted.\n    this.noRootActiveLevelDiff = setOption(init.noRootActiveLevelDiff, NO_ROOT_ACTIVE_LEVEL_DIFF);\n\n    // Determine the level of transitions\n    // - 0 [Default]: Show all transitions\n    // - 1: Show only CSS transitions\n    // - 2: Show no transitions\n    this.lessTransitionsJs = init.lessTransitions > 0;\n    this.lessTransitionsCss = init.lessTransitions > 1;\n\n    // Enable or disable\n    this.disableDebouncedContextMenu = setOption(init.disableDebouncedContextMenu, DISABLE_DEBOUNCED_CONTEXT_MENU);\n\n    this.baseElD3.classed('less-animations', this.lessTransitionsCss);\n\n    // Holds the key of the property to be sorted initially. E.g. `precision`.\n    this.sortBy = init.sortBy;\n\n    // Initial sort order. Anything other than `asc` will fall back to `desc`.\n    this.sortOrder = init.sortOrder === 'asc' ? 1 : DEFAULT_SORT_ORDER;\n\n    this.nodeInfoContextMenu = isArray(init.nodeInfoContextMenu) ? init.nodeInfoContextMenu : [];\n\n    this.events = new Events(this.baseEl, init.dispatcher);\n\n    this.baseElJq.addClass(CLASSNAME);\n\n    this.dragged = { x: 0, y: 0 };\n\n    if (init.forceWidth) {\n      this.baseElJq.width(this.width);\n    }\n\n    this.layout = new _d3.listGraph({ // eslint-disable-line new-cap\n      size: [this.width, this.height],\n      grid: [this.columns, this.rows],\n      d3: _d3\n    });\n\n    this.data = init.data;\n    this.visData = this.layout.process(this.data, this.rootNodes, {\n      showLinkLocation: this.showLinkLocation,\n      linkLocationBucketSize: this.linkLocationBucketSize,\n      sortBy: this.sortBy,\n      sortOrder: this.sortOrder\n    });\n\n    /**\n     * Stores current sorting, e.g. type, order and a reference to the element.\n     *\n     * @type  {Object}\n     */\n    this.currentSorting = {\n      global: {\n        type: this.sortBy,\n        order: this.sortOrder\n      },\n      local: {}\n    };\n\n    this.barMode = init.barMode || DEFAULT_BAR_MODE;\n    this.svgD3.classed(this.barMode + '-bar', true);\n\n    this.topbar = new Topbar(this, this.baseElD3, this.visData);\n\n    this.svgD3.attr('viewBox', '0 0 ' + this.width + ' ' + this.height);\n\n    this.container = this.svgD3.append('g').attr('class', 'main-container');\n\n    this.levels = new Levels(this.container, this, this.visData);\n\n    this.links = new Links(this, this.levels.groups, this.visData, this.layout);\n    this.nodes = new Nodes(this, this.levels.groups, this.visData, this.links, this.events);\n    this.levels.scrollPreparation(this.scrollbarWidth);\n    this.scrollbars = new Scrollbars(this.levels.groups, this.visData, this.scrollbarWidth);\n\n    this.nodeContextMenu = new NodeContextMenu({\n      visData: this.visData,\n      baseEl: this.container,\n      events: this.events,\n      nodes: this.nodes,\n      iconPath: this.iconPath,\n      infoFields: this.nodeInfoContextMenu,\n      isQueryable: this.querying,\n      isDebounced: !this.disableDebouncedContextMenu\n    });\n\n    this.nodeContextMenu.wrapper.on('mousedown', function () {\n      _this.mouseDownOnContextMenu = true;\n    });\n\n    dropShadow(this.svgD3, 'context-menu', 0, 1, 2, 0.2);\n    dropShadow(this.svgD3, 'context-menu-inverted', 0, -1, 2, 0.2);\n\n    // jQuery's mousewheel plugin is much nicer than D3's half-baked zoom event.\n    // We are using delegated event listeners to provide better scaling\n    this.svgJq.on('mousewheel', '.' + this.levels.className, function (event) {\n      if (!self.zoomedOut) {\n        self.mousewheelColumn(this, event);\n      }\n    });\n\n    this.svgJq.on('click', function (event) {\n      self.checkGlobalClick.call(self, event.target);\n    });\n\n    // Add jQuery delegated event listeners instead of direct listeners of D3.\n    this.svgJq.on('click', '.' + this.nodes.classNodeVisible, function () {\n      // Add a new global outside click listener using this node and the\n      // node context menu as the related elements.\n      requestNextAnimationFrame(function () {\n        self.registerOutSideClickHandler('nodeContextMenu', [self.nodeContextMenu.wrapper.node()], ['visible-node'], function () {\n          // The context of this method is the context of the outer click\n          // handler.\n          self.nodeContextMenu.close();\n          self.unregisterOutSideClickHandler.call(self, 'nodeContextMenu');\n        });\n      });\n\n      self.nodeContextMenu.toggle.call(self.nodeContextMenu, _d3.select(this.parentNode));\n    });\n\n    this.svgJq.on('click', '.' + this.nodes.classFocusControls + '.' + this.nodes.classRoot, function () {\n      self.nodes.rootHandler.call(self.nodes, _d3.select(this), true);\n    });\n\n    if (this.querying) {\n      this.svgJq.on('click', '.' + this.nodes.classFocusControls + '.' + this.nodes.classQuery, function () {\n        self.nodes.queryHandler.call(self.nodes, _d3.select(this.parentNode), 'unquery');\n        self.nodeContextMenu.updateStates();\n      });\n    }\n\n    this.svgJq.on('click', '.' + this.nodes.classFocusControls + '.' + this.nodes.classLock, function () {\n      self.nodes.lockHandler.call(self.nodes, this, _d3.select(this).datum());\n    });\n\n    this.svgJq.on('mouseenter', '.' + this.nodes.classNodeVisible, function () {\n      self.interactionWrapper.call(self, function (domEl, data) {\n        if (!this.vis.activeScrollbar) {\n          this.enterHandler.call(this, domEl, data);\n        }\n      }.bind(self.nodes), [this, _d3.select(this).datum()]);\n    });\n\n    this.svgJq.on('mouseleave', '.' + this.nodes.classNodeVisible, function () {\n      self.interactionWrapper.call(self, function (domEl, data) {\n        if (!this.vis.activeScrollbar) {\n          this.leaveHandler.call(this, domEl, data);\n        }\n      }.bind(self.nodes), [this, _d3.select(this).datum()]);\n    });\n\n    // Normally we would reference a named methods but since we need to access\n    // the class' `this` property instead of the DOM element we need to use an\n    // arrow function.\n    this.scrollbars.all.on('mousedown', function () {\n      self.scrollbarMouseDown(this, _d3.event);\n    });\n\n    // We need to listen to `mouseup` and `mousemove` globally otherwise\n    // scrolling will only work as long as the cursor hovers the actual\n    // scrollbar, which is super annoying.\n    _d3.select(document).on('mouseup', function () {\n      _this.globalMouseUp(_d3.event);\n    });\n\n    // Enable dragging of the whole graph.\n    this.svgD3.call(onDragDrop, this.dragStartHandler.bind(this), this.dragMoveHandler.bind(this), this.dragEndHandler.bind(this), [this.container, this.topbar.localControlWrapper], 'horizontal', this.getDragLimits.bind(this), this.noDragging.bind(this), this.dragged, 2);\n\n    this.events.on('d3ListGraphLevelFocus', function (levelId) {\n      return _this.levels.focus(levelId);\n    });\n\n    this.events.on('d3ListGraphNodeRoot', function () {\n      _this.nodes.bars.updateAll(_this.layout.updateBars(_this.data), _this.currentSorting.global.type);\n      _this.updateSorting();\n    });\n\n    this.events.on('d3ListGraphNodeUnroot', function () {\n      _this.nodes.bars.updateAll(_this.layout.updateBars(_this.data), _this.currentSorting.global.type);\n      _this.updateSorting();\n    });\n\n    this.events.on('d3ListGraphUpdateBars', function () {\n      _this.nodes.bars.updateAll(_this.layout.updateBars(_this.data), _this.currentSorting.global.type);\n      _this.updateSorting();\n    });\n\n    this.events.on('d3ListGraphActiveLevel', function (nextLevel) {\n      var oldLevel = _this.activeLevel;\n      _this.activeLevel = Math.max(nextLevel, 0);\n      if (_this.nodes.rootedNode) {\n        var rootNodeDepth = _this.nodes.rootedNode.datum().depth;\n        _this.levels.blur(rootNodeDepth + oldLevel);\n        _this.levels.focus(rootNodeDepth + _this.activeLevel);\n      } else {\n        _this.levels.blur(oldLevel - _this.noRootActiveLevelDiff);\n        _this.levels.focus(_this.activeLevel - _this.noRootActiveLevelDiff);\n      }\n    });\n\n    // Initialize `this.left` and `this.top`\n    this.getBoundingRect();\n  }\n\n  createClass(ListGraph, [{\n    key: 'dragMoveHandler',\n    value: function dragMoveHandler$$(data, elsToBeDragged, orientation, limits, notWhenTrue) {\n      dragMoveHandler(data, elsToBeDragged, orientation, limits, notWhenTrue);\n      this.checkNodeVisibility();\n    }\n  }, {\n    key: 'checkNodeVisibility',\n    value: function checkNodeVisibility(level, customScrollTop) {\n      var nodes = level ? this.nodes.nodes.filter(function (data) {\n        return data.depth === level;\n      }) : this.nodes.nodes;\n\n      nodes.call(this.nodes.isInvisible.bind(this.nodes), customScrollTop);\n    }\n  }, {\n    key: 'registerOutSideClickHandler',\n    value: function registerOutSideClickHandler(id, els, elClassNames, callback) {\n      // We need to register a unique property to be able to indentify that\n      // element later efficiently.\n      for (var i = els.length; i--;) {\n        if (els[i].__id__) {\n          els[i].__id__.push(id);\n        } else {\n          els[i].__id__ = [id];\n        }\n      }\n      var newLength = this.outsideClickHandler[id] = {\n        id: id, els: els, elClassNames: elClassNames, callback: callback\n      };\n      for (var _i = elClassNames.length; _i--;) {\n        this.outsideClickClassHandler[elClassNames[_i]] = this.outsideClickHandler[id];\n      }\n      return newLength;\n    }\n  }, {\n    key: 'unregisterOutSideClickHandler',\n    value: function unregisterOutSideClickHandler(id) {\n      var handler = this.outsideClickHandler[id];\n\n      // Remove element `__id__` property.\n      for (var i = handler.els.length; i--;) {\n        handler.els[i].__id__ = undefined;\n        delete handler.els[i].__id__;\n      }\n\n      // Remove handler.\n      this.outsideClickHandler[id] = undefined;\n      delete this.outsideClickHandler[id];\n    }\n  }, {\n    key: 'checkGlobalClick',\n    value: function checkGlobalClick(target) {\n      var found = {};\n      var checkClass = Object.keys(this.outsideClickClassHandler).length;\n\n      var el = target;\n      try {\n        while (!el.__d3ListGraphBase__) {\n          if (el.__id__) {\n            for (var i = el.__id__.length; i--;) {\n              found[el.__id__[i]] = true;\n            }\n          }\n          if (checkClass) {\n            var classNames = Object.keys(this.outsideClickClassHandler);\n            for (var _i2 = classNames.length; _i2--;) {\n              var className = el.getAttribute('class');\n              if (className && className.indexOf(classNames[_i2]) >= 0) {\n                found[this.outsideClickClassHandler[classNames[_i2]].id] = true;\n              }\n            }\n          }\n          el = el.parentNode;\n        }\n      } catch (e) {\n        return;\n      }\n\n      var handlerIds = Object.keys(this.outsideClickHandler);\n      for (var _i3 = handlerIds.length; _i3--;) {\n        if (!found[handlerIds[_i3]]) {\n          this.outsideClickHandler[handlerIds[_i3]].callback.call(this);\n        }\n      }\n    }\n  }, {\n    key: 'getDragLimits',\n    value: function getDragLimits() {\n      return {\n        x: {\n          min: this.dragMinX,\n          max: 0\n        }\n      };\n    }\n\n    /**\n     * Helper method to get the top and left position of the base `svg`.\n     *\n     * @Description\n     * Calling `getBoundingClientRect()` right at the beginning leads to errornous\n     * values, probably because the function is called because HTML has been fully\n     * rendered.\n     *\n     * @method  getBoundingRect\n     * @author  Fritz Lekschas\n     * @date    2016-02-24\n     */\n\n  }, {\n    key: 'getBoundingRect',\n    value: function getBoundingRect() {\n      this.left = this.svgEl.getBoundingClientRect().left;\n      this.top = this.svgEl.getBoundingClientRect().top;\n    }\n  }, {\n    key: 'interactionWrapper',\n    value: function interactionWrapper(callback, params) {\n      if (!this.noInteractions) {\n        callback.apply(this, params);\n      }\n    }\n  }, {\n    key: 'dragStartHandler',\n    value: function dragStartHandler() {\n      if (!this.dragging) {\n        this.noInteractions = this.dragging = true;\n      }\n    }\n  }, {\n    key: 'dragEndHandler',\n    value: function dragEndHandler() {\n      if (this.dragging) {\n        this.noInteractions = this.dragging = false;\n      }\n    }\n  }, {\n    key: 'noDragging',\n    value: function noDragging() {\n      return !!this.activeScrollbar || this.mouseDownOnContextMenu;\n    }\n  }, {\n    key: 'globalMouseUp',\n    value: function globalMouseUp(event) {\n      this.noInteractions = false;\n      this.mouseDownOnContextMenu = false;\n\n      if (this.activeScrollbar) {\n        var data = this.activeScrollbar.datum();\n        var deltaY = data.scrollbar.clientY - event.clientY;\n\n        // Save final vertical position\n        // Scrollbar\n        data.scrollbar.scrollTop = Math.min(Math.max(data.scrollbar.scrollTop - deltaY, 0), data.scrollbar.scrollHeight);\n\n        // Content\n        data.scrollTop = Math.max(Math.min(data.scrollTop + data.invertedHeightScale(deltaY), 0), -data.scrollHeight);\n\n        this.activeScrollbar.classed('active', false);\n\n        this.activeScrollbar = undefined;\n\n        this.stopScrollBarMouseMove();\n      }\n    }\n  }, {\n    key: 'startScrollBarMouseMove',\n    value: function startScrollBarMouseMove() {\n      var _this2 = this;\n\n      _d3.select(document).on('mousemove', function () {\n        _this2.dragScrollbar(_d3.event);\n      });\n    }\n  }, {\n    key: 'stopScrollBarMouseMove',\n    value: function stopScrollBarMouseMove() {\n      _d3.select(document).on('mousemove', null);\n    }\n\n    /**\n     * Method for scrolling a column of nodes when the scrollbar is dragged.\n     *\n     * @method  dragScrollbar\n     * @author  Fritz Lekschas\n     * @date    2016-09-12\n     * @param   {Object}  event  D3's _mousemove_ event object.\n     */\n\n  }, {\n    key: 'dragScrollbar',\n    value: function dragScrollbar(event) {\n      event.preventDefault();\n      var data = this.activeScrollbar.datum();\n      var deltaY = data.scrollbar.clientY - event.clientY;\n\n      // Scroll scrollbar\n      ListGraph.scrollElVertically(this.activeScrollbar.node(), Math.min(Math.max(data.scrollbar.scrollTop - deltaY, 0), data.scrollbar.scrollHeight));\n\n      // Scroll content\n      var contentScrollTop = Math.max(Math.min(data.scrollTop + data.invertedHeightScale(deltaY), 0), -data.scrollHeight);\n\n      ListGraph.scrollElVertically(data.nodes, contentScrollTop);\n\n      // Scroll Links\n      if (data.level !== this.visData.nodes.length) {\n        this.links.scroll(data.linkSelections.outgoing, this.layout.offsetLinks(data.level, contentScrollTop, 'source'));\n      }\n\n      if (data.level > 0) {\n        this.links.scroll(data.linkSelections.incoming, this.layout.offsetLinks(data.level - 1, contentScrollTop, 'target'));\n      }\n\n      if (this.showLinkLocation) {\n        this.nodes.updateLinkLocationIndicators(data.level - 1, data.level + 1);\n      }\n\n      if (this.nodeContextMenu.opened) {\n        this.nodeContextMenu.scrollY(contentScrollTop);\n      }\n\n      // Check if nodes are visible.\n      this.checkNodeVisibility(data.level, contentScrollTop);\n    }\n  }, {\n    key: 'scrollbarMouseDown',\n    value: function scrollbarMouseDown(el, event) {\n      this.noInteractions = true;\n      this.activeScrollbar = _d3.select(el).classed('active', true);\n      this.activeScrollbar.datum().scrollbar.clientY = event.clientY;\n      this.startScrollBarMouseMove();\n    }\n  }, {\n    key: 'mousewheelColumn',\n    value: function mousewheelColumn(el, event) {\n      event.preventDefault();\n\n      var data = _d3.select(el).datum();\n\n      if (data.scrollHeight > 0) {\n        // Scroll nodes\n        data.scrollTop = Math.max(Math.min(data.scrollTop + event.deltaY, 0), -data.scrollHeight);\n\n        this.scrollY(data);\n      }\n\n      // Check if nodes are visible.\n      this.checkNodeVisibility(data.level);\n    }\n  }, {\n    key: 'scrollY',\n    value: function scrollY(columnData, scrollbarDragging) {\n      ListGraph.scrollElVertically(columnData.nodes, columnData.scrollTop);\n\n      if (!scrollbarDragging) {\n        // Scroll scrollbar\n        columnData.scrollbar.scrollTop = columnData.scrollbar.heightScale(-columnData.scrollTop);\n\n        ListGraph.scrollElVertically(columnData.scrollbar.el, columnData.scrollbar.scrollTop);\n      }\n\n      // Scroll Links\n      if (columnData.level !== this.visData.nodes.length) {\n        this.links.scroll(columnData.linkSelections.outgoing, this.layout.offsetLinks(columnData.level, columnData.scrollTop, 'source'));\n      }\n\n      if (columnData.level > 0) {\n        this.links.scroll(columnData.linkSelections.incoming, this.layout.offsetLinks(columnData.level - 1, columnData.scrollTop, 'target'));\n      }\n\n      if (this.showLinkLocation) {\n        this.nodes.updateLinkLocationIndicators(columnData.level - 1, columnData.level + 1);\n      }\n\n      if (this.nodeContextMenu.isOpenSameColumn(columnData.level)) {\n        this.nodeContextMenu.scrollY(columnData.scrollTop);\n      }\n    }\n  }, {\n    key: 'scrollYTo',\n    value: function scrollYTo(selection, positionY) {\n      var _this3 = this;\n\n      return selection.transition().duration(TRANSITION_SEMI_FAST).tween('scrollY', function (data) {\n        var scrollPositionY = _d3.interpolateNumber(data.scrollTop, positionY);\n        return function (time) {\n          data.scrollTop = scrollPositionY(time);\n          _this3.scrollY(data);\n        };\n      });\n    }\n  }, {\n    key: 'resetAllScrollPositions',\n    value: function resetAllScrollPositions() {\n      return this.scrollYTo(this.levels.groups, 0);\n    }\n  }, {\n    key: 'selectByLevel',\n    value: function selectByLevel(level, selector) {\n      return _d3.select(this.levels.groups._groups[0][level]).selectAll(selector);\n    }\n  }, {\n    key: 'updateSorting',\n    value: function updateSorting() {\n      var levels = Object.keys(this.currentSorting.local);\n      for (var i = levels.length; i--;) {\n        this.sortColumn(i, this.currentSorting.local[levels[i]].type, this.currentSorting.local[levels[i]].order, this.currentSorting.local[levels[i]].type);\n      }\n    }\n  }, {\n    key: 'sortColumn',\n    value: function sortColumn(level, property, sortOrder, newSortType) {\n      this.nodes.sort(this.layout.sort(level, property, sortOrder).updateNodesVisibility().nodes(level), newSortType);\n      this.links.sort(this.layout.links(level - 1, level + 1));\n      this.nodeContextMenu.updatePosition();\n      this.checkNodeVisibility();\n    }\n  }, {\n    key: 'sortAllColumns',\n    value: function sortAllColumns(property, newSortType) {\n      this.currentSorting.global.order = this.currentSorting.global.order === -1 && !newSortType ? 1 : -1;\n\n      this.nodes.sort(this.layout.sort(undefined, property, this.currentSorting.global.order).updateNodesVisibility().nodes(), newSortType);\n\n      this.links.sort(this.layout.links());\n      this.nodeContextMenu.updatePosition();\n      this.checkNodeVisibility();\n    }\n  }, {\n    key: 'switchBarMode',\n    value: function switchBarMode(mode) {\n      this.svgD3.classed('one-bar', mode === 'one');\n      this.svgD3.classed('two-bar', mode === 'two');\n      this.nodes.bars.switchMode(mode, this.currentSorting);\n    }\n  }, {\n    key: 'trigger',\n    value: function trigger(event, data) {\n      this.events.trigger(event, data);\n    }\n\n    /**\n     * Update the scroll position and scroll-bar visibility.\n     *\n     * @description\n     * This method needs to be called after hiding or showing nodes.\n     *\n     * @method  updateScrolling\n     * @author  Fritz Lekschas\n     * @date    2016-02-21\n     */\n\n  }, {\n    key: 'updateScrolling',\n    value: function updateScrolling() {\n      var _this4 = this;\n\n      this.resetAllScrollPositions().call(allTransitionsEnded, function () {\n        _this4.levels.updateScrollProperties();\n        _this4.scrollbars.updateVisibility();\n      });\n    }\n  }, {\n    key: 'updateLevelsVisibility',\n    value: function updateLevelsVisibility() {\n      this.levels.updateVisibility();\n    }\n  }, {\n    key: 'globalView',\n    value: function globalView(selectionInterst) {\n      var _this5 = this;\n\n      if (!this.zoomedOut) {\n        (function () {\n          var x = 0;\n          var y = 0;\n          var width = 0;\n          var height = 0;\n          var cRect = void 0;\n          var contBBox = _this5.container.node().getBBox();\n\n          var globalCRect = _this5.svgD3.node().getBoundingClientRect();\n\n          if (selectionInterst && !selectionInterst.empty()) {\n            selectionInterst.each(function () {\n              cRect = this.getBoundingClientRect();\n              width = Math.max(width, cRect.left - (globalCRect.left + cRect.width));\n              height = Math.max(height, cRect.top - (globalCRect.top + cRect.height));\n            });\n            width = _this5.width > width ? _this5.width : width;\n            height = _this5.height > height ? _this5.height : height;\n          } else {\n            width = _this5.width > contBBox.width ? _this5.width : contBBox.width;\n            height = _this5.height > contBBox.height ? _this5.height : contBBox.height;\n          }\n\n          x = contBBox.x + _this5.dragged.x;\n          y = contBBox.y;\n\n          _this5.nodes.makeAllTempVisible();\n          _this5.links.makeAllTempVisible();\n\n          _this5.svgD3.classed('zoomedOut', true).transition().duration(TRANSITION_SEMI_FAST).attr('viewBox', x + ' ' + y + ' ' + width + ' ' + height);\n        })();\n      }\n    }\n  }, {\n    key: 'zoomedView',\n    value: function zoomedView() {\n      if (!this.zoomedOut) {\n        this.nodes.makeAllTempVisible(true);\n        this.links.makeAllTempVisible(true);\n\n        this.svgD3.classed('zoomedOut', false).transition().duration(TRANSITION_SEMI_FAST).attr('viewBox', '0 0 ' + this.width + ' ' + this.height);\n      }\n    }\n  }, {\n    key: 'toggleView',\n    value: function toggleView() {\n      if (this.zoomedOut) {\n        this.zoomedOut = false;\n        this.zoomedView();\n      } else {\n        this.globalView();\n        this.zoomedOut = true;\n      }\n    }\n\n    /**\n     * Check if an element is actually visible, i.e. within the boundaries of the\n     * SVG element.\n     *\n     * @method  isHidden\n     * @author  Fritz Lekschas\n     * @date    2016-02-24\n     * @param   {Object}    el  DOM element to be checked.\n     * @return  {Boolean}       If `true` element is not visible.\n     */\n\n  }, {\n    key: 'isHidden',\n    value: function isHidden(el) {\n      var boundingRect = el.getBoundingClientRect();\n      return boundingRect.top + boundingRect.height <= this.top || boundingRect.left + boundingRect.width <= this.left || boundingRect.top >= this.top + this.height || boundingRect.left >= this.left + this.width;\n    }\n\n    /**\n     * Assesses any of the two ends of a link points outwards.\n     *\n     * @description\n     * In order to be able to determine where a link points to, the output of\n     * `linkPointsOutside` for the source and target location is shifted bitwise\n     * in such a way that this method return 11 unique numbers.\n     * - 0: link is completely inwards\n     * - 1: source is outwards to the top\n     * - 2: source is outwards to the bottom\n     * - 4: target is outwards to the top\n     * - 8: target is outwards to the bottom\n     * - 5: source and target are outwards to the top\n     * - 6: source is outwards to the bottom and target is outwards to the top\n     * - 9: source is outwards to the top and target is outwards to the bottom\n     * - 10: source and target are outwards to the bottom\n     * - 16: source is invisible\n     * - 64: target is invisible\n     *\n     * If you're asking yourself: \"WAT?!?!!\" Think of a 4x4 binary matrix:\n     * |    target    |    source    |\n     * | bottom | top | bottom | top |\n     * |    0   |  0  |    0   |  0  | (=0)\n     * |    0   |  0  |    0   |  1  | (=1)\n     * |    0   |  0  |    1   |  0  | (=2)\n     * |    0   |  1  |    0   |  0  | (=4)\n     * |    1   |  0  |    0   |  0  | (=8)\n     * |    0   |  1  |    0   |  1  | (=5)\n     * |    0   |  1  |    1   |  0  | (=6)\n     * |    1   |  0  |    0   |  1  | (=9)\n     * |    1   |  0  |    1   |  0  | (=10)\n     *\n     * *Note: 16 and 64 are two special values when the source or target node is\n     * hidden. The numbers are so hight just because that the bitwise-and with 4\n     * and 8 results to 0.\n     *\n     * To check whether the source or target location is above, below or within\n     * the global SVG container is very simple. For example, to find out if the\n     * target location is above, all we need to do is `<VALUE> & 4 > 0`. This\n     * performs a bit-wise AND operation with only two possible outcomes: 4 and 0.\n     *\n     * @method  pointsOutside\n     * @author  Fritz Lekschas\n     * @date    2016-09-14\n     * @param   {Object}  data  Link data.\n     * @return  {Number}  Numberical represenation of the links constallation. See\n     *   description for details.\n     */\n\n  }, {\n    key: 'pointsOutside',\n    value: function pointsOutside(data) {\n      var source = this.linkPointsOutside(data.source);\n      var target = this.linkPointsOutside(data.target) << 2;\n      return source | target;\n    }\n\n    /**\n     * Assesses whether a link's end points outwards\n     *\n     * @method  linkPointsOutside\n     * @author  Fritz Lekschas\n     * @date    2016-09-14\n     * @param   {Object}  data  Link data.\n     * @return  {Number}  If link ends inwards returns `0`, if it points outwards\n     *   to the top returns `1` or `2` when it points to the bottom. If the node\n     *   pointed to is hidden return `16`.\n     */\n\n  }, {\n    key: 'linkPointsOutside',\n    value: function linkPointsOutside(data) {\n      var y = data.node.y + data.offsetY;\n      if (data.node.hidden) {\n        return 16;\n      }\n      if (y + this.visData.global.row.height - this.visData.global.row.padding <= 0) {\n        return 1;\n      }\n      if (y + this.visData.global.row.padding >= this.height) {\n        return 2;\n      }\n      return 0;\n    }\n  }, {\n    key: 'area',\n    get: function get() {\n      return this.container.node().getBoundingClientRect();\n    }\n  }, {\n    key: 'dragMinX',\n    get: function get() {\n      return Math.min(0, this.width - this.area.width);\n    }\n  }, {\n    key: 'barMode',\n    get: function get() {\n      if (this.bars) {\n        return this.nodes.bars.mode;\n      }\n      return this._barMode;\n    },\n    set: function set(mode) {\n      if (this.bars) {\n        this.nodes.bars.mode = mode;\n      }\n      this._barMode = mode;\n    }\n  }], [{\n    key: 'scrollElVertically',\n    value: function scrollElVertically(el, offset) {\n      _d3.select(el).attr('transform', 'translate(0, ' + offset + ')');\n    }\n  }]);\n  return ListGraph;\n}();\n\nListGraph.version = '0.17.0';\n\nreturn ListGraph;\n\n})));"],"sourceRoot":"/source/"}