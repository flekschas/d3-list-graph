{"version":3,"sources":["listGraph.min.js"],"names":["ListGraph","$","d3","mergeSelections","selections","pushSelection","selection","each","mergedSelection","push","this","selectAll","i","length","allTransitionsEnded","transition","callback","size","n","apply","arguments","onDragDrop","dragStartHandler","dragMoveHandler","dropHandler","elsToBeDragged","orientation","limits","notWhenTrue","drag","behavior","appliedLimits","on","data","call","el","select","dragX","dragY","datum","withinLimits","value","applyingLimits","restrictedValue","undefined","Math","min","max","e","LimitsUnsupportedFormat","els","event","dx","x","style","dy","y","isFinite","nativeIsFinite","collectInclClones","node","originalNode","clone","clones","concat","up","depth","includeClones","child","nodesInclClones","parentsId","Object","keys","parents","j","down","childRefs","upAndDown","callbackUp","callbackDown","siblings","siblingsId","isObject","type","isFunction","objToString","funcTag","roundRect","width","height","radius","topLeft","topRight","bottomLeft","bottomRight","isObjectLike","isNative","reIsNative","test","fnToString","reIsHostCtor","getNative","object","key","isLength","MAX_SAFE_INTEGER","setOption","defaultValue","noFalsyValue","babelHelpers","classCallCheck","instance","Constructor","TypeError","createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","protoProps","staticProps","prototype","inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","possibleConstructorReturn","self","ReferenceError","CLASSNAME","SCROLLBAR_WIDTH","COLUMNS","ROWS","ICON_PATH","DEFAULT_SORT_ORDER","DEFAULT_BAR_MODE","HIGHLIGHT_ACTIVE_LEVEL","ACTIVE_LEVEL","NO_ROOT_ACTIVE_LEVEL_DIFF","QUERYING","TRANSITION_LIGHTNING_FAST","TRANSITION_SEMI_FAST","ExtendableError","_Error","message","_this","getPrototypeOf","name","Error","captureStackTrace","_ExtendableError","SCROLLBAR_CLASS","Scrollbars","baseSelection","visData","all","append","attr","parentNode","scrollbar","classed","duration","objectTypes","function","freeExports","exports","nodeType","freeModule","module","freeGlobal","global","freeSelf","freeWindow","window","root","objectProto","toString","BAR_CLASS","Bar","barGroup","barData","nodeData","bars","setupMagnitude","_this2","currentSorting","nodes","sortBy","generatePath","mode","setupBorder","row","padding","column","contentWidth","contentHeight","setupIndicator","class","level","cell","activeHeight","inactiveheight","enter","id","bind","referenceValue","lessTransitions","reference","indicator","adjustWidth","bottom","generateTwoBarsPath","generateOneBarPath","normValue","normIndicator","abs","BARS_CLASS","Bars","vis","that","update","barId","insertBefore","children","direct","updateIndicator","lessTransitionsJs","_this3","CLASS_NODES","CLASS_NODE","CLASS_CLONE","CLASS_LABEL_WRAPPER","CLASS_FOCUS_CONTROLS","CLASS_ROOT","CLASS_QUERY","CLASS_LOCK","CLASS_ACTIVE","CLASS_INACTIVE","Nodes","links","events","drawFullSizeRect","className","shrinking","noRoundBorder","shrinkingAmount","currentLinks","iconDimension","groups","rows","interactionWrapper","domEl","_data","activeScrollbar","enterHandler","querying","leaveHandler","queryMode","nodeRooted","setUpFocusControls","iconPath","nodeQuery","nodeLocks","barMode","text","focusNodes","blurNodes","nodeIds","eventHelper","highlightNodes","unhighlightNodes","toggleLock","toggleRoot","toggleQueryMode","eventData","clonedFromId","broadcast","locked","unlocked","lock","unlock","rooted","unrooted","excludeClones","zoomOut","globalView","filter","hovering","zoomedView","zoomIn","optionalParams","subSelectionClass","indexOf","setFalse","d3El","lockedNode","unlockNode","lockNode","parseInt","start","end","active","inactive","query-and","query-or","query-not","queryBeforeRooting","rootedNode","updateVisibility","previousMode","queryNode","unqueryNode","levels","blur","unrootNode","focus","activeLevel","noRootActiveLevelDiff","rootNode","hideNodes","showNodes","location","position","paddedDim","cx","cy","r","direction","nodesVisibility","show","hidden","restriction","checkNodeVisibility","_el","isHidden","checkNodeDirect","checkNodeIndirect","updateDirectBarIndicator","currentlyActiveBar","updateIndirectBarIndicator","nodeId","currentNodeData","includeParents","appliedClassName","includeChildren","empty","traverseCallbackUp","childData","traverseCallbackDown","barIndicatorClass","directNodes","indirectNodes","highlight","traverseCallback","newSortType","svgD3","updateLevelsVisibility","updateScrolling","local","_this4","layout","updateNodesVisibility","get","LINKS_CLASS","LINK_CLASS","Links","index","d","diagonal","_highlight","source","svg","offsetY","offsetX","projection","COLUMN_CLASS","SCROLL_CONTAINER_CLASS","Levels","highlightActiveLevel","scrollbarWidth","getBoundingClientRect","scrollHeight","scrollbarHeight","linkSelections","incoming","selectByLevel","outgoing","scrollTop","heightScale","scale","linear","domain","range","invertedHeightScale","invert","group","TOPBAR_EL","TOPBAR_CLASS","TOPBAR_CONTROL_EL","TOPBAR_CONTROL_CLASS","TOPBAR_GLOBAL_CONTROL_CLASS","Topbar","insert","controlSwitch","switchArrow","globalControls","globalPrecision","sortAllColumns","highlightBars","globalPrecisionWrapper","order","globalRecall","globalRecallWrapper","globalName","highlightLabels","globalNameWrapper","globalOneBar","switchBarMode","globalOneBarWrapper","globalTwoBars","globalTwoBarsWrapper","globalZoomOut","zoomedOut","toggleView","globalZoomOutWrapper","localControlWrapper","localControls","control","sortOrder","toggleColumn","left","controlData","sortColumn","html","toggleOptions","deHighlight","baseElD3","selectNodesLevel","semiActiveSortingEls","resetSemiActiveSortingEls","resetSortEl","columnKeys","len","newType","objectProto$2","Function","hasOwnProperty","RegExp","replace","arrayTag","objectProto$1","objToString$1","nativeIsArray","Array","isArray","LayoutNotAvailable","EventDispatcherNoFunction","_ExtendableError2","Events","_stack","dispatch","_dispatchEvent","eventName","document","createEvent","initCustomEvent","dispatchEvent","times","normTimes","Infinity","stack","splice","off","init","listGraph","baseEl","element","baseElJq","svgEl","svgJq","rootNodes","getBoundingRect","columns","lessTransitionsCss","dispatcher","addClass","forceWidth","process","topbar","container","scrollPreparation","scrollbars","mousewheelColumn","classLabelWrapper","classFocusControls","classRoot","rootHandler","classQuery","classLock","lockHandler","scrollbarMouseDown","globalMouseUp","globalMouseMove","dragEndHandler","getDragLimits","scrollbarDragging","levelId","updateAll","updateBars","updateSorting","nextLevel","oldLevel","rootNodeDepth","dragMinX","top","params","noInteractions","deltaY","clientY","scrollElVertically","contentScrollTop","scroll","offsetLinks","preventDefault","scrollY","columnData","positionY","tween","scrollPositionY","interpolateNumber","time","scrollYTo","selector","property","sort","switchMode","trigger","resetAllScrollPositions","updateScrollProperties","selectionInterst","bBox","cRect","globalCRect","getBBox","boundingRect","area","_barMode","set","offset"],"mappings":"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","file":"listGraph.min.js","sourcesContent":["/* Copyright Fritz Lekschas: D3 example visualization app using list-based graphs */\nvar ListGraph = (function ($,d3) { 'use strict';\n\n  var babelHelpers = {};\n\n  babelHelpers.classCallCheck = function (instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  };\n\n  babelHelpers.createClass = (function () {\n    function defineProperties(target, props) {\n      for (var i = 0; i < props.length; i++) {\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n      }\n    }\n\n    return function (Constructor, protoProps, staticProps) {\n      if (protoProps) defineProperties(Constructor.prototype, protoProps);\n      if (staticProps) defineProperties(Constructor, staticProps);\n      return Constructor;\n    };\n  })();\n\n  babelHelpers.inherits = function (subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n  };\n\n  babelHelpers.possibleConstructorReturn = function (self, call) {\n    if (!self) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n  };\n\n  babelHelpers;\n  var CLASSNAME = 'list-graph';\n\n  var SCROLLBAR_WIDTH = 6;\n  var COLUMNS = 5;\n  var ROWS = 5;\n\n  // An empty path is equal to inline SVG.\n  var ICON_PATH = '';\n\n  // -1 = desc, 1 = asc\n  var DEFAULT_SORT_ORDER = -1;\n\n  var DEFAULT_BAR_MODE = 'one';\n\n  var HIGHLIGHT_ACTIVE_LEVEL = true;\n  var ACTIVE_LEVEL = 0;\n  var NO_ROOT_ACTIVE_LEVEL_DIFF = 0;\n  var QUERYING = false;\n\n  var TRANSITION_LIGHTNING_FAST = 150;\n  var TRANSITION_SEMI_FAST = 250;\n\n  function mergeSelections(selections) {\n    // Create a new empty selection\n    var mergedSelection = d3.selectAll('.d3-list-graph-not-existent');\n\n    function pushSelection(selection) {\n      selection.each(function pushDomNode() {\n        mergedSelection[0].push(this);\n      });\n    }\n\n    for (var i = selections.length; i--;) {\n      pushSelection(selections[i]);\n    }\n\n    return mergedSelection;\n  }\n\n  function allTransitionsEnded(transition, callback) {\n    if (transition.size() === 0) {\n      callback();\n    }\n    var n = 0;\n    transition.each(function () {\n      return ++n;\n    }).each('end', function () {\n      if (! --n) callback.apply(this, arguments);\n    });\n  }\n\n  var ExtendableError = (function (_Error) {\n    babelHelpers.inherits(ExtendableError, _Error);\n\n    function ExtendableError(message) {\n      babelHelpers.classCallCheck(this, ExtendableError);\n\n      var _this = babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(ExtendableError).call(this, message));\n\n      _this.name = _this.constructor.name;\n      _this.message = message;\n      Error.captureStackTrace(_this, _this.constructor.name);\n      return _this;\n    }\n\n    return ExtendableError;\n  })(Error);\n\n  var LimitsUnsupportedFormat = (function (_ExtendableError) {\n    babelHelpers.inherits(LimitsUnsupportedFormat, _ExtendableError);\n\n    function LimitsUnsupportedFormat(message) {\n      babelHelpers.classCallCheck(this, LimitsUnsupportedFormat);\n      return babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(LimitsUnsupportedFormat).call(this, message || 'The limits are wrongly formatted. Please provide an ' + 'object of the following format: `{ x: { min: 0, max: 1 }, y: { min: ' + '0, max: 1 } }`'));\n    }\n\n    return LimitsUnsupportedFormat;\n  })(ExtendableError);\n\n  /**\n   * Drap and drop event handler that works via translation.\n   *\n   * @method  onDragDrop\n   * @author  Fritz Lekschas\n   * @date    2016-01-23\n   * @param   {Object}  selection        D3 selection to listen for the drag\n   *   event.\n   * @param   {Object}           dragMoveHandler  Handler for drag-move.\n   * @param   {Object}           dropHandler      Handler for drag-end, i.e. drop.\n   * @param   {Array}            elsToBeDragged   Array of D3 selections to be\n   *   moved according to the drag event. If empty or undefined `selection` will\n   *   be used.\n   * @param   {String}           orientation      Can either be \"horizontal\",\n   *   \"vertical\" or `undefined`, i.e. both directions.\n   * @param   {Object|Function}  limits           X and Y drag limits. E.g.\n   *   `{ x: { min: 0, max: 10 } }`.\n   * @param   {Array}             notWhenTrue     List if function returning a\n   *   Boolean value which should prevent the dragMoveHandler from working.\n   */\n  function onDragDrop(selection, dragStartHandler, dragMoveHandler, dropHandler, elsToBeDragged, orientation, limits, notWhenTrue) {\n    var drag = d3.behavior.drag();\n\n    var appliedLimits = limits || {}; // eslint-disable-line no-param-reassign\n\n    if (dragStartHandler) {\n      drag.on('dragstart', function () {\n        if (typeof limits === 'function') {\n          appliedLimits = limits();\n        }\n        dragStartHandler();\n      });\n    }\n\n    if (dragMoveHandler) {\n      drag.on('drag', function (data) {\n        dragMoveHandler.call(this, data, elsToBeDragged, orientation, appliedLimits, notWhenTrue);\n      });\n    }\n\n    if (dropHandler) {\n      drag.on('dragend', dropHandler);\n    }\n\n    selection.each(function (data) {\n      var el = d3.select(this);\n\n      // Set default data if not available.\n      if (!data) {\n        data = { dragX: 0, dragY: 0 }; // eslint-disable-line no-param-reassign\n        el.datum(data);\n      }\n\n      // Add drag event handler\n      el.call(drag);\n    });\n  }\n\n  function dragMoveHandler(data, elsToBeDragged, orientation, limits, notWhenTrue) {\n    for (var i = notWhenTrue.length; i--;) {\n      if (notWhenTrue[i]()) {\n        return;\n      }\n    }\n\n    var els = d3.select(this);\n\n    if (elsToBeDragged && elsToBeDragged.length) {\n      els = mergeSelections(elsToBeDragged);\n    }\n\n    function withinLimits(value, applyingLimits) {\n      var restrictedValue = undefined;\n\n      if (applyingLimits) {\n        try {\n          restrictedValue = Math.min(applyingLimits.max, Math.max(applyingLimits.min, value));\n        } catch (e) {\n          throw new LimitsUnsupportedFormat();\n        }\n      }\n      return restrictedValue;\n    }\n\n    if (orientation === 'horizontal' || orientation === 'vertical') {\n      if (orientation === 'horizontal') {\n        data.dragX += d3.event.dx;\n        data.dragX = withinLimits(data.dragX + d3.event.dx, limits.x);\n        els.style('transform', 'translateX(' + data.dragX + 'px)');\n      }\n      if (orientation === 'vertical') {\n        data.dragY += d3.event.dy;\n        data.dragX = withinLimits(data.dragY + d3.event.dy, limits.y);\n        els.style('transform', 'translateY(' + data.dragY + 'px)');\n      }\n    } else {\n      data.dragX += d3.event.dx;\n      data.dragY += d3.event.dy;\n      els.style('transform', 'translate(' + data.dragX + 'px,' + data.dragY + 'px)');\n    }\n  }\n\n  var SCROLLBAR_CLASS = 'scrollbar';\n\n  var Scrollbars = (function () {\n    function Scrollbars(baseSelection, visData, width) {\n      babelHelpers.classCallCheck(this, Scrollbars);\n\n      this.visData = visData;\n      this.width = width;\n\n      // Add empty scrollbar element\n      this.all = baseSelection.append('rect').attr('class', SCROLLBAR_CLASS).call(function (selection) {\n        selection.each(function setScrollBarDomElement() {\n          d3.select(this.parentNode).datum().scrollbar.el = this;\n        });\n      }).attr('x', function (data) {\n        return data.scrollbar.x - 2;\n      }).attr('y', function (data) {\n        return data.scrollbar.y;\n      }).attr('width', this.width).attr('height', function (data) {\n        return data.scrollbar.height;\n      }).attr('rx', this.width / 2).attr('ry', this.width / 2).classed('ready', true);\n    }\n\n    babelHelpers.createClass(Scrollbars, [{\n      key: 'updateVisibility',\n      value: function updateVisibility() {\n        this.all.transition().duration(TRANSITION_LIGHTNING_FAST).attr({\n          x: function x(data) {\n            return data.scrollbar.x;\n          },\n          height: function height(data) {\n            return data.scrollbar.height;\n          }\n        });\n      }\n    }]);\n    return Scrollbars;\n  })();\n\n  /** Used to determine if values are of the language type `Object`. */\n  var objectTypes = {\n    'function': true,\n    'object': true\n  };\n\n  /** Detect free variable `exports`. */\n  var freeExports = objectTypes[typeof exports] && exports && !exports.nodeType && exports;\n\n  /** Detect free variable `module`. */\n  var freeModule = objectTypes[typeof module] && module && !module.nodeType && module;\n\n  /** Detect free variable `global` from Node.js. */\n  var freeGlobal = freeExports && freeModule && typeof global == 'object' && global && global.Object && global;\n\n  /** Detect free variable `self`. */\n  var freeSelf = objectTypes[typeof self] && self && self.Object && self;\n\n  /** Detect free variable `window`. */\n  var freeWindow = objectTypes[typeof window] && window && window.Object && window;\n\n  /**\n   * Used as a reference to the global object.\n   *\n   * The `this` value is used if it's the global object to avoid Greasemonkey's\n   * restricted `window` object, otherwise the `window` object is used.\n   */\n  var root = freeGlobal || ((freeWindow !== (this && this.window)) && freeWindow) || freeSelf || this;\n\n  /* Native method references for those with the same name as other `lodash` methods. */\n  var nativeIsFinite = root.isFinite;\n\n  /**\n   * Checks if `value` is a finite primitive number.\n   *\n   * **Note:** This method is based on [`Number.isFinite`](http://ecma-international.org/ecma-262/6.0/#sec-number.isfinite).\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is a finite number, else `false`.\n   * @example\n   *\n   * _.isFinite(10);\n   * // => true\n   *\n   * _.isFinite('10');\n   * // => false\n   *\n   * _.isFinite(true);\n   * // => false\n   *\n   * _.isFinite(Object(10));\n   * // => false\n   *\n   * _.isFinite(Infinity);\n   * // => false\n   */\n  function isFinite(value) {\n    return typeof value == 'number' && nativeIsFinite(value);\n  }\n\n  /**\n   * Collect all cloned nodes, including the original node.\n   *\n   * @method  collectInclClones\n   * @author  Fritz Lekschas\n   * @date    2015-12-30\n   * @param   {Object}  node  Start node\n   * @return  {Array}         Array of original and cloned nodes.\n   */\n  function collectInclClones(node) {\n    var originalNode = node;\n\n    if (node.clone) {\n      originalNode = node.originalNode;\n    }\n\n    var clones = [originalNode];\n\n    if (originalNode.clones.length) {\n      clones = clones.concat(originalNode.clones);\n    }\n\n    return clones;\n  }\n\n  function up(node, callback, depth, includeClones, child) {\n    var nodesInclClones = includeClones ? collectInclClones(node) : [node];\n\n    for (var i = nodesInclClones.length; i--;) {\n      if (child) {\n        callback(nodesInclClones[i], child);\n      }\n\n      if (!isFinite(depth) || depth > 0) {\n        var parentsId = Object.keys(nodesInclClones[i].parents);\n        for (var j = parentsId.length; j--;) {\n          up(nodesInclClones[i].parents[parentsId[j]], callback, depth - 1, includeClones, nodesInclClones[i]);\n        }\n      }\n    }\n  }\n\n  function down(node, callback, depth, includeClones) {\n    var nodesInclClones = includeClones ? collectInclClones(node) : [node];\n\n    for (var i = nodesInclClones.length; i--;) {\n      callback(nodesInclClones[i]);\n\n      if (!isFinite(depth) || depth > 0) {\n        for (var j = nodesInclClones[i].childRefs.length; j--;) {\n          down(nodesInclClones[i].childRefs[j], callback, depth - 1, includeClones);\n        }\n      }\n    }\n  }\n\n  function upAndDown(node, callbackUp, callbackDown, depth, includeClones) {\n    if (callbackDown) {\n      up(node, callbackUp, depth, includeClones);\n      down(node, callbackDown, depth, includeClones);\n    } else {\n      up(node, callbackUp, depth, includeClones);\n      down(node, callbackUp, depth, includeClones);\n    }\n  }\n\n  function siblings(node, callback) {\n    var parentsId = Object.keys(node.parents);\n    for (var i = parentsId.length; i--;) {\n      for (var j = node.parents[parentsId[i]].childRefs.length; j--;) {\n        callback(node.parents[parentsId[i]].childRefs[j]);\n      }\n    }\n    // The root node doesn't have a `parents` property but might have `siblings`.\n    if (node.siblings) {\n      var siblingsId = Object.keys(node.siblings);\n      for (var i = siblingsId.length; i--;) {\n        callback(node.siblings[siblingsId[i]]);\n      }\n    }\n  }\n\n  /**\n   * Checks if `value` is the [language type](https://es5.github.io/#x8) of `Object`.\n   * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n   * @example\n   *\n   * _.isObject({});\n   * // => true\n   *\n   * _.isObject([1, 2, 3]);\n   * // => true\n   *\n   * _.isObject(1);\n   * // => false\n   */\n  function isObject(value) {\n    // Avoid a V8 JIT bug in Chrome 19-20.\n    // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.\n    var type = typeof value;\n    return !!value && (type == 'object' || type == 'function');\n  }\n\n  /** `Object#toString` result references. */\n  var funcTag = '[object Function]';\n\n  /** Used for native method references. */\n  var objectProto = Object.prototype;\n\n  /**\n   * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n   * of values.\n   */\n  var objToString = objectProto.toString;\n\n  /**\n   * Checks if `value` is classified as a `Function` object.\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n   * @example\n   *\n   * _.isFunction(_);\n   * // => true\n   *\n   * _.isFunction(/abc/);\n   * // => false\n   */\n  function isFunction(value) {\n    // The use of `Object#toString` avoids issues with the `typeof` operator\n    // in older versions of Chrome and Safari which return 'function' for regexes\n    // and Safari 8 which returns 'object' for typed array constructors.\n    return isObject(value) && objToString.call(value) == funcTag;\n  }\n\n  // Credits go to Mike Bostock: http://bl.ocks.org/mbostock/3468167\n  function roundRect(x, y, width, height, radius) {\n    var topLeft = radius.topLeft || 0;\n    var topRight = radius.topRight || 0;\n    var bottomLeft = radius.bottomLeft || 0;\n    var bottomRight = radius.bottomRight || 0;\n\n    return 'M' + (x + topLeft) + ',' + y + 'h' + (width - topLeft - topRight) + 'a' + topRight + ',' + topRight + ' 0 0 1 ' + topRight + ',' + topRight + 'v' + (height - (topRight + bottomRight)) + 'a' + bottomRight + ',' + bottomRight + ' 0 0 1 ' + -bottomRight + ',' + bottomRight + 'h' + (bottomLeft - (width - bottomRight)) + 'a' + bottomLeft + ',' + bottomLeft + ' 0 0 1 ' + -bottomLeft + ',' + -bottomLeft + 'v' + (topLeft - (height - bottomLeft)) + 'a' + topLeft + ',' + topLeft + ' 0 0 1 ' + topLeft + ',' + -topLeft + 'z';\n  }\n\n  var BAR_CLASS = 'bar';\n\n  var Bar = (function () {\n    function Bar(barGroup, barData, nodeData, visData, bars) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Bar);\n\n      this.data = barData;\n      this.nodeData = nodeData;\n      this.visData = visData;\n      this.bars = bars;\n\n      this.data.x = nodeData.x;\n      this.data.level = nodeData.depth;\n\n      this.height = this.visData.global.row.contentHeight / (this.data.length * 2) - this.visData.global.cell.padding * 2;\n\n      this.activeHeight = this.visData.global.row.contentHeight - 2;\n\n      this.inactiveheight = this.visData.global.cell.padding * 2 - 1;\n\n      this.selection = barGroup.selectAll(BAR_CLASS).data(this.data).enter().append('g').attr('class', function (data) {\n        return BAR_CLASS + ' ' + data.id;\n      }).classed('active', function (data) {\n        return data.id === _this.visData.nodes[_this.nodeData.depth].sortBy;\n      });\n\n      // Local helper method to avoid code duplication.\n      // Calling a class method from within the consructor is possible but `this`\n      // is not available. Thus, we need to create local function and pass in\n      // `this` as `that`, which feels very hacky but it works.\n      function setupMagnitude(selection) {\n        var _this2 = this;\n\n        var currentSorting = this.visData.nodes[this.nodeData.depth].sortBy;\n\n        selection.attr('d', function (data) {\n          return Bar.generatePath(data, _this2.bars.mode, currentSorting, _this2.visData);\n        }).classed('bar-magnitude', true);\n      }\n\n      function setupBorder(selection) {\n        selection.attr('x', 0).attr('y', this.visData.global.row.padding).attr('width', this.visData.global.column.contentWidth).attr('height', this.visData.global.row.contentHeight).attr('rx', 2).attr('ry', 2).classed('bar-border', true);\n      }\n\n      function setupIndicator(selection) {\n        selection.attr({\n          class: 'bar-indicator',\n          x: 0,\n          y: this.visData.global.row.padding,\n          width: 2,\n          height: 4\n        });\n      }\n\n      this.selection.append('rect').call(setupBorder.bind(this));\n\n      this.selection.append('path').call(setupMagnitude.bind(this));\n\n      this.selection.append('rect').call(setupIndicator.bind(this));\n    }\n\n    babelHelpers.createClass(Bar, null, [{\n      key: 'updateIndicator',\n      value: function updateIndicator(selection, contentWidth, contentHeight, referenceValue, lessTransitions, reference) {\n        var y = Math.min(contentWidth * Math.min(referenceValue, 1) - 1, contentWidth - 2);\n\n        // Stop previous transitions.\n        selection.attr({\n          height: contentHeight,\n          x: reference ? y : 0\n        }).classed('positive', function (data) {\n          return data.value >= referenceValue;\n        }).transition().duration(0).attr('width', reference ? 2 : lessTransitions ? y : 0 // eslint-disable-line no-nested-ternary\n        );\n\n        if (!lessTransitions && !reference) {\n          selection.transition().duration(TRANSITION_SEMI_FAST).attr('width', y);\n        }\n      }\n    }, {\n      key: 'generatePath',\n      value: function generatePath(data, mode, currentSorting, visData, indicator, adjustWidth, bottom) {\n        if (mode === 'two') {\n          return Bar.generateTwoBarsPath(data, visData, bottom);\n        }\n        return Bar.generateOneBarPath(data, currentSorting, visData, indicator, adjustWidth);\n      }\n    }, {\n      key: 'generateOneBarPath',\n      value: function generateOneBarPath(data, currentSorting, visData, indicator, adjustWidth) {\n        var height = visData.global.row.contentHeight;\n        var normValue = Math.min(data.value, 1);\n        var normIndicator = Math.min(indicator, 1);\n\n        var x = 0;\n        var width = 2;\n\n        var radius = {\n          topLeft: 2,\n          bottomLeft: 2\n        };\n\n        if (indicator) {\n          radius = {};\n        }\n\n        if (data.id !== currentSorting && typeof indicator === 'undefined') {\n          x = normValue * visData.global.column.contentWidth - 3;\n          radius = {};\n        } else if (indicator) {\n          x = normIndicator * visData.global.column.contentWidth;\n          if (adjustWidth) {\n            if (normValue < normIndicator) {\n              x = normValue * visData.global.column.contentWidth;\n            }\n            width = Math.max(Math.abs(normIndicator - normValue) * visData.global.column.contentWidth, 2);\n          }\n        } else {\n          width = visData.global.column.contentWidth * normValue;\n        }\n\n        x = Math.min(x, visData.global.column.contentWidth - 2);\n\n        return roundRect(x, visData.global.row.padding, width, height, radius);\n      }\n    }, {\n      key: 'generateTwoBarsPath',\n      value: function generateTwoBarsPath(data, visData, bottom) {\n        var normValue = Math.min(data.value, 1);\n        var height = visData.global.row.contentHeight / 2;\n        var width = visData.global.column.contentWidth * normValue;\n\n        var y = visData.global.row.padding;\n        var radius = { topLeft: 2 };\n\n        if (bottom) {\n          radius = { bottomLeft: 2 };\n          y += height;\n        }\n\n        return roundRect(0, y, width, height, radius);\n      }\n    }]);\n    return Bar;\n  })();\n\n  var BARS_CLASS = 'bars';\n\n  var Bars = (function () {\n    function Bars(vis, selection, mode, visData) {\n      babelHelpers.classCallCheck(this, Bars);\n\n      var that = this;\n\n      this.vis = vis;\n      this.mode = mode;\n      this.visData = visData;\n\n      this.selection = selection.append('g').attr('class', BARS_CLASS);\n\n      this.selection.each(function (datum) {\n        new Bar(d3.select(this), datum.data.bars, datum, that.visData, that);\n      });\n    }\n\n    babelHelpers.createClass(Bars, [{\n      key: 'updateAll',\n      value: function updateAll(update, sortBy) {\n        var _this = this;\n\n        this.selection.selectAll('.bar-magnitude').data(update, function (data) {\n          return data.barId;\n        }).transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n          return Bar.generatePath(data, _this.mode, sortBy, _this.visData);\n        });\n      }\n    }, {\n      key: 'update',\n      value: function update(selection, sortBy) {\n        var _this2 = this;\n\n        selection.each(function (data) {\n          var el = d3.select(this);\n\n          if (data.id === sortBy && !el.classed('active')) {\n            el.classed('active', true);\n            // Ensure that the active bars we are places before any other bar,\n            // thus placing them in the background\n            this.parentNode.insertBefore(this, this.parentNode.children[0]);\n          }\n\n          if (data.id !== sortBy) {\n            el.classed('active', false);\n          }\n        });\n\n        selection.selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n          return Bar.generatePath(data, _this2.mode, sortBy, _this2.visData);\n        });\n      }\n    }, {\n      key: 'updateIndicator',\n      value: function updateIndicator(bars, referenceValue, direct) {\n        Bar.updateIndicator(bars, this.visData.global.column.contentWidth, direct ? this.visData.global.row.contentHeight : 4, referenceValue, this.vis.lessTransitionsJs, direct);\n      }\n    }, {\n      key: 'switchMode',\n      value: function switchMode(mode, currentSorting) {\n        var _this3 = this;\n\n        if (this.mode !== mode) {\n          if (mode === 'one') {\n            if (currentSorting.global.type) {\n              this.selection.selectAll('.bar').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n                return Bar.generateOneBarPath(data, currentSorting.global.type, _this3.visData);\n              });\n            } else {\n              // console.error(\n              //   'Switching magnitude visualization after individual sorting is ' +\n              //   'not supported yet.'\n              // );\n            }\n          }\n\n          if (mode === 'two') {\n            this.selection.selectAll('.bar.precision').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n              return Bar.generateTwoBarsPath(data, _this3.visData);\n            });\n\n            this.selection.selectAll('.bar.recall').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n              return Bar.generateTwoBarsPath(data, _this3.visData, true);\n            });\n          }\n\n          this.mode = mode;\n        }\n      }\n    }]);\n    return Bars;\n  })();\n\n  var CLASS_NODES = 'nodes';\n  var CLASS_NODE = 'node';\n  var CLASS_CLONE = 'clone';\n  var CLASS_LABEL_WRAPPER = 'label-wrapper';\n  var CLASS_FOCUS_CONTROLS = 'focus-controls';\n  var CLASS_ROOT = 'root';\n  var CLASS_QUERY = 'query';\n  var CLASS_LOCK = 'lock';\n  var CLASS_ACTIVE = 'active';\n  var CLASS_INACTIVE = 'inactive';\n\n  var Nodes = (function () {\n    function Nodes(vis, baseSelection, visData, links, events) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Nodes);\n\n      var that = this;\n\n      // Helper\n      function drawFullSizeRect(selection, className, shrinking, noRoundBorder) {\n        var shrinkingAmount = shrinking ? shrinking : 0;\n\n        selection.attr('x', shrinkingAmount).attr('y', that.visData.global.row.padding + shrinkingAmount).attr('width', that.visData.global.column.contentWidth - 2 * shrinkingAmount).attr('height', that.visData.global.row.contentHeight - 2 * shrinkingAmount).attr('rx', noRoundBorder ? 0 : 2 - shrinkingAmount).attr('ry', noRoundBorder ? 0 : 2 - shrinkingAmount).classed(className, true);\n      }\n\n      this.vis = vis;\n      this.visData = visData;\n      this.links = links;\n      this.events = events;\n      this.currentLinks = {};\n      this.iconDimension = Math.min(this.visData.global.row.contentHeight / 2 - this.visData.global.cell.padding * 2, this.visData.global.column.padding / 2 - 4);\n\n      this.groups = baseSelection.append('g').attr('class', CLASS_NODES).call(function (selection) {\n        selection.each(function storeLinkToGroupNode() {\n          d3.select(this.parentNode).datum().nodes = this;\n        });\n      });\n\n      this.nodes = this.groups.selectAll('.' + CLASS_NODE).data(function (data) {\n        return data.rows;\n      }).enter().append('g').classed(CLASS_NODE, true).classed(CLASS_CLONE, function (data) {\n        return data.clone;\n      }).attr('transform', function (data) {\n        return 'translate(' + (data.x + _this.visData.global.column.padding) + ', ' + data.y + ')';\n      }).on('mouseenter', function (data) {\n        that.vis.interactionWrapper.call(that.vis, (function (domEl, _data) {\n          var el = d3.select(domEl);\n\n          if (!!!this.vis.activeScrollbar) {\n            this.enterHandler.call(this, domEl, _data);\n          }\n\n          if (!el.classed('rooted')) {\n            el.selectAll('.bg-extension').style('transform', 'translateX(' + (this.vis.querying ? -this.iconDimension * 2 - 10 : -this.iconDimension - 6) + 'px)');\n          }\n        }).bind(that), [this, data]);\n      }).on('mouseleave', function (data) {\n        that.vis.interactionWrapper.call(that.vis, (function (domEl, _data) {\n          var el = d3.select(domEl);\n\n          if (!!!this.vis.activeScrollbar) {\n            this.leaveHandler.call(this, domEl, _data);\n          }\n\n          if (!el.classed('rooted')) {\n            if (_data.data.queryMode) {\n              el.selectAll('.bg-extension').style('transform', 'translateX(' + (-this.iconDimension - 6) + 'px)');\n            } else {\n              el.selectAll('.bg-extension').style('transform', 'translateX(0px)');\n            }\n          }\n        }).bind(that), [this, data]);\n      });\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'bg-extension').attr('width', Math.max(this.visData.global.column.padding + this.visData.global.column.contentWidth / 2, this.visData.global.column.contentWidth));\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'bg-border');\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'bg', 1, true);\n\n      // Rooting icons\n      var nodeRooted = this.nodes.append('g').attr('class', CLASS_FOCUS_CONTROLS + ' ' + CLASS_ROOT + ' ' + CLASS_INACTIVE);\n\n      nodeRooted.append('rect').call(this.setUpFocusControls.bind(this), 'left', this.vis.querying ? 2 : 1, 'hover-helper', 'hover-helper');\n\n      nodeRooted.append('svg').call(this.setUpFocusControls.bind(this), 'left', this.vis.querying ? 2 : 1, 'icon', 'ease-all state-inactive invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#unlocked');\n\n      nodeRooted.append('svg').call(this.setUpFocusControls.bind(this), 'left', this.vis.querying ? 2 : 1, 'icon', 'ease-all state-active invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#locked');\n\n      // Querying icons\n      if (this.vis.querying) {\n        var nodeQuery = this.nodes.append('g').attr('class', CLASS_FOCUS_CONTROLS + ' ' + CLASS_QUERY + ' ' + CLASS_INACTIVE);\n\n        nodeQuery.append('rect').call(this.setUpFocusControls.bind(this), 'left', 1, 'hover-helper', 'hover-helper');\n\n        nodeQuery.append('svg').call(this.setUpFocusControls.bind(this), 'left', 1, 'icon', 'ease-all state-inactive invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#set-inactive');\n\n        nodeQuery.append('svg').call(this.setUpFocusControls.bind(this), 'left', 1, 'icon', 'ease-all state-and-or invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#union');\n\n        nodeQuery.append('svg').call(this.setUpFocusControls.bind(this), 'left', 1, 'icon', 'ease-all state-not invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#not');\n      }\n\n      var nodeLocks = this.nodes.append('g').attr('class', CLASS_FOCUS_CONTROLS + ' ' + CLASS_LOCK + ' ' + CLASS_INACTIVE);\n\n      nodeLocks.append('circle').call(this.setUpFocusControls.bind(this), 'right', 0, 'bg', 'bg');\n\n      nodeLocks.append('svg').call(this.setUpFocusControls.bind(this), 'right', 0, 'icon', 'ease-all state-inactive invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#unlocked');\n\n      nodeLocks.append('svg').call(this.setUpFocusControls.bind(this), 'right', 0, 'icon', 'ease-all state-active invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#locked');\n\n      this.bars = new Bars(this.vis, this.nodes, this.vis.barMode, this.visData);\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'border');\n\n      // Add node label\n      this.nodes.append('foreignObject').attr('x', this.visData.global.cell.padding).attr('y', this.visData.global.row.padding + this.visData.global.cell.padding).attr('width', this.visData.global.column.contentWidth).attr('height', this.visData.global.row.contentHeight - this.visData.global.cell.padding * 2).attr('class', CLASS_LABEL_WRAPPER).append('xhtml:div').attr('class', 'label').attr('title', function (data) {\n        return data.data.name;\n      }).style('line-height', this.visData.global.row.contentHeight - this.visData.global.cell.padding * 2 + 'px').append('xhtml:span').text(function (data) {\n        return data.data.name;\n      });\n\n      if (isFunction(this.events.on)) {\n        // this.events.on('d3ListGraphNodeClick', dataSetIds => {\n        //   console.log('d3ListGraphNodeClick', dataSetIds);\n        // });\n\n        this.events.on('d3ListGraphFocusNodes', function (event) {\n          return _this.focusNodes(event);\n        });\n\n        this.events.on('d3ListGraphBlurNodes', function (event) {\n          return _this.blurNodes(event);\n        });\n\n        this.events.on('d3ListGraphNodeEnter', function (nodeIds) {\n          return _this.eventHelper(nodeIds, _this.highlightNodes);\n        });\n\n        this.events.on('d3ListGraphNodeLeave', function (nodeIds) {\n          return _this.eventHelper(nodeIds, _this.unhighlightNodes);\n        });\n\n        this.events.on('d3ListGraphNodeLock', function (nodeIds) {\n          return _this.eventHelper(nodeIds, _this.toggleLock, [], '.lock');\n        });\n\n        this.events.on('d3ListGraphNodeUnlock', function (nodeIds) {\n          return _this.eventHelper(nodeIds, _this.toggleLock, [true], '.lock');\n        });\n\n        this.events.on('d3ListGraphNodeRoot', function (data) {\n          return _this.eventHelper(data.nodeIds, _this.toggleRoot, [], '.root');\n        });\n\n        this.events.on('d3ListGraphNodeUnroot', function (data) {\n          return _this.eventHelper(data.nodeIds, _this.toggleRoot, [true], '.root');\n        });\n      }\n    }\n\n    babelHelpers.createClass(Nodes, [{\n      key: 'clickHandler',\n      value: function clickHandler(el, data) {\n        this.toggleQueryMode(el.parentNode, data);\n        // this.events.broadcast('d3ListGraphNodeClick', { id: data.id });\n      }\n    }, {\n      key: 'enterHandler',\n      value: function enterHandler(el, data) {\n        this.highlightNodes(el, data);\n\n        var eventData = {\n          id: data.id,\n          clone: false,\n          clonedFromId: undefined\n        };\n\n        if (data.clone) {\n          eventData.clone = true;\n          eventData.clonedFromId = data.originalNode.id;\n        }\n\n        this.events.broadcast('d3ListGraphNodeEnter', eventData);\n      }\n    }, {\n      key: 'leaveHandler',\n      value: function leaveHandler(el, data) {\n        this.unhighlightNodes(el, data);\n\n        var eventData = {\n          id: data.id,\n          clone: false,\n          clonedFromId: undefined\n        };\n\n        if (data.clone) {\n          eventData.clone = true;\n          eventData.clonedFromId = data.originalNode.id;\n        }\n\n        this.events.broadcast('d3ListGraphNodeLeave', eventData);\n      }\n    }, {\n      key: 'lockHandler',\n      value: function lockHandler(el) {\n        var events = this.toggleLock(el);\n\n        if (events.locked && events.unlocked) {\n          if (events.locked) {\n            this.events.broadcast('d3ListGraphNodeLockChange', {\n              lock: {\n                id: events.locked.id,\n                clone: events.locked.clone,\n                clonedFromId: events.locked.clone ? events.locked.originalNode.id : undefined\n              },\n              unlock: {\n                id: events.unlocked.id,\n                clone: events.unlocked.clone,\n                clonedFromId: events.unlocked.clone ? events.unlocked.originalNode.id : undefined\n              }\n            });\n          }\n        } else {\n          if (events.locked) {\n            this.events.broadcast('d3ListGraphNodeLock', {\n              id: events.locked.id,\n              clone: events.locked.clone,\n              clonedFromId: events.locked.clone ? events.locked.originalNode.id : undefined\n            });\n          }\n\n          if (events.unlocked) {\n            this.events.broadcast('d3ListGraphNodeUnlock', {\n              id: events.unlocked.id,\n              clone: events.unlocked.clone,\n              clonedFromId: events.unlocked.clone ? events.unlocked.originalNode.id : undefined\n            });\n          }\n        }\n      }\n    }, {\n      key: 'rootHandler',\n      value: function rootHandler(el) {\n        var events = this.toggleRoot(el);\n\n        if (events.rooted && events.unrooted) {\n          this.events.broadcast('d3ListGraphNodeReroot', {\n            rooted: {\n              id: events.rooted.id,\n              clone: events.rooted.clone,\n              clonedFromId: events.rooted.clone ? events.rooted.originalNode.id : undefined\n            },\n            unrooted: {\n              id: events.unrooted.id,\n              clone: events.unrooted.clone,\n              clonedFromId: events.unrooted.clone ? events.unrooted.originalNode.id : undefined\n            }\n          });\n        } else {\n          if (events.rooted) {\n            this.events.broadcast('d3ListGraphNodeRoot', {\n              id: events.rooted.id,\n              clone: events.rooted.clone,\n              clonedFromId: events.rooted.clone ? events.rooted.originalNode.id : undefined\n            });\n          }\n\n          if (events.unrooted) {\n            this.events.broadcast('d3ListGraphNodeUnroot', {\n              id: events.unrooted.id,\n              clone: events.unrooted.clone,\n              clonedFromId: events.unrooted.clone ? events.unrooted.originalNode.id : undefined\n            });\n          }\n        }\n\n        this.events.broadcast('d3ListGraphUpdateBarsRequest', {\n          id: events.rooted.id,\n          clone: events.rooted.clone,\n          clonedFromId: events.rooted.clone ? events.rooted.originalNode.id : undefined\n        });\n      }\n    }, {\n      key: 'focusNodes',\n      value: function focusNodes(event) {\n        this.eventHelper(event.nodeIds, this.highlightNodes, ['focus', 'directParentsOnly', !!event.excludeClones ? true : false]);\n        if (event.zoomOut) {\n          this.vis.globalView(this.nodes.filter(function (data) {\n            return data.hovering > 0;\n          }));\n        } else {\n          this.vis.zoomedView();\n        }\n      }\n    }, {\n      key: 'blurNodes',\n      value: function blurNodes(event) {\n        this.eventHelper(event.nodeIds, this.unhighlightNodes, ['focus', 'directParentsOnly', !!event.excludeClones ? true : false]);\n        if (event.zoomIn) {\n          this.vis.zoomedView();\n        }\n      }\n    }, {\n      key: 'eventHelper',\n      value: function eventHelper(nodeIds, callback, optionalParams, subSelectionClass) {\n        var that = this;\n\n        this.nodes\n        // Filter by node ID\n        .filter(function (data) {\n          return !! ~nodeIds.indexOf(data.id);\n        }).each(function triggerCallback(data) {\n          var el = this;\n\n          if (subSelectionClass) {\n            el = d3.select(this).select(subSelectionClass).node();\n          }\n\n          callback.apply(that, [el, data].concat(optionalParams ? optionalParams : []));\n        });\n      }\n    }, {\n      key: 'toggleLock',\n      value: function toggleLock(el, nodeData, setFalse) {\n        var d3El = d3.select(el);\n        var data = d3El.datum();\n        var events = { locked: false, unlocked: false };\n\n        if (this.lockedNode) {\n          this.lockedNode.classed(CLASS_ACTIVE, false).classed(CLASS_INACTIVE, true);\n          if (this.lockedNode.datum().id === data.id) {\n            this.unlockNode(this.lockedNode.datum().id);\n            events.unlocked = this.lockedNode.datum();\n            this.lockedNode = undefined;\n          } else {\n            // Reset previously locked node;\n            this.unlockNode(this.lockedNode.datum().id);\n            events.unlocked = this.lockedNode.datum();\n\n            if (!setFalse) {\n              d3El.classed(CLASS_ACTIVE, true).classed(CLASS_INACTIVE, false);\n              this.lockNode(data.id);\n              events.locked = data;\n              this.lockedNode = d3El;\n            }\n          }\n        } else {\n          if (!setFalse) {\n            d3El.classed(CLASS_ACTIVE, true).classed(CLASS_INACTIVE, false);\n            this.lockNode(data.id);\n            events.locked = data;\n            this.lockedNode = d3El;\n          }\n        }\n\n        return events;\n      }\n    }, {\n      key: 'lockNode',\n      value: function lockNode(id) {\n        var that = this;\n        var els = this.nodes.filter(function (data) {\n          return data.id === id;\n        });\n\n        els.each(function triggerHighlighter(data) {\n          that.highlightNodes(this, data, 'lock', undefined);\n        });\n\n        els.selectAll('.bg-border').transition().duration(TRANSITION_SEMI_FAST).attr('width', function width() {\n          return parseInt(d3.select(this).attr('width'), 10) + that.visData.global.row.height / 2;\n        });\n      }\n    }, {\n      key: 'unlockNode',\n      value: function unlockNode(id) {\n        var that = this;\n        var els = this.nodes.filter(function (data) {\n          return data.id === id;\n        });\n        var start = function animationStart() {\n          d3.select(this.parentNode).classed('animating', true);\n        };\n        var end = function animationEnd() {\n          d3.select(this.parentNode).classed('animating', false);\n        };\n\n        els.selectAll('.bg-border').transition().duration(TRANSITION_SEMI_FAST).attr('width', this.visData.global.column.contentWidth).each('start', start).each('end', end);\n\n        els.each(function (data) {\n          that.unhighlightNodes(this, data, 'lock', undefined);\n        });\n      }\n    }, {\n      key: 'queryNode',\n      value: function queryNode(el, data, mode) {\n        data.data.queryMode = mode;\n        d3.select(el).classed({\n          active: true,\n          inactive: false,\n          'query-and': mode === 'and' ? true : false,\n          'query-or': mode === 'or' ? true : false,\n          'query-not': mode === 'not' ? true : false\n        });\n      }\n    }, {\n      key: 'unqueryNode',\n      value: function unqueryNode(el, data) {\n        data.data.queryMode = undefined;\n        data.data.queryBeforeRooting = undefined;\n        d3.select(el).classed({\n          active: false,\n          inactive: true,\n          'query-and': false,\n          'query-or': false,\n          'query-not': false\n        });\n        if (this.rootedNode) {\n          this.updateVisibility();\n        }\n      }\n    }, {\n      key: 'toggleQueryMode',\n      value: function toggleQueryMode(el, data) {\n        var previousMode = data.data.queryMode;\n\n        if (data.rooted) {\n          if (previousMode !== 'or') {\n            this.queryNode(el, data, 'or');\n          } else {\n            this.queryNode(el, data, 'and');\n          }\n        } else {\n          switch (previousMode) {\n            case 'or':\n              this.queryNode(el, data, 'and');\n              break;\n            case 'and':\n              this.queryNode(el, data, 'not');\n              break;\n            case 'not':\n              this.unqueryNode(el, data);\n              break;\n            default:\n              this.queryNode(el, data, 'or');\n              break;\n          }\n        }\n\n        if (data.data.queryMode) {\n          if (data.data.queryMode !== previousMode) {\n            this.events.broadcast('d3ListGraphNodeQuery', {\n              id: data.id,\n              clone: data.clone,\n              clonedFromId: data.clone ? data.originalNode.id : undefined,\n              mode: data.data.queryMode\n            });\n          }\n        } else {\n          this.events.broadcast('d3ListGraphNodeUnquery', {\n            id: data.id,\n            clone: data.clone,\n            clonedFromId: data.clone ? data.originalNode.id : undefined\n          });\n        }\n      }\n    }, {\n      key: 'progToggleQueryMode',\n      value: function progToggleQueryMode(el, data) {\n        this.toggleQueryMode(d3.select(el).selectAll('.focus-controls.query')[0].node(), data);\n      }\n    }, {\n      key: 'toggleRoot',\n      value: function toggleRoot(el, setFalse) {\n        var d3El = d3.select(el);\n        var data = d3El.datum();\n        var events = { rooted: false, unrooted: false };\n\n        // Blur current levels\n        this.vis.levels.blur();\n\n        if (this.rootedNode) {\n          // Reset current root node\n          this.rootedNode.classed({ active: false, inactive: true });\n          this.unrootNode(this.rootedNode.node(), this.rootedNode.datum());\n          events.unrooted = this.rootedNode.datum();\n\n          // Activate new root\n          if (this.rootedNode.datum().id !== data.id && !setFalse) {\n            d3El.classed({ active: true, inactive: false });\n            this.rootNode(el, data);\n            this.rootedNode = d3El;\n            events.rooted = data;\n          } else {\n            this.rootedNode = undefined;\n            // Highlight first level\n            this.vis.levels.focus(this.vis.activeLevel - this.vis.noRootActiveLevelDiff);\n          }\n        } else {\n          if (!setFalse) {\n            d3El.classed({ active: true, inactive: false });\n            this.rootNode(el, data);\n            events.rooted = data;\n            this.rootedNode = d3El;\n          }\n        }\n\n        return events;\n      }\n    }, {\n      key: 'rootNode',\n      value: function rootNode(el, data) {\n        var d3El = d3.select(el.parentNode);\n\n        data.rooted = true;\n        d3El.classed('rooted', true);\n        this.hideNodes(d3El.node(), data, 'downStream');\n\n        d3El.selectAll('.bg-extension').style('transform', 'translateX(' + (this.vis.querying ? -this.iconDimension * 2 - 10 : -this.iconDimension - 6) + 'px)');\n\n        // Highlight level\n        this.vis.levels.focus(data.depth + this.vis.activeLevel);\n\n        if (!data.data.queryMode || data.data.queryMode === 'not') {\n          this.toggleQueryMode(d3El.node(), data);\n          data.data.queryBeforeRooting = false;\n        } else {\n          data.data.queryBeforeRooting = true;\n        }\n      }\n    }, {\n      key: 'unrootNode',\n      value: function unrootNode(el, data) {\n        var d3El = d3.select(el.parentNode);\n\n        var x = 0;\n\n        if (data.data.queryMode) {\n          x = -this.iconDimension - 6;\n        }\n\n        d3El.selectAll('.bg-extension').style('transform', 'translateX(' + x + 'px)');\n\n        data.rooted = false;\n        d3El.classed('rooted', false);\n        this.showNodes(d3El.node(), data, 'downStream');\n\n        if (!data.data.queryBeforeRooting) {\n          this.unqueryNode(d3El.node(), data);\n        }\n      }\n    }, {\n      key: 'setUpFocusControls',\n      value: function setUpFocusControls(selection, location, position, mode, className) {\n        // const height = (this.visData.global.row.contentHeight / 2 -\n        //   this.visData.global.cell.padding * 2);\n\n        var paddedDim = this.iconDimension + 4;\n\n        var x = location === 'left' ? -paddedDim * (position ? position : 1) : this.visData.global.column.contentWidth + 2;\n        var y = this.visData.global.row.padding + (this.visData.global.row.contentHeight - 2 * this.visData.global.cell.padding) / 4;\n\n        if (mode === 'bg') {\n          selection.attr({\n            class: className,\n            cx: x + this.iconDimension / 2,\n            cy: y + this.iconDimension / 2,\n            r: this.iconDimension * 3 / 4\n          });\n        } else if (mode === 'hover-helper') {\n          selection.attr({\n            class: className,\n            x: x - 2,\n            y: y - 2,\n            width: this.iconDimension + 4,\n            height: this.iconDimension + 4\n          });\n        } else {\n          selection.attr({\n            class: className,\n            x: x,\n            y: y,\n            width: this.iconDimension,\n            height: this.iconDimension\n          });\n        }\n      }\n\n      /**\n       * Helper method to hide nodes.\n       *\n       * @method  hideNodes\n       * @author  Fritz Lekschas\n       * @date    2016-02-21\n       * @param   {Object}  el         DOM element.\n       * @param   {Object}  data       D3 data object of `el`.\n       * @param   {String}  direction  Defines whether upstream or downstream nodes\n       *   should be hidden.\n       */\n\n    }, {\n      key: 'hideNodes',\n      value: function hideNodes(el, data, direction) {\n        this.nodesVisibility(el, data, direction);\n      }\n\n      /**\n       * Helper method to show nodes.\n       *\n       * @method  showNodes\n       * @author  Fritz Lekschas\n       * @date    2016-02-21\n       * @param   {Object}  el         DOM element.\n       * @param   {Object}  data       D3 data object of `el`.\n       * @param   {String}  direction  Defines whether upstream or downstream nodes\n       *   should be shown.\n       */\n\n    }, {\n      key: 'showNodes',\n      value: function showNodes(el, data, direction) {\n        this.nodesVisibility(el, data, direction, true);\n      }\n\n      /**\n       * Sets the nodes' visibility\n       *\n       * @method  nodesVisibility\n       * @author  Fritz Lekschas\n       * @date    2016-02-21\n       * @param   {Object}   el         DOM element.\n       * @param   {Object}   data       D3 data object of `el`.\n       * @param   {String}   direction  Defines whether upstream or downstream nodes\n       * @param   {Boolean}  show       If `true` nodes will be shown.\n       */\n\n    }, {\n      key: 'nodesVisibility',\n      value: function nodesVisibility(el, data, direction, show) {\n        if (show) {\n          this.nodes.classed('hidden', false).each(function (nodeData) {\n            return nodeData.hidden = false;\n          });\n        } else {\n          // First we set all nodes to `hidden`.\n          this.nodes.each(function (nodeData) {\n            return nodeData.hidden = true;\n          });\n\n          // Then we set direct child and parent nodes of the current node visible.\n          upAndDown(data, function (nodeData) {\n            return nodeData.hidden = false;\n          });\n\n          // We also show sibling nodes.\n          siblings(data, function (nodeData) {\n            return nodeData.hidden = false;\n          });\n\n          this.nodes.classed('hidden', function (nodeData) {\n            return nodeData.hidden && !nodeData.data.queryMode;\n          });\n        }\n        this.updateVisibility();\n      }\n    }, {\n      key: 'highlightNodes',\n      value: function highlightNodes(el, data, className, restriction, excludeClones) {\n        var _this2 = this;\n\n        var that = this;\n        var nodeId = data.id;\n        var currentNodeData = data.clone ? data.originalNode : data;\n        var includeParents = true;\n        var appliedClassName = className ? className : 'hovering';\n        var includeClones = excludeClones ? false : true;\n        var includeChildren = restriction === 'directParentsOnly' ? false : true;\n\n        // Store link IDs\n        if (!this.currentLinks[appliedClassName]) {\n          this.currentLinks[appliedClassName] = {};\n        }\n        this.currentLinks[appliedClassName][nodeId] = {};\n\n        var currentlyActiveBar = d3.select(el).selectAll('.bar.active .bar-magnitude');\n        if (!currentlyActiveBar.empty()) {\n          currentlyActiveBar = currentlyActiveBar.datum();\n        } else {\n          currentlyActiveBar = undefined;\n        }\n\n        var traverseCallbackUp = function traverseCallbackUp(nodeData, childData) {\n          nodeData.hovering = 2;\n          for (var i = nodeData.links.length; i--;) {\n            // Only push direct parent child connections. E.g.\n            // Store: (parent)->(child)\n            // Ignore: (parent)->(siblings of child)\n            if (nodeData.links[i].target.node.id === childData.id) {\n              _this2.currentLinks[appliedClassName][nodeId][nodeData.links[i].id] = true;\n            }\n          }\n        };\n\n        var traverseCallbackDown = function traverseCallbackDown(nodeData) {\n          nodeData.hovering = 2;\n          for (var i = nodeData.links.length; i--;) {\n            _this2.currentLinks[appliedClassName][nodeId][nodeData.links[i].id] = true;\n          }\n        };\n\n        if (includeParents && includeChildren) {\n          upAndDown(data, traverseCallbackUp, traverseCallbackDown, undefined, includeClones);\n        }\n        if (includeParents && !includeChildren) {\n          up(data, traverseCallbackUp, undefined, includeClones);\n        }\n        if (!includeParents && includeChildren) {\n          down(data, traverseCallbackUp, undefined, includeClones);\n        }\n\n        currentNodeData.hovering = 1;\n\n        if (includeClones) {\n          for (var i = currentNodeData.clones.length; i--;) {\n            currentNodeData.clones[i].hovering = 1;\n          }\n        }\n\n        /**\n         * Helper method to assess the node visibility.\n         *\n         * @method  checkNodeVisibility\n         * @author  Fritz Lekschas\n         * @date    2016-02-25\n         * @param   {Object}  _el    [description]\n         * @param   {Object}  _data  [description]\n         * @return  {Boolean}        If `true` element is hidden.\n         */\n        function checkNodeVisibility(_el, _data) {\n          return !_data.hidden && !that.vis.isHidden.call(that.vis, _el);\n        }\n\n        /**\n         * Helper method to filter out directly hovered nodes.\n         *\n         * @method  checkNodeDirect\n         * @author  Fritz Lekschas\n         * @date    2016-02-25\n         * @param   {Object}  nodeData  The node's data object.\n         * @return  {Boolean}           If `true` element will not be filtered out.\n         */\n        function checkNodeDirect(nodeData) {\n          return nodeData.hovering === 1 && checkNodeVisibility(this, nodeData);\n        }\n\n        /**\n         * Helper method to filter out indirectly hovered nodes.\n         *\n         * @method  checkNodeIndirect\n         * @author  Fritz Lekschas\n         * @date    2016-02-25\n         * @param   {Object}  nodeData  The node's data object.\n         * @return  {Boolean}           If `true` element will not be filtered out.\n         */\n        function checkNodeIndirect(nodeData) {\n          return nodeData.hovering === 2 && checkNodeVisibility(this, nodeData);\n        }\n\n        /**\n         * Helper method to update bar indicators of the directly hovered node and\n         * clones.\n         *\n         * @method  updateDirectBarIndicator\n         * @author  Fritz Lekschas\n         * @date    2016-02-25\n         * @param   {Object}  selection  D3 node selection.\n         */\n        function updateDirectBarIndicator(selection) {\n          that.bars.updateIndicator(selection, currentlyActiveBar.value, true);\n        }\n\n        /**\n         * Helper method to update bar indicators of the indirectly hovered nodes.\n         *\n         * @method  updateDirectBarIndicator\n         * @author  Fritz Lekschas\n         * @date    2016-02-25\n         * @param   {Object}  selection  D3 node selection.\n         */\n        function updateIndirectBarIndicator(selection) {\n          that.bars.updateIndicator(selection, currentlyActiveBar.value);\n        }\n\n        var barIndicatorClass = currentlyActiveBar ? '.bar.' + currentlyActiveBar.id + ' .bar-indicator' : '';\n        var directNodes = this.nodes.filter(checkNodeDirect).classed(appliedClassName + '-directly', true);\n        var indirectNodes = this.nodes.filter(checkNodeIndirect).classed(appliedClassName + '-indirectly', true);\n\n        if (currentlyActiveBar) {\n          directNodes.select(barIndicatorClass).call(updateDirectBarIndicator);\n          indirectNodes.select(barIndicatorClass).call(updateIndirectBarIndicator);\n        }\n\n        this.links.highlight(this.currentLinks[appliedClassName][data.id], true, appliedClassName);\n      }\n    }, {\n      key: 'unhighlightNodes',\n      value: function unhighlightNodes(el, data, className, restriction, excludeClones) {\n        var traverseCallback = function traverseCallback(nodeData) {\n          return nodeData.hovering = 0;\n        };\n        var includeParents = true;\n        var appliedClassName = className ? className : 'hovering';\n        var includeClones = excludeClones ? false : true;\n        var includeChildren = restriction === 'directParentsOnly' ? false : true;\n\n        data.hovering = 0;\n        if (includeParents && includeChildren) {\n          upAndDown(data, traverseCallback, undefined, undefined, includeClones);\n        }\n        if (includeParents && !includeChildren) {\n          up(data, traverseCallback, undefined, includeClones);\n        }\n        if (!includeParents && includeChildren) {\n          down(data, traverseCallback, undefined, includeClones);\n        }\n\n        if (data.clone) {\n          data.originalNode.hovering = 0;\n        } else {\n          if (includeClones) {\n            for (var i = data.clones.length; i--;) {\n              data.clones[i].hovering = 0;\n            }\n          }\n        }\n\n        this.nodes.classed(appliedClassName + '-directly', false);\n        this.nodes.classed(appliedClassName + '-indirectly', false);\n\n        if (this.currentLinks[appliedClassName][data.id]) {\n          this.links.highlight(this.currentLinks[appliedClassName][data.id], false, appliedClassName);\n        }\n      }\n    }, {\n      key: 'sort',\n      value: function sort(update, newSortType) {\n        var _this3 = this;\n\n        for (var i = update.length; i--;) {\n          var selection = this.nodes.data(update[i].rows, function (data) {\n            return data.id;\n          });\n\n          this.vis.svgD3.classed('sorting', true);\n          selection.transition().duration(TRANSITION_SEMI_FAST).attr('transform', function (data) {\n            return 'translate(' + (data.x + _this3.visData.global.column.padding) + ', ' + data.y + ')';\n          }).call(allTransitionsEnded, function () {\n            _this3.vis.svgD3.classed('sorting', false);\n            _this3.vis.updateLevelsVisibility();\n            _this3.vis.updateScrolling();\n          });\n\n          if (newSortType && this.vis.currentSorting.local[update[i].level].type !== 'name') {\n            this.bars.update(selection.selectAll('.bar'), update[i].sortBy);\n          }\n        }\n      }\n\n      /**\n       * Updates the nodes' visibility visually.\n       *\n       * @method  updateVisibility\n       * @author  Fritz Lekschas\n       * @date    2016-02-21\n       */\n\n    }, {\n      key: 'updateVisibility',\n      value: function updateVisibility() {\n        var _this4 = this;\n\n        // Calls the D3 list graph layout method to update the nodes position.\n        this.vis.layout.updateNodesVisibility();\n\n        // Transition to the updated position\n        this.nodes.transition().duration(TRANSITION_SEMI_FAST).attr('transform', function (data) {\n          return 'translate(' + (data.x + _this4.visData.global.column.padding) + ', ' + data.y + ')';\n        }).call(allTransitionsEnded, function () {\n          _this4.vis.updateLevelsVisibility();\n          _this4.vis.updateScrolling();\n        });\n\n        this.vis.links.updateVisibility();\n      }\n    }, {\n      key: 'classNnodes',\n      get: function get() {\n        return CLASS_NODES;\n      }\n    }, {\n      key: 'classNode',\n      get: function get() {\n        return CLASS_NODE;\n      }\n    }, {\n      key: 'classClone',\n      get: function get() {\n        return CLASS_CLONE;\n      }\n    }, {\n      key: 'classLabelWrapper',\n      get: function get() {\n        return CLASS_LABEL_WRAPPER;\n      }\n    }, {\n      key: 'classFocusControls',\n      get: function get() {\n        return CLASS_FOCUS_CONTROLS;\n      }\n    }, {\n      key: 'classRoot',\n      get: function get() {\n        return CLASS_ROOT;\n      }\n    }, {\n      key: 'classQuery',\n      get: function get() {\n        return CLASS_QUERY;\n      }\n    }, {\n      key: 'classLock',\n      get: function get() {\n        return CLASS_LOCK;\n      }\n    }, {\n      key: 'barMode',\n      get: function get() {\n        return this.bars.mode;\n      }\n    }]);\n    return Nodes;\n  })();\n\n  var LINKS_CLASS = 'links';\n  var LINK_CLASS = 'link';\n\n  var Links = (function () {\n    function Links(levels, visData, layout) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Links);\n\n      this.visData = visData;\n      this.layout = layout;\n\n      this.groups = levels.append('g').attr('class', LINKS_CLASS).call(function (selection) {\n        selection.each(function () {\n          d3.select(this.parentNode).datum().links = this;\n        });\n      });\n\n      this.links = this.groups.selectAll(LINK_CLASS + '-bg').data(function (data, index) {\n        return _this.layout.links(index);\n      }).enter().append('g').attr('class', LINK_CLASS);\n\n      this.links.append('path').attr({\n        class: LINK_CLASS + '-bg',\n        d: this.diagonal\n      });\n\n      this.links.append('path').attr({\n        class: LINK_CLASS + '-direct',\n        d: this.diagonal\n      });\n    }\n\n    babelHelpers.createClass(Links, [{\n      key: 'highlight',\n      value: function highlight(nodeIds, _highlight, className) {\n        this.links.filter(function (data) {\n          return nodeIds[data.id];\n        }).classed(className, _highlight);\n      }\n    }, {\n      key: 'scroll',\n      value: function scroll(selection, data) {\n        // Update data of `g`.\n        selection.data(data);\n\n        // Next update all paths according to the new data.\n        selection.selectAll('path').attr('d', this.diagonal);\n      }\n    }, {\n      key: 'sort',\n      value: function sort(update) {\n        var start = function start() {\n          d3.select(this).classed('sorting', true);\n        };\n        var end = function end() {\n          d3.select(this).classed('sorting', false);\n        };\n\n        // Update data of `g`.\n        this.links.data(update, function (data) {\n          return data.id;\n        });\n\n        // Next update all paths according to the new data.\n        this.links.selectAll('path').transition().duration(TRANSITION_SEMI_FAST).attr('d', this.diagonal).each('start', start).each('end', end);\n      }\n    }, {\n      key: 'updateVisibility',\n      value: function updateVisibility() {\n        this.links.selectAll('path').classed('hidden', function (data) {\n          return data.target.node.hidden || data.source.node.hidden;\n        }).transition().duration(TRANSITION_SEMI_FAST).attr('d', this.diagonal);\n      }\n    }, {\n      key: 'diagonal',\n      get: function get() {\n        var _this2 = this;\n\n        return d3.svg.diagonal().source(function (data) {\n          return {\n            x: data.source.node.y + data.source.offsetY + _this2.visData.global.row.height / 2,\n            y: data.source.node.x + data.source.offsetX + _this2.visData.global.column.contentWidth + _this2.visData.global.column.padding\n          };\n        }).target(function (data) {\n          return {\n            x: data.target.node.y + data.target.offsetY + _this2.visData.global.row.height / 2,\n            y: data.target.node.x + data.target.offsetX + _this2.visData.global.column.padding\n          };\n        }).projection(function (data) {\n          return [data.y, data.x];\n        });\n      }\n    }]);\n    return Links;\n  })();\n\n  var COLUMN_CLASS = 'column';\n  var SCROLL_CONTAINER_CLASS = 'scroll-container';\n\n  var Levels = (function () {\n    function Levels(selection, vis, visData) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Levels);\n\n      this.vis = vis;\n      this.visData = visData;\n      this.groups = selection.selectAll('g').data(this.visData.nodes).enter().append('g').attr('class', COLUMN_CLASS).classed('active', function (data, index) {\n        if (_this.vis.highlightActiveLevel) {\n          if (!_this.vis.nodes || !_this.vis.nodes.rootedNode) {\n            return index === _this.vis.activeLevel - _this.vis.noRootActiveLevelDiff;\n          }\n          return index === _this.vis.activeLevel;\n        }\n      });\n\n      // We need to add an empty rectangle that fills up the whole column to ensure\n      // that the `g`'s size is at a maximum, otherwise scrolling will be halted\n      // when the cursor leaves an actually drawn element.\n      this.groups.append('rect').attr('class', SCROLL_CONTAINER_CLASS).attr('x', function (data) {\n        return data.x;\n      }).attr('y', function (data) {\n        return data.y;\n      }).attr('width', this.visData.global.column.width + 1).attr('height', this.visData.global.column.height);\n    }\n\n    babelHelpers.createClass(Levels, [{\n      key: 'scrollPreparation',\n      value: function scrollPreparation(vis, scrollbarWidth) {\n        var _this2 = this;\n\n        this.groups.each(function (data, index) {\n          var contentHeight = data.nodes.getBoundingClientRect().height + 2 * _this2.visData.global.row.padding;\n          var scrollHeight = contentHeight - _this2.visData.global.column.height;\n          var scrollbarHeight = scrollHeight > 0 ? Math.max(_this2.visData.global.column.height * _this2.visData.global.column.height / contentHeight, 10) : 0;\n\n          data.height = contentHeight;\n          data.linkSelections = {\n            incoming: index > 0 ? vis.selectByLevel(index - 1, '.link') : null,\n            outgoing: vis.selectByLevel(index, '.link')\n          };\n          data.scrollHeight = scrollHeight;\n          data.scrollTop = 0;\n          data.scrollbar = {\n            el: undefined,\n            x: data.x + _this2.visData.global.column.width - scrollbarWidth,\n            y: 0,\n            width: scrollbarWidth,\n            height: scrollbarHeight,\n            scrollHeight: _this2.visData.global.column.height - scrollbarHeight,\n            scrollTop: 0,\n            heightScale: d3.scale.linear().domain([0, scrollHeight]).range([0, _this2.visData.global.column.height - scrollbarHeight])\n          };\n          data.invertedHeightScale = data.scrollbar.heightScale.invert;\n        });\n      }\n    }, {\n      key: 'updateScrollProperties',\n      value: function updateScrollProperties() {\n        var _this3 = this;\n\n        this.groups.each(function (data) {\n          var contentHeight = data.nodes.getBoundingClientRect().height + 2 * _this3.visData.global.row.padding;\n          var scrollHeight = contentHeight - _this3.visData.global.column.height;\n          var scrollbarHeight = scrollHeight > 0 ? Math.max(_this3.visData.global.column.height * _this3.visData.global.column.height / contentHeight, 10) : 0;\n\n          data.height = contentHeight;\n          data.scrollHeight = scrollHeight;\n          data.scrollTop = 0;\n          data.scrollbar.y = 0;\n          data.scrollbar.height = scrollbarHeight;\n          data.scrollbar.scrollHeight = _this3.visData.global.column.height - scrollbarHeight;\n          data.scrollbar.scrollTop = 0;\n          data.scrollbar.heightScale = d3.scale.linear().domain([0, scrollHeight]).range([0, _this3.visData.global.column.height - scrollbarHeight]);\n        });\n      }\n    }, {\n      key: 'updateVisibility',\n      value: function updateVisibility() {\n        this.groups.each(function () {\n          var group = d3.select(this);\n\n          group.classed('hidden', group.selectAll('.node').filter(function (data) {\n            return !data.hidden;\n          }).empty());\n        });\n      }\n    }, {\n      key: 'focus',\n      value: function focus(level) {\n        if (this.vis.highlightActiveLevel) {\n          this.groups.filter(function (data) {\n            return data.level === level;\n          }).classed('active', true);\n        }\n      }\n    }, {\n      key: 'blur',\n      value: function blur(level) {\n        if (this.vis.highlightActiveLevel) {\n          if (level) {\n            this.groups.filter(function (data) {\n              return data.level === level;\n            }).classed('active', false);\n          } else {\n            this.groups.classed('active', false);\n          }\n        }\n      }\n    }, {\n      key: 'className',\n      get: function get() {\n        return COLUMN_CLASS;\n      }\n    }, {\n      key: 'height',\n      get: function get() {\n        return this.visData.global.column.height;\n      }\n    }]);\n    return Levels;\n  })();\n\n  var TOPBAR_EL = 'div';\n  var TOPBAR_CLASS = 'top-bar';\n\n  var TOPBAR_CONTROL_EL = 'ul';\n  var TOPBAR_CONTROL_CLASS = 'controls';\n  var TOPBAR_GLOBAL_CONTROL_CLASS = 'global-controls';\n\n  var Topbar = (function () {\n    function Topbar(vis, selection, visData) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Topbar);\n\n      var that = this;\n\n      this.vis = vis;\n      this.visData = visData;\n      // Add base topbar element\n      this.el = selection.select('.' + TOPBAR_CLASS);\n\n      if (this.el.empty()) {\n        this.el = selection.insert(TOPBAR_EL, ':first-child').attr('class', TOPBAR_CLASS);\n      }\n\n      this.controlSwitch = this.el.append('div').attr('title', 'Toggle global / local topbar').style('width', this.visData.global.column.padding + 'px').classed('control-switch', true).on('click', this.switch.bind(this));\n\n      this.switchArrow = this.controlSwitch.append('svg').append('use').attr('xlink:href', this.vis.iconPath + '#arrow-down').attr('class', 'switch-arrow');\n\n      this.globalControls = this.el.append(TOPBAR_CONTROL_EL).classed(TOPBAR_GLOBAL_CONTROL_CLASS, true);\n\n      // Add button for sorting by precision\n      this.globalPrecision = this.globalControls.append('li').attr('class', 'control-btn sort-precision').classed('active', function () {\n        if (that.vis.currentSorting.global.type === 'precision') {\n          // Save currently active element. Needed when when re-sorting for the\n          // first time, to be able to de-highlight this element.\n          that.vis.currentSorting.global.el = d3.select(this);\n          return true;\n        }\n      }).on('click', function () {\n        that.sortAllColumns(this, 'precision');\n      }).on('mouseenter', function () {\n        _this.vis.interactionWrapper.call(_this.vis, (function () {\n          this.highlightBars(undefined, 'precision');\n        }).bind(_this), []);\n      }).on('mouseleave', function () {\n        _this.vis.interactionWrapper.call(_this.vis, (function () {\n          this.highlightBars(undefined, 'precision', true);\n        }).bind(_this), []);\n      });\n\n      this.globalPrecisionWrapper = this.globalPrecision.append('div').attr('class', 'wrapper');\n\n      this.globalPrecisionWrapper.append('span').attr('class', 'label').text('Precision');\n\n      this.globalPrecisionWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'precision').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n      this.globalPrecisionWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'precision' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-asc');\n\n      this.globalPrecisionWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'precision' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-desc');\n\n      // Add button for sorting by recall\n      this.globalRecall = this.globalControls.append('li').attr('class', 'control-btn sort-recall').classed('active', function () {\n        if (that.vis.currentSorting.global.type === 'recall') {\n          // See precision\n          that.vis.currentSorting.global.el = d3.select(this);\n          return true;\n        }\n      }).on('click', function () {\n        that.sortAllColumns(this, 'recall');\n      }).on('mouseenter', function () {\n        _this.vis.interactionWrapper.call(_this.vis, (function () {\n          this.highlightBars(undefined, 'recall');\n        }).bind(_this), []);\n      }).on('mouseleave', function () {\n        _this.vis.interactionWrapper.call(_this.vis, (function () {\n          this.highlightBars(undefined, 'recall', true);\n        }).bind(_this), []);\n      });\n\n      this.globalRecallWrapper = this.globalRecall.append('div').attr('class', 'wrapper');\n\n      this.globalRecallWrapper.append('span').attr('class', 'label').text('Recall');\n\n      this.globalRecallWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'recall').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n      this.globalRecallWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'recall' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-asc');\n\n      this.globalRecallWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'recall' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-desc');\n\n      // Add button for sorting by name\n      this.globalName = this.globalControls.append('li').attr('class', 'control-btn sort-name').classed('active', function () {\n        if (that.vis.currentSorting.global.type === 'name') {\n          // See precision\n          that.vis.currentSorting.global.el = d3.select(this);\n          return true;\n        }\n      }).on('click', function () {\n        that.sortAllColumns(this, 'name');\n      }).on('mouseenter', function () {\n        _this.vis.interactionWrapper.call(_this.vis, (function () {\n          this.highlightLabels();\n        }).bind(_this), []);\n      }).on('mouseleave', function () {\n        _this.vis.interactionWrapper.call(_this.vis, (function () {\n          this.highlightLabels(true);\n        }).bind(_this), []);\n      });\n\n      this.globalNameWrapper = this.globalName.append('div').attr('class', 'wrapper');\n\n      this.globalNameWrapper.append('span').attr('class', 'label').text('Name');\n\n      this.globalNameWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'name').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n      this.globalNameWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'name' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-alpha-asc');\n\n      this.globalNameWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'name' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-alpha-desc');\n\n      // Add button for switching to 'one bar'\n      this.globalOneBar = this.globalControls.append('li').attr('class', 'control-btn one-bar').classed('active', this.vis.barMode === 'one').on('click', function () {\n        that.switchBarMode(this, 'one');\n      });\n\n      this.globalOneBarWrapper = this.globalOneBar.append('div').attr('class', 'wrapper').text('One bar');\n\n      this.globalOneBarWrapper.append('svg').attr('class', 'icon-one-bar').append('use').attr('xlink:href', this.vis.iconPath + '#one-bar');\n\n      // Add button for switching to 'two bars'\n      this.globalTwoBars = this.globalControls.append('li').attr('class', 'control-btn two-bars').classed('active', this.vis.barMode === 'two').on('click', function () {\n        that.switchBarMode(this, 'two');\n      });\n\n      this.globalTwoBarsWrapper = this.globalTwoBars.append('div').attr('class', 'wrapper').text('Two bars');\n\n      this.globalTwoBarsWrapper.append('svg').attr('class', 'icon-two-bars').append('use').attr('xlink:href', this.vis.iconPath + '#two-bars');\n\n      // Add button for zoom-out\n      this.globalZoomOut = this.globalControls.append('li').attr('class', 'control-btn zoom-out').classed('active', this.vis.zoomedOut).on('mouseenter', function () {\n        _this.vis.interactionWrapper.call(_this.vis, (function () {\n          this.vis.globalView.call(this.vis);\n        }).bind(_this), []);\n      }).on('mouseleave', function () {\n        _this.vis.interactionWrapper.call(_this.vis, (function () {\n          this.vis.zoomedView.call(this.vis);\n        }).bind(_this), []);\n      }).on('click', function () {\n        that.vis.toggleView.call(that.vis);\n        d3.select(this).classed('active', that.vis.zoomedOut);\n      });\n\n      this.globalZoomOutWrapper = this.globalZoomOut.append('div').attr('class', 'wrapper').text('Zoom Out').style('margin-right', this.visData.global.column.padding + 'px');\n\n      this.globalZoomOutWrapper.append('svg').attr('class', 'icon-zoom-out').append('use').attr('xlink:href', this.vis.iconPath + '#zoom-out');\n\n      this.localControlWrapper = this.el.append('div').classed('local-controls', true);\n\n      this.localControls = this.localControlWrapper.selectAll(TOPBAR_CONTROL_CLASS).data(visData.nodes).enter().append(TOPBAR_CONTROL_EL).classed(TOPBAR_CONTROL_CLASS, true).style('width', this.visData.global.column.width + 'px');\n\n      this.localControls.each(function (data, index) {\n        var control = d3.select(this);\n\n        /*\n         * Order:\n         * 0 = unsorted\n         * 1 = asc\n         * -1 = desc\n         */\n        that.vis.currentSorting.local[index] = {\n          type: data.sortBy,\n          order: data.sortOrder,\n          el: undefined\n        };\n\n        control.append('li').attr('class', 'control-btn toggle').style('width', that.visData.global.column.padding + 'px').on('click', that.toggleColumn);\n\n        control.append('li').attr('class', 'control-btn sort-precision ease-all').classed('active', function () {\n          if (that.vis.currentSorting.local[index].type === 'precision') {\n            // See precision\n            that.vis.currentSorting.local[index].el = d3.select(this);\n            return true;\n          }\n        }).style({\n          width: that.visData.global.column.contentWidth / 2 + 'px',\n          left: that.visData.global.column.padding + 'px'\n        }).on('click', function (controlData) {\n          that.sortColumn(this, controlData.level, 'precision');\n        }).on('mouseenter', function () {\n          that.highlightBars(this.parentNode, 'precision');\n          d3.select(this).style('width', that.visData.global.column.contentWidth - 16 + 'px');\n        }).on('mouseleave', function () {\n          that.highlightBars(this.parentNode, 'precision', true);\n          d3.select(this).style('width', that.visData.global.column.contentWidth / 2 + 'px');\n        }).html('<div class=\"expandable-label\">' + '  <span class=\"letter abbr\">P</span>' + '  <span class=\"letter abbr\">r</span>' + '  <span class=\"letter\">e</span>' + '  <span class=\"letter abbr\">c</span>' + '  <span class=\"letter\">i</span>' + '  <span class=\"letter\">s</span>' + '  <span class=\"letter\">i</span>' + '  <span class=\"letter\">o</span>' + '  <span class=\"letter\">n</span>' + '</div>' + '<svg class=\"icon-unsort invisible-default ' + (that.vis.currentSorting.local[index].type !== 'precision' ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#unsort\"></use>' + '</svg>' + '<svg class=\"icon-sort-asc invisible-default ' + (that.vis.currentSorting.local[index].type === 'precision' && that.vis.currentSorting.local[index].order === 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#sort-asc\"></use>' + '</svg>' + '<svg class=\"icon-sort-desc invisible-default ' + (that.vis.currentSorting.local[index].type === 'precision' && that.vis.currentSorting.local[index].order !== 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#sort-desc\"></use>' + '</svg>');\n\n        control.append('li').attr('class', 'control-btn sort-recall ease-all').classed('active', function () {\n          if (that.vis.currentSorting.local[index].type === 'recall') {\n            // See recall\n            that.vis.currentSorting.local[index].el = d3.select(this);\n            return true;\n          }\n        }).style({\n          width: that.visData.global.column.contentWidth / 2 + 'px',\n          left: that.visData.global.column.contentWidth / 2 + that.visData.global.column.padding + 'px'\n        }).on('click', function (controlData) {\n          that.sortColumn(this, controlData.level, 'recall');\n        }).on('mouseenter', function () {\n          that.highlightBars(this.parentNode, 'recall');\n          d3.select(this).style({\n            width: that.visData.global.column.contentWidth - 16 + 'px',\n            left: that.visData.global.column.padding + 16 + 'px'\n          });\n        }).on('mouseleave', function () {\n          that.highlightBars(this.parentNode, 'recall', true);\n          d3.select(this).style({\n            width: that.visData.global.column.contentWidth / 2 + 'px',\n            left: that.visData.global.column.contentWidth / 2 + that.visData.global.column.padding + 'px'\n          });\n        }).html('<div class=\"expandable-label\">' + '  <span class=\"letter abbr\">R</span>' + '  <span class=\"letter\">e</span>' + '  <span class=\"letter abbr\">c</span>' + '  <span class=\"letter\">a</span>' + '  <span class=\"letter abbr\">l</span>' + '  <span class=\"letter\">l</span>' + '</div>' + '<svg class=\"icon-unsort invisible-default ' + (that.vis.currentSorting.local[index].type !== 'recall' ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#unsort\"></use>' + '</svg>' + '<svg class=\"icon-sort-asc invisible-default ' + (that.vis.currentSorting.local[index].type === 'recall' && that.vis.currentSorting.local[index].order === 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#sort-asc\"></use>' + '</svg>' + '<svg class=\"icon-sort-desc invisible-default ' + (that.vis.currentSorting.local[index].type === 'recall' && that.vis.currentSorting.local[index].order !== 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#sort-desc\"></use>' + '</svg>');\n\n        control.append('li').attr('class', 'control-btn options').style('width', that.visData.global.column.padding + 'px').on('click', that.toggleOptions).html('<svg class=\"icon-gear\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#gear\"></use>' + '</svg>');\n\n        if (that.vis.currentSorting.local[index].type) {\n          that.vis.currentSorting.local[index].el = control.select('.sort-' + that.vis.currentSorting.local[index].type);\n        }\n      });\n    }\n\n    // toggleColumn () {\n    //   console.log('Toggle column');\n    // }\n\n    babelHelpers.createClass(Topbar, [{\n      key: 'selectNodesLevel',\n      value: function selectNodesLevel(el) {\n        return this.vis.selectByLevel(d3.select(el).datum().level, '.node');\n      }\n    }, {\n      key: 'highlightLabels',\n      value: function highlightLabels(deHighlight) {\n        this.vis.baseElD3.selectAll('.node').classed('highlight-label', !deHighlight);\n      }\n    }, {\n      key: 'highlightBars',\n      value: function highlightBars(el, type, deHighlight) {\n        var nodes = el ? this.selectNodesLevel(el) : this.vis.baseElD3.selectAll('.node');\n\n        nodes.classed('highlight-bar', !deHighlight).selectAll('.bar.' + type).classed('highlight', !deHighlight);\n      }\n    }, {\n      key: 'sortAllColumns',\n      value: function sortAllColumns(el, type) {\n        if (this.semiActiveSortingEls) {\n          this.resetSemiActiveSortingEls();\n        }\n\n        if (this.vis.currentSorting.global.type !== type) {\n          // Unset class of previous global sorting element\n          if (this.vis.currentSorting.global.el) {\n            this.resetSortEl(this.vis.currentSorting.global.el, type);\n          }\n        }\n\n        this.vis.currentSorting.global.el = d3.select(el);\n        this.vis.currentSorting.global.el.classed('active', true);\n        this.vis.currentSorting.global.type = type;\n\n        var columnKeys = Object.keys(this.vis.currentSorting.local);\n        for (var i = 0, len = columnKeys.length; i < len; i++) {\n          this.sortColumn(el, columnKeys[i], type, true);\n        }\n\n        this.vis.sortAllColumns(type, true);\n      }\n    }, {\n      key: 'sortColumn',\n      value: function sortColumn(el, index, type, global) {\n        // Reset global sorting\n        if (!global) {\n          if (this.semiActiveSortingEls) {\n            this.resetSemiActiveSortingEls();\n          }\n          if (this.vis.currentSorting.global.type) {\n            this.resetSortEl(this.vis.currentSorting.global.el, type);\n          }\n          this.vis.currentSorting.global.type = undefined;\n        }\n\n        var newSortType = false;\n\n        if (this.vis.currentSorting.local[index].el) {\n          if (this.vis.currentSorting.local[index].type !== type) {\n            this.resetSortEl(this.vis.currentSorting.local[index].el, type);\n          }\n        }\n\n        if (this.vis.currentSorting.local[index].type !== type) {\n          newSortType = true;\n          // Reset sort order\n          this.vis.currentSorting.local[index].order = 0;\n        }\n\n        this.vis.currentSorting.local[index].el = d3.select(el);\n        this.vis.currentSorting.local[index].type = type;\n\n        // -1 = desc, 1 = asc\n        if (this.vis.currentSorting.local[index].order === -1) {\n          this.vis.currentSorting.local[index].order = 1;\n          this.vis.currentSorting.local[index].el.select('.icon-sort-desc').classed('visible', false);\n          this.vis.currentSorting.local[index].el.select('.icon-sort-asc').classed('visible', true);\n        } else {\n          this.vis.currentSorting.local[index].order = -1;\n          this.vis.currentSorting.local[index].el.select('.icon-sort-asc').classed('visible', false);\n          this.vis.currentSorting.local[index].el.select('.icon-sort-desc').classed('visible', true);\n        }\n\n        this.vis.currentSorting.local[index].el.select('.icon-unsort').classed('visible', false);\n\n        this.vis.currentSorting.local[index].el.classed('active', true);\n\n        if (!global) {\n          this.vis.sortColumn(index, type, this.vis.currentSorting.local[index].order, newSortType);\n        }\n      }\n    }, {\n      key: 'resetSortEl',\n      value: function resetSortEl(el, newType) {\n        el.classed('active', false);\n        el.select('.icon-sort-desc').classed('visible', false);\n        el.select('.icon-sort-asc').classed('visible', false);\n        el.select('.icon-unsort').classed('visible', true);\n        if (newType === 'name') {\n          el.classed('semi-active', true);\n          this.semiActiveSortingEls = true;\n        }\n      }\n    }, {\n      key: 'resetSemiActiveSortingEls',\n      value: function resetSemiActiveSortingEls() {\n        this.el.selectAll('.semi-active').classed('semi-active', false);\n      }\n\n      // toggleOptions () {\n      //   console.log('Toggle options');\n      // }\n\n    }, {\n      key: 'switch',\n      value: function _switch() {\n        this.el.classed('details', !this.el.classed('details'));\n      }\n    }, {\n      key: 'switchBarMode',\n      value: function switchBarMode(el, mode) {\n        if (this.vis.nodes.barMode !== mode) {\n          if (mode === 'one') {\n            this.globalOneBar.classed('active', true);\n            this.globalTwoBars.classed('active', false);\n          } else {\n            this.globalOneBar.classed('active', false);\n            this.globalTwoBars.classed('active', true);\n          }\n          this.vis.switchBarMode(mode);\n        }\n      }\n    }]);\n    return Topbar;\n  })();\n\n  /**\n   * Checks if `value` is object-like.\n   *\n   * @private\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n   */\n  function isObjectLike(value) {\n    return !!value && typeof value == 'object';\n  }\n\n  /** Used to detect host constructors (Safari > 5). */\n  var reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n  /** Used for native method references. */\n  var objectProto$2 = Object.prototype;\n\n  /** Used to resolve the decompiled source of functions. */\n  var fnToString = Function.prototype.toString;\n\n  /** Used to check objects for own properties. */\n  var hasOwnProperty = objectProto$2.hasOwnProperty;\n\n  /** Used to detect if a method is native. */\n  var reIsNative = RegExp('^' +\n    fnToString.call(hasOwnProperty).replace(/[\\\\^$.*+?()[\\]{}|]/g, '\\\\$&')\n    .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n  );\n\n  /**\n   * Checks if `value` is a native function.\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is a native function, else `false`.\n   * @example\n   *\n   * _.isNative(Array.prototype.push);\n   * // => true\n   *\n   * _.isNative(_);\n   * // => false\n   */\n  function isNative(value) {\n    if (value == null) {\n      return false;\n    }\n    if (isFunction(value)) {\n      return reIsNative.test(fnToString.call(value));\n    }\n    return isObjectLike(value) && reIsHostCtor.test(value);\n  }\n\n  /**\n   * Gets the native function at `key` of `object`.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @param {string} key The key of the method to get.\n   * @returns {*} Returns the function if it's native, else `undefined`.\n   */\n  function getNative(object, key) {\n    var value = object == null ? undefined : object[key];\n    return isNative(value) ? value : undefined;\n  }\n\n  /**\n   * Used as the [maximum length](http://ecma-international.org/ecma-262/6.0/#sec-number.max_safe_integer)\n   * of an array-like value.\n   */\n  var MAX_SAFE_INTEGER = 9007199254740991;\n\n  /**\n   * Checks if `value` is a valid array-like length.\n   *\n   * **Note:** This function is based on [`ToLength`](http://ecma-international.org/ecma-262/6.0/#sec-tolength).\n   *\n   * @private\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n   */\n  function isLength(value) {\n    return typeof value == 'number' && value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n  }\n\n  /** `Object#toString` result references. */\n  var arrayTag = '[object Array]';\n\n  /** Used for native method references. */\n  var objectProto$1 = Object.prototype;\n\n  /**\n   * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n   * of values.\n   */\n  var objToString$1 = objectProto$1.toString;\n\n  /* Native method references for those with the same name as other `lodash` methods. */\n  var nativeIsArray = getNative(Array, 'isArray');\n\n  /**\n   * Checks if `value` is classified as an `Array` object.\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n   * @example\n   *\n   * _.isArray([1, 2, 3]);\n   * // => true\n   *\n   * _.isArray(function() { return arguments; }());\n   * // => false\n   */\n  var isArray = nativeIsArray || function(value) {\n    return isObjectLike(value) && isLength(value.length) && objToString$1.call(value) == arrayTag;\n  };\n\n  var LayoutNotAvailable = (function (_ExtendableError) {\n    babelHelpers.inherits(LayoutNotAvailable, _ExtendableError);\n\n    function LayoutNotAvailable(message) {\n      babelHelpers.classCallCheck(this, LayoutNotAvailable);\n      return babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(LayoutNotAvailable).call(this, message || 'D3.layout.listGraph.js has not been loaded yet.'));\n    }\n\n    return LayoutNotAvailable;\n  })(ExtendableError);\n\n  var EventDispatcherNoFunction = (function (_ExtendableError2) {\n    babelHelpers.inherits(EventDispatcherNoFunction, _ExtendableError2);\n\n    function EventDispatcherNoFunction(message) {\n      babelHelpers.classCallCheck(this, EventDispatcherNoFunction);\n      return babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(EventDispatcherNoFunction).call(this, message || 'Dispatcher needs to be a function.'));\n    }\n\n    return EventDispatcherNoFunction;\n  })(ExtendableError);\n\n  var Events = (function () {\n    function Events(el, broadcast) {\n      babelHelpers.classCallCheck(this, Events);\n\n      if (broadcast && !isFunction(broadcast)) {\n        throw new EventDispatcherNoFunction();\n      }\n\n      this.el = el;\n      this._stack = {};\n      this.dispatch = broadcast ? broadcast : this._dispatchEvent;\n    }\n\n    babelHelpers.createClass(Events, [{\n      key: '_dispatchEvent',\n      value: function _dispatchEvent(eventName, data) {\n        var event = document.createEvent('CustomEvent');\n        event.initCustomEvent(eventName, false, false, data);\n        this.el.dispatchEvent(event);\n      }\n    }, {\n      key: 'broadcast',\n      value: function broadcast(event, data) {\n        this.dispatch(event, data);\n      }\n\n      /**\n       * Add a callback function to an event stack.\n       *\n       * @method  on\n       * @author  Fritz Lekschas\n       * @date    2016-01-07\n       *\n       * @param   {String}    event     Event identifier.\n       * @param   {Function}  callback  Function which is called when the event\n       *   stack is triggered.\n       * @param   {Number}    times     Number of times the callback function should\n       *   be triggered before it is removed from the event stack. This is useful\n       *   when an event happens only a certain number of times.\n       * @return  {Number}              Index of callback, which is needed to\n       *   manually remove the callback from the event stack.\n       */\n\n    }, {\n      key: 'on',\n      value: function on(event, callback, times) {\n        if (!isFunction(callback)) {\n          return false;\n        }\n\n        var normTimes = isFinite(times) ? parseInt(times, 10) : Infinity;\n\n        if (isArray(this.stack[event])) {\n          return this.stack[event].push({ callback: callback, times: normTimes }) - 1;\n        }\n        this.stack[event] = [{ callback: callback, times: normTimes }];\n        return 0;\n      }\n\n      /**\n       * Removes a callback function from an event stack given its index.\n       *\n       * @method  off\n       * @author  Fritz Lekschas\n       * @date    2016-01-07\n       *\n       * @param   {String}   event  Event identifier.\n       * @param   {Number}   index  Index of the callback to be removed.\n       * @return  {Boolean}         Returns `true` if event callback was found and\n       *   successfully removed.\n       */\n\n    }, {\n      key: 'off',\n      value: function off(event, index) {\n        try {\n          this.stack[event].splice(index, 1);\n          return true;\n        } catch (e) {\n          return false;\n        }\n      }\n\n      /**\n       * Trigger an event stack\n       *\n       * @method  trigger\n       * @author  Fritz Lekschas\n       * @date    2016-01-07\n       *\n       * @param   {String}   event  Event identifier.\n       * @return  {Boolean}         Returns `true` if an event stack was found.\n       */\n\n    }, {\n      key: 'trigger',\n      value: function trigger(event, data) {\n        if (isArray(this.stack[event])) {\n          // Traversing from the end to the start, which has the advantage that\n          // deletion of events, i.e. calling `Event.off()` doesn't affect the index\n          // of event listeners in the next step.\n          for (var i = this.stack[event].length; i--;) {\n            // Instead of checking whether `stack[event][i]` is a function here,\n            // we do it just once when we add the function to the stack.\n            if (this.stack[event][i].times--) {\n              this.stack[event][i].callback(data);\n            } else {\n              this.off(event, i);\n            }\n          }\n          return true;\n        }\n        return false;\n      }\n    }, {\n      key: 'stack',\n      get: function get() {\n        return this._stack;\n      }\n    }]);\n    return Events;\n  })();\n\n  function setOption(value, defaultValue, noFalsyValue) {\n    if (noFalsyValue) {\n      return value ? value : defaultValue;\n    }\n\n    return typeof value !== 'undefined' ? value : defaultValue;\n  }\n\n  var ListGraph = (function () {\n    function ListGraph(init) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, ListGraph);\n\n      if (!d3.layout.listGraph) {\n        throw new LayoutNotAvailable();\n      }\n\n      var that = this;\n\n      this.baseEl = init.element;\n      this.baseElD3 = d3.select(this.baseEl);\n      this.baseElJq = $(this.baseEl);\n      this.svgD3 = this.baseElD3.select('svg.base');\n      this.svgEl = this.svgD3.node();\n\n      if (this.svgD3.empty()) {\n        this.svgD3 = this.baseElD3.append('svg').attr('class', 'base');\n        this.svgJq = $(this.svgD3.node());\n      } else {\n        this.svgJq = $(this.svgD3.node());\n      }\n\n      this.rootNodes = init.rootNodes;\n\n      this.width = setOption(init.width, this.svgJq.width(), true);\n      this.height = setOption(init.height, this.svgJq.height(), true);\n\n      // Refresh top and left position of the base `svg` everytime the user enters\n      // the element with his/her mouse cursor. This will avoid relying on complex\n      // browser resize events and other layout manipulations as they most likely\n      // won't happen when the user tries to interact with the visualization.\n      this.svgD3.on('mouseenter', function () {\n        that.getBoundingRect.call(that, this);\n      });\n\n      this.scrollbarWidth = setOption(init.scrollbarWidth, SCROLLBAR_WIDTH, true);\n      this.columns = setOption(init.columns, COLUMNS, true);\n      this.rows = setOption(init.rows, ROWS, true);\n      this.iconPath = setOption(init.iconPath, ICON_PATH, true);\n      this.querying = setOption(init.querying, QUERYING);\n\n      this.highlightActiveLevel = setOption(init.highlightActiveLevel, HIGHLIGHT_ACTIVE_LEVEL);\n\n      // Determines which level from the rooted node will be regarded as active.\n      // Zero means that the level of the rooted node is regarded.\n      this.activeLevel = setOption(init.activeLevel, ACTIVE_LEVEL);\n\n      this.noRootActiveLevelDiff = setOption(init.noRootActiveLevelDiff, NO_ROOT_ACTIVE_LEVEL_DIFF);\n\n      this.lessTransitionsJs = init.lessTransitions > 0;\n      this.lessTransitionsCss = init.lessTransitions > 1;\n\n      this.baseElD3.classed('less-animations', this.lessTransitionsCss);\n\n      this.sortBy = init.sortBy;\n      this.sortOrder = init.sortOrder === 'asc' ? 1 : DEFAULT_SORT_ORDER;\n\n      this.events = new Events(this.baseEl, init.dispatcher);\n\n      this.baseElJq.addClass(CLASSNAME);\n\n      if (init.forceWidth) {\n        this.baseElJq.width(this.width);\n      }\n\n      this.layout = new d3.layout.listGraph( // eslint-disable-line new-cap\n      [this.width, this.height], [this.columns, this.rows]);\n\n      this.data = init.data;\n      this.visData = this.layout.process(this.data, this.rootNodes, {\n        sortBy: this.sortBy,\n        sortOrder: this.sortOrder\n      });\n\n      /**\n       * Stores current sorting, e.g. type, order and a reference to the element.\n       *\n       * @type  {Object}\n       */\n      this.currentSorting = {\n        global: {\n          type: this.sortBy,\n          order: this.sortOrder\n        },\n        local: {}\n      };\n\n      this.barMode = init.barMode || DEFAULT_BAR_MODE;\n      this.svgD3.classed(this.barMode + '-bar', true);\n\n      this.topbar = new Topbar(this, this.baseElD3, this.visData);\n\n      this.svgD3.attr('viewBox', '0 0 ' + this.width + ' ' + this.height);\n\n      this.container = this.svgD3.append('g').attr('class', 'main-container');\n\n      this.levels = new Levels(this.container, this, this.visData);\n\n      this.links = new Links(this.levels.groups, this.visData, this.layout);\n      this.nodes = new Nodes(this, this.levels.groups, this.visData, this.links, this.events);\n      this.levels.scrollPreparation(this, this.scrollbarWidth);\n      this.scrollbars = new Scrollbars(this.levels.groups, this.visData, this.scrollbarWidth);\n\n      // jQuery's mousewheel plugin is much nicer than D3's half-baked zoom event.\n      // We are using delegated event listeners to provide better scaling\n      this.svgJq.on('mousewheel', '.' + this.levels.className, function (event) {\n        if (!that.zoomedOut) {\n          that.mousewheelColumn(this, event);\n        }\n      });\n\n      // Add jQuery delegated event listeners instead of direct listeners of D3.\n      if (this.querying) {\n        this.svgJq.on('click', '.' + this.nodes.classLabelWrapper, function () {\n          that.nodes.toggleQueryMode.call(that.nodes, this.parentNode, d3.select(this).datum());\n        });\n      }\n\n      this.svgJq.on('click', '.' + this.nodes.classFocusControls + '.' + this.nodes.classRoot, function () {\n        that.nodes.rootHandler.call(that.nodes, this, d3.select(this).datum());\n      });\n\n      if (this.querying) {\n        this.svgJq.on('click', '.' + this.nodes.classFocusControls + '.' + this.nodes.classQuery, function () {\n          that.nodes.toggleQueryMode.call(that.nodes, this.parentNode, d3.select(this).datum());\n        });\n      }\n\n      this.svgJq.on('click', '.' + this.nodes.classFocusControls + '.' + this.nodes.classLock, function () {\n        that.nodes.lockHandler.call(that.nodes, this, d3.select(this).datum());\n      });\n\n      // Normally we would reference a named methods but since we need to access\n      // the class' `this` property instead of the DOM element we need to use an\n      // arrow function.\n      this.scrollbars.all.on('mousedown', function () {\n        that.scrollbarMouseDown(this, d3.event);\n      });\n\n      // We need to listen to `mouseup` and `mousemove` globally otherwise\n      // scrolling will only work as long as the cursor hovers the actual\n      // scrollbar, which is super annoying.\n      d3.select(document).on('mouseup', function () {\n        _this.globalMouseUp(d3.event);\n      }).on('mousemove', function () {\n        _this.globalMouseMove(d3.event);\n      });\n\n      // Enable dragging of the whole graph.\n      this.svgD3.call(onDragDrop, this.dragStartHandler.bind(this), dragMoveHandler, this.dragEndHandler.bind(this), [this.container, this.topbar.localControlWrapper], 'horizontal', this.getDragLimits.bind(this), [this.scrollbarDragging.bind(this)]);\n\n      this.events.on('d3ListGraphLevelFocus', function (levelId) {\n        return _this.levels.focus(levelId);\n      });\n\n      this.events.on('d3ListGraphNodeRoot', function () {\n        _this.nodes.bars.updateAll(_this.layout.updateBars(_this.data), _this.currentSorting.global.type);\n        _this.updateSorting();\n      });\n\n      this.events.on('d3ListGraphNodeUnroot', function () {\n        _this.nodes.bars.updateAll(_this.layout.updateBars(_this.data), _this.currentSorting.global.type);\n        _this.updateSorting();\n      });\n\n      this.events.on('d3ListGraphUpdateBars', function () {\n        _this.nodes.bars.updateAll(_this.layout.updateBars(_this.data), _this.currentSorting.global.type);\n        _this.updateSorting();\n      });\n\n      this.events.on('d3ListGraphActiveLevel', function (nextLevel) {\n        var oldLevel = _this.activeLevel;\n        _this.activeLevel = Math.max(nextLevel, 0);\n        if (_this.nodes.rootedNode) {\n          var rootNodeDepth = _this.nodes.rootedNode.datum().depth;\n          _this.levels.blur(rootNodeDepth + oldLevel);\n          _this.levels.focus(rootNodeDepth + _this.activeLevel);\n        } else {\n          _this.levels.blur(oldLevel - _this.noRootActiveLevelDiff);\n          _this.levels.focus(_this.activeLevel - _this.noRootActiveLevelDiff);\n        }\n      });\n    }\n\n    babelHelpers.createClass(ListGraph, [{\n      key: 'getDragLimits',\n      value: function getDragLimits() {\n        return {\n          x: {\n            min: this.dragMinX,\n            max: 0\n          }\n        };\n      }\n\n      /**\n       * Helper method to get the top and left position of the base `svg`.\n       *\n       * @Description\n       * Calling `getBoundingClientRect()` right at the beginning leads to errornous\n       * values, probably because the function is called because HTML has been fully\n       * rendered.\n       *\n       * @method  getBoundingRect\n       * @author  Fritz Lekschas\n       * @date    2016-02-24\n       * @param   {Object}  el  Element on which `getBoundingClientRect` is called.\n       */\n\n    }, {\n      key: 'getBoundingRect',\n      value: function getBoundingRect(el) {\n        this.top = el.getBoundingClientRect().top;\n        this.left = el.getBoundingClientRect().left;\n      }\n    }, {\n      key: 'interactionWrapper',\n      value: function interactionWrapper(callback, params) {\n        if (!this.noInteractions) {\n          callback.apply(this, params);\n        }\n      }\n    }, {\n      key: 'dragStartHandler',\n      value: function dragStartHandler() {\n        this.noInteractions = true;\n        this.baseElD3.classed('unselectable', true);\n      }\n    }, {\n      key: 'dragEndHandler',\n      value: function dragEndHandler() {\n        this.noInteractions = false;\n        this.baseElD3.classed('unselectable', false);\n      }\n    }, {\n      key: 'scrollbarDragging',\n      value: function scrollbarDragging() {\n        return !!this.activeScrollbar;\n      }\n    }, {\n      key: 'globalMouseUp',\n      value: function globalMouseUp(event) {\n        this.noInteractions = false;\n        if (this.activeScrollbar) {\n          this.baseElD3.classed('unselectable', false);\n          var data = this.activeScrollbar.datum();\n          var deltaY = data.scrollbar.clientY - event.clientY;\n\n          // Save final vertical position\n          // Scrollbar\n          data.scrollbar.scrollTop = Math.min(Math.max(data.scrollbar.scrollTop - deltaY, 0), data.scrollbar.scrollHeight);\n\n          // Content\n          data.scrollTop = Math.max(Math.min(data.scrollTop + data.invertedHeightScale(deltaY), 0), -data.scrollHeight);\n\n          this.activeScrollbar.classed('active', false);\n\n          this.activeScrollbar = undefined;\n        }\n      }\n    }, {\n      key: 'globalMouseMove',\n      value: function globalMouseMove(event) {\n        if (this.activeScrollbar) {\n          var data = this.activeScrollbar.datum();\n          var deltaY = data.scrollbar.clientY - event.clientY;\n\n          // Scroll scrollbar\n          ListGraph.scrollElVertically(this.activeScrollbar.node(), Math.min(Math.max(data.scrollbar.scrollTop - deltaY, 0), data.scrollbar.scrollHeight));\n\n          // Scroll content\n          var contentScrollTop = Math.max(Math.min(data.scrollTop + data.invertedHeightScale(deltaY), 0), -data.scrollHeight);\n\n          ListGraph.scrollElVertically(data.nodes, contentScrollTop);\n\n          // Scroll Links\n          this.links.scroll(data.linkSelections.outgoing, this.layout.offsetLinks(data.level, contentScrollTop, 'source'));\n\n          this.links.scroll(data.linkSelections.incoming, this.layout.offsetLinks(data.level - 1, contentScrollTop, 'target'));\n        }\n      }\n    }, {\n      key: 'scrollbarMouseDown',\n      value: function scrollbarMouseDown(el, event) {\n        this.noInteractions = true;\n        this.baseElD3.classed('unselectable', true);\n        this.activeScrollbar = d3.select(el).classed('active', true);\n        this.activeScrollbar.datum().scrollbar.clientY = event.clientY;\n      }\n    }, {\n      key: 'mousewheelColumn',\n      value: function mousewheelColumn(el, event) {\n        event.preventDefault();\n\n        var data = d3.select(el).datum();\n\n        if (data.scrollHeight > 0) {\n          // Scroll nodes\n          data.scrollTop = Math.max(Math.min(data.scrollTop + event.deltaY, 0), -data.scrollHeight);\n\n          this.scrollY(data);\n        }\n      }\n    }, {\n      key: 'scrollY',\n      value: function scrollY(columnData) {\n        ListGraph.scrollElVertically(columnData.nodes, columnData.scrollTop);\n\n        // Scroll scrollbar\n        columnData.scrollbar.scrollTop = columnData.scrollbar.heightScale(-columnData.scrollTop);\n\n        ListGraph.scrollElVertically(columnData.scrollbar.el, columnData.scrollbar.scrollTop);\n\n        // Scroll Links\n        if (columnData.level !== this.visData.nodes.length) {\n          this.links.scroll(columnData.linkSelections.outgoing, this.layout.offsetLinks(columnData.level, columnData.scrollTop, 'source'));\n        }\n\n        if (columnData.level > 0) {\n          this.links.scroll(columnData.linkSelections.incoming, this.layout.offsetLinks(columnData.level - 1, columnData.scrollTop, 'target'));\n        }\n      }\n    }, {\n      key: 'scrollYTo',\n      value: function scrollYTo(selection, positionY) {\n        var _this2 = this;\n\n        return selection.transition().duration(TRANSITION_SEMI_FAST).tween('scrollY', function (data) {\n          var scrollPositionY = d3.interpolateNumber(data.scrollTop, positionY);\n          return function (time) {\n            data.scrollTop = scrollPositionY(time);\n            _this2.scrollY(data);\n          };\n        });\n      }\n    }, {\n      key: 'resetAllScrollPositions',\n      value: function resetAllScrollPositions() {\n        return this.scrollYTo(this.levels.groups, 0);\n      }\n    }, {\n      key: 'selectByLevel',\n      value: function selectByLevel(level, selector) {\n        return d3.select(this.levels.groups[0][level]).selectAll(selector);\n      }\n    }, {\n      key: 'updateSorting',\n      value: function updateSorting() {\n        var levels = Object.keys(this.currentSorting.local);\n        for (var i = levels.length; i--;) {\n          this.sortColumn(i, this.currentSorting.local[levels[i]].type, this.currentSorting.local[levels[i]].order, this.currentSorting.local[levels[i]].type);\n        }\n      }\n    }, {\n      key: 'sortColumn',\n      value: function sortColumn(level, property, sortOrder, newSortType) {\n        this.nodes.sort(this.layout.sort(level, property, sortOrder).updateNodesVisibility().nodes(level), newSortType);\n        this.links.sort(this.layout.links(level - 1, level + 1));\n      }\n    }, {\n      key: 'sortAllColumns',\n      value: function sortAllColumns(property, newSortType) {\n        this.currentSorting.global.order = this.currentSorting.global.order === -1 ? 1 : -1;\n\n        this.nodes.sort(this.layout.sort(undefined, property, this.currentSorting.global.order).updateNodesVisibility().nodes(), newSortType);\n\n        this.links.sort(this.layout.links());\n      }\n    }, {\n      key: 'switchBarMode',\n      value: function switchBarMode(mode) {\n        this.svgD3.classed('one-bar', mode === 'one');\n        this.svgD3.classed('two-bar', mode === 'two');\n        this.nodes.bars.switchMode(mode, this.currentSorting);\n      }\n    }, {\n      key: 'trigger',\n      value: function trigger(event, data) {\n        this.events.trigger(event, data);\n      }\n\n      /**\n       * Update the scroll position and scroll-bar visibility.\n       *\n       * @description\n       * This method needs to be called after hiding or showing nodes.\n       *\n       * @method  updateScrolling\n       * @author  Fritz Lekschas\n       * @date    2016-02-21\n       */\n\n    }, {\n      key: 'updateScrolling',\n      value: function updateScrolling() {\n        var _this3 = this;\n\n        this.resetAllScrollPositions().call(allTransitionsEnded, function () {\n          _this3.levels.updateScrollProperties();\n          _this3.scrollbars.updateVisibility();\n        });\n      }\n    }, {\n      key: 'updateLevelsVisibility',\n      value: function updateLevelsVisibility() {\n        this.levels.updateVisibility();\n      }\n    }, {\n      key: 'globalView',\n      value: function globalView(selectionInterst) {\n        var _this4 = this;\n\n        if (!this.zoomedOut) {\n          (function () {\n            var x = 0;\n            var y = 0;\n            var width = 0;\n            var height = 0;\n            var bBox = undefined;\n            var cRect = undefined;\n\n            var globalCRect = _this4.svgD3.node().getBoundingClientRect();\n\n            if (selectionInterst && !selectionInterst.empty()) {\n              selectionInterst.each(function () {\n                bBox = this.getBBox();\n                cRect = this.getBoundingClientRect();\n                width = Math.max(width, cRect.left - globalCRect.left + cRect.width);\n                height = Math.max(height, cRect.top - globalCRect.top + cRect.height);\n              });\n              width = _this4.width > width ? _this4.width : width;\n              height = _this4.height > height ? _this4.height : height;\n            } else {\n              bBox = _this4.container.node().getBBox();\n              width = _this4.width > bBox.width ? _this4.width : bBox.width;\n              height = _this4.height > bBox.height ? _this4.height : bBox.height;\n            }\n\n            x = bBox.x;\n            y = bBox.y;\n\n            _this4.svgD3.classed('zoomedOut', true).transition().duration(TRANSITION_SEMI_FAST).attr('viewBox', x + ' ' + y + ' ' + width + ' ' + height);\n          })();\n        }\n      }\n    }, {\n      key: 'zoomedView',\n      value: function zoomedView() {\n        if (!this.zoomedOut) {\n          this.svgD3.classed('zoomedOut', false).transition().duration(TRANSITION_SEMI_FAST).attr('viewBox', '0 0 ' + this.width + ' ' + this.height);\n        }\n      }\n    }, {\n      key: 'toggleView',\n      value: function toggleView() {\n        if (this.zoomedOut) {\n          this.zoomedOut = false;\n          this.zoomedView();\n        } else {\n          this.globalView();\n          this.zoomedOut = true;\n        }\n      }\n\n      /**\n       * Check if an element is actually visible, i.e. within the boundaries of the\n       * SVG element.\n       *\n       * @method  isHidden\n       * @author  Fritz Lekschas\n       * @date    2016-02-24\n       * @param   {Object}    el  DOM element to be checked.\n       * @return  {Boolean}       If `true` element is not visible.\n       */\n\n    }, {\n      key: 'isHidden',\n      value: function isHidden(el) {\n        var boundingRect = el.getBoundingClientRect();\n        return boundingRect.top + boundingRect.height <= this.top || boundingRect.left + boundingRect.width <= this.left || boundingRect.top >= this.top + this.height || boundingRect.left >= this.left + this.width;\n      }\n    }, {\n      key: 'area',\n      get: function get() {\n        return this.container.node().getBoundingClientRect();\n      }\n    }, {\n      key: 'dragMinX',\n      get: function get() {\n        return Math.min(0, this.width - this.area.width);\n      }\n    }, {\n      key: 'barMode',\n      get: function get() {\n        if (this.bars) {\n          return this.nodes.bars.mode;\n        }\n        return this._barMode;\n      },\n      set: function set(mode) {\n        if (this.bars) {\n          this.nodes.bars.mode = mode;\n        }\n        this._barMode = mode;\n      }\n    }], [{\n      key: 'scrollElVertically',\n      value: function scrollElVertically(el, offset) {\n        d3.select(el).attr('transform', 'translate(0, ' + offset + ')');\n      }\n    }]);\n    return ListGraph;\n  })();\n\n  return ListGraph;\n\n})($,d3);"],"sourceRoot":"/source/"}