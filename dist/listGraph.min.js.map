{"version":3,"sources":["listGraph.min.js"],"names":["ListGraph","$","d3","isObject","value","type","isFunction","tag","objectToString","call","funcTag","genTag","checkGlobal","Object","isFinite","nativeIsFinite","collectInclClones","node","originalNode","clone","clones","length","concat","up","callback","depth","includeClones","child","nodesInclClones","i","parentsId","keys","parents","j","down","childRefs","upAndDown","callbackUp","callbackDown","siblings","siblingsId","roundRect","x","y","width","height","radius","topLeft","topRight","bottomLeft","bottomRight","mergeSelections","selections","pushSelection","selection","each","mergedSelection","push","this","selectAll","allTransitionsEnded","transition","size","n","_len","arguments","args","Array","_key","apply","onDragDrop","dragStartHandler","dragMoveHandler","dropHandler","elsToBeDragged","orientation","limits","notWhenTrue","drag","behavior","appliedLimits","on","data","el","select","dragX","dragY","datum","withinLimits","applyingLimits","restrictedValue","undefined","Math","min","max","e","LimitsUnsupportedFormat","els","event","dx","style","dy","setOption","defaultValue","noFalsyValue","babelHelpers","classCallCheck","instance","Constructor","TypeError","createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","protoProps","staticProps","prototype","inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","possibleConstructorReturn","self","ReferenceError","ExtendableError","_Error","message","_this","getPrototypeOf","name","Error","captureStackTrace","LayoutNotAvailable","_ExtendableError","EventDispatcherNoFunction","_ExtendableError2","CLASSNAME","SCROLLBAR_WIDTH","COLUMNS","ROWS","ICON_PATH","DEFAULT_SORT_ORDER","DEFAULT_BAR_MODE","HIGHLIGHT_ACTIVE_LEVEL","ACTIVE_LEVEL","NO_ROOT_ACTIVE_LEVEL_DIFF","QUERYING","HIDE_OUTWARDS_LINKS","SHOW_LINK_LOCATION","TRANSITION_LIGHTNING_FAST","TRANSITION_SEMI_FAST","TOPBAR_EL","TOPBAR_CLASS","TOPBAR_CONTROL_EL","TOPBAR_CONTROL_CLASS","TOPBAR_GLOBAL_CONTROL_CLASS","Topbar","vis","visData","that","empty","insert","attr","controlSwitch","append","global","column","padding","classed","bind","switchArrow","iconPath","globalControls","globalPrecision","currentSorting","sortAllColumns","interactionWrapper","highlightBars","globalPrecisionWrapper","text","order","globalRecall","globalRecallWrapper","globalName","highlightLabels","globalNameWrapper","globalOneBar","barMode","switchBarMode","globalOneBarWrapper","globalTwoBars","globalTwoBarsWrapper","globalZoomOut","zoomedOut","globalView","zoomedView","toggleView","globalZoomOutWrapper","localControlWrapper","localControls","nodes","enter","index","control","local","sortBy","sortOrder","toggleColumn","contentWidth","left","controlData","sortColumn","level","parentNode","html","toggleOptions","selectByLevel","deHighlight","baseElD3","selectNodesLevel","semiActiveSortingEls","resetSemiActiveSortingEls","resetSortEl","columnKeys","len","newSortType","newType","mode","COLUMN_CLASS","SCROLL_CONTAINER_CLASS","Levels","groups","highlightActiveLevel","rootedNode","activeLevel","noRootActiveLevelDiff","scrollbarWidth","_this2","contentHeight","getBoundingClientRect","row","scrollHeight","scrollbarHeight","linkSelections","incoming","outgoing","scrollTop","scrollbar","heightScale","scale","linear","domain","range","invertedHeightScale","invert","_this3","group","filter","hidden","get","LINKS_CLASS","LINK_CLASS","Links","levels","layout","links","hideOutwardsLinks","linkVisibility","class","d","diagonal","pointsOutside","nodeIds","_highlight","className","id","update","start","end","duration","source","getSourceX","offsetX","getTargetX","getY","offsetY","extraOffsetX","showLinkLocation","sourceY","sourceX","targetY","targetX","middleX","objectProto","toString","objectTypes","function","object","freeExports","exports","nodeType","freeModule","module","freeGlobal","freeSelf","freeWindow","window","thisGlobal","root","Function","BAR_CLASS","Bar","barGroup","barData","nodeData","bars","setupMagnitude","generatePath","setupBorder","setupIndicator","cell","activeHeight","inactiveheight","referenceValue","lessTransitions","reference","indicator","adjustWidth","bottom","generateTwoBarsPath","generateOneBarPath","normValue","normIndicator","abs","BARS_CLASS","Bars","barId","insertBefore","children","direct","updateIndicator","lessTransitionsJs","CLASS_NODES","CLASS_NODE","CLASS_CLONE","CLASS_LABEL_WRAPPER","CLASS_FOCUS_CONTROLS","CLASS_ROOT","CLASS_QUERY","CLASS_LOCK","CLASS_ACTIVE","CLASS_INACTIVE","CLASS_INDICATOR_BAR","CLASS_INDICATOR_LOCATION","CLASS_INDICATOR_INCOMING","CLASS_INDICATOR_OUTGOING","CLASS_INDICATOR_ABOVE","CLASS_INDICATOR_BELOW","Nodes","baseSelection","events","drawLinkIndicator","direction","linkDensityBg","refs","drawLinkLocationIndicator","position","above","drawFullSizeRect","shrinking","noRoundBorder","shrinkingAmount","currentLinks","iconDimension","rows","domEl","_data","activeScrollbar","enterHandler","querying","leaveHandler","queryMode","calcHeightLinkLocationIndicator","nodeRooted","setUpFocusControls","nodeQuery","nodeLocks","focusNodes","blurNodes","eventHelper","highlightNodes","unhighlightNodes","toggleLock","toggleRoot","right","below","total","updateHeightLinkLocationIndicatorBars","barRefHeight","barAboveRefTop","baseClassName","toggleQueryMode","eventData","clonedFromId","broadcast","locked","unlocked","lock","unlock","rooted","unrooted","excludeClones","zoomOut","hovering","zoomIn","optionalParams","subSelectionClass","indexOf","setFalse","d3El","lockedNode","unlockNode","lockNode","parseInt","active","inactive","query-and","query-or","query-not","queryBeforeRooting","updateVisibility","previousMode","queryNode","unqueryNode","blur","unrootNode","focus","rootNode","hideNodes","showNodes","location","paddedDim","cx","cy","r","nodesVisibility","show","restriction","checkNodeVisibility","_el","isHidden","checkNodeDirect","checkNodeIndirect","updateDirectBarIndicator","currentlyActiveBar","updateIndirectBarIndicator","nodeId","currentNodeData","includeParents","appliedClassName","includeChildren","traverseCallbackUp","childData","traverseCallbackDown","barIndicatorClass","directNodes","indirectNodes","highlight","traverseCallback","svgD3","updateLevelsVisibility","updateScrolling","_this4","updateNodesVisibility","SCROLLBAR_CLASS","Scrollbars","all","isArray","Events","_stack","dispatch","_dispatchEvent","eventName","document","createEvent","initCustomEvent","dispatchEvent","times","normTimes","Infinity","stack","splice","off","init","listGraph","baseEl","element","baseElJq","svgEl","svgJq","rootNodes","getBoundingRect","columns","linkLocationBucketSize","lessTransitionsCss","dispatcher","addClass","forceWidth","process","topbar","container","scrollPreparation","scrollbars","mousewheelColumn","classLabelWrapper","classFocusControls","classRoot","rootHandler","classQuery","classLock","lockHandler","scrollbarMouseDown","globalMouseUp","globalMouseMove","dragEndHandler","getDragLimits","scrollbarDragging","levelId","updateAll","updateBars","updateSorting","nextLevel","oldLevel","rootNodeDepth","dragMinX","top","params","noInteractions","deltaY","clientY","scrollElVertically","contentScrollTop","scroll","offsetLinks","updateLinkLocationIndicators","preventDefault","scrollY","columnData","positionY","tween","scrollPositionY","interpolateNumber","time","scrollYTo","selector","property","sort","switchMode","trigger","resetAllScrollPositions","updateScrollProperties","selectionInterst","bBox","cRect","globalCRect","getBBox","boundingRect","linkPointsOutside","area","_barMode","set","offset"],"mappings":"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","file":"listGraph.min.js","sourcesContent":["/* Copyright Fritz Lekschas: D3 example visualization app using list-based graphs */\nvar ListGraph = (function ($,d3) {\n  'use strict';\n\n  var babelHelpers = {};\n\n  babelHelpers.classCallCheck = function (instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  };\n\n  babelHelpers.createClass = function () {\n    function defineProperties(target, props) {\n      for (var i = 0; i < props.length; i++) {\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n      }\n    }\n\n    return function (Constructor, protoProps, staticProps) {\n      if (protoProps) defineProperties(Constructor.prototype, protoProps);\n      if (staticProps) defineProperties(Constructor, staticProps);\n      return Constructor;\n    };\n  }();\n\n  babelHelpers.inherits = function (subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n  };\n\n  babelHelpers.possibleConstructorReturn = function (self, call) {\n    if (!self) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n  };\n\n  babelHelpers;\n\n  var ExtendableError = function (_Error) {\n    babelHelpers.inherits(ExtendableError, _Error);\n\n    function ExtendableError(message) {\n      babelHelpers.classCallCheck(this, ExtendableError);\n\n      var _this = babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(ExtendableError).call(this, message));\n\n      _this.name = _this.constructor.name;\n      _this.message = message;\n      Error.captureStackTrace(_this, _this.constructor.name);\n      return _this;\n    }\n\n    return ExtendableError;\n  }(Error);\n\n  var LayoutNotAvailable = function (_ExtendableError) {\n    babelHelpers.inherits(LayoutNotAvailable, _ExtendableError);\n\n    function LayoutNotAvailable(message) {\n      babelHelpers.classCallCheck(this, LayoutNotAvailable);\n      return babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(LayoutNotAvailable).call(this, message || 'D3.layout.listGraph.js has not been loaded yet.'));\n    }\n\n    return LayoutNotAvailable;\n  }(ExtendableError);\n\n  var EventDispatcherNoFunction = function (_ExtendableError2) {\n    babelHelpers.inherits(EventDispatcherNoFunction, _ExtendableError2);\n\n    function EventDispatcherNoFunction(message) {\n      babelHelpers.classCallCheck(this, EventDispatcherNoFunction);\n      return babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(EventDispatcherNoFunction).call(this, message || 'Dispatcher needs to be a function.'));\n    }\n\n    return EventDispatcherNoFunction;\n  }(ExtendableError);\n\n  var CLASSNAME = 'list-graph';\n\n  var SCROLLBAR_WIDTH = 6;\n  var COLUMNS = 5;\n  var ROWS = 5;\n\n  // An empty path is equal to inline SVG.\n  var ICON_PATH = '';\n\n  // -1 = desc, 1 = asc\n  var DEFAULT_SORT_ORDER = -1;\n\n  var DEFAULT_BAR_MODE = 'one';\n\n  var HIGHLIGHT_ACTIVE_LEVEL = true;\n  var ACTIVE_LEVEL = 0;\n  var NO_ROOT_ACTIVE_LEVEL_DIFF = 0;\n  var QUERYING = false;\n  var HIDE_OUTWARDS_LINKS = false;\n  var SHOW_LINK_LOCATION = false;\n\n  var TRANSITION_LIGHTNING_FAST = 150;\n  var TRANSITION_SEMI_FAST = 250;\n\n  var TOPBAR_EL = 'div';\n  var TOPBAR_CLASS = 'top-bar';\n\n  var TOPBAR_CONTROL_EL = 'ul';\n  var TOPBAR_CONTROL_CLASS = 'controls';\n  var TOPBAR_GLOBAL_CONTROL_CLASS = 'global-controls';\n\n  var Topbar = function () {\n    function Topbar(vis, selection, visData) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Topbar);\n\n      var that = this;\n\n      this.vis = vis;\n      this.visData = visData;\n      // Add base topbar element\n      this.el = selection.select('.' + TOPBAR_CLASS);\n\n      if (this.el.empty()) {\n        this.el = selection.insert(TOPBAR_EL, ':first-child').attr('class', TOPBAR_CLASS);\n      }\n\n      this.controlSwitch = this.el.append('div').attr('title', 'Toggle global / local topbar').style('width', this.visData.global.column.padding + 'px').classed('control-switch', true).on('click', this.switch.bind(this));\n\n      this.switchArrow = this.controlSwitch.append('svg').append('use').attr('xlink:href', this.vis.iconPath + '#arrow-down').attr('class', 'switch-arrow');\n\n      this.globalControls = this.el.append(TOPBAR_CONTROL_EL).classed(TOPBAR_GLOBAL_CONTROL_CLASS, true);\n\n      // Add button for sorting by precision\n      this.globalPrecision = this.globalControls.append('li').attr('class', 'control-btn sort-precision').classed('active', function () {\n        if (that.vis.currentSorting.global.type === 'precision') {\n          // Save currently active element. Needed when when re-sorting for the\n          // first time, to be able to de-highlight this element.\n          that.vis.currentSorting.global.el = d3.select(this);\n          return true;\n        }\n        return false;\n      }).on('click', function () {\n        that.sortAllColumns(this, 'precision');\n      }).on('mouseenter', function () {\n        _this.vis.interactionWrapper.call(_this.vis, function () {\n          _this.highlightBars(undefined, 'precision');\n        }, []);\n      }).on('mouseleave', function () {\n        _this.vis.interactionWrapper.call(_this.vis, function () {\n          _this.highlightBars(undefined, 'precision', true);\n        }, []);\n      });\n\n      this.globalPrecisionWrapper = this.globalPrecision.append('div').attr('class', 'wrapper');\n\n      this.globalPrecisionWrapper.append('span').attr('class', 'label').text('Precision');\n\n      this.globalPrecisionWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'precision').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n      this.globalPrecisionWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'precision' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-asc');\n\n      this.globalPrecisionWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'precision' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-desc');\n\n      // Add button for sorting by recall\n      this.globalRecall = this.globalControls.append('li').attr('class', 'control-btn sort-recall').classed('active', function () {\n        if (that.vis.currentSorting.global.type === 'recall') {\n          // See precision\n          that.vis.currentSorting.global.el = d3.select(this);\n          return true;\n        }\n        return false;\n      }).on('click', function () {\n        that.sortAllColumns(this, 'recall');\n      }).on('mouseenter', function () {\n        _this.vis.interactionWrapper.call(_this.vis, function () {\n          _this.highlightBars(undefined, 'recall');\n        }, []);\n      }).on('mouseleave', function () {\n        _this.vis.interactionWrapper.call(_this.vis, function () {\n          _this.highlightBars(undefined, 'recall', true);\n        }, []);\n      });\n\n      this.globalRecallWrapper = this.globalRecall.append('div').attr('class', 'wrapper');\n\n      this.globalRecallWrapper.append('span').attr('class', 'label').text('Recall');\n\n      this.globalRecallWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'recall').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n      this.globalRecallWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'recall' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-asc');\n\n      this.globalRecallWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'recall' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-desc');\n\n      // Add button for sorting by name\n      this.globalName = this.globalControls.append('li').attr('class', 'control-btn sort-name').classed('active', function () {\n        if (that.vis.currentSorting.global.type === 'name') {\n          // See precision\n          that.vis.currentSorting.global.el = d3.select(this);\n          return true;\n        }\n        return false;\n      }).on('click', function () {\n        that.sortAllColumns(this, 'name');\n      }).on('mouseenter', function () {\n        _this.vis.interactionWrapper.call(_this.vis, function () {\n          _this.highlightLabels();\n        }, []);\n      }).on('mouseleave', function () {\n        _this.vis.interactionWrapper.call(_this.vis, function () {\n          _this.highlightLabels(true);\n        }, []);\n      });\n\n      this.globalNameWrapper = this.globalName.append('div').attr('class', 'wrapper');\n\n      this.globalNameWrapper.append('span').attr('class', 'label').text('Name');\n\n      this.globalNameWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'name').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n      this.globalNameWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'name' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-alpha-asc');\n\n      this.globalNameWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'name' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-alpha-desc');\n\n      // Add button for switching to 'one bar'\n      this.globalOneBar = this.globalControls.append('li').attr('class', 'control-btn one-bar').classed('active', this.vis.barMode === 'one').on('click', function () {\n        that.switchBarMode(this, 'one');\n      });\n\n      this.globalOneBarWrapper = this.globalOneBar.append('div').attr('class', 'wrapper').text('One bar');\n\n      this.globalOneBarWrapper.append('svg').attr('class', 'icon-one-bar').append('use').attr('xlink:href', this.vis.iconPath + '#one-bar');\n\n      // Add button for switching to 'two bars'\n      this.globalTwoBars = this.globalControls.append('li').attr('class', 'control-btn two-bars').classed('active', this.vis.barMode === 'two').on('click', function () {\n        that.switchBarMode(this, 'two');\n      });\n\n      this.globalTwoBarsWrapper = this.globalTwoBars.append('div').attr('class', 'wrapper').text('Two bars');\n\n      this.globalTwoBarsWrapper.append('svg').attr('class', 'icon-two-bars').append('use').attr('xlink:href', this.vis.iconPath + '#two-bars');\n\n      // Add button for zoom-out\n      this.globalZoomOut = this.globalControls.append('li').attr('class', 'control-btn zoom-out').classed('active', this.vis.zoomedOut).on('mouseenter', function () {\n        _this.vis.interactionWrapper.call(_this.vis, function () {\n          _this.vis.globalView.call(_this.vis);\n        }, []);\n      }).on('mouseleave', function () {\n        _this.vis.interactionWrapper.call(_this.vis, function () {\n          _this.vis.zoomedView.call(_this.vis);\n        }, []);\n      }).on('click', function () {\n        that.vis.toggleView.call(that.vis);\n        d3.select(this).classed('active', that.vis.zoomedOut);\n      });\n\n      this.globalZoomOutWrapper = this.globalZoomOut.append('div').attr('class', 'wrapper').text('Zoom Out').style('margin-right', this.visData.global.column.padding + 'px');\n\n      this.globalZoomOutWrapper.append('svg').attr('class', 'icon-zoom-out').append('use').attr('xlink:href', this.vis.iconPath + '#zoom-out');\n\n      this.localControlWrapper = this.el.append('div').classed('local-controls', true);\n\n      this.localControls = this.localControlWrapper.selectAll(TOPBAR_CONTROL_CLASS).data(visData.nodes).enter().append(TOPBAR_CONTROL_EL).classed(TOPBAR_CONTROL_CLASS, true).style('width', this.visData.global.column.width + 'px');\n\n      this.localControls.each(function (data, index) {\n        var control = d3.select(this);\n\n        /*\n         * Order:\n         * 0 = unsorted\n         * 1 = asc\n         * -1 = desc\n         */\n        that.vis.currentSorting.local[index] = {\n          type: data.sortBy,\n          order: data.sortOrder,\n          el: undefined\n        };\n\n        control.append('li').attr('class', 'control-btn toggle').style('width', that.visData.global.column.padding + 'px').on('click', that.toggleColumn);\n\n        control.append('li').attr('class', 'control-btn sort-precision ease-all').classed('active', function () {\n          if (that.vis.currentSorting.local[index].type === 'precision') {\n            // See precision\n            that.vis.currentSorting.local[index].el = d3.select(this);\n            return true;\n          }\n          return false;\n        }).style({\n          width: that.visData.global.column.contentWidth / 2 + 'px',\n          left: that.visData.global.column.padding + 'px'\n        }).on('click', function (controlData) {\n          that.sortColumn(this, controlData.level, 'precision');\n        }).on('mouseenter', function () {\n          that.highlightBars(this.parentNode, 'precision');\n          d3.select(this).style('width', that.visData.global.column.contentWidth - 16 + 'px');\n        }).on('mouseleave', function () {\n          that.highlightBars(this.parentNode, 'precision', true);\n          d3.select(this).style('width', that.visData.global.column.contentWidth / 2 + 'px');\n        }).html('<div class=\"expandable-label\">' + '  <span class=\"letter abbr\">P</span>' + '  <span class=\"letter abbr\">r</span>' + '  <span class=\"letter\">e</span>' + '  <span class=\"letter abbr\">c</span>' + '  <span class=\"letter\">i</span>' + '  <span class=\"letter\">s</span>' + '  <span class=\"letter\">i</span>' + '  <span class=\"letter\">o</span>' + '  <span class=\"letter\">n</span>' + '</div>' + '<svg class=\"icon-unsort invisible-default ' + (that.vis.currentSorting.local[index].type !== 'precision' ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#unsort\"></use>' + '</svg>' + '<svg class=\"icon-sort-asc invisible-default ' + (that.vis.currentSorting.local[index].type === 'precision' && that.vis.currentSorting.local[index].order === 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#sort-asc\"></use>' + '</svg>' + '<svg class=\"icon-sort-desc invisible-default ' + (that.vis.currentSorting.local[index].type === 'precision' && that.vis.currentSorting.local[index].order !== 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#sort-desc\"></use>' + '</svg>');\n\n        control.append('li').attr('class', 'control-btn sort-recall ease-all').classed('active', function () {\n          if (that.vis.currentSorting.local[index].type === 'recall') {\n            // See recall\n            that.vis.currentSorting.local[index].el = d3.select(this);\n            return true;\n          }\n          return false;\n        }).style({\n          width: that.visData.global.column.contentWidth / 2 + 'px',\n          left: that.visData.global.column.contentWidth / 2 + that.visData.global.column.padding + 'px'\n        }).on('click', function (controlData) {\n          that.sortColumn(this, controlData.level, 'recall');\n        }).on('mouseenter', function () {\n          that.highlightBars(this.parentNode, 'recall');\n          d3.select(this).style({\n            width: that.visData.global.column.contentWidth - 16 + 'px',\n            left: that.visData.global.column.padding + 16 + 'px'\n          });\n        }).on('mouseleave', function () {\n          that.highlightBars(this.parentNode, 'recall', true);\n          d3.select(this).style({\n            width: that.visData.global.column.contentWidth / 2 + 'px',\n            left: that.visData.global.column.contentWidth / 2 + that.visData.global.column.padding + 'px'\n          });\n        }).html('<div class=\"expandable-label\">' + '  <span class=\"letter abbr\">R</span>' + '  <span class=\"letter\">e</span>' + '  <span class=\"letter abbr\">c</span>' + '  <span class=\"letter\">a</span>' + '  <span class=\"letter abbr\">l</span>' + '  <span class=\"letter\">l</span>' + '</div>' + '<svg class=\"icon-unsort invisible-default ' + (that.vis.currentSorting.local[index].type !== 'recall' ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#unsort\"></use>' + '</svg>' + '<svg class=\"icon-sort-asc invisible-default ' + (that.vis.currentSorting.local[index].type === 'recall' && that.vis.currentSorting.local[index].order === 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#sort-asc\"></use>' + '</svg>' + '<svg class=\"icon-sort-desc invisible-default ' + (that.vis.currentSorting.local[index].type === 'recall' && that.vis.currentSorting.local[index].order !== 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#sort-desc\"></use>' + '</svg>');\n\n        control.append('li').attr('class', 'control-btn options').style('width', that.visData.global.column.padding + 'px').on('click', that.toggleOptions).html('<svg class=\"icon-gear\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#gear\"></use>' + '</svg>');\n\n        if (that.vis.currentSorting.local[index].type) {\n          that.vis.currentSorting.local[index].el = control.select('.sort-' + that.vis.currentSorting.local[index].type);\n        }\n      });\n    }\n\n    // toggleColumn () {\n    //   console.log('Toggle column');\n    // }\n\n    babelHelpers.createClass(Topbar, [{\n      key: 'selectNodesLevel',\n      value: function selectNodesLevel(el) {\n        return this.vis.selectByLevel(d3.select(el).datum().level, '.node');\n      }\n    }, {\n      key: 'highlightLabels',\n      value: function highlightLabels(deHighlight) {\n        this.vis.baseElD3.selectAll('.node').classed('highlight-label', !deHighlight);\n      }\n    }, {\n      key: 'highlightBars',\n      value: function highlightBars(el, type, deHighlight) {\n        var nodes = el ? this.selectNodesLevel(el) : this.vis.baseElD3.selectAll('.node');\n\n        nodes.classed('highlight-bar', !deHighlight).selectAll('.bar.' + type).classed('highlight', !deHighlight);\n      }\n    }, {\n      key: 'sortAllColumns',\n      value: function sortAllColumns(el, type) {\n        if (this.semiActiveSortingEls) {\n          this.resetSemiActiveSortingEls();\n        }\n\n        if (this.vis.currentSorting.global.type !== type) {\n          // Unset class of previous global sorting element\n          if (this.vis.currentSorting.global.el) {\n            this.resetSortEl(this.vis.currentSorting.global.el, type);\n          }\n        }\n\n        this.vis.currentSorting.global.el = d3.select(el);\n        this.vis.currentSorting.global.el.classed('active', true);\n        this.vis.currentSorting.global.type = type;\n\n        var columnKeys = Object.keys(this.vis.currentSorting.local);\n        for (var i = 0, len = columnKeys.length; i < len; i++) {\n          this.sortColumn(el, columnKeys[i], type, true);\n        }\n\n        this.vis.sortAllColumns(type, true);\n      }\n    }, {\n      key: 'sortColumn',\n      value: function sortColumn(el, index, type, global) {\n        // Reset global sorting\n        if (!global) {\n          if (this.semiActiveSortingEls) {\n            this.resetSemiActiveSortingEls();\n          }\n          if (this.vis.currentSorting.global.type) {\n            this.resetSortEl(this.vis.currentSorting.global.el, type);\n          }\n          this.vis.currentSorting.global.type = undefined;\n        }\n\n        var newSortType = false;\n\n        if (this.vis.currentSorting.local[index].el) {\n          if (this.vis.currentSorting.local[index].type !== type) {\n            this.resetSortEl(this.vis.currentSorting.local[index].el, type);\n          }\n        }\n\n        if (this.vis.currentSorting.local[index].type !== type) {\n          newSortType = true;\n          // Reset sort order\n          this.vis.currentSorting.local[index].order = 0;\n        }\n\n        this.vis.currentSorting.local[index].el = d3.select(el);\n        this.vis.currentSorting.local[index].type = type;\n\n        // -1 = desc, 1 = asc\n        if (this.vis.currentSorting.local[index].order === -1) {\n          this.vis.currentSorting.local[index].order = 1;\n          this.vis.currentSorting.local[index].el.select('.icon-sort-desc').classed('visible', false);\n          this.vis.currentSorting.local[index].el.select('.icon-sort-asc').classed('visible', true);\n        } else {\n          this.vis.currentSorting.local[index].order = -1;\n          this.vis.currentSorting.local[index].el.select('.icon-sort-asc').classed('visible', false);\n          this.vis.currentSorting.local[index].el.select('.icon-sort-desc').classed('visible', true);\n        }\n\n        this.vis.currentSorting.local[index].el.select('.icon-unsort').classed('visible', false);\n\n        this.vis.currentSorting.local[index].el.classed('active', true);\n\n        if (!global) {\n          this.vis.sortColumn(index, type, this.vis.currentSorting.local[index].order, newSortType);\n        }\n      }\n    }, {\n      key: 'resetSortEl',\n      value: function resetSortEl(el, newType) {\n        el.classed('active', false);\n        el.select('.icon-sort-desc').classed('visible', false);\n        el.select('.icon-sort-asc').classed('visible', false);\n        el.select('.icon-unsort').classed('visible', true);\n        if (newType === 'name') {\n          el.classed('semi-active', true);\n          this.semiActiveSortingEls = true;\n        }\n      }\n    }, {\n      key: 'resetSemiActiveSortingEls',\n      value: function resetSemiActiveSortingEls() {\n        this.el.selectAll('.semi-active').classed('semi-active', false);\n      }\n\n      // toggleOptions () {\n      //   console.log('Toggle options');\n      // }\n\n    }, {\n      key: 'switch',\n      value: function _switch() {\n        this.el.classed('details', !this.el.classed('details'));\n      }\n    }, {\n      key: 'switchBarMode',\n      value: function switchBarMode(el, mode) {\n        if (this.vis.nodes.barMode !== mode) {\n          if (mode === 'one') {\n            this.globalOneBar.classed('active', true);\n            this.globalTwoBars.classed('active', false);\n          } else {\n            this.globalOneBar.classed('active', false);\n            this.globalTwoBars.classed('active', true);\n          }\n          this.vis.switchBarMode(mode);\n        }\n      }\n    }]);\n    return Topbar;\n  }();\n\n  var COLUMN_CLASS = 'column';\n  var SCROLL_CONTAINER_CLASS = 'scroll-container';\n\n  var Levels = function () {\n    function Levels(selection, vis, visData) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Levels);\n\n      this.vis = vis;\n      this.visData = visData;\n      this.groups = selection.selectAll('g').data(this.visData.nodes).enter().append('g').attr('class', COLUMN_CLASS).classed('active', function (data, index) {\n        if (_this.vis.highlightActiveLevel) {\n          if (!_this.vis.nodes || !_this.vis.nodes.rootedNode) {\n            return index === _this.vis.activeLevel - _this.vis.noRootActiveLevelDiff;\n          }\n          return index === _this.vis.activeLevel;\n        }\n        return false;\n      });\n\n      // We need to add an empty rectangle that fills up the whole column to ensure\n      // that the `g`'s size is at a maximum, otherwise scrolling will be halted\n      // when the cursor leaves an actually drawn element.\n      this.groups.append('rect').attr('class', SCROLL_CONTAINER_CLASS).attr('x', function (data) {\n        return data.x;\n      }).attr('y', function (data) {\n        return data.y;\n      }).attr('width', this.visData.global.column.width + 1).attr('height', this.visData.global.column.height);\n    }\n\n    babelHelpers.createClass(Levels, [{\n      key: 'scrollPreparation',\n      value: function scrollPreparation(vis, scrollbarWidth) {\n        var _this2 = this;\n\n        this.groups.each(function (data, index) {\n          var contentHeight = data.nodes.getBoundingClientRect().height + 2 * _this2.visData.global.row.padding;\n          var scrollHeight = contentHeight - _this2.visData.global.column.height;\n          var scrollbarHeight = scrollHeight > 0 ? Math.max(_this2.visData.global.column.height * _this2.visData.global.column.height / contentHeight, 10) : 0;\n\n          data.height = contentHeight;\n          data.linkSelections = {\n            incoming: index > 0 ? vis.selectByLevel(index - 1, '.link') : null,\n            outgoing: vis.selectByLevel(index, '.link')\n          };\n          data.scrollHeight = scrollHeight;\n          data.scrollTop = 0;\n          data.scrollbar = {\n            el: undefined,\n            x: data.x + _this2.visData.global.column.width - scrollbarWidth,\n            y: 0,\n            width: scrollbarWidth,\n            height: scrollbarHeight,\n            scrollHeight: _this2.visData.global.column.height - scrollbarHeight,\n            scrollTop: 0,\n            heightScale: d3.scale.linear().domain([0, scrollHeight]).range([0, _this2.visData.global.column.height - scrollbarHeight])\n          };\n          data.invertedHeightScale = data.scrollbar.heightScale.invert;\n        });\n      }\n    }, {\n      key: 'updateScrollProperties',\n      value: function updateScrollProperties() {\n        var _this3 = this;\n\n        this.groups.each(function (data) {\n          var contentHeight = data.nodes.getBoundingClientRect().height + 2 * _this3.visData.global.row.padding;\n          var scrollHeight = contentHeight - _this3.visData.global.column.height;\n          var scrollbarHeight = scrollHeight > 0 ? Math.max(_this3.visData.global.column.height * _this3.visData.global.column.height / contentHeight, 10) : 0;\n\n          data.height = contentHeight;\n          data.scrollHeight = scrollHeight;\n          data.scrollTop = 0;\n          data.scrollbar.y = 0;\n          data.scrollbar.height = scrollbarHeight;\n          data.scrollbar.scrollHeight = _this3.visData.global.column.height - scrollbarHeight;\n          data.scrollbar.scrollTop = 0;\n          data.scrollbar.heightScale = d3.scale.linear().domain([0, scrollHeight]).range([0, _this3.visData.global.column.height - scrollbarHeight]);\n        });\n      }\n    }, {\n      key: 'updateVisibility',\n      value: function updateVisibility() {\n        this.groups.each(function () {\n          var group = d3.select(this);\n\n          group.classed('hidden', group.selectAll('.node').filter(function (data) {\n            return !data.hidden;\n          }).empty());\n        });\n      }\n    }, {\n      key: 'focus',\n      value: function focus(level) {\n        if (this.vis.highlightActiveLevel) {\n          this.groups.filter(function (data) {\n            return data.level === level;\n          }).classed('active', true);\n        }\n      }\n    }, {\n      key: 'blur',\n      value: function blur(level) {\n        if (this.vis.highlightActiveLevel) {\n          if (level) {\n            this.groups.filter(function (data) {\n              return data.level === level;\n            }).classed('active', false);\n          } else {\n            this.groups.classed('active', false);\n          }\n        }\n      }\n    }, {\n      key: 'className',\n      get: function get() {\n        return COLUMN_CLASS;\n      }\n    }, {\n      key: 'height',\n      get: function get() {\n        return this.visData.global.column.height;\n      }\n    }]);\n    return Levels;\n  }();\n\n  var LINKS_CLASS = 'links';\n  var LINK_CLASS = 'link';\n\n  var Links = function () {\n    function Links(vis, levels, visData, layout) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Links);\n\n      this.vis = vis;\n      this.visData = visData;\n      this.layout = layout;\n\n      this.groups = levels.append('g').attr('class', LINKS_CLASS).call(function (selection) {\n        selection.each(function () {\n          d3.select(this.parentNode).datum().links = this;\n        });\n      });\n\n      this.links = this.groups.selectAll(LINK_CLASS).data(function (data, index) {\n        return _this.layout.links(index);\n      }).enter().append('g').attr('class', LINK_CLASS).classed('visible', !this.vis.hideOutwardsLinks || this.linkVisibility.bind(this));\n\n      this.links.append('path').attr({\n        class: LINK_CLASS + '-bg',\n        d: this.diagonal\n      });\n\n      this.links.append('path').attr({\n        class: LINK_CLASS + '-direct',\n        d: this.diagonal\n      });\n    }\n\n    babelHelpers.createClass(Links, [{\n      key: 'linkVisibility',\n      value: function linkVisibility(data) {\n        // Cache visibility.\n        data.hidden = this.vis.pointsOutside.call(this.vis, data);\n        return data.hidden === 0;\n      }\n    }, {\n      key: 'highlight',\n      value: function highlight(nodeIds, _highlight, className) {\n        this.links.filter(function (data) {\n          return nodeIds[data.id];\n        }).classed(className, _highlight);\n      }\n    }, {\n      key: 'scroll',\n      value: function scroll(selection, data) {\n        // Update data of `g`.\n        selection.data(data);\n\n        if (this.vis.hideOutwardsLinks) {\n          // Check if links point outwards.\n          selection.classed('visible', this.linkVisibility.bind(this));\n        }\n\n        // Next, update all paths according to the new data.\n        selection.selectAll('path').attr('d', this.diagonal);\n      }\n    }, {\n      key: 'sort',\n      value: function sort(update) {\n        var start = function start() {\n          d3.select(this).classed('sorting', true);\n        };\n        var end = function end() {\n          d3.select(this).classed('sorting', false);\n        };\n\n        // Update data of `g`.\n        this.links.data(update, function (data) {\n          return data.id;\n        });\n\n        // Next update all paths according to the new data.\n        this.links.selectAll('path').transition().duration(TRANSITION_SEMI_FAST).attr('d', this.diagonal).each('start', start).each('end', end);\n      }\n    }, {\n      key: 'updateVisibility',\n      value: function updateVisibility() {\n        this.links.selectAll('path').classed('hidden', function (data) {\n          return data.target.node.hidden || data.source.node.hidden;\n        }).transition().duration(TRANSITION_SEMI_FAST).attr('d', this.diagonal);\n      }\n    }, {\n      key: 'diagonal',\n      get: function get() {\n        var _this2 = this;\n\n        var extraOffsetX = this.vis.showLinkLocation ? 6 : 0;\n\n        function getSourceX(source) {\n          return source.node.x + source.offsetX + this.visData.global.column.contentWidth + this.visData.global.column.padding;\n        }\n\n        function getTargetX(source) {\n          return source.node.x + source.offsetX + this.visData.global.column.padding;\n        }\n\n        function getY(source) {\n          return source.node.y + source.offsetY + this.visData.global.row.height / 2;\n        }\n\n        return function (data) {\n          var sourceY = getY.call(_this2, data.source);\n          var sourceX = getSourceX.call(_this2, data.source);\n          var targetY = getY.call(_this2, data.target);\n          var targetX = getTargetX.call(_this2, data.target);\n          var middleX = (sourceX + targetX) / 2;\n\n          return 'M' + sourceX + ',' + sourceY + 'h' + extraOffsetX + 'C' + (middleX + extraOffsetX) + ',' + sourceY + ' ' + (middleX - extraOffsetX) + ',' + targetY + ' ' + (targetX - extraOffsetX) + ',' + targetY + 'h' + extraOffsetX;\n        };\n      }\n    }]);\n    return Links;\n  }();\n\n  /**\n   * Checks if `value` is the [language type](https://es5.github.io/#x8) of `Object`.\n   * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n   * @example\n   *\n   * _.isObject({});\n   * // => true\n   *\n   * _.isObject([1, 2, 3]);\n   * // => true\n   *\n   * _.isObject(_.noop);\n   * // => true\n   *\n   * _.isObject(null);\n   * // => false\n   */\n  function isObject(value) {\n    var type = typeof value;\n    return !!value && (type == 'object' || type == 'function');\n  }\n\n  var funcTag = '[object Function]';\n  var genTag = '[object GeneratorFunction]';\n  /** Used for built-in method references. */\n  var objectProto = Object.prototype;\n\n  /**\n   * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n   * of values.\n   */\n  var objectToString = objectProto.toString;\n\n  /**\n   * Checks if `value` is classified as a `Function` object.\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n   * @example\n   *\n   * _.isFunction(_);\n   * // => true\n   *\n   * _.isFunction(/abc/);\n   * // => false\n   */\n  function isFunction(value) {\n    // The use of `Object#toString` avoids issues with the `typeof` operator\n    // in Safari 8 which returns 'object' for typed array constructors, and\n    // PhantomJS 1.9 which returns 'function' for `NodeList` instances.\n    var tag = isObject(value) ? objectToString.call(value) : '';\n    return tag == funcTag || tag == genTag;\n  }\n\n  /**\n   * Checks if `value` is a global object.\n   *\n   * @private\n   * @param {*} value The value to check.\n   * @returns {null|Object} Returns `value` if it's a global object, else `null`.\n   */\n  function checkGlobal(value) {\n    return (value && value.Object === Object) ? value : null;\n  }\n\n  /** Used to determine if values are of the language type `Object`. */\n  var objectTypes = {\n    'function': true,\n    'object': true\n  };\n\n  /** Detect free variable `exports`. */\n  var freeExports = (objectTypes[typeof exports] && exports && !exports.nodeType)\n    ? exports\n    : undefined;\n\n  /** Detect free variable `module`. */\n  var freeModule = (objectTypes[typeof module] && module && !module.nodeType)\n    ? module\n    : undefined;\n\n  /** Detect free variable `global` from Node.js. */\n  var freeGlobal = checkGlobal(freeExports && freeModule && typeof global == 'object' && global);\n\n  /** Detect free variable `self`. */\n  var freeSelf = checkGlobal(objectTypes[typeof self] && self);\n\n  /** Detect free variable `window`. */\n  var freeWindow = checkGlobal(objectTypes[typeof window] && window);\n\n  /** Detect `this` as the global object. */\n  var thisGlobal = checkGlobal(objectTypes[typeof this] && this);\n\n  /**\n   * Used as a reference to the global object.\n   *\n   * The `this` value is used if it's the global object to avoid Greasemonkey's\n   * restricted `window` object, otherwise the `window` object is used.\n   */\n  var root = freeGlobal ||\n    ((freeWindow !== (thisGlobal && thisGlobal.window)) && freeWindow) ||\n      freeSelf || thisGlobal || Function('return this')();\n\n  /* Built-in method references for those with the same name as other `lodash` methods. */\n  var nativeIsFinite = root.isFinite;\n\n  /**\n   * Checks if `value` is a finite primitive number.\n   *\n   * **Note:** This method is based on [`Number.isFinite`](https://mdn.io/Number/isFinite).\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is a finite number, else `false`.\n   * @example\n   *\n   * _.isFinite(3);\n   * // => true\n   *\n   * _.isFinite(Number.MAX_VALUE);\n   * // => true\n   *\n   * _.isFinite(3.14);\n   * // => true\n   *\n   * _.isFinite(Infinity);\n   * // => false\n   */\n  function isFinite(value) {\n    return typeof value == 'number' && nativeIsFinite(value);\n  }\n\n  /**\n   * Collect all cloned nodes, including the original node.\n   *\n   * @method  collectInclClones\n   * @author  Fritz Lekschas\n   * @date    2015-12-30\n   * @param   {Object}  node  Start node\n   * @return  {Array}         Array of original and cloned nodes.\n   */\n  function collectInclClones(node) {\n    var originalNode = node;\n\n    if (node.clone) {\n      originalNode = node.originalNode;\n    }\n\n    var clones = [originalNode];\n\n    if (originalNode.clones.length) {\n      clones = clones.concat(originalNode.clones);\n    }\n\n    return clones;\n  }\n\n  function up(node, callback, depth, includeClones, child) {\n    var nodesInclClones = includeClones ? collectInclClones(node) : [node];\n\n    for (var i = nodesInclClones.length; i--;) {\n      if (child) {\n        callback(nodesInclClones[i], child);\n      }\n\n      if (!isFinite(depth) || depth > 0) {\n        var parentsId = Object.keys(nodesInclClones[i].parents);\n        for (var j = parentsId.length; j--;) {\n          up(nodesInclClones[i].parents[parentsId[j]], callback, depth - 1, includeClones, nodesInclClones[i]);\n        }\n      }\n    }\n  }\n\n  function down(node, callback, depth, includeClones) {\n    var nodesInclClones = includeClones ? collectInclClones(node) : [node];\n\n    for (var i = nodesInclClones.length; i--;) {\n      callback(nodesInclClones[i]);\n\n      if (!isFinite(depth) || depth > 0) {\n        for (var j = nodesInclClones[i].childRefs.length; j--;) {\n          down(nodesInclClones[i].childRefs[j], callback, depth - 1, includeClones);\n        }\n      }\n    }\n  }\n\n  function upAndDown(node, callbackUp, callbackDown, depth, includeClones) {\n    if (callbackDown) {\n      up(node, callbackUp, depth, includeClones);\n      down(node, callbackDown, depth, includeClones);\n    } else {\n      up(node, callbackUp, depth, includeClones);\n      down(node, callbackUp, depth, includeClones);\n    }\n  }\n\n  function siblings(node, callback) {\n    var parentsId = Object.keys(node.parents);\n    for (var i = parentsId.length; i--;) {\n      for (var j = node.parents[parentsId[i]].childRefs.length; j--;) {\n        callback(node.parents[parentsId[i]].childRefs[j]);\n      }\n    }\n    // The root node doesn't have a `parents` property but might have `siblings`.\n    if (node.siblings) {\n      var siblingsId = Object.keys(node.siblings);\n      for (var i = siblingsId.length; i--;) {\n        callback(node.siblings[siblingsId[i]]);\n      }\n    }\n  }\n\n  // Credits go to Mike Bostock: http://bl.ocks.org/mbostock/3468167\n  function roundRect(x, y, width, height, radius) {\n    var topLeft = radius.topLeft || 0;\n    var topRight = radius.topRight || 0;\n    var bottomLeft = radius.bottomLeft || 0;\n    var bottomRight = radius.bottomRight || 0;\n\n    return 'M' + (x + topLeft) + ',' + y + 'h' + (width - topLeft - topRight) + 'a' + topRight + ',' + topRight + ' 0 0 1 ' + topRight + ',' + topRight + 'v' + (height - (topRight + bottomRight)) + 'a' + bottomRight + ',' + bottomRight + ' 0 0 1 ' + -bottomRight + ',' + bottomRight + 'h' + (bottomLeft - (width - bottomRight)) + 'a' + bottomLeft + ',' + bottomLeft + ' 0 0 1 ' + -bottomLeft + ',' + -bottomLeft + 'v' + (topLeft - (height - bottomLeft)) + 'a' + topLeft + ',' + topLeft + ' 0 0 1 ' + topLeft + ',' + -topLeft + 'z';\n  }\n\n  var BAR_CLASS = 'bar';\n\n  var Bar = function () {\n    function Bar(barGroup, barData, nodeData, visData, bars) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Bar);\n\n      this.data = barData;\n      this.nodeData = nodeData;\n      this.visData = visData;\n      this.bars = bars;\n\n      this.data.x = nodeData.x;\n      this.data.level = nodeData.depth;\n\n      this.height = this.visData.global.row.contentHeight / (this.data.length * 2) - this.visData.global.cell.padding * 2;\n\n      this.activeHeight = this.visData.global.row.contentHeight - 2;\n\n      this.inactiveheight = this.visData.global.cell.padding * 2 - 1;\n\n      this.selection = barGroup.selectAll(BAR_CLASS).data(this.data).enter().append('g').attr('class', function (data) {\n        return BAR_CLASS + ' ' + data.id;\n      }).classed('active', function (data) {\n        return data.id === _this.visData.nodes[_this.nodeData.depth].sortBy;\n      });\n\n      // Local helper method to avoid code duplication.\n      // Calling a class method from within the consructor is possible but `this`\n      // is not available. Thus, we need to create local function and pass in\n      // `this` as `that`, which feels very hacky but it works.\n      function setupMagnitude(selection) {\n        var _this2 = this;\n\n        var currentSorting = this.visData.nodes[this.nodeData.depth].sortBy;\n\n        selection.attr('d', function (data) {\n          return Bar.generatePath(data, _this2.bars.mode, currentSorting, _this2.visData);\n        }).classed('bar-magnitude', true);\n      }\n\n      function setupBorder(selection) {\n        selection.attr('x', 0).attr('y', this.visData.global.row.padding).attr('width', this.visData.global.column.contentWidth).attr('height', this.visData.global.row.contentHeight).attr('rx', 2).attr('ry', 2).classed('bar-border', true);\n      }\n\n      function setupIndicator(selection) {\n        selection.attr({\n          class: 'bar-indicator',\n          x: 0,\n          y: this.visData.global.row.padding,\n          width: 2,\n          height: 4\n        });\n      }\n\n      this.selection.append('rect').call(setupBorder.bind(this));\n\n      this.selection.append('path').call(setupMagnitude.bind(this));\n\n      this.selection.append('rect').call(setupIndicator.bind(this));\n    }\n\n    babelHelpers.createClass(Bar, null, [{\n      key: 'updateIndicator',\n      value: function updateIndicator(selection, contentWidth, contentHeight, referenceValue, lessTransitions, reference) {\n        var y = Math.min(contentWidth * Math.min(referenceValue, 1) - 1, contentWidth - 2);\n\n        // Stop previous transitions.\n        selection.attr({\n          height: contentHeight,\n          x: reference ? y : 0\n        }).classed('positive', function (data) {\n          return data.value >= referenceValue;\n        }).transition().duration(0).attr('width', reference ? 2 : lessTransitions ? y : 0 // eslint-disable-line no-nested-ternary\n        );\n\n        if (!lessTransitions && !reference) {\n          selection.transition().duration(TRANSITION_SEMI_FAST).attr('width', y);\n        }\n      }\n    }, {\n      key: 'generatePath',\n      value: function generatePath(data, mode, currentSorting, visData, indicator, adjustWidth, bottom) {\n        if (mode === 'two') {\n          return Bar.generateTwoBarsPath(data, visData, bottom);\n        }\n        return Bar.generateOneBarPath(data, currentSorting, visData, indicator, adjustWidth);\n      }\n    }, {\n      key: 'generateOneBarPath',\n      value: function generateOneBarPath(data, currentSorting, visData, indicator, adjustWidth) {\n        var height = visData.global.row.contentHeight;\n        var normValue = Math.min(data.value, 1);\n        var normIndicator = Math.min(indicator, 1);\n\n        var x = 0;\n        var width = 2;\n\n        var radius = {\n          topLeft: 2,\n          bottomLeft: 2\n        };\n\n        if (indicator) {\n          radius = {};\n        }\n\n        if (data.id !== currentSorting && typeof indicator === 'undefined') {\n          x = normValue * visData.global.column.contentWidth - 3;\n          radius = {};\n        } else if (indicator) {\n          x = normIndicator * visData.global.column.contentWidth;\n          if (adjustWidth) {\n            if (normValue < normIndicator) {\n              x = normValue * visData.global.column.contentWidth;\n            }\n            width = Math.max(Math.abs(normIndicator - normValue) * visData.global.column.contentWidth, 2);\n          }\n        } else {\n          width = visData.global.column.contentWidth * normValue;\n        }\n\n        x = Math.min(x, visData.global.column.contentWidth - 2);\n\n        return roundRect(x, visData.global.row.padding, width, height, radius);\n      }\n    }, {\n      key: 'generateTwoBarsPath',\n      value: function generateTwoBarsPath(data, visData, bottom) {\n        var normValue = Math.min(data.value, 1);\n        var height = visData.global.row.contentHeight / 2;\n        var width = visData.global.column.contentWidth * normValue;\n\n        var y = visData.global.row.padding;\n        var radius = { topLeft: 2 };\n\n        if (bottom) {\n          radius = { bottomLeft: 2 };\n          y += height;\n        }\n\n        return roundRect(0, y, width, height, radius);\n      }\n    }]);\n    return Bar;\n  }();\n\n  var BARS_CLASS = 'bars';\n\n  var Bars = function () {\n    function Bars(vis, selection, mode, visData) {\n      babelHelpers.classCallCheck(this, Bars);\n\n      var that = this;\n\n      this.vis = vis;\n      this.mode = mode;\n      this.visData = visData;\n\n      this.selection = selection.append('g').attr('class', BARS_CLASS);\n\n      this.selection.each(function (datum) {\n        new Bar(d3.select(this), datum.data.bars, datum, that.visData, that);\n      });\n    }\n\n    babelHelpers.createClass(Bars, [{\n      key: 'updateAll',\n      value: function updateAll(update, sortBy) {\n        var _this = this;\n\n        this.selection.selectAll('.bar-magnitude').data(update, function (data) {\n          return data.barId;\n        }).transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n          return Bar.generatePath(data, _this.mode, sortBy, _this.visData);\n        });\n      }\n    }, {\n      key: 'update',\n      value: function update(selection, sortBy) {\n        var _this2 = this;\n\n        selection.each(function (data) {\n          var el = d3.select(this);\n\n          if (data.id === sortBy && !el.classed('active')) {\n            el.classed('active', true);\n            // Ensure that the active bars we are places before any other bar,\n            // thus placing them in the background\n            this.parentNode.insertBefore(this, this.parentNode.children[0]);\n          }\n\n          if (data.id !== sortBy) {\n            el.classed('active', false);\n          }\n        });\n\n        selection.selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n          return Bar.generatePath(data, _this2.mode, sortBy, _this2.visData);\n        });\n      }\n    }, {\n      key: 'updateIndicator',\n      value: function updateIndicator(bars, referenceValue, direct) {\n        Bar.updateIndicator(bars, this.visData.global.column.contentWidth, direct ? this.visData.global.row.contentHeight : 4, referenceValue, this.vis.lessTransitionsJs, direct);\n      }\n    }, {\n      key: 'switchMode',\n      value: function switchMode(mode, currentSorting) {\n        var _this3 = this;\n\n        if (this.mode !== mode) {\n          if (mode === 'one') {\n            if (currentSorting.global.type) {\n              this.selection.selectAll('.bar').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n                return Bar.generateOneBarPath(data, currentSorting.global.type, _this3.visData);\n              });\n            } else {\n              // console.error(\n              //   'Switching magnitude visualization after individual sorting is ' +\n              //   'not supported yet.'\n              // );\n            }\n          }\n\n          if (mode === 'two') {\n            this.selection.selectAll('.bar.precision').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n              return Bar.generateTwoBarsPath(data, _this3.visData);\n            });\n\n            this.selection.selectAll('.bar.recall').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n              return Bar.generateTwoBarsPath(data, _this3.visData, true);\n            });\n          }\n\n          this.mode = mode;\n        }\n      }\n    }]);\n    return Bars;\n  }();\n\n  function mergeSelections(selections) {\n    // Create a new empty selection\n    var mergedSelection = d3.selectAll('.d3-list-graph-not-existent');\n\n    function pushSelection(selection) {\n      selection.each(function pushDomNode() {\n        mergedSelection[0].push(this);\n      });\n    }\n\n    for (var i = selections.length; i--;) {\n      pushSelection(selections[i]);\n    }\n\n    return mergedSelection;\n  }\n\n  function allTransitionsEnded(transition, callback) {\n    if (transition.size() === 0) {\n      callback();\n    }\n    var n = 0;\n    transition.each(function () {\n      return ++n;\n    }).each('end', function () {\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      if (! --n) callback.apply(this, args);\n    });\n  }\n\n  var CLASS_NODES = 'nodes';\n  var CLASS_NODE = 'node';\n  var CLASS_CLONE = 'clone';\n  var CLASS_LABEL_WRAPPER = 'label-wrapper';\n  var CLASS_FOCUS_CONTROLS = 'focus-controls';\n  var CLASS_ROOT = 'root';\n  var CLASS_QUERY = 'query';\n  var CLASS_LOCK = 'lock';\n  var CLASS_ACTIVE = 'active';\n  var CLASS_INACTIVE = 'inactive';\n  var CLASS_INDICATOR_BAR = 'link-indicator';\n  var CLASS_INDICATOR_LOCATION = 'link-location-indicator';\n  var CLASS_INDICATOR_INCOMING = 'incoming';\n  var CLASS_INDICATOR_OUTGOING = 'outgoing';\n  var CLASS_INDICATOR_ABOVE = 'above';\n  var CLASS_INDICATOR_BELOW = 'below';\n\n  var Nodes = function () {\n    function Nodes(vis, baseSelection, visData, links, events) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Nodes);\n\n      var that = this;\n\n      this.vis = vis;\n      this.visData = visData;\n      this.links = links;\n      this.events = events;\n      this.currentLinks = {};\n      this.iconDimension = Math.min(this.visData.global.row.contentHeight / 2 - this.visData.global.cell.padding * 2, this.visData.global.column.padding / 2 - 4);\n\n      var linkDensityBg = d3.scale.linear().domain([1, this.vis.rows]).range(['#ccc', '#000']);\n\n      function drawLinkIndicator(selection, direction) {\n        var incoming = direction === 'incoming';\n\n        selection.attr('class', CLASS_INDICATOR_BAR + ' ' + (incoming ? CLASS_INDICATOR_INCOMING : CLASS_INDICATOR_OUTGOING)).attr('d', roundRect(incoming ? -7 : this.visData.global.column.contentWidth, this.visData.global.row.height / 2 - 1, 7, 2, {\n          topLeft: incoming ? 1 : 0,\n          topRight: incoming ? 0 : 1,\n          bottomLeft: incoming ? 1 : 0,\n          bottomRight: incoming ? 0 : 1\n        })).attr('fill', function (data) {\n          return linkDensityBg(data.links[direction].refs.length);\n        }).classed('visible', function (data) {\n          return data.links[direction].refs.length > 0;\n        });\n      }\n\n      function drawLinkLocationIndicator(selection, direction, position) {\n        var above = position === 'above';\n        var incoming = direction === 'incoming';\n\n        var className = CLASS_INDICATOR_LOCATION + ' ' + (incoming ? CLASS_INDICATOR_INCOMING : CLASS_INDICATOR_OUTGOING) + ' ' + (above ? CLASS_INDICATOR_ABOVE : CLASS_INDICATOR_BELOW);\n\n        selection.datum(function (data) {\n          return data.links[direction];\n        }).attr('class', className).attr('x', incoming ? -5 : this.visData.global.column.contentWidth + 2).attr('y', above ? this.visData.global.row.height / 2 - 1 : this.visData.global.row.height / 2 + 1).attr('width', 3).attr('height', 3).attr('fill', function (data) {\n          return linkDensityBg(data.refs.length);\n        });\n      }\n\n      // Helper\n      function drawFullSizeRect(selection, className, shrinking, noRoundBorder) {\n        var shrinkingAmount = shrinking || 0;\n\n        selection.attr('x', shrinkingAmount).attr('y', that.visData.global.row.padding + shrinkingAmount).attr('width', that.visData.global.column.contentWidth - 2 * shrinkingAmount).attr('height', that.visData.global.row.contentHeight - 2 * shrinkingAmount).attr('rx', noRoundBorder ? 0 : 2 - shrinkingAmount).attr('ry', noRoundBorder ? 0 : 2 - shrinkingAmount).classed(className, true);\n      }\n\n      this.groups = baseSelection.append('g').attr('class', CLASS_NODES).call(function (selection) {\n        selection.each(function storeLinkToGroupNode() {\n          d3.select(this.parentNode).datum().nodes = this;\n        });\n      });\n\n      this.nodes = this.groups.selectAll('.' + CLASS_NODE).data(function (data) {\n        return data.rows;\n      }).enter().append('g').classed(CLASS_NODE, true).classed(CLASS_CLONE, function (data) {\n        return data.clone;\n      }).attr('transform', function (data) {\n        return 'translate(' + (data.x + _this.visData.global.column.padding) + ', ' + data.y + ')';\n      }).on('mouseenter', function (data) {\n        that.vis.interactionWrapper.call(that.vis, function (domEl, _data) {\n          var el = d3.select(domEl);\n\n          if (!!!this.vis.activeScrollbar) {\n            this.enterHandler.call(this, domEl, _data);\n          }\n\n          if (!el.classed('rooted')) {\n            el.selectAll('.bg-extension').style('transform', 'translateX(' + (this.vis.querying ? -this.iconDimension * 2 - 10 : -this.iconDimension - 6) + 'px)');\n          }\n        }.bind(that), [this, data]);\n      }).on('mouseleave', function (data) {\n        that.vis.interactionWrapper.call(that.vis, function (domEl, _data) {\n          var el = d3.select(domEl);\n\n          if (!!!this.vis.activeScrollbar) {\n            this.leaveHandler.call(this, domEl, _data);\n          }\n\n          if (!el.classed('rooted')) {\n            if (_data.data.queryMode) {\n              el.selectAll('.bg-extension').style('transform', 'translateX(' + (-this.iconDimension - 6) + 'px)');\n            } else {\n              el.selectAll('.bg-extension').style('transform', 'translateX(0px)');\n            }\n          }\n        }.bind(that), [this, data]);\n      });\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'bg-extension').attr('width', Math.max(this.visData.global.column.padding + this.visData.global.column.contentWidth / 2, this.visData.global.column.contentWidth));\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'bg-border');\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'bg', 1, true);\n\n      if (this.vis.showLinkLocation) {\n        this.nodes.append('rect').call(drawLinkLocationIndicator.bind(this), 'incoming', 'above');\n        this.nodes.append('rect').call(drawLinkLocationIndicator.bind(this), 'incoming', 'bottom');\n        this.nodes.append('rect').call(drawLinkLocationIndicator.bind(this), 'outgoing', 'above');\n        this.nodes.append('rect').call(drawLinkLocationIndicator.bind(this), 'outgoing', 'bottom');\n\n        this.nodes.append('path').call(drawLinkIndicator.bind(this), 'incoming');\n        this.nodes.append('path').call(drawLinkIndicator.bind(this), 'outgoing');\n\n        // Set all the link location indicator bars.\n        this.groups.each(function (data, index) {\n          _this.calcHeightLinkLocationIndicator(index, true, true);\n        });\n      }\n\n      // Rooting icons\n      var nodeRooted = this.nodes.append('g').attr('class', CLASS_FOCUS_CONTROLS + ' ' + CLASS_ROOT + ' ' + CLASS_INACTIVE);\n\n      nodeRooted.append('rect').call(this.setUpFocusControls.bind(this), 'left', this.vis.querying ? 2 : 1, 'hover-helper', 'hover-helper');\n\n      nodeRooted.append('svg').call(this.setUpFocusControls.bind(this), 'left', this.vis.querying ? 2 : 1, 'icon', 'ease-all state-inactive invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#unlocked');\n\n      nodeRooted.append('svg').call(this.setUpFocusControls.bind(this), 'left', this.vis.querying ? 2 : 1, 'icon', 'ease-all state-active invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#locked');\n\n      // Querying icons\n      if (this.vis.querying) {\n        var nodeQuery = this.nodes.append('g').attr('class', CLASS_FOCUS_CONTROLS + ' ' + CLASS_QUERY + ' ' + CLASS_INACTIVE);\n\n        nodeQuery.append('rect').call(this.setUpFocusControls.bind(this), 'left', 1, 'hover-helper', 'hover-helper');\n\n        nodeQuery.append('svg').call(this.setUpFocusControls.bind(this), 'left', 1, 'icon', 'ease-all state-inactive invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#set-inactive');\n\n        nodeQuery.append('svg').call(this.setUpFocusControls.bind(this), 'left', 1, 'icon', 'ease-all state-and-or invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#union');\n\n        nodeQuery.append('svg').call(this.setUpFocusControls.bind(this), 'left', 1, 'icon', 'ease-all state-not invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#not');\n      }\n\n      var nodeLocks = this.nodes.append('g').attr('class', CLASS_FOCUS_CONTROLS + ' ' + CLASS_LOCK + ' ' + CLASS_INACTIVE);\n\n      nodeLocks.append('circle').call(this.setUpFocusControls.bind(this), 'right', 0, 'bg', 'bg');\n\n      nodeLocks.append('svg').call(this.setUpFocusControls.bind(this), 'right', 0, 'icon', 'ease-all state-inactive invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#unlocked');\n\n      nodeLocks.append('svg').call(this.setUpFocusControls.bind(this), 'right', 0, 'icon', 'ease-all state-active invisible-default icon').append('use').attr('xlink:href', this.vis.iconPath + '#locked');\n\n      this.bars = new Bars(this.vis, this.nodes, this.vis.barMode, this.visData);\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'border');\n\n      // Add node label\n      this.nodes.append('foreignObject').attr('x', this.visData.global.cell.padding).attr('y', this.visData.global.row.padding + this.visData.global.cell.padding).attr('width', this.visData.global.column.contentWidth).attr('height', this.visData.global.row.contentHeight - this.visData.global.cell.padding * 2).attr('class', CLASS_LABEL_WRAPPER).append('xhtml:div').attr('class', 'label').attr('title', function (data) {\n        return data.data.name;\n      }).style('line-height', this.visData.global.row.contentHeight - this.visData.global.cell.padding * 2 + 'px').append('xhtml:span').text(function (data) {\n        return data.data.name;\n      });\n\n      if (isFunction(this.events.on)) {\n        // this.events.on('d3ListGraphNodeClick', dataSetIds => {\n        //   console.log('d3ListGraphNodeClick', dataSetIds);\n        // });\n\n        this.events.on('d3ListGraphFocusNodes', function (event) {\n          return _this.focusNodes(event);\n        });\n\n        this.events.on('d3ListGraphBlurNodes', function (event) {\n          return _this.blurNodes(event);\n        });\n\n        this.events.on('d3ListGraphNodeEnter', function (nodeIds) {\n          return _this.eventHelper(nodeIds, _this.highlightNodes);\n        });\n\n        this.events.on('d3ListGraphNodeLeave', function (nodeIds) {\n          return _this.eventHelper(nodeIds, _this.unhighlightNodes);\n        });\n\n        this.events.on('d3ListGraphNodeLock', function (nodeIds) {\n          return _this.eventHelper(nodeIds, _this.toggleLock, [], '.lock');\n        });\n\n        this.events.on('d3ListGraphNodeUnlock', function (nodeIds) {\n          return _this.eventHelper(nodeIds, _this.toggleLock, [true], '.lock');\n        });\n\n        this.events.on('d3ListGraphNodeRoot', function (data) {\n          return _this.eventHelper(data.nodeIds, _this.toggleRoot, [], '.root');\n        });\n\n        this.events.on('d3ListGraphNodeUnroot', function (data) {\n          return _this.eventHelper(data.nodeIds, _this.toggleRoot, [true], '.root');\n        });\n      }\n    }\n\n    babelHelpers.createClass(Nodes, [{\n      key: 'updateLinkLocationIndicators',\n      value: function updateLinkLocationIndicators(left, right) {\n        this.calcHeightLinkLocationIndicator(left, false, true);\n        this.calcHeightLinkLocationIndicator(right, true, false);\n      }\n    }, {\n      key: 'calcHeightLinkLocationIndicator',\n      value: function calcHeightLinkLocationIndicator(level, incoming, outgoing) {\n        var nodes = this.nodes.filter(function (data) {\n          return data.depth === level;\n        });\n        nodes.each(function (data) {\n          if (incoming) {\n            data.links.incoming.above = 0;\n            data.links.incoming.below = 0;\n            for (var i = data.links.incoming.total; i--;) {\n              // We are checking the source location of the incoming link. The\n              // source location is the location of the node of the column being\n              // scrolled.\n              if ((data.links.incoming.refs[i].hidden & 1) > 0) {\n                data.links.incoming.above++;\n              }\n              if ((data.links.incoming.refs[i].hidden & 2) > 0) {\n                data.links.incoming.below++;\n              }\n            }\n          }\n          if (outgoing) {\n            data.links.outgoing.above = 0;\n            data.links.outgoing.below = 0;\n            for (var i = data.links.outgoing.total; i--;) {\n              // We are checking the target location of the outgoing link. The\n              // source location is the location of the node of the column being\n              // scrolled.\n              if ((data.links.outgoing.refs[i].hidden & 4) > 0) {\n                data.links.outgoing.above++;\n              }\n              if ((data.links.outgoing.refs[i].hidden & 8) > 0) {\n                data.links.outgoing.below++;\n              }\n            }\n          }\n        });\n\n        if (incoming) {\n          this.updateHeightLinkLocationIndicatorBars(nodes);\n        }\n\n        if (outgoing) {\n          this.updateHeightLinkLocationIndicatorBars(nodes, true);\n        }\n      }\n    }, {\n      key: 'updateHeightLinkLocationIndicatorBars',\n      value: function updateHeightLinkLocationIndicatorBars(selection, outgoing) {\n        var barRefHeight = this.visData.global.row.contentHeight / 2 - 1;\n        var barAboveRefTop = this.visData.global.row.height / 2 - 1;\n\n        var baseClassName = '.' + CLASS_INDICATOR_LOCATION + '.' + (outgoing ? CLASS_INDICATOR_OUTGOING : CLASS_INDICATOR_INCOMING);\n\n        selection.selectAll(baseClassName + '.' + CLASS_INDICATOR_ABOVE).attr('y', function (data) {\n          return data.total ? barAboveRefTop - data.above / data.total * barRefHeight : barAboveRefTop;\n        }).attr('height', function (data) {\n          return data.total ? data.above / data.total * barRefHeight : 0;\n        });\n\n        selection.selectAll(baseClassName + '.' + CLASS_INDICATOR_BELOW).attr('height', function (data) {\n          return data.total ? data.below / data.total * barRefHeight : 0;\n        });\n      }\n    }, {\n      key: 'clickHandler',\n      value: function clickHandler(el, data) {\n        this.toggleQueryMode(el.parentNode, data);\n        // this.events.broadcast('d3ListGraphNodeClick', { id: data.id });\n      }\n    }, {\n      key: 'enterHandler',\n      value: function enterHandler(el, data) {\n        this.highlightNodes(el, data);\n\n        var eventData = {\n          id: data.id,\n          clone: false,\n          clonedFromId: undefined\n        };\n\n        if (data.clone) {\n          eventData.clone = true;\n          eventData.clonedFromId = data.originalNode.id;\n        }\n\n        this.events.broadcast('d3ListGraphNodeEnter', eventData);\n      }\n    }, {\n      key: 'leaveHandler',\n      value: function leaveHandler(el, data) {\n        this.unhighlightNodes(el, data);\n\n        var eventData = {\n          id: data.id,\n          clone: false,\n          clonedFromId: undefined\n        };\n\n        if (data.clone) {\n          eventData.clone = true;\n          eventData.clonedFromId = data.originalNode.id;\n        }\n\n        this.events.broadcast('d3ListGraphNodeLeave', eventData);\n      }\n    }, {\n      key: 'lockHandler',\n      value: function lockHandler(el) {\n        var events = this.toggleLock(el);\n\n        if (events.locked && events.unlocked) {\n          if (events.locked) {\n            this.events.broadcast('d3ListGraphNodeLockChange', {\n              lock: {\n                id: events.locked.id,\n                clone: events.locked.clone,\n                clonedFromId: events.locked.clone ? events.locked.originalNode.id : undefined\n              },\n              unlock: {\n                id: events.unlocked.id,\n                clone: events.unlocked.clone,\n                clonedFromId: events.unlocked.clone ? events.unlocked.originalNode.id : undefined\n              }\n            });\n          }\n        } else {\n          if (events.locked) {\n            this.events.broadcast('d3ListGraphNodeLock', {\n              id: events.locked.id,\n              clone: events.locked.clone,\n              clonedFromId: events.locked.clone ? events.locked.originalNode.id : undefined\n            });\n          }\n\n          if (events.unlocked) {\n            this.events.broadcast('d3ListGraphNodeUnlock', {\n              id: events.unlocked.id,\n              clone: events.unlocked.clone,\n              clonedFromId: events.unlocked.clone ? events.unlocked.originalNode.id : undefined\n            });\n          }\n        }\n      }\n    }, {\n      key: 'rootHandler',\n      value: function rootHandler(el) {\n        var events = this.toggleRoot(el);\n\n        if (events.rooted && events.unrooted) {\n          this.events.broadcast('d3ListGraphNodeReroot', {\n            rooted: {\n              id: events.rooted.id,\n              clone: events.rooted.clone,\n              clonedFromId: events.rooted.clone ? events.rooted.originalNode.id : undefined\n            },\n            unrooted: {\n              id: events.unrooted.id,\n              clone: events.unrooted.clone,\n              clonedFromId: events.unrooted.clone ? events.unrooted.originalNode.id : undefined\n            }\n          });\n        } else {\n          if (events.rooted) {\n            this.events.broadcast('d3ListGraphNodeRoot', {\n              id: events.rooted.id,\n              clone: events.rooted.clone,\n              clonedFromId: events.rooted.clone ? events.rooted.originalNode.id : undefined\n            });\n          }\n\n          if (events.unrooted) {\n            this.events.broadcast('d3ListGraphNodeUnroot', {\n              id: events.unrooted.id,\n              clone: events.unrooted.clone,\n              clonedFromId: events.unrooted.clone ? events.unrooted.originalNode.id : undefined\n            });\n          }\n        }\n\n        this.events.broadcast('d3ListGraphUpdateBarsRequest', {\n          id: events.rooted.id,\n          clone: events.rooted.clone,\n          clonedFromId: events.rooted.clone ? events.rooted.originalNode.id : undefined\n        });\n      }\n    }, {\n      key: 'focusNodes',\n      value: function focusNodes(event) {\n        this.eventHelper(event.nodeIds, this.highlightNodes, ['focus', 'directParentsOnly', !!event.excludeClones]);\n        if (event.zoomOut) {\n          this.vis.globalView(this.nodes.filter(function (data) {\n            return data.hovering > 0;\n          }));\n        } else {\n          this.vis.zoomedView();\n        }\n      }\n    }, {\n      key: 'blurNodes',\n      value: function blurNodes(event) {\n        this.eventHelper(event.nodeIds, this.unhighlightNodes, ['focus', 'directParentsOnly', !!event.excludeClones]);\n        if (event.zoomIn) {\n          this.vis.zoomedView();\n        }\n      }\n    }, {\n      key: 'eventHelper',\n      value: function eventHelper(nodeIds, callback, optionalParams, subSelectionClass) {\n        var that = this;\n\n        this.nodes\n        // Filter by node ID\n        .filter(function (data) {\n          return !! ~nodeIds.indexOf(data.id);\n        }).each(function triggerCallback(data) {\n          var el = this;\n\n          if (subSelectionClass) {\n            el = d3.select(this).select(subSelectionClass).node();\n          }\n\n          callback.apply(that, [el, data].concat(optionalParams || []));\n        });\n      }\n    }, {\n      key: 'toggleLock',\n      value: function toggleLock(el, nodeData, setFalse) {\n        var d3El = d3.select(el);\n        var data = d3El.datum();\n        var events = { locked: false, unlocked: false };\n\n        if (this.lockedNode) {\n          this.lockedNode.classed(CLASS_ACTIVE, false).classed(CLASS_INACTIVE, true);\n          if (this.lockedNode.datum().id === data.id) {\n            this.unlockNode(this.lockedNode.datum().id);\n            events.unlocked = this.lockedNode.datum();\n            this.lockedNode = undefined;\n          } else {\n            // Reset previously locked node;\n            this.unlockNode(this.lockedNode.datum().id);\n            events.unlocked = this.lockedNode.datum();\n\n            if (!setFalse) {\n              d3El.classed(CLASS_ACTIVE, true).classed(CLASS_INACTIVE, false);\n              this.lockNode(data.id);\n              events.locked = data;\n              this.lockedNode = d3El;\n            }\n          }\n        } else {\n          if (!setFalse) {\n            d3El.classed(CLASS_ACTIVE, true).classed(CLASS_INACTIVE, false);\n            this.lockNode(data.id);\n            events.locked = data;\n            this.lockedNode = d3El;\n          }\n        }\n\n        return events;\n      }\n    }, {\n      key: 'lockNode',\n      value: function lockNode(id) {\n        var that = this;\n        var els = this.nodes.filter(function (data) {\n          return data.id === id;\n        });\n\n        els.each(function triggerHighlighter(data) {\n          that.highlightNodes(this, data, 'lock', undefined);\n        });\n\n        els.selectAll('.bg-border').transition().duration(TRANSITION_SEMI_FAST).attr('width', function width() {\n          return parseInt(d3.select(this).attr('width'), 10) + that.visData.global.row.height / 2;\n        });\n      }\n    }, {\n      key: 'unlockNode',\n      value: function unlockNode(id) {\n        var that = this;\n        var els = this.nodes.filter(function (data) {\n          return data.id === id;\n        });\n        var start = function animationStart() {\n          d3.select(this.parentNode).classed('animating', true);\n        };\n        var end = function animationEnd() {\n          d3.select(this.parentNode).classed('animating', false);\n        };\n\n        els.selectAll('.bg-border').transition().duration(TRANSITION_SEMI_FAST).attr('width', this.visData.global.column.contentWidth).each('start', start).each('end', end);\n\n        els.each(function (data) {\n          that.unhighlightNodes(this, data, 'lock', undefined);\n        });\n      }\n    }, {\n      key: 'queryNode',\n      value: function queryNode(el, data, mode) {\n        data.data.queryMode = mode;\n        d3.select(el).classed({\n          active: true,\n          inactive: false,\n          'query-and': mode === 'and',\n          'query-or': mode === 'or',\n          'query-not': mode === 'not'\n        });\n      }\n    }, {\n      key: 'unqueryNode',\n      value: function unqueryNode(el, data) {\n        data.data.queryMode = undefined;\n        data.data.queryBeforeRooting = undefined;\n        d3.select(el).classed({\n          active: false,\n          inactive: true,\n          'query-and': false,\n          'query-or': false,\n          'query-not': false\n        });\n        if (this.rootedNode) {\n          this.updateVisibility();\n        }\n      }\n    }, {\n      key: 'toggleQueryMode',\n      value: function toggleQueryMode(el, data) {\n        var previousMode = data.data.queryMode;\n\n        if (data.rooted) {\n          if (previousMode !== 'or') {\n            this.queryNode(el, data, 'or');\n          } else {\n            this.queryNode(el, data, 'and');\n          }\n        } else {\n          switch (previousMode) {\n            case 'or':\n              this.queryNode(el, data, 'and');\n              break;\n            case 'and':\n              this.queryNode(el, data, 'not');\n              break;\n            case 'not':\n              this.unqueryNode(el, data);\n              break;\n            default:\n              this.queryNode(el, data, 'or');\n              break;\n          }\n        }\n\n        if (data.data.queryMode) {\n          if (data.data.queryMode !== previousMode) {\n            this.events.broadcast('d3ListGraphNodeQuery', {\n              id: data.id,\n              clone: data.clone,\n              clonedFromId: data.clone ? data.originalNode.id : undefined,\n              mode: data.data.queryMode\n            });\n          }\n        } else {\n          this.events.broadcast('d3ListGraphNodeUnquery', {\n            id: data.id,\n            clone: data.clone,\n            clonedFromId: data.clone ? data.originalNode.id : undefined\n          });\n        }\n      }\n    }, {\n      key: 'progToggleQueryMode',\n      value: function progToggleQueryMode(el, data) {\n        this.toggleQueryMode(d3.select(el).selectAll('.focus-controls.query')[0].node(), data);\n      }\n    }, {\n      key: 'toggleRoot',\n      value: function toggleRoot(el, setFalse) {\n        var d3El = d3.select(el);\n        var data = d3El.datum();\n        var events = { rooted: false, unrooted: false };\n\n        // Blur current levels\n        this.vis.levels.blur();\n\n        if (this.rootedNode) {\n          // Reset current root node\n          this.rootedNode.classed({ active: false, inactive: true });\n          this.unrootNode(this.rootedNode.node(), this.rootedNode.datum());\n          events.unrooted = this.rootedNode.datum();\n\n          // Activate new root\n          if (this.rootedNode.datum().id !== data.id && !setFalse) {\n            d3El.classed({ active: true, inactive: false });\n            this.rootNode(el, data);\n            this.rootedNode = d3El;\n            events.rooted = data;\n          } else {\n            this.rootedNode = undefined;\n            // Highlight first level\n            this.vis.levels.focus(this.vis.activeLevel - this.vis.noRootActiveLevelDiff);\n          }\n        } else {\n          if (!setFalse) {\n            d3El.classed({ active: true, inactive: false });\n            this.rootNode(el, data);\n            events.rooted = data;\n            this.rootedNode = d3El;\n          }\n        }\n\n        return events;\n      }\n    }, {\n      key: 'rootNode',\n      value: function rootNode(el, data) {\n        var d3El = d3.select(el.parentNode);\n\n        data.rooted = true;\n        d3El.classed('rooted', true);\n        this.hideNodes(d3El.node(), data, 'downStream');\n\n        d3El.selectAll('.bg-extension').style('transform', 'translateX(' + (this.vis.querying ? -this.iconDimension * 2 - 10 : -this.iconDimension - 6) + 'px)');\n\n        // Highlight level\n        this.vis.levels.focus(data.depth + this.vis.activeLevel);\n\n        if (!data.data.queryMode || data.data.queryMode === 'not') {\n          this.toggleQueryMode(d3El.node(), data);\n          data.data.queryBeforeRooting = false;\n        } else {\n          data.data.queryBeforeRooting = true;\n        }\n      }\n    }, {\n      key: 'unrootNode',\n      value: function unrootNode(el, data) {\n        var d3El = d3.select(el.parentNode);\n\n        var x = 0;\n\n        if (data.data.queryMode) {\n          x = -this.iconDimension - 6;\n        }\n\n        d3El.selectAll('.bg-extension').style('transform', 'translateX(' + x + 'px)');\n\n        data.rooted = false;\n        d3El.classed('rooted', false);\n        this.showNodes(d3El.node(), data, 'downStream');\n\n        if (!data.data.queryBeforeRooting) {\n          this.unqueryNode(d3El.node(), data);\n        }\n      }\n    }, {\n      key: 'setUpFocusControls',\n      value: function setUpFocusControls(selection, location, position, mode, className) {\n        // const height = (this.visData.global.row.contentHeight / 2 -\n        //   this.visData.global.cell.padding * 2);\n\n        var paddedDim = this.iconDimension + 4;\n\n        var x = location === 'left' ? -paddedDim * (position || 1) : this.visData.global.column.contentWidth + 2;\n        var y = this.visData.global.row.padding + (this.visData.global.row.contentHeight - 2 * this.visData.global.cell.padding) / 4;\n\n        if (mode === 'bg') {\n          selection.attr({\n            class: className,\n            cx: x + this.iconDimension / 2,\n            cy: y + this.iconDimension / 2,\n            r: this.iconDimension * 3 / 4\n          });\n        } else if (mode === 'hover-helper') {\n          selection.attr({\n            class: className,\n            x: x - 2,\n            y: y - 2,\n            width: this.iconDimension + 4,\n            height: this.iconDimension + 4\n          });\n        } else {\n          selection.attr({\n            class: className,\n            x: x,\n            y: y,\n            width: this.iconDimension,\n            height: this.iconDimension\n          });\n        }\n      }\n\n      /**\n       * Helper method to hide nodes.\n       *\n       * @method  hideNodes\n       * @author  Fritz Lekschas\n       * @date    2016-02-21\n       * @param   {Object}  el         DOM element.\n       * @param   {Object}  data       D3 data object of `el`.\n       * @param   {String}  direction  Defines whether upstream or downstream nodes\n       *   should be hidden.\n       */\n\n    }, {\n      key: 'hideNodes',\n      value: function hideNodes(el, data, direction) {\n        this.nodesVisibility(el, data, direction);\n      }\n\n      /**\n       * Helper method to show nodes.\n       *\n       * @method  showNodes\n       * @author  Fritz Lekschas\n       * @date    2016-02-21\n       * @param   {Object}  el         DOM element.\n       * @param   {Object}  data       D3 data object of `el`.\n       * @param   {String}  direction  Defines whether upstream or downstream nodes\n       *   should be shown.\n       */\n\n    }, {\n      key: 'showNodes',\n      value: function showNodes(el, data, direction) {\n        this.nodesVisibility(el, data, direction, true);\n      }\n\n      /**\n       * Sets the nodes' visibility\n       *\n       * @method  nodesVisibility\n       * @author  Fritz Lekschas\n       * @date    2016-02-21\n       * @param   {Object}   el         DOM element.\n       * @param   {Object}   data       D3 data object of `el`.\n       * @param   {String}   direction  Defines whether upstream or downstream nodes\n       * @param   {Boolean}  show       If `true` nodes will be shown.\n       */\n\n    }, {\n      key: 'nodesVisibility',\n      value: function nodesVisibility(el, data, direction, show) {\n        if (show) {\n          this.nodes.classed('hidden', false).each(function (nodeData) {\n            nodeData.hidden = false;\n          });\n        } else {\n          // First we set all nodes to `hidden`.\n          this.nodes.each(function (nodeData) {\n            nodeData.hidden = true;\n          });\n\n          // Then we set direct child and parent nodes of the current node visible.\n          upAndDown(data, function (nodeData) {\n            nodeData.hidden = false;\n          });\n\n          // We also show sibling nodes.\n          siblings(data, function (nodeData) {\n            nodeData.hidden = false;\n          });\n\n          this.nodes.classed('hidden', function (nodeData) {\n            return nodeData.hidden && !nodeData.data.queryMode;\n          });\n        }\n        this.updateVisibility();\n      }\n    }, {\n      key: 'highlightNodes',\n      value: function highlightNodes(el, data, className, restriction, excludeClones) {\n        var _this2 = this;\n\n        var that = this;\n        var nodeId = data.id;\n        var currentNodeData = data.clone ? data.originalNode : data;\n        var includeParents = true;\n        var appliedClassName = className || 'hovering';\n        var includeClones = !!!excludeClones;\n        var includeChildren = restriction !== 'directParentsOnly';\n\n        // Store link IDs\n        if (!this.currentLinks[appliedClassName]) {\n          this.currentLinks[appliedClassName] = {};\n        }\n        this.currentLinks[appliedClassName][nodeId] = {};\n\n        var currentlyActiveBar = d3.select(el).selectAll('.bar.active .bar-magnitude');\n        if (!currentlyActiveBar.empty()) {\n          currentlyActiveBar = currentlyActiveBar.datum();\n        } else {\n          currentlyActiveBar = undefined;\n        }\n\n        var traverseCallbackUp = function traverseCallbackUp(nodeData, childData) {\n          nodeData.hovering = 2;\n          for (var i = nodeData.links.outgoing.refs.length; i--;) {\n            // Only push direct parent child connections. E.g.\n            // Store: (parent)->(child)\n            // Ignore: (parent)->(siblings of child)\n            if (nodeData.links.outgoing.refs[i].target.node.id === childData.id) {\n              _this2.currentLinks[appliedClassName][nodeId][nodeData.links.outgoing.refs[i].id] = true;\n            }\n          }\n        };\n\n        var traverseCallbackDown = function traverseCallbackDown(nodeData) {\n          nodeData.hovering = 2;\n          for (var i = nodeData.links.outgoing.refs.length; i--;) {\n            _this2.currentLinks[appliedClassName][nodeId][nodeData.links.outgoing.refs[i].id] = true;\n          }\n        };\n\n        if (includeParents && includeChildren) {\n          upAndDown(data, traverseCallbackUp, traverseCallbackDown, undefined, includeClones);\n        }\n        if (includeParents && !includeChildren) {\n          up(data, traverseCallbackUp, undefined, includeClones);\n        }\n        if (!includeParents && includeChildren) {\n          down(data, traverseCallbackUp, undefined, includeClones);\n        }\n\n        currentNodeData.hovering = 1;\n\n        if (includeClones) {\n          for (var i = currentNodeData.clones.length; i--;) {\n            currentNodeData.clones[i].hovering = 1;\n          }\n        }\n\n        /**\n         * Helper method to assess the node visibility.\n         *\n         * @method  checkNodeVisibility\n         * @author  Fritz Lekschas\n         * @date    2016-02-25\n         * @param   {Object}  _el    [description]\n         * @param   {Object}  _data  [description]\n         * @return  {Boolean}        If `true` element is hidden.\n         */\n        function checkNodeVisibility(_el, _data) {\n          return !_data.hidden && !that.vis.isHidden.call(that.vis, _el);\n        }\n\n        /**\n         * Helper method to filter out directly hovered nodes.\n         *\n         * @method  checkNodeDirect\n         * @author  Fritz Lekschas\n         * @date    2016-02-25\n         * @param   {Object}  nodeData  The node's data object.\n         * @return  {Boolean}           If `true` element will not be filtered out.\n         */\n        function checkNodeDirect(nodeData) {\n          return nodeData.hovering === 1 && checkNodeVisibility(this, nodeData);\n        }\n\n        /**\n         * Helper method to filter out indirectly hovered nodes.\n         *\n         * @method  checkNodeIndirect\n         * @author  Fritz Lekschas\n         * @date    2016-02-25\n         * @param   {Object}  nodeData  The node's data object.\n         * @return  {Boolean}           If `true` element will not be filtered out.\n         */\n        function checkNodeIndirect(nodeData) {\n          return nodeData.hovering === 2 && checkNodeVisibility(this, nodeData);\n        }\n\n        /**\n         * Helper method to update bar indicators of the directly hovered node and\n         * clones.\n         *\n         * @method  updateDirectBarIndicator\n         * @author  Fritz Lekschas\n         * @date    2016-02-25\n         * @param   {Object}  selection  D3 node selection.\n         */\n        function updateDirectBarIndicator(selection) {\n          that.bars.updateIndicator(selection, currentlyActiveBar.value, true);\n        }\n\n        /**\n         * Helper method to update bar indicators of the indirectly hovered nodes.\n         *\n         * @method  updateDirectBarIndicator\n         * @author  Fritz Lekschas\n         * @date    2016-02-25\n         * @param   {Object}  selection  D3 node selection.\n         */\n        function updateIndirectBarIndicator(selection) {\n          that.bars.updateIndicator(selection, currentlyActiveBar.value);\n        }\n\n        var barIndicatorClass = currentlyActiveBar ? '.bar.' + currentlyActiveBar.id + ' .bar-indicator' : '';\n        var directNodes = this.nodes.filter(checkNodeDirect).classed(appliedClassName + '-directly', true);\n        var indirectNodes = this.nodes.filter(checkNodeIndirect).classed(appliedClassName + '-indirectly', true);\n\n        if (currentlyActiveBar) {\n          directNodes.select(barIndicatorClass).call(updateDirectBarIndicator);\n          indirectNodes.select(barIndicatorClass).call(updateIndirectBarIndicator);\n        }\n\n        this.links.highlight(this.currentLinks[appliedClassName][data.id], true, appliedClassName);\n      }\n    }, {\n      key: 'unhighlightNodes',\n      value: function unhighlightNodes(el, data, className, restriction, excludeClones) {\n        var traverseCallback = function traverseCallback(nodeData) {\n          nodeData.hovering = 0;\n        };\n        var includeParents = true;\n        var appliedClassName = className || 'hovering';\n        var includeClones = !!!excludeClones;\n        var includeChildren = restriction !== 'directParentsOnly';\n\n        data.hovering = 0;\n        if (includeParents && includeChildren) {\n          upAndDown(data, traverseCallback, undefined, undefined, includeClones);\n        }\n        if (includeParents && !includeChildren) {\n          up(data, traverseCallback, undefined, includeClones);\n        }\n        if (!includeParents && includeChildren) {\n          down(data, traverseCallback, undefined, includeClones);\n        }\n\n        if (data.clone) {\n          data.originalNode.hovering = 0;\n        } else {\n          if (includeClones) {\n            for (var i = data.clones.length; i--;) {\n              data.clones[i].hovering = 0;\n            }\n          }\n        }\n\n        this.nodes.classed(appliedClassName + '-directly', false);\n        this.nodes.classed(appliedClassName + '-indirectly', false);\n\n        if (this.currentLinks[appliedClassName][data.id]) {\n          this.links.highlight(this.currentLinks[appliedClassName][data.id], false, appliedClassName);\n        }\n      }\n    }, {\n      key: 'sort',\n      value: function sort(update, newSortType) {\n        var _this3 = this;\n\n        for (var i = update.length; i--;) {\n          var selection = this.nodes.data(update[i].rows, function (data) {\n            return data.id;\n          });\n\n          this.vis.svgD3.classed('sorting', true);\n          selection.transition().duration(TRANSITION_SEMI_FAST).attr('transform', function (data) {\n            return 'translate(' + (data.x + _this3.visData.global.column.padding) + ', ' + data.y + ')';\n          }).call(allTransitionsEnded, function () {\n            _this3.vis.svgD3.classed('sorting', false);\n            _this3.vis.updateLevelsVisibility();\n            _this3.vis.updateScrolling();\n          });\n\n          if (newSortType && this.vis.currentSorting.local[update[i].level].type !== 'name') {\n            this.bars.update(selection.selectAll('.bar'), update[i].sortBy);\n          }\n        }\n      }\n\n      /**\n       * Updates the nodes' visibility visually.\n       *\n       * @method  updateVisibility\n       * @author  Fritz Lekschas\n       * @date    2016-02-21\n       */\n\n    }, {\n      key: 'updateVisibility',\n      value: function updateVisibility() {\n        var _this4 = this;\n\n        // Calls the D3 list graph layout method to update the nodes position.\n        this.vis.layout.updateNodesVisibility();\n\n        // Transition to the updated position\n        this.nodes.transition().duration(TRANSITION_SEMI_FAST).attr('transform', function (data) {\n          return 'translate(' + (data.x + _this4.visData.global.column.padding) + ', ' + data.y + ')';\n        }).call(allTransitionsEnded, function () {\n          _this4.vis.updateLevelsVisibility();\n          _this4.vis.updateScrolling();\n        });\n\n        this.vis.links.updateVisibility();\n      }\n    }, {\n      key: 'classNnodes',\n      get: function get() {\n        return CLASS_NODES;\n      }\n    }, {\n      key: 'classNode',\n      get: function get() {\n        return CLASS_NODE;\n      }\n    }, {\n      key: 'classClone',\n      get: function get() {\n        return CLASS_CLONE;\n      }\n    }, {\n      key: 'classLabelWrapper',\n      get: function get() {\n        return CLASS_LABEL_WRAPPER;\n      }\n    }, {\n      key: 'classFocusControls',\n      get: function get() {\n        return CLASS_FOCUS_CONTROLS;\n      }\n    }, {\n      key: 'classRoot',\n      get: function get() {\n        return CLASS_ROOT;\n      }\n    }, {\n      key: 'classQuery',\n      get: function get() {\n        return CLASS_QUERY;\n      }\n    }, {\n      key: 'classLock',\n      get: function get() {\n        return CLASS_LOCK;\n      }\n    }, {\n      key: 'barMode',\n      get: function get() {\n        return this.bars.mode;\n      }\n    }]);\n    return Nodes;\n  }();\n\n  var SCROLLBAR_CLASS = 'scrollbar';\n\n  var Scrollbars = function () {\n    function Scrollbars(baseSelection, visData, width) {\n      babelHelpers.classCallCheck(this, Scrollbars);\n\n      this.visData = visData;\n      this.width = width;\n\n      // Add empty scrollbar element\n      this.all = baseSelection.append('rect').attr('class', SCROLLBAR_CLASS).call(function (selection) {\n        selection.each(function setScrollBarDomElement() {\n          d3.select(this.parentNode).datum().scrollbar.el = this;\n        });\n      }).attr('x', function (data) {\n        return data.scrollbar.x - 2;\n      }).attr('y', function (data) {\n        return data.scrollbar.y;\n      }).attr('width', this.width).attr('height', function (data) {\n        return data.scrollbar.height;\n      }).attr('rx', this.width / 2).attr('ry', this.width / 2).classed('ready', true);\n    }\n\n    babelHelpers.createClass(Scrollbars, [{\n      key: 'updateVisibility',\n      value: function updateVisibility() {\n        this.all.transition().duration(TRANSITION_LIGHTNING_FAST).attr({\n          x: function x(data) {\n            return data.scrollbar.x;\n          },\n          height: function height(data) {\n            return data.scrollbar.height;\n          }\n        });\n      }\n    }]);\n    return Scrollbars;\n  }();\n\n  /**\n   * Checks if `value` is classified as an `Array` object.\n   *\n   * @static\n   * @memberOf _\n   * @type {Function}\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n   * @example\n   *\n   * _.isArray([1, 2, 3]);\n   * // => true\n   *\n   * _.isArray(document.body.children);\n   * // => false\n   *\n   * _.isArray('abc');\n   * // => false\n   *\n   * _.isArray(_.noop);\n   * // => false\n   */\n  var isArray = Array.isArray;\n\n  var Events = function () {\n    function Events(el, broadcast) {\n      babelHelpers.classCallCheck(this, Events);\n\n      if (broadcast && !isFunction(broadcast)) {\n        throw new EventDispatcherNoFunction();\n      }\n\n      this.el = el;\n      this._stack = {};\n      this.dispatch = broadcast || this._dispatchEvent;\n    }\n\n    babelHelpers.createClass(Events, [{\n      key: '_dispatchEvent',\n      value: function _dispatchEvent(eventName, data) {\n        var event = document.createEvent('CustomEvent');\n        event.initCustomEvent(eventName, false, false, data);\n        this.el.dispatchEvent(event);\n      }\n    }, {\n      key: 'broadcast',\n      value: function broadcast(event, data) {\n        this.dispatch(event, data);\n      }\n\n      /**\n       * Add a callback function to an event stack.\n       *\n       * @method  on\n       * @author  Fritz Lekschas\n       * @date    2016-01-07\n       *\n       * @param   {String}    event     Event identifier.\n       * @param   {Function}  callback  Function which is called when the event\n       *   stack is triggered.\n       * @param   {Number}    times     Number of times the callback function should\n       *   be triggered before it is removed from the event stack. This is useful\n       *   when an event happens only a certain number of times.\n       * @return  {Number}              Index of callback, which is needed to\n       *   manually remove the callback from the event stack.\n       */\n\n    }, {\n      key: 'on',\n      value: function on(event, callback, times) {\n        if (!isFunction(callback)) {\n          return false;\n        }\n\n        var normTimes = isFinite(times) ? parseInt(times, 10) : Infinity;\n\n        if (isArray(this.stack[event])) {\n          return this.stack[event].push({ callback: callback, times: normTimes }) - 1;\n        }\n        this.stack[event] = [{ callback: callback, times: normTimes }];\n        return 0;\n      }\n\n      /**\n       * Removes a callback function from an event stack given its index.\n       *\n       * @method  off\n       * @author  Fritz Lekschas\n       * @date    2016-01-07\n       *\n       * @param   {String}   event  Event identifier.\n       * @param   {Number}   index  Index of the callback to be removed.\n       * @return  {Boolean}         Returns `true` if event callback was found and\n       *   successfully removed.\n       */\n\n    }, {\n      key: 'off',\n      value: function off(event, index) {\n        try {\n          this.stack[event].splice(index, 1);\n          return true;\n        } catch (e) {\n          return false;\n        }\n      }\n\n      /**\n       * Trigger an event stack\n       *\n       * @method  trigger\n       * @author  Fritz Lekschas\n       * @date    2016-01-07\n       *\n       * @param   {String}   event  Event identifier.\n       * @return  {Boolean}         Returns `true` if an event stack was found.\n       */\n\n    }, {\n      key: 'trigger',\n      value: function trigger(event, data) {\n        if (isArray(this.stack[event])) {\n          // Traversing from the end to the start, which has the advantage that\n          // deletion of events, i.e. calling `Event.off()` doesn't affect the index\n          // of event listeners in the next step.\n          for (var i = this.stack[event].length; i--;) {\n            // Instead of checking whether `stack[event][i]` is a function here,\n            // we do it just once when we add the function to the stack.\n            if (this.stack[event][i].times--) {\n              this.stack[event][i].callback(data);\n            } else {\n              this.off(event, i);\n            }\n          }\n          return true;\n        }\n        return false;\n      }\n    }, {\n      key: 'stack',\n      get: function get() {\n        return this._stack;\n      }\n    }]);\n    return Events;\n  }();\n\n  var LimitsUnsupportedFormat = function (_ExtendableError) {\n    babelHelpers.inherits(LimitsUnsupportedFormat, _ExtendableError);\n\n    function LimitsUnsupportedFormat(message) {\n      babelHelpers.classCallCheck(this, LimitsUnsupportedFormat);\n      return babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(LimitsUnsupportedFormat).call(this, message || 'The limits are wrongly formatted. Please provide an ' + 'object of the following format: `{ x: { min: 0, max: 1 }, y: { min: ' + '0, max: 1 } }`'));\n    }\n\n    return LimitsUnsupportedFormat;\n  }(ExtendableError);\n\n  /**\n   * Drap and drop event handler that works via translation.\n   *\n   * @method  onDragDrop\n   * @author  Fritz Lekschas\n   * @date    2016-01-23\n   * @param   {Object}  selection        D3 selection to listen for the drag\n   *   event.\n   * @param   {Object}           dragMoveHandler  Handler for drag-move.\n   * @param   {Object}           dropHandler      Handler for drag-end, i.e. drop.\n   * @param   {Array}            elsToBeDragged   Array of D3 selections to be\n   *   moved according to the drag event. If empty or undefined `selection` will\n   *   be used.\n   * @param   {String}           orientation      Can either be \"horizontal\",\n   *   \"vertical\" or `undefined`, i.e. both directions.\n   * @param   {Object|Function}  limits           X and Y drag limits. E.g.\n   *   `{ x: { min: 0, max: 10 } }`.\n   * @param   {Array}             notWhenTrue     List if function returning a\n   *   Boolean value which should prevent the dragMoveHandler from working.\n   */\n  function onDragDrop(selection, dragStartHandler, dragMoveHandler, dropHandler, elsToBeDragged, orientation, limits, notWhenTrue) {\n    var drag = d3.behavior.drag();\n\n    var appliedLimits = limits || {}; // eslint-disable-line no-param-reassign\n\n    if (dragStartHandler) {\n      drag.on('dragstart', function () {\n        if (typeof limits === 'function') {\n          appliedLimits = limits();\n        }\n        dragStartHandler();\n      });\n    }\n\n    if (dragMoveHandler) {\n      drag.on('drag', function (data) {\n        dragMoveHandler.call(this, data, elsToBeDragged, orientation, appliedLimits, notWhenTrue);\n      });\n    }\n\n    if (dropHandler) {\n      drag.on('dragend', dropHandler);\n    }\n\n    selection.each(function (data) {\n      var el = d3.select(this);\n\n      // Set default data if not available.\n      if (!data) {\n        data = { dragX: 0, dragY: 0 }; // eslint-disable-line no-param-reassign\n        el.datum(data);\n      }\n\n      // Add drag event handler\n      el.call(drag);\n    });\n  }\n\n  function dragMoveHandler(data, elsToBeDragged, orientation, limits, notWhenTrue) {\n    for (var i = notWhenTrue.length; i--;) {\n      if (notWhenTrue[i]()) {\n        return;\n      }\n    }\n\n    var els = d3.select(this);\n\n    if (elsToBeDragged && elsToBeDragged.length) {\n      els = mergeSelections(elsToBeDragged);\n    }\n\n    function withinLimits(value, applyingLimits) {\n      var restrictedValue = undefined;\n\n      if (applyingLimits) {\n        try {\n          restrictedValue = Math.min(applyingLimits.max, Math.max(applyingLimits.min, value));\n        } catch (e) {\n          throw new LimitsUnsupportedFormat();\n        }\n      }\n      return restrictedValue;\n    }\n\n    if (orientation === 'horizontal' || orientation === 'vertical') {\n      if (orientation === 'horizontal') {\n        data.dragX += d3.event.dx;\n        data.dragX = withinLimits(data.dragX + d3.event.dx, limits.x);\n        els.style('transform', 'translateX(' + data.dragX + 'px)');\n      }\n      if (orientation === 'vertical') {\n        data.dragY += d3.event.dy;\n        data.dragX = withinLimits(data.dragY + d3.event.dy, limits.y);\n        els.style('transform', 'translateY(' + data.dragY + 'px)');\n      }\n    } else {\n      data.dragX += d3.event.dx;\n      data.dragY += d3.event.dy;\n      els.style('transform', 'translate(' + data.dragX + 'px,' + data.dragY + 'px)');\n    }\n  }\n\n  function setOption(value, defaultValue, noFalsyValue) {\n    if (noFalsyValue) {\n      return value || defaultValue;\n    }\n\n    return typeof value !== 'undefined' ? value : defaultValue;\n  }\n\n  var ListGraph = function () {\n    function ListGraph(init) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, ListGraph);\n\n      if (!d3.layout.listGraph) {\n        throw new LayoutNotAvailable();\n      }\n\n      var that = this;\n\n      this.baseEl = init.element;\n      this.baseElD3 = d3.select(this.baseEl);\n      this.baseElJq = $(this.baseEl);\n      this.svgD3 = this.baseElD3.select('svg.base');\n      this.svgEl = this.svgD3.node();\n\n      if (this.svgD3.empty()) {\n        this.svgD3 = this.baseElD3.append('svg').attr('class', 'base');\n        this.svgJq = $(this.svgD3.node());\n      } else {\n        this.svgJq = $(this.svgD3.node());\n      }\n\n      // Array of root node IDs.\n      this.rootNodes = init.rootNodes;\n\n      // Width of the vis. If `undefined` the SVG's width will be used.\n      this.width = setOption(init.width, this.svgJq.width(), true);\n\n      // Height of the vis. If `undefined` the SVG's height will be used.\n      this.height = setOption(init.height, this.svgJq.height(), true);\n\n      // Refresh top and left position of the base `svg` everytime the user enters\n      // the element with his/her mouse cursor. This will avoid relying on complex\n      // browser resize events and other layout manipulations as they most likely\n      // won't happen when the user tries to interact with the visualization.\n      this.svgD3.on('mouseenter', function () {\n        that.getBoundingRect.call(that, this);\n      });\n\n      // With of the column's scrollbars\n      this.scrollbarWidth = setOption(init.scrollbarWidth, SCROLLBAR_WIDTH, true);\n\n      // Number of visible columns\n      this.columns = setOption(init.columns, COLUMNS, true);\n\n      // Number of visible rows.\n      this.rows = setOption(init.rows, ROWS, true);\n\n      // Path to SVG icon file.\n      this.iconPath = setOption(init.iconPath, ICON_PATH, true);\n\n      // If `true` query icons and controls are enabled.\n      this.querying = setOption(init.querying, QUERYING);\n\n      // If `true` hide links that point to invisible nodes.\n      this.hideOutwardsLinks = setOption(init.hideOutwardsLinks, HIDE_OUTWARDS_LINKS);\n\n      // If `true` and `this.hideOutwardsLinks === true` indicates the location of\n      // target nodes of invisible nodes connected via links.\n      this.showLinkLocation = setOption(init.showLinkLocation, SHOW_LINK_LOCATION);\n\n      // The visual size of a location bucket. E.g. `3` pixel.\n      this.linkLocationBucketSize = init.linkLocationBucketSize;\n\n      // If `true` the currently rooted level will softly be highlighted.\n      this.highlightActiveLevel = setOption(init.highlightActiveLevel, HIGHLIGHT_ACTIVE_LEVEL);\n\n      // Determines which level from the rooted node will be regarded as active.\n      // Zero means that the level of the rooted node is regarded.\n      this.activeLevel = setOption(init.activeLevel, ACTIVE_LEVEL);\n\n      // When no manually rooted node is available the active level will be\n      // `this.activeLevel` minus `this.noRootActiveLevelDiff`.\n      // WAT?\n      // In some cases it makes sense to hide the original root node just to save\n      // a column, so having no manually set root node means that the invisible\n      // root node is active. Using this option it can be assured that the\n      // approriate column is being highlighted.\n      this.noRootActiveLevelDiff = setOption(init.noRootActiveLevelDiff, NO_ROOT_ACTIVE_LEVEL_DIFF);\n\n      // Determine the level of transitions\n      // - 0 [Default]: Show all transitions\n      // - 1: Show only CSS transitions\n      // - 2: Show no transitions\n      this.lessTransitionsJs = init.lessTransitions > 0;\n      this.lessTransitionsCss = init.lessTransitions > 1;\n\n      this.baseElD3.classed('less-animations', this.lessTransitionsCss);\n\n      // Holds the key of the property to be sorted initially. E.g. `precision`.\n      this.sortBy = init.sortBy;\n\n      // Initial sort order. Anything other than `asc` will fall back to `desc`.\n      this.sortOrder = init.sortOrder === 'asc' ? 1 : DEFAULT_SORT_ORDER;\n\n      this.events = new Events(this.baseEl, init.dispatcher);\n\n      this.baseElJq.addClass(CLASSNAME);\n\n      if (init.forceWidth) {\n        this.baseElJq.width(this.width);\n      }\n\n      this.layout = new d3.layout.listGraph( // eslint-disable-line new-cap\n      [this.width, this.height], [this.columns, this.rows]);\n\n      this.data = init.data;\n      this.visData = this.layout.process(this.data, this.rootNodes, {\n        showLinkLocation: this.showLinkLocation,\n        linkLocationBucketSize: this.linkLocationBucketSize,\n        sortBy: this.sortBy,\n        sortOrder: this.sortOrder\n      });\n\n      /**\n       * Stores current sorting, e.g. type, order and a reference to the element.\n       *\n       * @type  {Object}\n       */\n      this.currentSorting = {\n        global: {\n          type: this.sortBy,\n          order: this.sortOrder\n        },\n        local: {}\n      };\n\n      this.barMode = init.barMode || DEFAULT_BAR_MODE;\n      this.svgD3.classed(this.barMode + '-bar', true);\n\n      this.topbar = new Topbar(this, this.baseElD3, this.visData);\n\n      this.svgD3.attr('viewBox', '0 0 ' + this.width + ' ' + this.height);\n\n      this.container = this.svgD3.append('g').attr('class', 'main-container');\n\n      this.levels = new Levels(this.container, this, this.visData);\n\n      this.links = new Links(this, this.levels.groups, this.visData, this.layout);\n      this.nodes = new Nodes(this, this.levels.groups, this.visData, this.links, this.events);\n      this.levels.scrollPreparation(this, this.scrollbarWidth);\n      this.scrollbars = new Scrollbars(this.levels.groups, this.visData, this.scrollbarWidth);\n\n      // jQuery's mousewheel plugin is much nicer than D3's half-baked zoom event.\n      // We are using delegated event listeners to provide better scaling\n      this.svgJq.on('mousewheel', '.' + this.levels.className, function (event) {\n        if (!that.zoomedOut) {\n          that.mousewheelColumn(this, event);\n        }\n      });\n\n      // Add jQuery delegated event listeners instead of direct listeners of D3.\n      if (this.querying) {\n        this.svgJq.on('click', '.' + this.nodes.classLabelWrapper, function () {\n          that.nodes.toggleQueryMode.call(that.nodes, this.parentNode, d3.select(this).datum());\n        });\n      }\n\n      this.svgJq.on('click', '.' + this.nodes.classFocusControls + '.' + this.nodes.classRoot, function () {\n        that.nodes.rootHandler.call(that.nodes, this, d3.select(this).datum());\n      });\n\n      if (this.querying) {\n        this.svgJq.on('click', '.' + this.nodes.classFocusControls + '.' + this.nodes.classQuery, function () {\n          that.nodes.toggleQueryMode.call(that.nodes, this.parentNode, d3.select(this).datum());\n        });\n      }\n\n      this.svgJq.on('click', '.' + this.nodes.classFocusControls + '.' + this.nodes.classLock, function () {\n        that.nodes.lockHandler.call(that.nodes, this, d3.select(this).datum());\n      });\n\n      // Normally we would reference a named methods but since we need to access\n      // the class' `this` property instead of the DOM element we need to use an\n      // arrow function.\n      this.scrollbars.all.on('mousedown', function () {\n        that.scrollbarMouseDown(this, d3.event);\n      });\n\n      // We need to listen to `mouseup` and `mousemove` globally otherwise\n      // scrolling will only work as long as the cursor hovers the actual\n      // scrollbar, which is super annoying.\n      d3.select(document).on('mouseup', function () {\n        _this.globalMouseUp(d3.event);\n      }).on('mousemove', function () {\n        _this.globalMouseMove(d3.event);\n      });\n\n      // Enable dragging of the whole graph.\n      this.svgD3.call(onDragDrop, this.dragStartHandler.bind(this), dragMoveHandler, this.dragEndHandler.bind(this), [this.container, this.topbar.localControlWrapper], 'horizontal', this.getDragLimits.bind(this), [this.scrollbarDragging.bind(this)]);\n\n      this.events.on('d3ListGraphLevelFocus', function (levelId) {\n        return _this.levels.focus(levelId);\n      });\n\n      this.events.on('d3ListGraphNodeRoot', function () {\n        _this.nodes.bars.updateAll(_this.layout.updateBars(_this.data), _this.currentSorting.global.type);\n        _this.updateSorting();\n      });\n\n      this.events.on('d3ListGraphNodeUnroot', function () {\n        _this.nodes.bars.updateAll(_this.layout.updateBars(_this.data), _this.currentSorting.global.type);\n        _this.updateSorting();\n      });\n\n      this.events.on('d3ListGraphUpdateBars', function () {\n        _this.nodes.bars.updateAll(_this.layout.updateBars(_this.data), _this.currentSorting.global.type);\n        _this.updateSorting();\n      });\n\n      this.events.on('d3ListGraphActiveLevel', function (nextLevel) {\n        var oldLevel = _this.activeLevel;\n        _this.activeLevel = Math.max(nextLevel, 0);\n        if (_this.nodes.rootedNode) {\n          var rootNodeDepth = _this.nodes.rootedNode.datum().depth;\n          _this.levels.blur(rootNodeDepth + oldLevel);\n          _this.levels.focus(rootNodeDepth + _this.activeLevel);\n        } else {\n          _this.levels.blur(oldLevel - _this.noRootActiveLevelDiff);\n          _this.levels.focus(_this.activeLevel - _this.noRootActiveLevelDiff);\n        }\n      });\n    }\n\n    babelHelpers.createClass(ListGraph, [{\n      key: 'getDragLimits',\n      value: function getDragLimits() {\n        return {\n          x: {\n            min: this.dragMinX,\n            max: 0\n          }\n        };\n      }\n\n      /**\n       * Helper method to get the top and left position of the base `svg`.\n       *\n       * @Description\n       * Calling `getBoundingClientRect()` right at the beginning leads to errornous\n       * values, probably because the function is called because HTML has been fully\n       * rendered.\n       *\n       * @method  getBoundingRect\n       * @author  Fritz Lekschas\n       * @date    2016-02-24\n       * @param   {Object}  el  Element on which `getBoundingClientRect` is called.\n       */\n\n    }, {\n      key: 'getBoundingRect',\n      value: function getBoundingRect(el) {\n        this.top = el.getBoundingClientRect().top;\n        this.left = el.getBoundingClientRect().left;\n      }\n    }, {\n      key: 'interactionWrapper',\n      value: function interactionWrapper(callback, params) {\n        if (!this.noInteractions) {\n          callback.apply(this, params);\n        }\n      }\n    }, {\n      key: 'dragStartHandler',\n      value: function dragStartHandler() {\n        this.noInteractions = true;\n        this.baseElD3.classed('unselectable', true);\n      }\n    }, {\n      key: 'dragEndHandler',\n      value: function dragEndHandler() {\n        this.noInteractions = false;\n        this.baseElD3.classed('unselectable', false);\n      }\n    }, {\n      key: 'scrollbarDragging',\n      value: function scrollbarDragging() {\n        return !!this.activeScrollbar;\n      }\n    }, {\n      key: 'globalMouseUp',\n      value: function globalMouseUp(event) {\n        this.noInteractions = false;\n        if (this.activeScrollbar) {\n          this.baseElD3.classed('unselectable', false);\n          var data = this.activeScrollbar.datum();\n          var deltaY = data.scrollbar.clientY - event.clientY;\n\n          // Save final vertical position\n          // Scrollbar\n          data.scrollbar.scrollTop = Math.min(Math.max(data.scrollbar.scrollTop - deltaY, 0), data.scrollbar.scrollHeight);\n\n          // Content\n          data.scrollTop = Math.max(Math.min(data.scrollTop + data.invertedHeightScale(deltaY), 0), -data.scrollHeight);\n\n          this.activeScrollbar.classed('active', false);\n\n          this.activeScrollbar = undefined;\n        }\n      }\n    }, {\n      key: 'globalMouseMove',\n      value: function globalMouseMove(event) {\n        if (this.activeScrollbar) {\n          var data = this.activeScrollbar.datum();\n          var deltaY = data.scrollbar.clientY - event.clientY;\n\n          // Scroll scrollbar\n          ListGraph.scrollElVertically(this.activeScrollbar.node(), Math.min(Math.max(data.scrollbar.scrollTop - deltaY, 0), data.scrollbar.scrollHeight));\n\n          // Scroll content\n          var contentScrollTop = Math.max(Math.min(data.scrollTop + data.invertedHeightScale(deltaY), 0), -data.scrollHeight);\n\n          ListGraph.scrollElVertically(data.nodes, contentScrollTop);\n\n          // Scroll Links\n          if (data.level !== this.visData.nodes.length) {\n            this.links.scroll(data.linkSelections.outgoing, this.layout.offsetLinks(data.level, contentScrollTop, 'source'));\n          }\n\n          if (data.level > 0) {\n            this.links.scroll(data.linkSelections.incoming, this.layout.offsetLinks(data.level - 1, contentScrollTop, 'target'));\n          }\n\n          if (this.showLinkLocation) {\n            this.nodes.updateLinkLocationIndicators(data.level - 1, data.level + 1);\n          }\n        }\n      }\n    }, {\n      key: 'scrollbarMouseDown',\n      value: function scrollbarMouseDown(el, event) {\n        this.noInteractions = true;\n        this.baseElD3.classed('unselectable', true);\n        this.activeScrollbar = d3.select(el).classed('active', true);\n        this.activeScrollbar.datum().scrollbar.clientY = event.clientY;\n      }\n    }, {\n      key: 'mousewheelColumn',\n      value: function mousewheelColumn(el, event) {\n        event.preventDefault();\n\n        var data = d3.select(el).datum();\n\n        if (data.scrollHeight > 0) {\n          // Scroll nodes\n          data.scrollTop = Math.max(Math.min(data.scrollTop + event.deltaY, 0), -data.scrollHeight);\n\n          this.scrollY(data);\n        }\n      }\n    }, {\n      key: 'scrollY',\n      value: function scrollY(columnData, scrollbarDragging) {\n        ListGraph.scrollElVertically(columnData.nodes, columnData.scrollTop);\n\n        if (true || !scrollbarDragging) {\n          // Scroll scrollbar\n          columnData.scrollbar.scrollTop = columnData.scrollbar.heightScale(-columnData.scrollTop);\n\n          ListGraph.scrollElVertically(columnData.scrollbar.el, columnData.scrollbar.scrollTop);\n        }\n\n        // Scroll Links\n        if (columnData.level !== this.visData.nodes.length) {\n          this.links.scroll(columnData.linkSelections.outgoing, this.layout.offsetLinks(columnData.level, columnData.scrollTop, 'source'));\n        }\n\n        if (columnData.level > 0) {\n          this.links.scroll(columnData.linkSelections.incoming, this.layout.offsetLinks(columnData.level - 1, columnData.scrollTop, 'target'));\n        }\n\n        if (this.showLinkLocation) {\n          this.nodes.updateLinkLocationIndicators(columnData.level - 1, columnData.level + 1);\n        }\n      }\n    }, {\n      key: 'scrollYTo',\n      value: function scrollYTo(selection, positionY) {\n        var _this2 = this;\n\n        return selection.transition().duration(TRANSITION_SEMI_FAST).tween('scrollY', function (data) {\n          var scrollPositionY = d3.interpolateNumber(data.scrollTop, positionY);\n          return function (time) {\n            data.scrollTop = scrollPositionY(time);\n            _this2.scrollY(data);\n          };\n        });\n      }\n    }, {\n      key: 'resetAllScrollPositions',\n      value: function resetAllScrollPositions() {\n        return this.scrollYTo(this.levels.groups, 0);\n      }\n    }, {\n      key: 'selectByLevel',\n      value: function selectByLevel(level, selector) {\n        return d3.select(this.levels.groups[0][level]).selectAll(selector);\n      }\n    }, {\n      key: 'updateSorting',\n      value: function updateSorting() {\n        var levels = Object.keys(this.currentSorting.local);\n        for (var i = levels.length; i--;) {\n          this.sortColumn(i, this.currentSorting.local[levels[i]].type, this.currentSorting.local[levels[i]].order, this.currentSorting.local[levels[i]].type);\n        }\n      }\n    }, {\n      key: 'sortColumn',\n      value: function sortColumn(level, property, sortOrder, newSortType) {\n        this.nodes.sort(this.layout.sort(level, property, sortOrder).updateNodesVisibility().nodes(level), newSortType);\n        this.links.sort(this.layout.links(level - 1, level + 1));\n      }\n    }, {\n      key: 'sortAllColumns',\n      value: function sortAllColumns(property, newSortType) {\n        this.currentSorting.global.order = this.currentSorting.global.order === -1 ? 1 : -1;\n\n        this.nodes.sort(this.layout.sort(undefined, property, this.currentSorting.global.order).updateNodesVisibility().nodes(), newSortType);\n\n        this.links.sort(this.layout.links());\n      }\n    }, {\n      key: 'switchBarMode',\n      value: function switchBarMode(mode) {\n        this.svgD3.classed('one-bar', mode === 'one');\n        this.svgD3.classed('two-bar', mode === 'two');\n        this.nodes.bars.switchMode(mode, this.currentSorting);\n      }\n    }, {\n      key: 'trigger',\n      value: function trigger(event, data) {\n        this.events.trigger(event, data);\n      }\n\n      /**\n       * Update the scroll position and scroll-bar visibility.\n       *\n       * @description\n       * This method needs to be called after hiding or showing nodes.\n       *\n       * @method  updateScrolling\n       * @author  Fritz Lekschas\n       * @date    2016-02-21\n       */\n\n    }, {\n      key: 'updateScrolling',\n      value: function updateScrolling() {\n        var _this3 = this;\n\n        this.resetAllScrollPositions().call(allTransitionsEnded, function () {\n          _this3.levels.updateScrollProperties();\n          _this3.scrollbars.updateVisibility();\n        });\n      }\n    }, {\n      key: 'updateLevelsVisibility',\n      value: function updateLevelsVisibility() {\n        this.levels.updateVisibility();\n      }\n    }, {\n      key: 'globalView',\n      value: function globalView(selectionInterst) {\n        var _this4 = this;\n\n        if (!this.zoomedOut) {\n          (function () {\n            var x = 0;\n            var y = 0;\n            var width = 0;\n            var height = 0;\n            var bBox = undefined;\n            var cRect = undefined;\n\n            var globalCRect = _this4.svgD3.node().getBoundingClientRect();\n\n            if (selectionInterst && !selectionInterst.empty()) {\n              selectionInterst.each(function () {\n                bBox = this.getBBox();\n                cRect = this.getBoundingClientRect();\n                width = Math.max(width, cRect.left - globalCRect.left + cRect.width);\n                height = Math.max(height, cRect.top - globalCRect.top + cRect.height);\n              });\n              width = _this4.width > width ? _this4.width : width;\n              height = _this4.height > height ? _this4.height : height;\n            } else {\n              bBox = _this4.container.node().getBBox();\n              width = _this4.width > bBox.width ? _this4.width : bBox.width;\n              height = _this4.height > bBox.height ? _this4.height : bBox.height;\n            }\n\n            x = bBox.x;\n            y = bBox.y;\n\n            _this4.svgD3.classed('zoomedOut', true).transition().duration(TRANSITION_SEMI_FAST).attr('viewBox', x + ' ' + y + ' ' + width + ' ' + height);\n          })();\n        }\n      }\n    }, {\n      key: 'zoomedView',\n      value: function zoomedView() {\n        if (!this.zoomedOut) {\n          this.svgD3.classed('zoomedOut', false).transition().duration(TRANSITION_SEMI_FAST).attr('viewBox', '0 0 ' + this.width + ' ' + this.height);\n        }\n      }\n    }, {\n      key: 'toggleView',\n      value: function toggleView() {\n        if (this.zoomedOut) {\n          this.zoomedOut = false;\n          this.zoomedView();\n        } else {\n          this.globalView();\n          this.zoomedOut = true;\n        }\n      }\n\n      /**\n       * Check if an element is actually visible, i.e. within the boundaries of the\n       * SVG element.\n       *\n       * @method  isHidden\n       * @author  Fritz Lekschas\n       * @date    2016-02-24\n       * @param   {Object}    el  DOM element to be checked.\n       * @return  {Boolean}       If `true` element is not visible.\n       */\n\n    }, {\n      key: 'isHidden',\n      value: function isHidden(el) {\n        var boundingRect = el.getBoundingClientRect();\n        return boundingRect.top + boundingRect.height <= this.top || boundingRect.left + boundingRect.width <= this.left || boundingRect.top >= this.top + this.height || boundingRect.left >= this.left + this.width;\n      }\n\n      /**\n       * Assesses any of the two ends of a link points outwards.\n       *\n       * @description\n       * In order to be able to determine where a link points to the output of\n       * `linkPointsOutside` for the source and target location is shifted bitwise\n       * in such a way that this method return 9 unique numbers.\n       * - 0: link is completely inwards\n       * - 1: source is outwards to the top\n       * - 2: source is outwards to the bottom\n       * - 4: target is outwards to the top\n       * - 8: target is outwards to the bottom\n       * - 5: source and target are outwards to the top\n       * - 6: source is outwards to the bottom and target is outwards to the top\n       * - 9: source is outwards to the top and target is outwards to the bottom\n       * - 10: source and target are outwards to the bottom\n       *\n       * If you're asking yourself: \"WAT?!?!!\" Think of a 4x4 matrix:\n       * |    target    |    source    |\n       * | bottom | top | bottom | top |\n       * |    0   |  0  |    0   |  0  | (=0)\n       * |    0   |  0  |    0   |  1  | (=1)\n       * |    0   |  0  |    1   |  0  | (=2)\n       * |    0   |  1  |    0   |  0  | (=4)\n       * |    1   |  0  |    0   |  0  | (=8)\n       * |    0   |  1  |    0   |  1  | (=5)\n       * |    0   |  1  |    1   |  0  | (=6)\n       * |    1   |  0  |    0   |  1  | (=9)\n       * |    1   |  0  |    1   |  0  | (=10)\n       *\n       * Checker whether the source or target location is above, below or within the\n       * global SVG container is very simple. For example, to find out if the target\n       * location is above, all we need to do is `<VALUE> & 4 > 0`. This performs a\n       * bit-wise AND operation with only two possible outcomes: 4 and 0.\n       *\n       * @method  pointsOutside\n       * @author  Fritz Lekschas\n       * @date    2016-02-29\n       * @param   {Object}  data  Link data.\n       * @return  {Number}  Numberical represenation of the links constallation. See\n       *   description for details.\n       */\n\n    }, {\n      key: 'pointsOutside',\n      value: function pointsOutside(data) {\n        var source = this.linkPointsOutside(data.source);\n        var target = this.linkPointsOutside(data.target) << 2;\n        return source | target;\n      }\n\n      /**\n       * Assesses whether a link's end points outwards\n       *\n       * @method  linkPointsOutside\n       * @author  Fritz Lekschas\n       * @date    2016-02-29\n       * @param   {Object}  data  Link data.\n       * @return  {Number}  If link ends inwards returns `0`, if it points outwards\n       *   to the top returns `1` otherwise `2`.\n       */\n\n    }, {\n      key: 'linkPointsOutside',\n      value: function linkPointsOutside(data) {\n        var y = data.node.y + data.offsetY;\n        if (y + this.visData.global.row.height <= 0) {\n          return 1;\n        }\n        if (y >= this.height) {\n          return 2;\n        }\n        return 0;\n      }\n    }, {\n      key: 'area',\n      get: function get() {\n        return this.container.node().getBoundingClientRect();\n      }\n    }, {\n      key: 'dragMinX',\n      get: function get() {\n        return Math.min(0, this.width - this.area.width);\n      }\n    }, {\n      key: 'barMode',\n      get: function get() {\n        if (this.bars) {\n          return this.nodes.bars.mode;\n        }\n        return this._barMode;\n      },\n      set: function set(mode) {\n        if (this.bars) {\n          this.nodes.bars.mode = mode;\n        }\n        this._barMode = mode;\n      }\n    }], [{\n      key: 'scrollElVertically',\n      value: function scrollElVertically(el, offset) {\n        d3.select(el).attr('transform', 'translate(0, ' + offset + ')');\n      }\n    }]);\n    return ListGraph;\n  }();\n\n  return ListGraph;\n\n}($,d3));"],"sourceRoot":"/source/"}