{"version":3,"sources":["listGraph.min.js"],"names":["ListGraph","$","d3","mergeSelections","selections","mergedSelection","selectAll","i","length","each","push","this","onDragDrop","selection","dragMoveHandler","dropHandler","elsToBeDragged","orientation","limits","drag","behavior","on","data","call","el","select","dragX","dragY","datum","withinLimits","value","Math","min","max","e","LimitsUnsupportedFormat","els","event","dx","x","style","dy","y","isObject","type","arrayToFakeObjs","arrayIds","fakeObjs","id","collectInclClones","node","originalNode","clone","clones","concat","isFinite","nativeIsFinite","up","callback","depth","includeClones","child","nodesInclClones","j","parents","down","childRefs","upAndDown","callbackUp","callbackDown","siblings","isFunction","objToString","funcTag","roundRect","width","height","radius","topLeft","topRight","bottomLeft","bottomRight","exponentialGradient","start","end","name","power","steps","scale","pow","exponent","stepSize","gradient","append","attr","offset","color","opacity","isObjectLike","isNative","reIsNative","test","fnToString","reIsHostCtor","getNative","object","key","undefined","isLength","MAX_SAFE_INTEGER","babelHelpers","classCallCheck","instance","Constructor","TypeError","createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","protoProps","staticProps","prototype","inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","possibleConstructorReturn","self","ReferenceError","ExtendableError","_Error","message","_this","getPrototypeOf","Error","captureStackTrace","_ExtendableError","SCROLLBAR_CLASS","Scrollbars","baseSelection","visData","index","parentNode","scrollbar","classed","CLASSNAME","SCROLLBAR_WIDTH","COLUMNS","ROWS","ICON_PATH","DEFAULT_SORT_ORDER","DEFAULT_BAR_MODE","TRANSITION_SEMI_FAST","COLOR_NEGATIVE_RED","COLOR_POSITIVE_GREEN","objectTypes","function","freeExports","exports","nodeType","freeModule","module","freeGlobal","global","freeSelf","freeWindow","window","root","objectProto","toString","BAR_CLASS","Bar","barData","nodeData","bars","setupMagnitude","_this2","currentSorting","nodes","sortBy","generatePath","mode","setupBorder","row","padding","column","contentWidth","contentHeight","setupIndicator","_this3","level","cell","activeHeight","inactiveheight","enter","bind","indicator","adjustWidth","bottom","generateTwoBarsPath","generateOneBarPath","abs","BARS_CLASS","Bars","that","insertBefore","transition","duration","refBars","currentBar","referenceValue","console","error","LINKS_CLASS","LINK_CLASS","Links","layout","groups","links","class","d","diagonal","nodeIds","_highlight","className","update","hidden","source","get","svg","offsetY","offsetX","projection","NODES_CLASS","NODE_CLASS","CLONE_CLASS","Nodes","vis","events","drawFullSizeRect","shrinking","currentLinks","rows","nodeRooted","toggleRoot","setUpFocusControls","iconPath","nodeLocks","toggleLock","mouseClickHandler","highlightNodes","dehighlightNodes","barMode","text","log","eventHelper","optionalParams","subSelectionClass","filter","apply","setFalse","d3El","lockedNode","active","inactive","unlockNode","lockNode","parseInt","rootedNode","unrootNode","rootNode","rooted","hideNodes","showNodes","location","cx","cy","r","broadcast","direction","nodesVisibility","show","updateVisibility","currentNodeData","currentActiveProperty","traverseCallbackUp","childData","hovering","traverseCallbackDown","updateIndicator","highlight","traverseCallback","newSortType","_this4","updateNodesVisibility","COLUMN_CLASS","SCROLL_CONTAINER_CLASS","Levels","scrollbarWidth","getBoundingClientRect","scrollHeight","scrollbarHeight","linkSelections","incoming","selectByLevel","outgoing","scrollTop","heightScale","linear","domain","range","invertedHeightScale","invert","TOPBAR_EL","TOPBAR_CLASS","TOPBAR_CONTROL_EL","TOPBAR_CONTROL_CLASS","TOPBAR_GLOBAL_CONTROL_CLASS","Topbar","empty","insert","controlSwitch","switchArrow","globalControls","globalPrecision","sortAllColumns","highlightBars","globalPrecisionWrapper","order","globalRecall","globalRecallWrapper","globalName","highlightLabels","globalNameWrapper","globalOneBar","switchBarMode","globalOneBarWrapper","globalTwoBars","globalTwoBarsWrapper","localControlWrapper","localControls","control","local","sortOrder","toggleColumn","left","sortColumn","html","toggleOptions","deHighlight","baseElD3","selectNodesLevel","resetSortEl","columnKeys","keys","len","objectProto$2","Function","hasOwnProperty","RegExp","replace","arrayTag","objectProto$1","objToString$1","nativeIsArray","Array","isArray","LayoutNotAvailable","EventDispatcherNoFunction","_ExtendableError2","Events","_stack","dispatch","_dispatchEvent","eventName","document","createEvent","initCustomEvent","dispatchEvent","times","Infinity","stack","splice","off","baseEl","rootNodes","options","listGraph","baseElJq","svgD3","svgJq","columns","dispatcher","addClass","forceWidth","process","afterOffsetOpacity","beforeOffsetOpacity","topbar","container","levels","scrollPreparation","scrollbars","$levels","mousewheelColumn","scrollbarMouseDown","globalMouseUp","globalMouseMove","getBBox","activeScrollbar","deltaY","clientY","scrollY","contentScrollTop","scroll","offsetLinks","preventDefault","selector","property","sort","switchMode","trigger","_barMode","set"],"mappings":"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","file":"listGraph.min.js","sourcesContent":["/* Copyright Fritz Lekschas: D3 example visualization app using list-based graphs */\nvar ListGraph = (function ($,d3) { 'use strict';\n\n  var babelHelpers = {};\n\n  babelHelpers.classCallCheck = function (instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  };\n\n  babelHelpers.createClass = (function () {\n    function defineProperties(target, props) {\n      for (var i = 0; i < props.length; i++) {\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n      }\n    }\n\n    return function (Constructor, protoProps, staticProps) {\n      if (protoProps) defineProperties(Constructor.prototype, protoProps);\n      if (staticProps) defineProperties(Constructor, staticProps);\n      return Constructor;\n    };\n  })();\n\n  babelHelpers.inherits = function (subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n  };\n\n  babelHelpers.possibleConstructorReturn = function (self, call) {\n    if (!self) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n  };\n\n  babelHelpers;\n  var ExtendableError = (function (_Error) {\n    babelHelpers.inherits(ExtendableError, _Error);\n\n    function ExtendableError(message) {\n      babelHelpers.classCallCheck(this, ExtendableError);\n\n      var _this = babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(ExtendableError).call(this, message));\n\n      _this.name = _this.constructor.name;\n      _this.message = message;\n      Error.captureStackTrace(_this, _this.constructor.name);\n      return _this;\n    }\n\n    return ExtendableError;\n  })(Error);\n\n  function mergeSelections(selections) {\n    // Create a new empty selection\n    var mergedSelection = d3.selectAll('.d3-list-graph-not-existent');\n\n    for (var i = selections.length; i--;) {\n      selections[i].each(function () {\n        mergedSelection[0].push(this);\n      });\n    }\n\n    return mergedSelection;\n  }\n\n  var LimitsUnsupportedFormat = (function (_ExtendableError) {\n    babelHelpers.inherits(LimitsUnsupportedFormat, _ExtendableError);\n\n    function LimitsUnsupportedFormat(message) {\n      babelHelpers.classCallCheck(this, LimitsUnsupportedFormat);\n      return babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(LimitsUnsupportedFormat).call(this, message || 'The limits are wrongly formatted. Please provide an ' + 'object of the following format: `{ x: { min: 0, max: 1 }, y: { min: ' + '0, max: 1 } }`'));\n    }\n\n    return LimitsUnsupportedFormat;\n  })(ExtendableError);\n\n  /**\n   * Drap and drop event handler that works via translation.\n   *\n   * @method  onDragDrop\n   * @author  Fritz Lekschas\n   * @date    2016-01-15\n   * @param   {Object}  selection        D3 selection to listen for the drag\n   *   event.\n   * @param   {Object}  dragMoveHandler  Handler for drag-move.\n   * @param   {Object}  dropHandler      Handler for drag-end, i.e. drop.\n   * @param   {Array}   elsToBeDragged   Array of D3 selections to be moved.\n   *   according to the drag event. If empty or undefined `selection` will be\n   * @param   {String}  orientation      Can either be \"horizontal\", \"vertical\" or\n   *   `undefined`, i.e. both directions.\n   * @param   {Object}  limits           X and Y drag limits. E.g.\n   *   `{ x: { min: 0, max: 10 } }`.\n   */\n  function onDragDrop(selection, dragMoveHandler, dropHandler, elsToBeDragged, orientation, limits) {\n    limits = limits || {};\n\n    var drag = d3.behavior.drag();\n\n    if (dragMoveHandler) {\n      drag.on('drag', function (data) {\n        dragMoveHandler.call(this, data, elsToBeDragged, orientation, limits);\n      });\n    }\n\n    if (dropHandler) {\n      drag.on('dragend', function (data) {\n        dropHandler.call(this, data, elsToBeDragged, orientation, limits);\n      });\n    }\n\n    selection.each(function (data) {\n      var el = d3.select(this);\n\n      // Set default data if not available.\n      if (!data) {\n        data = {\n          dragX: 0,\n          dragY: 0\n        };\n        el.datum(data);\n      }\n\n      // Add drag event handler\n      el.call(drag);\n    });\n  }\n\n  function dragMoveHandler(data, elsToBeDragged, orientation, limits) {\n    var els = d3.select(this);\n\n    if (elsToBeDragged && elsToBeDragged.length) {\n      els = mergeSelections(elsToBeDragged);\n    }\n\n    function withinLimits(value, limits) {\n      if (limits) {\n        try {\n          value = Math.min(limits.max, Math.max(limits.min, value));\n        } catch (e) {\n          throw new LimitsUnsupportedFormat();\n        }\n      }\n      return value;\n    }\n\n    if (orientation === 'horizontal' || orientation === 'vertical') {\n      if (orientation === 'horizontal') {\n        // data.dragX += d3.event.dx;\n        data.dragX = withinLimits(data.dragX + d3.event.dx, limits.x);\n        els.style('transform', 'translateX(' + data.dragX + 'px)');\n      }\n      if (orientation === 'vertical') {\n        data.dragY += d3.event.dy;\n        data.dragX = withinLimits(data.dragY + d3.event.dy, limits.y);\n        els.style('transform', 'translateY(' + data.dragY + 'px)');\n      }\n    } else {\n      data.dragX += d3.event.dx;\n      data.dragY += d3.event.dy;\n      els.style('transform', 'translate(' + data.dragX + 'px,' + data.dragY + 'px)');\n    }\n  }\n\n  /**\n   * Checks if `value` is the [language type](https://es5.github.io/#x8) of `Object`.\n   * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n   * @example\n   *\n   * _.isObject({});\n   * // => true\n   *\n   * _.isObject([1, 2, 3]);\n   * // => true\n   *\n   * _.isObject(1);\n   * // => false\n   */\n  function isObject(value) {\n    // Avoid a V8 JIT bug in Chrome 19-20.\n    // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.\n    var type = typeof value;\n    return !!value && (type == 'object' || type == 'function');\n  }\n\n  var SCROLLBAR_CLASS = 'scrollbar';\n\n  var Scrollbars = function Scrollbars(baseSelection, visData, width) {\n    var _this = this;\n\n    babelHelpers.classCallCheck(this, Scrollbars);\n\n    this.visData = visData;\n    this.width = width;\n\n    // Add empty scrollbar element\n    this.selection = baseSelection.append('rect').attr('class', SCROLLBAR_CLASS).call(function (selection) {\n      selection.each(function (data, index) {\n        d3.select(this.parentNode).datum().scrollbar.el = this;\n      });\n    }).attr('x', function (data) {\n      return data.scrollbar.x;\n    }).attr('y', function (data) {\n      return data.scrollbar.y;\n    }).attr('width', function (data) {\n      return _this.width;\n    }).attr('height', function (data) {\n      return data.scrollbar.height;\n    }).attr('rx', this.width / 2).attr('ry', this.width / 2).classed('ready', true);\n  };\n\n  var CLASSNAME = 'list-graph';\n\n  var SCROLLBAR_WIDTH = 6;\n  var COLUMNS = 5;\n  var ROWS = 5;\n\n  // An empty path is equal to inline SVG.\n  var ICON_PATH = '';\n\n  var DEFAULT_SORT_ORDER = 'desc';\n\n  var DEFAULT_BAR_MODE = 'one';\n\n  var TRANSITION_SEMI_FAST = 250;\n  // Gradient colors\n  var COLOR_NEGATIVE_RED = '#e0001c';\n  var COLOR_POSITIVE_GREEN = '#60bf00';\n\n  function arrayToFakeObjs(arrayIds) {\n    var fakeObjs = [];\n\n    for (var i = arrayIds.length; i--;) {\n      fakeObjs.push({ id: arrayIds[i] });\n    }\n\n    return fakeObjs;\n  }\n\n  /**\n   * Collect all cloned nodes, including the original node.\n   *\n   * @method  collectInclClones\n   * @author  Fritz Lekschas\n   * @date    2015-12-30\n   * @param   {Object}  node  Start node\n   * @return  {Array}         Array of original and cloned nodes.\n   */\n  function collectInclClones(node) {\n    var originalNode = node;\n\n    if (node.clone) {\n      originalNode = node.originalNode;\n    }\n\n    var clones = [originalNode];\n\n    if (originalNode.clones.length) {\n      clones = clones.concat(originalNode.clones);\n    }\n\n    return clones;\n  }\n\n  /** Used to determine if values are of the language type `Object`. */\n  var objectTypes = {\n    'function': true,\n    'object': true\n  };\n\n  /** Detect free variable `exports`. */\n  var freeExports = objectTypes[typeof exports] && exports && !exports.nodeType && exports;\n\n  /** Detect free variable `module`. */\n  var freeModule = objectTypes[typeof module] && module && !module.nodeType && module;\n\n  /** Detect free variable `global` from Node.js. */\n  var freeGlobal = freeExports && freeModule && typeof global == 'object' && global && global.Object && global;\n\n  /** Detect free variable `self`. */\n  var freeSelf = objectTypes[typeof self] && self && self.Object && self;\n\n  /** Detect free variable `window`. */\n  var freeWindow = objectTypes[typeof window] && window && window.Object && window;\n\n  /**\n   * Used as a reference to the global object.\n   *\n   * The `this` value is used if it's the global object to avoid Greasemonkey's\n   * restricted `window` object, otherwise the `window` object is used.\n   */\n  var root = freeGlobal || ((freeWindow !== (this && this.window)) && freeWindow) || freeSelf || this;\n\n  /* Native method references for those with the same name as other `lodash` methods. */\n  var nativeIsFinite = root.isFinite;\n\n  /**\n   * Checks if `value` is a finite primitive number.\n   *\n   * **Note:** This method is based on [`Number.isFinite`](http://ecma-international.org/ecma-262/6.0/#sec-number.isfinite).\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is a finite number, else `false`.\n   * @example\n   *\n   * _.isFinite(10);\n   * // => true\n   *\n   * _.isFinite('10');\n   * // => false\n   *\n   * _.isFinite(true);\n   * // => false\n   *\n   * _.isFinite(Object(10));\n   * // => false\n   *\n   * _.isFinite(Infinity);\n   * // => false\n   */\n  function isFinite(value) {\n    return typeof value == 'number' && nativeIsFinite(value);\n  }\n\n  function up(node, callback, depth, includeClones, child) {\n    var nodesInclClones = includeClones ? collectInclClones(node) : [node];\n\n    for (var i = nodesInclClones.length; i--;) {\n      if (child) {\n        callback(nodesInclClones[i], child);\n      }\n\n      if (!isFinite(depth) || depth > 0) {\n        for (var j = nodesInclClones[i].parents.length; j--;) {\n          up(nodesInclClones[i].parents[j], callback, --depth, includeClones, nodesInclClones[i]);\n        }\n      }\n    }\n  }\n\n  function down(node, callback, depth, includeClones) {\n    var nodesInclClones = includeClones ? collectInclClones(node) : [node];\n\n    for (var i = nodesInclClones.length; i--;) {\n      callback(nodesInclClones[i]);\n\n      if (!isFinite(depth) || depth > 0) {\n        for (var j = nodesInclClones[i].childRefs.length; j--;) {\n          down(nodesInclClones[i].childRefs[j], callback, --depth, includeClones);\n        }\n      }\n    }\n  }\n\n  function upAndDown(node, callbackUp, callbackDown, depth, includeClones) {\n    if (callbackDown) {\n      up(node, callbackUp, depth, includeClones);\n      down(node, callbackDown, depth, includeClones);\n    } else {\n      up(node, callbackUp, depth, includeClones);\n      down(node, callbackUp, depth, includeClones);\n    }\n  }\n\n  function siblings(node, callback) {\n    for (var i = node.parents.length; i--;) {\n      for (var j = node.parents[i].childRefs.length; j--;) {\n        callback(node.parents[i].childRefs[j]);\n      }\n    }\n  }\n\n  /** `Object#toString` result references. */\n  var funcTag = '[object Function]';\n\n  /** Used for native method references. */\n  var objectProto = Object.prototype;\n\n  /**\n   * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n   * of values.\n   */\n  var objToString = objectProto.toString;\n\n  /**\n   * Checks if `value` is classified as a `Function` object.\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n   * @example\n   *\n   * _.isFunction(_);\n   * // => true\n   *\n   * _.isFunction(/abc/);\n   * // => false\n   */\n  function isFunction(value) {\n    // The use of `Object#toString` avoids issues with the `typeof` operator\n    // in older versions of Chrome and Safari which return 'function' for regexes\n    // and Safari 8 which returns 'object' for typed array constructors.\n    return isObject(value) && objToString.call(value) == funcTag;\n  }\n\n  function roundRect(x, y, width, height, radius) {\n    var topLeft = 0;\n    var topRight = 0;\n    var bottomLeft = 0;\n    var bottomRight = 0;\n\n    try {\n      topLeft = radius.topLeft || 0;\n      topRight = radius.topRight || 0;\n      bottomLeft = radius.bottomLeft || 0;\n      bottomRight = radius.bottomRight || 0;\n    } catch (e) {}\n\n    return 'M' + (x + topLeft) + ',' + y + 'h' + (width - topLeft - topRight) + 'a' + topRight + ',' + topRight + ' 0 0 1 ' + topRight + ',' + topRight + 'v' + (height - (topRight + bottomRight)) + 'a' + bottomRight + ',' + bottomRight + ' 0 0 1 ' + -bottomRight + ',' + bottomRight + 'h' + (bottomLeft - (width - bottomRight)) + 'a' + bottomLeft + ',' + bottomLeft + ' 0 0 1 ' + -bottomLeft + ',' + -bottomLeft + 'v' + (topLeft - (height - bottomLeft)) + 'a' + topLeft + ',' + topLeft + ' 0 0 1 ' + topLeft + ',' + -topLeft + 'z';\n  }\n\n  var BAR_CLASS = 'bar';\n\n  var Bar = (function () {\n    function Bar(selection, barData, nodeData, visData, bars) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Bar);\n\n      var that = this;\n\n      this.data = barData;\n      this.nodeData = nodeData;\n      this.visData = visData;\n      this.bars = bars;\n\n      this.data.x = nodeData.x;\n      this.data.level = nodeData.depth;\n\n      this.height = this.visData.global.row.contentHeight / (this.data.length * 2) - this.visData.global.cell.padding * 2;\n\n      this.activeHeight = this.visData.global.row.contentHeight - 2;\n\n      this.inactiveheight = this.visData.global.cell.padding * 2 - 1;\n\n      this.selection = selection.selectAll(BAR_CLASS).data(this.data).enter().append('g').attr('class', function (data) {\n        return BAR_CLASS + ' ' + data.id;\n      }).classed('active', function (data) {\n        return data.id === _this.visData.nodes[_this.nodeData.depth].sortBy;\n      });\n\n      // Local helper method to avoid code duplication.\n      // Calling a class method from within the consructor is possible but `this`\n      // is not available. Thus, we need to create local function and pass in\n      // `this` as `that`, which feels very hacky but it works.\n      function setupMagnitude(selection) {\n        var _this2 = this;\n\n        var currentSorting = this.visData.nodes[this.nodeData.depth].sortBy;\n\n        selection.attr('d', function (data) {\n          return Bar.generatePath(data, _this2.bars.mode, currentSorting, _this2.visData);\n        }).classed('bar-magnitude', true);\n      }\n\n      function setupBorder(selection) {\n        selection.attr('x', 0).attr('y', this.visData.global.row.padding).attr('width', this.visData.global.column.contentWidth).attr('height', this.visData.global.row.contentHeight).attr('rx', 2).attr('ry', 2).classed('bar-border', true);\n      }\n\n      function setupIndicator(selection) {\n        var _this3 = this;\n\n        selection.attr('d', function (data) {\n          return Bar.generatePath(data, _this3.bars.mode, undefined, _this3.visData, data.value);\n        }).classed('bar-indicator', true);\n      }\n\n      this.selection.append('rect').call(setupBorder.bind(this));\n\n      this.selection.append('path').call(setupMagnitude.bind(this));\n\n      this.selection.append('path').call(setupIndicator.bind(this));\n    }\n\n    babelHelpers.createClass(Bar, null, [{\n      key: 'generatePath',\n      value: function generatePath(data, mode, currentSorting, visData, indicator, adjustWidth, bottom) {\n        if (mode === 'two') {\n          return Bar.generateTwoBarsPath(data, visData, bottom);\n        } else {\n          return Bar.generateOneBarPath(data, currentSorting, visData, indicator, adjustWidth);\n        }\n      }\n    }, {\n      key: 'generateOneBarPath',\n      value: function generateOneBarPath(data, currentSorting, visData, indicator, adjustWidth) {\n        var x = 0;\n\n        var width = 2;\n\n        var height = visData.global.row.contentHeight;\n\n        var radius = {\n          topLeft: 2,\n          bottomLeft: 2\n        };\n\n        if (indicator) {\n          radius = {};\n        }\n\n        if (data.id !== currentSorting && typeof indicator === 'undefined') {\n          x = data.value * visData.global.column.contentWidth - 3;\n          radius = {};\n        } else if (indicator) {\n          x = indicator * visData.global.column.contentWidth;\n          if (adjustWidth) {\n            if (data.value < indicator) {\n              x = data.value * visData.global.column.contentWidth;\n            }\n            width = Math.min(Math.abs(indicator - data.value), 2) * visData.global.column.contentWidth;\n          }\n        } else {\n          width = visData.global.column.contentWidth * data.value;\n        }\n\n        return roundRect(x, visData.global.row.padding, width, height, radius);\n      }\n    }, {\n      key: 'generateTwoBarsPath',\n      value: function generateTwoBarsPath(data, visData, bottom) {\n        var height = visData.global.row.contentHeight / 2;\n\n        var width = visData.global.column.contentWidth * data.value;\n\n        var y = visData.global.row.padding;\n\n        var radius = { topLeft: 2 };\n\n        if (bottom) {\n          radius = { bottomLeft: 2 };\n          y += height;\n        }\n\n        return roundRect(0, y, width, height, radius);\n      }\n    }]);\n    return Bar;\n  })();\n\n  var BARS_CLASS = 'bars';\n\n  var Bars = (function () {\n    function Bars(selection, mode, visData) {\n      babelHelpers.classCallCheck(this, Bars);\n\n      var that = this;\n\n      this.mode = mode;\n      this.visData = visData;\n\n      this.selection = selection.append('g').attr('class', BARS_CLASS);\n\n      this.selection.each(function (datum) {\n        new Bar(d3.select(this), datum.data.bars, datum, that.visData, that);\n      });\n    }\n\n    babelHelpers.createClass(Bars, [{\n      key: 'update',\n      value: function update(selection, sortBy) {\n        var _this = this;\n\n        selection.each(function () {\n          var el = d3.select(this);\n\n          if (el.classed('active')) {\n            el.classed('active', false);\n          } else {\n            el.classed('active', true);\n            // Ensure that the active bars we are places before any other bar,\n            // thus placing them in the background\n            this.parentNode.insertBefore(this, d3.select(this.parentNode).select('.bar').node());\n          }\n        });\n\n        selection.selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n          return Bar.generatePath(data, _this.mode, sortBy, _this.visData);\n        });\n      }\n    }, {\n      key: 'updateIndicator',\n      value: function updateIndicator(refBars, currentBar, referenceValue) {\n        var _this2 = this;\n\n        currentBar.transition().duration(0).attr('d', function (data) {\n          return Bar.generatePath(data, _this2.mode, undefined, _this2.visData);\n        });\n\n        refBars.attr('d', function (data) {\n          return Bar.generatePath(data, _this2.mode, undefined, _this2.visData, referenceValue);\n        }).classed('positive', function (data) {\n          return data.value >= referenceValue;\n        });\n\n        refBars.transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n          return Bar.generatePath(data, _this2.mode, undefined, _this2.visData, referenceValue, true);\n        });\n      }\n    }, {\n      key: 'switchMode',\n      value: function switchMode(mode, currentSorting) {\n        var _this3 = this;\n\n        if (this.mode !== mode) {\n          if (mode === 'one') {\n            if (currentSorting.global.type) {\n              this.selection.selectAll('.bar').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n                return Bar.generateOneBarPath(data, currentSorting.global.type, _this3.visData);\n              });\n            } else {\n              console.error('Switching magnitude visualization after individual sorting is ' + 'not supported yet.');\n            }\n          }\n\n          if (mode === 'two') {\n            this.selection.selectAll('.bar.precision').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n              return Bar.generateTwoBarsPath(data, _this3.visData);\n            });\n\n            this.selection.selectAll('.bar.recall').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n              return Bar.generateTwoBarsPath(data, _this3.visData, true);\n            });\n          }\n\n          this.mode = mode;\n        }\n      }\n    }]);\n    return Bars;\n  })();\n\n  var LINKS_CLASS = 'links';\n  var LINK_CLASS = 'link';\n\n  var Links = (function () {\n    function Links(selection, visData, layout) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Links);\n\n      this.visData = visData;\n      this.layout = layout;\n\n      this.groups = selection.append('g').attr('class', LINKS_CLASS).call(function (selection) {\n        selection.each(function (data, index) {\n          d3.select(this.parentNode).datum().links = this;\n        });\n      });\n\n      this.links = this.groups.selectAll(LINK_CLASS + '-bg').data(function (data, index) {\n        return _this.layout.links(index);\n      }).enter().append('g').attr('class', LINK_CLASS);\n\n      this.links.append('path').attr({\n        'class': LINK_CLASS + '-bg',\n        'd': this.diagonal\n      });\n\n      this.links.append('path').attr({\n        'class': LINK_CLASS + '-direct',\n        'd': this.diagonal\n      });\n    }\n\n    babelHelpers.createClass(Links, [{\n      key: 'highlight',\n      value: function highlight(nodeIds, _highlight, className) {\n        className = className ? className : 'hovering';\n\n        this.links.data(nodeIds, function (data) {\n          return data.id;\n        }).classed(className, _highlight === false ? false : true);\n      }\n    }, {\n      key: 'scroll',\n      value: function scroll(selection, data) {\n        // Update data of `g`.\n        selection.data(data);\n\n        // Next update all paths according to the new data.\n        selection.selectAll('path').attr('d', this.diagonal);\n      }\n    }, {\n      key: 'sort',\n      value: function sort(update) {\n        var start = function start() {\n          d3.select(this).classed('sorting', true);\n        };\n        var end = function end() {\n          d3.select(this).classed('sorting', false);\n        };\n\n        // Update data of `g`.\n        this.links.data(update, function (data) {\n          return data.id;\n        });\n\n        // Next update all paths according to the new data.\n        this.links.selectAll('path').transition().duration(TRANSITION_SEMI_FAST).attr('d', this.diagonal).each('start', start).each('end', end);\n      }\n    }, {\n      key: 'updateVisibility',\n      value: function updateVisibility() {\n        this.links.selectAll('path').classed('hidden', function (data) {\n          return data.target.node.hidden || data.source.node.hidden;\n        }).transition().duration(TRANSITION_SEMI_FAST).attr('d', this.diagonal);\n      }\n    }, {\n      key: 'diagonal',\n      get: function get() {\n        var _this2 = this;\n\n        return d3.svg.diagonal().source(function (data) {\n          return {\n            x: data.source.node.y + data.source.offsetY + _this2.visData.global.row.height / 2,\n            y: data.source.node.x + data.source.offsetX + _this2.visData.global.column.contentWidth + _this2.visData.global.column.padding\n          };\n        }).target(function (data) {\n          return {\n            x: data.target.node.y + data.target.offsetY + _this2.visData.global.row.height / 2,\n            y: data.target.node.x + data.target.offsetX + _this2.visData.global.column.padding\n          };\n        }).projection(function (data) {\n          return [data.y, data.x];\n        });\n      }\n    }]);\n    return Links;\n  })();\n\n  var NODES_CLASS = 'nodes';\n  var NODE_CLASS = 'node';\n  var CLONE_CLASS = 'clone';\n\n  var Nodes = (function () {\n    function Nodes(vis, baseSelection, visData, links, events) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Nodes);\n\n      var that = this;\n\n      // Helper\n      function drawFullSizeRect(selection, className, shrinking) {\n        if (!shrinking) {\n          shrinking = 0;\n        }\n\n        selection.attr('x', function (data) {\n          return shrinking;\n        }).attr('y', function (data) {\n          return that.visData.global.row.padding + shrinking;\n        }).attr('width', that.visData.global.column.contentWidth - 2 * shrinking).attr('height', that.visData.global.row.contentHeight - 2 * shrinking).attr('rx', 2 - shrinking).attr('ry', 2 - shrinking).classed(className, true);\n      }\n\n      this.vis = vis;\n      this.visData = visData;\n      this.links = links;\n      this.events = events;\n      this.currentLinks = {};\n\n      this.groups = baseSelection.append('g').attr('class', NODES_CLASS).call(function (selection) {\n        selection.each(function (data, index) {\n          d3.select(this.parentNode).datum().nodes = this;\n        });\n      });\n\n      this.nodes = this.groups.selectAll('.' + NODE_CLASS).data(function (data) {\n        return data.rows;\n      }).enter().append('g').classed(NODE_CLASS, true).classed(CLONE_CLASS, function (data) {\n        return data.clone;\n      }).attr('transform', function (data) {\n        return 'translate(' + (data.x + _this.visData.global.column.padding) + ', ' + data.y + ')';\n      });\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'bg-extension').attr('width', this.visData.global.column.padding + 5);\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'bg-border');\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'bg', 1);\n\n      // Rooting icons\n      var nodeRooted = this.nodes.append('g').attr('class', 'focus-controls root inactive').on('click', function () {\n        that.toggleRoot.call(that, this);\n      });\n\n      nodeRooted.append('circle').call(this.setUpFocusControls.bind(this), 'left', 'bg', 'bg');\n\n      nodeRooted.append('svg').call(this.setUpFocusControls.bind(this), 'left', 'icon', 'ease-all state-inactive invisible-default').append('use').attr('xlink:href', this.vis.iconPath + '#unlocked');\n\n      nodeRooted.append('svg').call(this.setUpFocusControls.bind(this), 'left', 'icon', 'ease-all state-active invisible-default').append('use').attr('xlink:href', this.vis.iconPath + '#locked');\n\n      var nodeLocks = this.nodes.append('g').attr('class', 'focus-controls lock inactive').on('click', function () {\n        that.toggleLock.call(that, this);\n      });\n\n      nodeLocks.append('circle').call(this.setUpFocusControls.bind(this), 'right', 'bg', 'bg');\n\n      nodeLocks.append('svg').call(this.setUpFocusControls.bind(this), 'right', 'icon', 'ease-all state-inactive invisible-default').append('use').attr('xlink:href', this.vis.iconPath + '#unlocked');\n\n      nodeLocks.append('svg').call(this.setUpFocusControls.bind(this), 'right', 'icon', 'ease-all state-active invisible-default').append('use').attr('xlink:href', this.vis.iconPath + '#locked');\n\n      this.nodes.on('click', function (data) {\n        that.mouseClickHandler.call(that, this, data);\n      });\n\n      this.nodes.on('mouseenter', function (data) {\n        that.highlightNodes(this, data);\n      });\n\n      this.nodes.on('mouseleave', function (data) {\n        that.dehighlightNodes(this, data);\n      });\n\n      this.bars = new Bars(this.nodes, this.vis.barMode, this.visData);\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'border');\n\n      // Add node label\n      this.nodes.call(function (selection) {\n        selection.append('foreignObject').attr('x', function (data) {\n          return _this.visData.global.cell.padding;\n        }).attr('y', function (data) {\n          return _this.visData.global.row.padding + _this.visData.global.cell.padding;\n        }).attr('width', _this.visData.global.column.contentWidth).attr('height', _this.visData.global.row.contentHeight - _this.visData.global.cell.padding * 2).attr('class', 'label-wrapper').append('xhtml:div').attr('class', 'label').attr('title', function (data) {\n          return data.data.name;\n        }).style('line-height', _this.visData.global.row.contentHeight - _this.visData.global.cell.padding * 2 + 'px').append('xhtml:span').text(function (data) {\n          return data.data.name;\n        });\n      });\n\n      if (isFunction(this.events.on)) {\n        this.events.on('d3ListGraphNodeClick', function (event) {\n          console.log('d3ListGraphNodeClick', event);\n        });\n\n        this.events.on('d3ListGraphNodeEnter', function (event) {\n          return _this.eventHelper(event, _this.highlightNodes);\n        });\n\n        this.events.on('d3ListGraphNodeLeave', function (event) {\n          return _this.eventHelper(event, _this.dehighlightNodes);\n        });\n\n        this.events.on('d3ListGraphNodeLock', function (event) {\n          return _this.eventHelper(event, _this.toggleLock, [], '.lock');\n        });\n\n        this.events.on('d3ListGraphNodeUnlock', function (event) {\n          return _this.eventHelper(event, _this.toggleLock, [true], '.lock');\n        });\n\n        this.events.on('d3ListGraphNodeRoot', function (event) {\n          return _this.eventHelper(event, _this.toggleRoot, [], '.root');\n        });\n\n        this.events.on('d3ListGraphNodeUnroot', function (event) {\n          return _this.eventHelper(event, _this.toggleRoot, [true], '.root');\n        });\n      }\n    }\n\n    babelHelpers.createClass(Nodes, [{\n      key: 'eventHelper',\n      value: function eventHelper(event, callback, optionalParams, subSelectionClass) {\n        var that = this;\n\n        optionalParams = optionalParams ? optionalParams : [];\n\n        if (event.id) {\n          this.nodes.filter(function (data) {\n            return data.id === event.id;\n          }).each(function (data) {\n            var el = this;\n\n            if (subSelectionClass) {\n              el = d3.select(this).select(subSelectionClass).node();\n            }\n\n            callback.apply(that, [el, data].concat(optionalParams));\n          });\n        }\n      }\n    }, {\n      key: 'toggleLock',\n      value: function toggleLock(el, nodeData, setFalse) {\n        var d3El = d3.select(el);\n        var data = d3El.datum();\n\n        if (this.lockedNode) {\n          if (this.lockedNode.datum().id === data.id) {\n            this.lockedNode.classed({\n              'active': false,\n              'inactive': true\n            });\n            this.unlockNode(this.lockedNode.datum().id);\n            this.lockedNode = undefined;\n          } else {\n            // Reset previously locked node;\n            this.lockedNode.classed({\n              'active': false,\n              'inactive': true\n            });\n            this.unlockNode(this.lockedNode.datum().id);\n\n            if (!setFalse) {\n              d3El.classed({\n                'active': true,\n                'inactive': false\n              });\n              this.lockNode(data.id);\n              this.lockedNode = d3El;\n            }\n          }\n        } else {\n          if (!setFalse) {\n            d3El.classed({\n              'active': true,\n              'inactive': false\n            });\n            this.lockNode(data.id);\n            this.lockedNode = d3El;\n          }\n        }\n      }\n    }, {\n      key: 'lockNode',\n      value: function lockNode(id) {\n        var that = this;\n        var els = this.nodes.filter(function (data) {\n          return data.id === id;\n        });\n\n        els.each(function (data) {\n          that.highlightNodes(this, data, 'lock');\n        });\n\n        els.selectAll('.bg-border').transition().duration(TRANSITION_SEMI_FAST).attr('width', function () {\n          return parseInt(d3.select(this).attr('width')) + that.visData.global.row.height / 2;\n        });\n      }\n    }, {\n      key: 'unlockNode',\n      value: function unlockNode(id) {\n        var that = this;\n        var els = this.nodes.filter(function (data) {\n          return data.id === id;\n        });\n        var start = function start() {\n          d3.select(this.parentNode).classed('animating', true);\n        };\n        var end = function end() {\n          d3.select(this.parentNode).classed('animating', false);\n        };\n\n        els.selectAll('.bg-border').transition().duration(TRANSITION_SEMI_FAST).attr('width', this.visData.global.column.contentWidth).each('start', start).each('end', end);\n\n        els.each(function (data) {\n          that.dehighlightNodes(this, data, 'lock');\n        });\n      }\n    }, {\n      key: 'toggleRoot',\n      value: function toggleRoot(el, nodeData, setFalse) {\n        var d3El = d3.select(el);\n        var data = d3El.datum();\n\n        if (this.rootedNode) {\n          // Reset current root node\n          this.rootedNode.classed({\n            'active': false,\n            'inactive': true\n          });\n          this.unrootNode(this.rootedNode.datum().id);\n\n          // Activate new root\n          if (this.rootedNode.datum().id !== data.id && !setFalse) {\n            d3El.classed({\n              'active': true,\n              'inactive': false\n            });\n            this.rootNode(data.id);\n            this.rootedNode = d3El;\n          } else {\n            this.rootedNode = undefined;\n          }\n        } else {\n          if (!setFalse) {\n            d3El.classed({\n              'active': true,\n              'inactive': false\n            });\n            this.rootNode(data.id);\n            this.rootedNode = d3El;\n          }\n        }\n      }\n    }, {\n      key: 'rootNode',\n      value: function rootNode(id) {\n        var that = this;\n        var els = this.nodes.filter(function (data) {\n          return data.id === id;\n        });\n\n        els.each(function (data) {\n          data.rooted = true;\n          d3.select(this).classed('rooted', true);\n          that.hideNodes.call(that, this, data, 'downStream');\n        });\n\n        els.selectAll('.bg-extension').transition().duration(TRANSITION_SEMI_FAST).attr('x', -that.visData.global.row.height / 2);\n      }\n    }, {\n      key: 'unrootNode',\n      value: function unrootNode(id) {\n        var that = this;\n        var els = this.nodes.filter(function (data) {\n          return data.id === id;\n        });\n        var start = function start() {\n          d3.select(this.parentNode).classed('animating', true);\n        };\n        var end = function end() {\n          d3.select(this.parentNode).classed('animating', false);\n        };\n\n        els.selectAll('.bg-extension').transition().duration(TRANSITION_SEMI_FAST).attr('x', 0).each('start', start).each('end', end);\n\n        els.each(function (data) {\n          data.rooted = false;\n          d3.select(this).classed('rooted', false);\n          that.showNodes.call(that, this, data, 'downStream');\n        });\n      }\n    }, {\n      key: 'setUpFocusControls',\n      value: function setUpFocusControls(selection, location, mode, className) {\n        var height = this.visData.global.row.contentHeight / 2 - this.visData.global.cell.padding * 2;\n        var x = location === 'left' ? -height - 2 : this.visData.global.column.contentWidth + 2;\n        var y = this.visData.global.row.padding + (this.visData.global.row.contentHeight - 2 * this.visData.global.cell.padding) / 4;\n\n        if (mode === 'bg') {\n          selection.attr({\n            class: className,\n            cx: x + height / 2,\n            cy: y + height / 2,\n            r: height * 3 / 4\n          });\n        } else {\n          selection.attr({\n            class: className,\n            x: x,\n            y: y,\n            width: height,\n            height: height\n          });\n        }\n      }\n    }, {\n      key: 'mouseClickHandler',\n      value: function mouseClickHandler(el, data) {\n        this.events.broadcast('d3ListGraphNodeClick', { id: data.id });\n      }\n    }, {\n      key: 'hideNodes',\n      value: function hideNodes(el, data, direction) {\n        return this.nodesVisibility(el, data, direction);\n      }\n    }, {\n      key: 'showNodes',\n      value: function showNodes(el, data, direction) {\n        return this.nodesVisibility(el, data, direction, true);\n      }\n    }, {\n      key: 'nodesVisibility',\n      value: function nodesVisibility(el, data, direction, show) {\n        var that = this;\n        var currentNodeData = data;\n\n        if (show) {\n          this.nodes.classed('hidden', false).each(function (data) {\n            return data.hidden = false;\n          });\n        } else {\n          // First we set all nodes to `hidden`.\n          this.nodes.each(function (data) {\n            return data.hidden = true;\n          });\n\n          // Then we set direct child and parent nodes of the current node visible.\n          upAndDown(data, function (data) {\n            return data.hidden = false;\n          });\n\n          // We also show sibling nodes.\n          siblings(data, function (data) {\n            return data.hidden = false;\n          });\n\n          this.nodes.classed('hidden', function (data) {\n            return data.hidden;\n          });\n        }\n        this.updateVisibility();\n      }\n    }, {\n      key: 'highlightNodes',\n      value: function highlightNodes(el, data, className) {\n        var _this2 = this;\n\n        var that = this;\n        var currentNodeData = data;\n\n        className = className ? className : 'hovering';\n\n        // Store link IDs\n        this.currentLinks[className] = [];\n\n        var currentActiveProperty = d3.select(el).selectAll('.bar.active .bar-magnitude').datum();\n\n        var traverseCallbackUp = function traverseCallbackUp(data, childData) {\n          data.hovering = 2;\n          for (var i = data.links.length; i--;) {\n            // Only push direct parent child connections. E.g.\n            // Store: (parent)->(child)\n            // Ignore: (parent)->(siblings of child)\n            if (data.links[i].target.node.id === childData.id) {\n              _this2.currentLinks[className].push(data.links[i].id);\n            }\n          }\n        };\n\n        var traverseCallbackDown = function traverseCallbackDown(data) {\n          data.hovering = 2;\n          for (var i = data.links.length; i--;) {\n            _this2.currentLinks[className].push(data.links[i].id);\n          }\n        };\n        upAndDown(data, traverseCallbackUp, traverseCallbackDown, undefined, true);\n\n        if (data.clone) {\n          data.originalNode.hovering = 1;\n        }\n\n        data.hovering = 1;\n\n        this.nodes.each(function (data) {\n          var node = d3.select(this);\n\n          if (data.hovering === 1) {\n            node.classed(className + '-directly', true);\n          } else if (data.hovering === 2) {\n            node.classed(className + '-indirectly', true);\n            node.selectAll('.bar.' + currentActiveProperty.id).classed('copy', function (data) {\n              var id = data.id;\n\n              if (data.clone) {\n                id = data.originalNode.id;\n              }\n\n              if (id !== currentNodeData.id) {\n                return true;\n              }\n            });\n\n            var currentBar = d3.select(el).selectAll('.bar.' + currentActiveProperty.id).classed('reference', true);\n\n            that.bars.updateIndicator(node.selectAll('.bar.copy .bar-indicator'), currentBar.selectAll('.bar-indicator'), currentActiveProperty.value);\n          }\n        });\n\n        this.links.highlight(arrayToFakeObjs(this.currentLinks[className]), true, className);\n\n        this.events.broadcast('d3ListGraphNodeEnter', { id: data.id });\n      }\n    }, {\n      key: 'dehighlightNodes',\n      value: function dehighlightNodes(el, data, className) {\n        var traverseCallback = function traverseCallback(data) {\n          return data.hovering = 0;\n        };\n\n        className = className ? className : 'hovering';\n\n        data.hovering = 0;\n        upAndDown(data, traverseCallback, undefined, undefined, true);\n\n        if (data.clone) {\n          data.originalNode.hovering = 0;\n        }\n\n        this.nodes.classed(className + '-directly', false);\n        this.nodes.classed(className + '-indirectly', false);\n\n        this.links.highlight(arrayToFakeObjs(this.currentLinks[className]), false, className);\n\n        this.events.broadcast('d3ListGraphNodeLeave', { id: data.id });\n      }\n    }, {\n      key: 'sort',\n      value: function sort(update, newSortType) {\n        var _this3 = this;\n\n        for (var i = update.length; i--;) {\n          var start = function start() {\n            d3.select(this).classed('sorting', true);\n          };\n          var end = function end() {\n            d3.select(this).classed('sorting', false);\n          };\n\n          var selection = this.nodes.data(update[i].rows, function (data) {\n            return data.id;\n          });\n\n          selection.transition().duration(TRANSITION_SEMI_FAST).attr('transform', function (data) {\n            return 'translate(' + (data.x + _this3.visData.global.column.padding) + ', ' + data.y + ')';\n          }).each('start', start).each('end', end);\n\n          if (newSortType) {\n            this.bars.update(selection.selectAll('.bar'), update[i].sortBy);\n          }\n        }\n      }\n    }, {\n      key: 'updateVisibility',\n      value: function updateVisibility() {\n        var _this4 = this;\n\n        this.vis.layout.updateNodesVisibility();\n\n        this.nodes.transition().duration(TRANSITION_SEMI_FAST).attr('transform', function (data) {\n          return 'translate(' + (data.x + _this4.visData.global.column.padding) + ', ' + data.y + ')';\n        });\n\n        this.vis.links.updateVisibility();\n      }\n    }, {\n      key: 'barMode',\n      get: function get() {\n        return this.bars.mode;\n      }\n    }]);\n    return Nodes;\n  })();\n\n  var COLUMN_CLASS = 'column';\n  var SCROLL_CONTAINER_CLASS = 'scroll-container';\n\n  var Levels = (function () {\n    function Levels(selection, visData) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Levels);\n\n      this.visData = visData;\n      this.groups = selection.selectAll('g').data(this.visData.nodes).enter().append('g').attr('class', COLUMN_CLASS);\n\n      // We need to add an empty rectangle that fills up the whole column to ensure\n      // that the `g`'s size is at a maximum, otherwise scrolling will be halted\n      // when the cursor leaves an actually drawn element.\n      this.groups.append('rect').attr('class', SCROLL_CONTAINER_CLASS).attr('x', function (data) {\n        return data.x;\n      }).attr('y', function (data) {\n        return data.y;\n      }).attr('width', function (data) {\n        return _this.visData.global.column.width;\n      }).attr('height', function (data) {\n        return _this.visData.global.column.height;\n      });\n    }\n\n    babelHelpers.createClass(Levels, [{\n      key: 'scrollPreparation',\n      value: function scrollPreparation(vis, scrollbarWidth) {\n        var _this2 = this;\n\n        this.groups.each(function (data, index) {\n          var contentHeight = data.nodes.getBoundingClientRect().height + 2 * _this2.visData.global.row.padding;\n          var scrollHeight = contentHeight - _this2.visData.global.column.height;\n          var scrollbarHeight = scrollHeight > 0 ? Math.max(_this2.visData.global.column.height * _this2.visData.global.column.height / contentHeight, 10) : 0;\n\n          data.height = contentHeight;\n          data.linkSelections = {\n            incoming: index > 0 ? vis.selectByLevel(index - 1, '.link') : null,\n            outgoing: vis.selectByLevel(index, '.link')\n          };\n          data.scrollHeight = scrollHeight;\n          data.scrollTop = 0;\n          data.scrollbar = {\n            el: undefined,\n            x: data.x + _this2.visData.global.column.width - scrollbarWidth,\n            y: 0,\n            width: scrollbarWidth,\n            height: scrollbarHeight,\n            scrollHeight: _this2.visData.global.column.height - scrollbarHeight,\n            scrollTop: 0,\n            heightScale: d3.scale.linear().domain([0, scrollHeight]).range([0, _this2.visData.global.column.height - scrollbarHeight])\n          };\n          data.invertedHeightScale = data.scrollbar.heightScale.invert;\n        });\n      }\n    }, {\n      key: 'height',\n      get: function get() {\n        return this.visData.global.column.height;\n      }\n    }]);\n    return Levels;\n  })();\n\n  var TOPBAR_EL = 'div';\n  var TOPBAR_CLASS = 'top-bar';\n\n  var TOPBAR_CONTROL_EL = 'ul';\n  var TOPBAR_CONTROL_CLASS = 'controls';\n  var TOPBAR_GLOBAL_CONTROL_CLASS = 'global-controls';\n\n  var Topbar = (function () {\n    function Topbar(vis, selection, visData) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Topbar);\n\n      var that = this;\n\n      this.vis = vis;\n      this.visData = visData;\n      // Add base topbar element\n      this.el = selection.select('.' + TOPBAR_CLASS);\n\n      if (this.el.empty()) {\n        this.el = selection.insert(TOPBAR_EL, ':first-child').attr('class', TOPBAR_CLASS);\n      }\n\n      this.controlSwitch = this.el.append('div').attr('title', 'Toggle global / local topbar').style('width', this.visData.global.column.padding + 'px').classed('control-switch', true).on('click', this.switch.bind(this));\n\n      this.switchArrow = this.controlSwitch.append('svg').append('use').attr('xlink:href', this.vis.iconPath + '#arrow-down').attr('class', 'switch-arrow');\n\n      this.globalControls = this.el.append(TOPBAR_CONTROL_EL).classed(TOPBAR_GLOBAL_CONTROL_CLASS, true);\n\n      // Add button for sorting by precision\n      this.globalPrecision = this.globalControls.append('li').attr('class', 'control-btn sort-precision').classed('active', function () {\n        if (that.vis.currentSorting.global.type === 'precision') {\n          // Save currently active element. Needed when when re-sorting for the\n          // first time, to be able to de-highlight this element.\n          that.vis.currentSorting.global.el = d3.select(this);\n          return true;\n        }\n      }).on('click', function (data) {\n        that.sortAllColumns(this, 'precision');\n      }).on('mouseenter', function () {\n        return _this.highlightBars(undefined, 'precision');\n      }).on('mouseleave', function () {\n        return _this.highlightBars(undefined, 'precision', true);\n      });\n\n      this.globalPrecisionWrapper = this.globalPrecision.append('div').attr('class', 'wrapper').text('Precision').style('margin', '0 ' + this.visData.global.column.padding + 'px');\n\n      this.globalPrecisionWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'precision').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n      this.globalPrecisionWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'precision' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-asc');\n\n      this.globalPrecisionWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'precision' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-desc');\n\n      // Add button for sorting by recall\n      this.globalRecall = this.globalControls.append('li').attr('class', 'control-btn sort-recall').classed('active', function () {\n        if (that.vis.currentSorting.global.type === 'recall') {\n          // See precision\n          that.vis.currentSorting.global.el = d3.select(this);\n          return true;\n        }\n      }).on('click', function (data) {\n        that.sortAllColumns(this, 'recall');\n      }).on('mouseenter', function () {\n        return _this.highlightBars(undefined, 'recall');\n      }).on('mouseleave', function () {\n        return _this.highlightBars(undefined, 'recall', true);\n      });\n\n      this.globalRecallWrapper = this.globalRecall.append('div').attr('class', 'wrapper').text('Recall').style('margin', '0 ' + this.visData.global.column.padding + 'px');\n\n      this.globalRecallWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'recall').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n      this.globalRecallWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'recall' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-asc');\n\n      this.globalRecallWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'recall' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-desc');\n\n      // Add button for sorting by name\n      this.globalName = this.globalControls.append('li').attr('class', 'control-btn sort-name').classed('active', function () {\n        if (that.vis.currentSorting.global.type === 'name') {\n          // See precision\n          that.vis.currentSorting.global.el = d3.select(this);\n          return true;\n        }\n      }).on('click', function (data) {\n        that.sortAllColumns(this, 'name');\n      }).on('mouseenter', function () {\n        return _this.highlightLabels();\n      }).on('mouseleave', function () {\n        return _this.highlightLabels(true);\n      });\n\n      this.globalNameWrapper = this.globalName.append('div').attr('class', 'wrapper').text('Name').style('margin', '0 ' + this.visData.global.column.padding + 'px');\n\n      this.globalNameWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'name').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n      this.globalNameWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'name' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-alpha-asc');\n\n      this.globalNameWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'name' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-alpha-desc');\n\n      // Add button for switching to 'one bar'\n      this.globalOneBar = this.globalControls.append('li').attr('class', 'control-btn one-bar').classed('active', this.vis.barMode === 'one').on('click', function () {\n        that.switchBarMode(this, 'one');\n      });\n\n      this.globalOneBarWrapper = this.globalOneBar.append('div').attr('class', 'wrapper').text('One bar').style('margin', '0 ' + this.visData.global.column.padding + 'px');\n\n      this.globalOneBarWrapper.append('svg').attr('class', 'icon-one-bar').append('use').attr('xlink:href', this.vis.iconPath + '#one-bar');\n\n      // Add button for switching to 'two bars'\n      this.globalTwoBars = this.globalControls.append('li').attr('class', 'control-btn two-bars').classed('active', this.vis.barMode === 'two').on('click', function () {\n        that.switchBarMode(this, 'two');\n      });\n\n      this.globalTwoBarsWrapper = this.globalTwoBars.append('div').attr('class', 'wrapper').text('Two bars').style('margin', '0 ' + this.visData.global.column.padding + 'px');\n\n      this.globalTwoBarsWrapper.append('svg').attr('class', 'icon-two-bars').append('use').attr('xlink:href', this.vis.iconPath + '#two-bars');\n\n      this.localControlWrapper = this.el.append('div').classed('local-controls', true);\n\n      this.localControls = this.localControlWrapper.selectAll(TOPBAR_CONTROL_CLASS).data(visData.nodes).enter().append(TOPBAR_CONTROL_EL).classed(TOPBAR_CONTROL_CLASS, true).style('width', this.visData.global.column.width + 'px');\n\n      this.localControls.each(function (data, index) {\n        var control = d3.select(this);\n\n        /*\n         * Order:\n         * 0 = unsorted\n         * 1 = asc\n         * -1 = desc\n         */\n        that.vis.currentSorting.local[index] = {\n          type: data.sortBy,\n          order: data.sortOrder,\n          el: undefined\n        };\n\n        control.append('li').attr('class', 'control-btn toggle').style('width', that.visData.global.column.padding + 'px').on('click', that.toggleColumn);\n\n        control.append('li').attr('class', 'control-btn sort-precision ease-all').style({\n          'width': that.visData.global.column.contentWidth / 2 + 'px',\n          'left': that.visData.global.column.padding + 'px'\n        }).on('click', function (data) {\n          that.sortColumn(this, data.level, 'precision');\n        }).on('mouseenter', function () {\n          that.highlightBars(this.parentNode, 'precision');\n          d3.select(this).style('width', that.visData.global.column.contentWidth - 16 + 'px');\n        }).on('mouseleave', function () {\n          that.highlightBars(this.parentNode, 'precision', true);\n          d3.select(this).style('width', that.visData.global.column.contentWidth / 2 + 'px');\n        }).html('<div class=\"expandable-label\">' + '  <span class=\"letter abbr\">P</span>' + '  <span class=\"letter abbr\">r</span>' + '  <span class=\"letter\">e</span>' + '  <span class=\"letter abbr\">c</span>' + '  <span class=\"letter\">i</span>' + '  <span class=\"letter\">s</span>' + '  <span class=\"letter\">i</span>' + '  <span class=\"letter\">o</span>' + '  <span class=\"letter\">n</span>' + '</div>' + '<svg class=\"icon-unsort invisible-default ' + (that.vis.currentSorting.local[index].type !== 'precision' ? 'visible' : '') + '\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#unsort\"></use>' + '</svg>' + '<svg class=\"icon-sort-asc invisible-default ' + (that.vis.currentSorting.local[index].type === 'precision' && that.vis.currentSorting.local[index].order === 1 ? 'visible' : '') + '\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#sort-asc\"></use>' + '</svg>' + '<svg class=\"icon-sort-desc invisible-default ' + (that.vis.currentSorting.local[index].type === 'precision' && that.vis.currentSorting.local[index].order !== 1 ? 'visible' : '') + '\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#sort-desc\"></use>' + '</svg>');\n\n        control.append('li').attr('class', 'control-btn sort-recall ease-all').style({\n          'width': that.visData.global.column.contentWidth / 2 + 'px',\n          'left': that.visData.global.column.contentWidth / 2 + that.visData.global.column.padding + 'px'\n        }).on('click', function (data) {\n          that.sortColumn(this, data.level, 'recall');\n        }).on('mouseenter', function () {\n          that.highlightBars(this.parentNode, 'recall');\n          d3.select(this).style({\n            'width': that.visData.global.column.contentWidth - 16 + 'px',\n            'left': that.visData.global.column.padding + 16 + 'px'\n          });\n        }).on('mouseleave', function () {\n          that.highlightBars(this.parentNode, 'recall', true);\n          d3.select(this).style({\n            'width': that.visData.global.column.contentWidth / 2 + 'px',\n            'left': that.visData.global.column.contentWidth / 2 + that.visData.global.column.padding + 'px'\n          });\n        }).html('<div class=\"expandable-label\">' + '  <span class=\"letter abbr\">R</span>' + '  <span class=\"letter\">e</span>' + '  <span class=\"letter abbr\">c</span>' + '  <span class=\"letter\">a</span>' + '  <span class=\"letter abbr\">l</span>' + '  <span class=\"letter\">l</span>' + '</div>' + '<svg class=\"icon-unsort invisible-default ' + (that.vis.currentSorting.local[index].type !== 'recall' ? 'visible' : '') + '\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#unsort\"></use>' + '</svg>' + '<svg class=\"icon-sort-asc invisible-default ' + (that.vis.currentSorting.local[index].type === 'recall' && that.vis.currentSorting.local[index].order === 1 ? 'visible' : '') + '\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#sort-asc\"></use>' + '</svg>' + '<svg class=\"icon-sort-desc invisible-default ' + (that.vis.currentSorting.local[index].type === 'recall' && that.vis.currentSorting.local[index].order !== 1 ? 'visible' : '') + '\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#sort-desc\"></use>' + '</svg>');\n\n        control.append('li').attr('class', 'control-btn options').style('width', that.visData.global.column.padding + 'px').on('click', that.toggleOptions).html('<svg class=\"icon-gear\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#gear\"></use>' + '</svg>');\n\n        if (that.vis.currentSorting.local[index].type) {\n          that.vis.currentSorting.local[index].el = control.select('.sort-' + that.vis.currentSorting.local[index].type);\n        }\n      });\n    }\n\n    babelHelpers.createClass(Topbar, [{\n      key: 'toggleColumn',\n      value: function toggleColumn() {\n        console.log('Toggle column');\n      }\n    }, {\n      key: 'selectNodesLevel',\n      value: function selectNodesLevel(el) {\n        return this.vis.selectByLevel(d3.select(el).datum().depth, '.node');\n      }\n    }, {\n      key: 'highlightLabels',\n      value: function highlightLabels(deHighlight) {\n        this.vis.baseElD3.selectAll('.node').classed('highlight-label', !deHighlight);\n      }\n    }, {\n      key: 'highlightBars',\n      value: function highlightBars(el, type, deHighlight) {\n        var nodes = el ? this.selectNodesLevel(el) : this.vis.baseElD3.selectAll('.node');\n\n        nodes.classed('highlight-bar', !deHighlight).selectAll('.bar.' + type).classed('highlight', !deHighlight);\n      }\n    }, {\n      key: 'sortAllColumns',\n      value: function sortAllColumns(el, type) {\n        var newSortType = false;\n\n        if (this.vis.currentSorting.global.type !== type) {\n          newSortType = true;\n\n          // Unset class of previous global sorting element\n          if (this.vis.currentSorting.global.el) {\n            this.resetSortEl(this.vis.currentSorting.global.el);\n          }\n        }\n\n        this.vis.currentSorting.global.el = d3.select(el);\n        this.vis.currentSorting.global.el.classed('active', true);\n        this.vis.currentSorting.global.type = type;\n\n        var columnKeys = Object.keys(this.vis.currentSorting.local);\n        for (var i = 0, len = columnKeys.length; i < len; i++) {\n          this.sortColumn(el, columnKeys[i], type, true);\n        }\n      }\n    }, {\n      key: 'sortColumn',\n      value: function sortColumn(el, index, type, global) {\n        // Reset global sorting\n        if (!global) {\n          this.vis.currentSorting.global.type = undefined;\n          this.resetSortEl(this.vis.currentSorting.global.el);\n        }\n\n        var newSortType = false;\n\n        if (this.vis.currentSorting.local[index].el) {\n          if (this.vis.currentSorting.local[index].type !== type) {\n            this.resetSortEl(this.vis.currentSorting.local[index].el);\n          }\n        }\n\n        if (this.vis.currentSorting.local[index].type !== type) {\n          newSortType = true;\n          // Reset sort order\n          this.vis.currentSorting.local[index].order = 0;\n        }\n\n        this.vis.currentSorting.local[index].el = d3.select(el);\n        this.vis.currentSorting.local[index].type = type;\n\n        // -1 = desc, 1 = asc\n        if (this.vis.currentSorting.local[index].order === -1) {\n          this.vis.currentSorting.local[index].order = 1;\n          this.vis.currentSorting.local[index].el.select('.icon-sort-desc').classed('visible', false);\n          this.vis.currentSorting.local[index].el.select('.icon-sort-asc').classed('visible', true);\n        } else {\n          this.vis.currentSorting.local[index].order = -1;\n          this.vis.currentSorting.local[index].el.select('.icon-sort-asc').classed('visible', false);\n          this.vis.currentSorting.local[index].el.select('.icon-sort-desc').classed('visible', true);\n        }\n\n        this.vis.currentSorting.local[index].el.select('.icon-unsort').classed('visible', false);\n\n        this.vis.sortColumn(index, type, this.vis.currentSorting.local[index].order, newSortType);\n      }\n    }, {\n      key: 'resetSortEl',\n      value: function resetSortEl(el) {\n        el.classed('active', false);\n        el.select('.icon-sort-desc').classed('visible', false);\n        el.select('.icon-sort-asc').classed('visible', false);\n        el.select('.icon-unsort').classed('visible', true);\n      }\n    }, {\n      key: 'toggleOptions',\n      value: function toggleOptions() {\n        console.log('Toggle options');\n      }\n    }, {\n      key: 'switch',\n      value: function _switch() {\n        this.el.classed('details', !this.el.classed('details'));\n      }\n    }, {\n      key: 'switchBarMode',\n      value: function switchBarMode(el, mode) {\n        if (this.vis.nodes.barMode !== mode) {\n          if (mode === 'one') {\n            this.globalOneBar.classed('active', true);\n            this.globalTwoBars.classed('active', false);\n          } else {\n            this.globalOneBar.classed('active', false);\n            this.globalTwoBars.classed('active', true);\n          }\n          this.vis.switchBarMode(mode);\n        }\n      }\n    }]);\n    return Topbar;\n  })();\n\n  /**\n   * Creates and adds an interpolated exponential SVG gradient to an SVG element.\n   *\n   * @example\n   * ```\n   * exponentialGradient(\n   *   d3.select('svg'),\n   *   {\n   *     color: #fff,\n   *     offset: 10,\n   *     opacity: 0.5,\n   *     x: 0,\n   *     y: 0\n   *   },\n   *   {\n   *     color: #000,\n   *     offset: 10,\n   *     opacity: 1,\n   *     x: 1,\n   *     y: 1\n   *   },\n   *   'myFancyGradient',\n   *   3,\n   *   5\n   * );\n   * ```\n   *\n   * @method  exponentialGradient\n   * @author  Fritz Lekschas\n   * @date    2015-12-30\n   * @param   {Object}  el     Element to which the `def` gradient should be\n   *   added to.\n   * @param   {Object}  start  Start properies.\n   * @param   {Object}  end    End properies.\n   * @param   {String}  name   Name of the gradient.\n   * @param   {Number}  power  Exponential power.\n   * @param   {Number}  steps  Interpolation steps.\n   */\n  function exponentialGradient(el, start, end, name, power, steps) {\n    var scale = d3.scale.pow().exponent(power || 2);\n    var stepSize = 1 / ((steps || 0) + 1);\n\n    var gradient = el.append('defs').append('linearGradient').attr('id', name).attr('x1', start.x).attr('y1', start.y).attr('x2', end.x).attr('y2', end.y).attr('spreadMethod', 'pad');\n\n    gradient.append('stop').attr('offset', start.offset + '%').attr('stop-color', start.color).attr('stop-opacity', start.opacity);\n\n    for (var i = 0; i < steps; i++) {\n      gradient.append('stop').attr('offset', start.offset + i * stepSize * (end.offset - start.offset) + '%').attr('stop-color', end.color).attr('stop-opacity', start.opacity + scale(i * stepSize) * (end.opacity - start.opacity));\n    }\n\n    gradient.append('stop').attr('offset', end.offset + '%').attr('stop-color', end.color).attr('stop-opacity', end.opacity);\n  }\n\n  /**\n   * Checks if `value` is object-like.\n   *\n   * @private\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n   */\n  function isObjectLike(value) {\n    return !!value && typeof value == 'object';\n  }\n\n  /** Used to detect host constructors (Safari > 5). */\n  var reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n  /** Used for native method references. */\n  var objectProto$2 = Object.prototype;\n\n  /** Used to resolve the decompiled source of functions. */\n  var fnToString = Function.prototype.toString;\n\n  /** Used to check objects for own properties. */\n  var hasOwnProperty = objectProto$2.hasOwnProperty;\n\n  /** Used to detect if a method is native. */\n  var reIsNative = RegExp('^' +\n    fnToString.call(hasOwnProperty).replace(/[\\\\^$.*+?()[\\]{}|]/g, '\\\\$&')\n    .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n  );\n\n  /**\n   * Checks if `value` is a native function.\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is a native function, else `false`.\n   * @example\n   *\n   * _.isNative(Array.prototype.push);\n   * // => true\n   *\n   * _.isNative(_);\n   * // => false\n   */\n  function isNative(value) {\n    if (value == null) {\n      return false;\n    }\n    if (isFunction(value)) {\n      return reIsNative.test(fnToString.call(value));\n    }\n    return isObjectLike(value) && reIsHostCtor.test(value);\n  }\n\n  /**\n   * Gets the native function at `key` of `object`.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @param {string} key The key of the method to get.\n   * @returns {*} Returns the function if it's native, else `undefined`.\n   */\n  function getNative(object, key) {\n    var value = object == null ? undefined : object[key];\n    return isNative(value) ? value : undefined;\n  }\n\n  /**\n   * Used as the [maximum length](http://ecma-international.org/ecma-262/6.0/#sec-number.max_safe_integer)\n   * of an array-like value.\n   */\n  var MAX_SAFE_INTEGER = 9007199254740991;\n\n  /**\n   * Checks if `value` is a valid array-like length.\n   *\n   * **Note:** This function is based on [`ToLength`](http://ecma-international.org/ecma-262/6.0/#sec-tolength).\n   *\n   * @private\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n   */\n  function isLength(value) {\n    return typeof value == 'number' && value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n  }\n\n  /** `Object#toString` result references. */\n  var arrayTag = '[object Array]';\n\n  /** Used for native method references. */\n  var objectProto$1 = Object.prototype;\n\n  /**\n   * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n   * of values.\n   */\n  var objToString$1 = objectProto$1.toString;\n\n  /* Native method references for those with the same name as other `lodash` methods. */\n  var nativeIsArray = getNative(Array, 'isArray');\n\n  /**\n   * Checks if `value` is classified as an `Array` object.\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n   * @example\n   *\n   * _.isArray([1, 2, 3]);\n   * // => true\n   *\n   * _.isArray(function() { return arguments; }());\n   * // => false\n   */\n  var isArray = nativeIsArray || function(value) {\n    return isObjectLike(value) && isLength(value.length) && objToString$1.call(value) == arrayTag;\n  };\n\n  var LayoutNotAvailable = (function (_ExtendableError) {\n    babelHelpers.inherits(LayoutNotAvailable, _ExtendableError);\n\n    function LayoutNotAvailable(message) {\n      babelHelpers.classCallCheck(this, LayoutNotAvailable);\n      return babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(LayoutNotAvailable).call(this, message || 'D3.layout.listGraph.js has not been loaded yet.'));\n    }\n\n    return LayoutNotAvailable;\n  })(ExtendableError);\n\n  var EventDispatcherNoFunction = (function (_ExtendableError2) {\n    babelHelpers.inherits(EventDispatcherNoFunction, _ExtendableError2);\n\n    function EventDispatcherNoFunction(message) {\n      babelHelpers.classCallCheck(this, EventDispatcherNoFunction);\n      return babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(EventDispatcherNoFunction).call(this, message || 'Dispatcher needs to be a function.'));\n    }\n\n    return EventDispatcherNoFunction;\n  })(ExtendableError);\n\n  var Events = (function () {\n    function Events(el, broadcast) {\n      babelHelpers.classCallCheck(this, Events);\n\n      if (broadcast && !isFunction(broadcast)) {\n        throw new EventDispatcherNoFunction();\n      }\n\n      this.el = el;\n      this._stack = {};\n      this.dispatch = broadcast ? broadcast : this._dispatchEvent;\n    }\n\n    babelHelpers.createClass(Events, [{\n      key: '_dispatchEvent',\n      value: function _dispatchEvent(eventName, data) {\n        var event = document.createEvent('CustomEvent');\n        event.initCustomEvent(eventName, false, false, data);\n        this.el.dispatchEvent(event);\n      }\n    }, {\n      key: 'broadcast',\n      value: function broadcast(event, data) {\n        this.dispatch(event, data);\n      }\n\n      /**\n       * Add a callback function to an event stack.\n       *\n       * @method  on\n       * @author  Fritz Lekschas\n       * @date    2016-01-07\n       *\n       * @param   {String}    event     Event identifier.\n       * @param   {Function}  callback  Function which is called when the event\n       *   stack is triggered.\n       * @param   {Number}    times     Number of times the callback function should\n       *   be triggered before it is removed from the event stack. This is useful\n       *   when an event happens only a certain number of times.\n       * @return  {Number}              Index of callback, which is needed to\n       *   manually remove the callback from the event stack.\n       */\n\n    }, {\n      key: 'on',\n      value: function on(event, callback, times) {\n        if (!isFunction(callback)) {\n          return false;\n        }\n\n        if (isFinite(times)) {\n          times = parseInt(times);\n        } else {\n          times = Infinity;\n        }\n\n        if (isArray(this.stack[event])) {\n          return this.stack[event].push({ callback: callback, times: times }) - 1;\n        } else {\n          this.stack[event] = [{ callback: callback, times: times }];\n          return 0;\n        }\n      }\n    }, {\n      key: 'off',\n\n      /**\n       * Removes a callback function from an event stack given its index.\n       *\n       * @method  off\n       * @author  Fritz Lekschas\n       * @date    2016-01-07\n       *\n       * @param   {String}   event  Event identifier.\n       * @param   {Number}   index  Index of the callback to be removed.\n       * @return  {Boolean}         Returns `true` if event callback was found and\n       *   successfully removed.\n       */\n      value: function off(event, index) {\n        try {\n          this.stack[event].splice(index, 1);\n          return true;\n        } catch (e) {\n          return false;\n        }\n      }\n    }, {\n      key: 'trigger',\n\n      /**\n       * Trigger an event stack\n       *\n       * @method  trigger\n       * @author  Fritz Lekschas\n       * @date    2016-01-07\n       *\n       * @param   {String}   event  Event identifier.\n       * @return  {Boolean}         Returns `true` if an event stack was found.\n       */\n      value: function trigger(event, data) {\n        if (isArray(this.stack[event])) {\n          // Traversing from the end to the start, which has the advantage that\n          // deletion of events, i.e. calling `Event.off()` doesn't affect the index\n          // of event listeners in the next step.\n          for (var i = this.stack[event].length; i--;) {\n            // Instead of checking whether `stack[event][i]` is a function here,\n            // we do it just once when we add the function to the stack.\n            if (this.stack[event][i].times--) {\n              this.stack[event][i].callback(data);\n            } else {\n              this.off(event, i);\n            }\n          }\n          return true;\n        } else {\n          return false;\n        }\n      }\n    }, {\n      key: 'stack',\n      get: function get() {\n        return this._stack;\n      }\n    }]);\n    return Events;\n  })();\n\n  var ListGraph = (function () {\n    function ListGraph(baseEl, data, rootNodes, options) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, ListGraph);\n\n      if (!d3.layout.listGraph) {\n        throw new LayoutNotAvailable();\n      }\n\n      if (!isObject(options)) {\n        options = {};\n      }\n\n      var that = this;\n\n      this.baseEl = baseEl;\n      this.baseElD3 = d3.select(baseEl);\n      this.baseElJq = $(baseEl);\n      this.svgD3 = this.baseElD3.select('svg.base');\n\n      if (this.svgD3.empty()) {\n        this.svgD3 = this.baseElD3.append('svg').attr('class', 'base');\n        this.svgJq = $(this.svgD3[0]);\n      } else {\n        this.svgJq = $(this.svgD3[0]);\n      }\n\n      this.rootNodes = rootNodes;\n\n      this.width = options.width || this.svgJq.width();\n      this.height = options.height || this.svgJq.height();\n      this.scrollbarWidth = options.scrollbarWidth || SCROLLBAR_WIDTH;\n      this.columns = options.columns || COLUMNS;\n      this.rows = options.rows || ROWS;\n      this.iconPath = options.iconPath || ICON_PATH;\n\n      this.sortBy = options.sortBy;\n      this.sortOrder = options.sortOrder || DEFAULT_SORT_ORDER;\n\n      this.events = new Events(this.baseEl, options.dispatcher);\n\n      this.baseElJq.addClass(CLASSNAME);\n\n      if (options.forceWidth) {\n        this.baseElJq.width(this.width);\n      }\n\n      this.layout = new d3.layout.listGraph([this.width, this.height], [this.columns, this.rows]);\n\n      this.data = data;\n      this.visData = this.layout.process(this.data, this.rootNodes, {\n        sortBy: this.sortBy,\n        sortOrder: this.sortOrder\n      });\n\n      /**\n       * Stores current sorting, e.g. type, order and a reference to the element.\n       *\n       * @type  {Object}\n       */\n      this.currentSorting = {\n        global: {\n          type: this.sortBy,\n          order: this.sortOrder\n        },\n        local: {}\n      };\n\n      exponentialGradient(this.svgD3, {\n        color: COLOR_NEGATIVE_RED,\n        offset: 0,\n        opacity: 0.2,\n        x: 0,\n        y: 0\n      }, {\n        afterOffsetOpacity: 1,\n        color: COLOR_NEGATIVE_RED,\n        offset: 99,\n        opacity: 1,\n        x: 1,\n        y: 0\n      }, 'negativeRed', 4, 10);\n\n      exponentialGradient(this.svgD3, {\n        beforeOffsetOpacity: 1,\n        color: COLOR_POSITIVE_GREEN,\n        offset: 1,\n        opacity: 1,\n        x: 0,\n        y: 0\n      }, {\n        color: COLOR_POSITIVE_GREEN,\n        offset: 100,\n        opacity: 0.2,\n        x: 1,\n        y: 0\n      }, 'positiveGreen', 0.25, 10);\n\n      this.barMode = options.barMode || DEFAULT_BAR_MODE;\n      this.svgD3.classed(this.barMode + '-bar', true);\n\n      this.topbar = new Topbar(this, this.baseElD3, this.visData);\n\n      this.svgD3.attr('viewBox', '0 0 ' + this.width + ' ' + this.height);\n\n      this.container = this.svgD3.append('g').attr('class', 'main-container');\n\n      this.levels = new Levels(this.container, this.visData);\n\n      this.links = new Links(this.levels.groups, this.visData, this.layout);\n      this.nodes = new Nodes(this, this.levels.groups, this.visData, this.links, this.events);\n      this.levels.scrollPreparation(this, this.scrollbarWidth);\n      this.scrollbars = new Scrollbars(this.levels.groups, this.visData, this.scrollbarWidth);\n\n      // jQuery's mousewheel plugin is much nicer than D3's half-baked zoom event.\n      this.$levels = $(this.levels.groups[0]).on('mousewheel', function (event) {\n        that.mousewheelColumn(this, event);\n      });\n\n      // Normally we would reference a named methods but since we need to aceess\n      // the class' `this` property instead of the DOM element we need to use an\n      // arrow function.\n      this.scrollbars.selection.on('mousedown', function () {\n        that.scrollbarMouseDown(this, d3.event);\n      });\n\n      // We need to listen to `mouseup` and `mousemove` globally otherwise\n      // scrolling will only work as long as the cursor hovers the actual\n      // scrollbar, which is super annoying.\n      d3.select(document).on('mouseup', function () {\n        _this.globalMouseUp(d3.event);\n      }).on('mousemove', function () {\n        _this.globalMouseMove(d3.event);\n      });\n\n      // Enable dragging of the whole graph.\n      this.svgD3.call(onDragDrop, dragMoveHandler, undefined, [this.container, this.topbar.localControlWrapper], 'horizontal', {\n        x: {\n          min: Math.min(0, this.width - this.container.node().getBBox().width),\n          max: 0\n        }\n      });\n    }\n\n    babelHelpers.createClass(ListGraph, [{\n      key: 'globalMouseUp',\n      value: function globalMouseUp(event) {\n        if (this.activeScrollbar) {\n          var data = this.activeScrollbar.datum();\n          var deltaY = data.scrollbar.clientY - event.clientY;\n\n          // Save final vertical position\n          // Scrollbar\n          data.scrollbar.scrollTop = Math.min(Math.max(data.scrollbar.scrollTop - deltaY, 0), data.scrollbar.scrollHeight);\n\n          // Content\n          data.scrollTop = Math.max(Math.min(data.scrollTop + data.invertedHeightScale(deltaY), 0), -data.scrollHeight);\n\n          this.activeScrollbar.classed('active', false);\n\n          this.activeScrollbar = undefined;\n        }\n      }\n    }, {\n      key: 'globalMouseMove',\n      value: function globalMouseMove(event) {\n        if (this.activeScrollbar) {\n          var data = this.activeScrollbar.datum();\n          var deltaY = data.scrollbar.clientY - event.clientY;\n\n          // Scroll scrollbar\n          ListGraph.scrollY(this.activeScrollbar.node(), Math.min(Math.max(data.scrollbar.scrollTop - deltaY, 0), data.scrollbar.scrollHeight));\n\n          // Scroll content\n          var contentScrollTop = Math.max(Math.min(data.scrollTop + data.invertedHeightScale(deltaY), 0), -data.scrollHeight);\n\n          ListGraph.scrollY(data.nodes, contentScrollTop);\n\n          // Scroll Links\n          this.links.scroll(data.linkSelections.outgoing, this.layout.offsetLinks(data.level, contentScrollTop, 'source'));\n\n          this.links.scroll(data.linkSelections.incoming, this.layout.offsetLinks(data.level - 1, contentScrollTop, 'target'));\n        }\n      }\n    }, {\n      key: 'scrollbarMouseDown',\n      value: function scrollbarMouseDown(el, event) {\n        this.activeScrollbar = d3.select(el).classed('active', true);\n        this.activeScrollbar.datum().scrollbar.clientY = event.clientY;\n      }\n    }, {\n      key: 'mousewheelColumn',\n      value: function mousewheelColumn(el, event) {\n        event.preventDefault();\n\n        var data = d3.select(el).datum();\n\n        if (data.scrollHeight > 0) {\n          // Scroll nodes\n          data.scrollTop = Math.max(Math.min(data.scrollTop + event.deltaY, 0), -data.scrollHeight);\n\n          ListGraph.scrollY(data.nodes, data.scrollTop);\n\n          // Scroll scrollbar\n          data.scrollbar.scrollTop = data.scrollbar.heightScale(-data.scrollTop);\n\n          ListGraph.scrollY(data.scrollbar.el, data.scrollbar.scrollTop);\n\n          // Scroll Links\n          this.links.scroll(data.linkSelections.outgoing, this.layout.offsetLinks(data.level, data.scrollTop, 'source'));\n\n          this.links.scroll(data.linkSelections.incoming, this.layout.offsetLinks(data.level - 1, data.scrollTop, 'target'));\n        }\n      }\n    }, {\n      key: 'selectByLevel',\n      value: function selectByLevel(level, selector) {\n        return d3.select(this.levels.groups[0][level]).selectAll(selector);\n      }\n    }, {\n      key: 'sortColumn',\n      value: function sortColumn(level, property, sortOrder, newSortType) {\n        this.nodes.sort(this.layout.sort(level, property, sortOrder).nodes(level), newSortType);\n        this.links.sort(this.layout.links(level - 1, level + 1));\n      }\n    }, {\n      key: 'switchBarMode',\n      value: function switchBarMode(mode) {\n        this.svgD3.classed('one-bar', mode === 'one');\n        this.svgD3.classed('two-bar', mode === 'two');\n        this.nodes.bars.switchMode(mode, this.currentSorting);\n      }\n    }, {\n      key: 'trigger',\n      value: function trigger(event, data) {\n        this.events.trigger(event, data);\n      }\n    }, {\n      key: 'barMode',\n      get: function get() {\n        if (this.bars) {\n          return this.nodes.bars.mode;\n        }\n        return this._barMode;\n      },\n      set: function set(mode) {\n        if (this.bars) {\n          this.nodes.bars.mode = mode;\n        }\n        this._barMode = mode;\n      }\n    }], [{\n      key: 'scrollY',\n      value: function scrollY(el, offset) {\n        d3.select(el).attr('transform', 'translate(0, ' + offset + ')');\n      }\n    }]);\n    return ListGraph;\n  })();\n\n  return ListGraph;\n\n})($,d3);"],"sourceRoot":"/source/"}