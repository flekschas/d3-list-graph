{"version":3,"sources":["listGraph.min.js"],"names":["ListGraph","$","d3","isObject","value","type","arrayToFakeObjs","arrayIds","fakeObjs","i","length","push","id","collectInclClones","node","originalNode","clone","clones","concat","up","callback","child","nodesInclClones","j","parent","down","childRefs","upAndDown","callbackUp","callbackDown","roundRect","x","y","width","height","radius","topLeft","topRight","bottomLeft","bottomRight","e","exponentialGradient","el","start","end","name","power","steps","scale","pow","exponent","stepSize","gradient","append","attr","offset","color","opacity","babelHelpers","classCallCheck","instance","Constructor","TypeError","createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","possibleConstructorReturn","self","call","ReferenceError","SCROLLBAR_CLASS","Scrollbars","baseSelection","visData","_this","this","selection","each","data","index","select","parentNode","datum","scrollbar","classed","CLASSNAME","SCROLLBAR_WIDTH","COLUMNS","ROWS","ICON_PATH","DEFAULT_SORT_ORDER","DEFAULT_BAR_MODE","TRANSITION_SEMI_FAST","COLOR_NEGATIVE_RED","COLOR_POSITIVE_GREEN","BAR_CLASS","Bar","barData","nodeData","barCollection","setupMagnitude","currentSorting","that","nodes","depth","sortBy","generatePath","setupBorder","global","row","padding","column","contentWidth","contentHeight","setupIndicator","undefined","level","cell","activeHeight","inactiveheight","selectAll","enter","indicator","adjustWidth","bottom","mode","generateTwoBarsPath","generateOneBarPath","Math","min","abs","BARS_CLASS","Bars","bars","insertBefore","transition","duration","refBars","currentBar","referenceValue","_this2","_this3","console","log","LINKS_CLASS","LINK_CLASS","Links","layout","groups","links","diagonal","nodeIds","_highlight","exit","remove","update","get","svg","source","offsetY","offsetX","projection","NODES_CLASS","NODE_CLASS","CLONE_CLASS","Nodes","events","barMode","drawFullSizeRect","className","shrinking","rows","on","mouseClick","mouseEnter","mouseLeave","style","text","broadcast","currentNodeData","currentlyHighlightedLinks","currentActiveProperty","traverseCallbackUp","childData","hovering","traverseCallbackDown","updateIndicator","highlight","traverseCallback","newSortType","COLUMN_CLASS","SCROLL_CONTAINER_CLASS","Columns","vis","scrollbarWidth","getBoundingClientRect","scrollHeight","scrollbarHeight","max","linkSelections","incoming","selectByColumn","outgoing","scrollTop","heightScale","linear","domain","range","invertedHeightScale","invert","TOPBAR_EL","TOPBAR_CLASS","TOPBAR_CONTROL_EL","TOPBAR_CONTROL_CLASS","TOPBAR_GLOBAL_CONTROL_CLASS","Topbar","empty","insert","controlSwitch","bind","switchArrow","iconPath","globalControls","globalPrecision","sortAllColumns","highlightBars","globalPrecisionWrapper","order","globalRecall","globalRecallWrapper","globalName","highlightLabels","globalNameWrapper","globalOneBar","switchBarMode","globalOneBarWrapper","globalTwoBars","globalTwoBarsWrapper","localControlWrapper","localControls","control","local","sortOrder","toggleColumn","left","sortColumn","html","toggleOptions","deHighlight","baseElD3","selectNodesColumn","resetSortEl","columnKeys","keys","len","ExtendableError","_Error","message","getPrototypeOf","Error","captureStackTrace","LayoutNotAvailable","_ExtendableError","EventDispatcherNoFunction","_ExtendableError2","Events","dispatch","_dispatchEvent","eventName","event","document","createEvent","initCustomEvent","dispatchEvent","baseEl","rootNodes","options","listGraph","baseElJq","svgD3","svgJq","columns","dispatcher","addClass","process","afterOffsetOpacity","beforeOffsetOpacity","topbar","container","scrollPreparation","scrollbars","$levels","mousewheelColumn","scrollbarMouseDown","globalMouseUp","globalMouseMove","activeScrollbar","deltaY","clientY","scrollY","contentScrollTop","scroll","offsetLinks","preventDefault","selector","property","sort","switchMode","_barMode","set"],"mappings":";AACA,GAAIA,WAAY,SAAWC,EAAEC,GAAM,YAyEjC,SAASC,GAASC,GAGhB,GAAIC,SAAcD,EAClB,SAASA,IAAkB,UAARC,GAA4B,YAARA,GA+CzC,QAASC,GAAgBC,GAGvB,IAAK,GAFDC,MAEKC,EAAIF,EAASG,OAAQD,KAC5BD,EAASG,MAAOC,GAAIL,EAASE,IAG/B,OAAOD,GAYT,QAASK,GAAkBC,GACzB,GAAIC,GAAeD,CAEfA,GAAKE,QACPD,EAAeD,EAAKC,aAGtB,IAAIE,IAAUF,EAMd,OAJIA,GAAaE,OAAOP,SACtBO,EAASA,EAAOC,OAAOH,EAAaE,SAG/BA,EAGT,QAASE,GAAGL,EAAMM,EAAUC,GAG1B,IAAK,GAFDC,GAAkBT,EAAkBC,GAE/BL,EAAIa,EAAgBZ,OAAQD,KAAM,CACrCY,GACFD,EAASE,EAAgBb,GAAIY,EAG/B,KAAK,GAAIE,GAAID,EAAgBb,GAAGe,OAAOd,OAAQa,KAC7CJ,EAAGG,EAAgBb,GAAGe,OAAOD,GAAIH,EAAUE,EAAgBb,KAKjE,QAASgB,GAAKX,EAAMM,GAGlB,IAAK,GAFDE,GAAkBT,EAAkBC,GAE/BL,EAAIa,EAAgBZ,OAAQD,KAAM,CACzCW,EAASE,EAAgBb,GAEzB,KAAK,GAAIc,GAAID,EAAgBb,GAAGiB,UAAUhB,OAAQa,KAChDE,EAAKH,EAAgBb,GAAGiB,UAAUH,GAAIH,IAK5C,QAASO,GAAUb,EAAMc,EAAYC,GAC/BA,GACFV,EAAGL,EAAMc,GACTH,EAAKX,EAAMe,KAEXV,EAAGL,EAAMc,GACTH,EAAKX,EAAMc,IAIf,QAASE,GAAUC,EAAGC,EAAGC,EAAOC,EAAQC,GACtC,GAAIC,GAAU,EACVC,EAAW,EACXC,EAAa,EACbC,EAAc,CAElB,KACEH,EAAUD,EAAOC,SAAW,EAC5BC,EAAWF,EAAOE,UAAY,EAC9BC,EAAaH,EAAOG,YAAc,EAClCC,EAAcJ,EAAOI,aAAe,EACpC,MAAOC,IAET,MAAO,KAAOT,EAAIK,GAAW,IAAMJ,EAAI,KAAOC,EAAQG,EAAUC,GAAY,IAAMA,EAAW,IAAMA,EAAW,UAAYA,EAAW,IAAMA,EAAW,KAAOH,GAAUG,EAAWE,IAAgB,IAAMA,EAAc,IAAMA,EAAc,WAAaA,EAAc,IAAMA,EAAc,KAAOD,GAAcL,EAAQM,IAAgB,IAAMD,EAAa,IAAMA,EAAa,WAAaA,EAAa,KAAOA,EAAa,KAAOF,GAAWF,EAASI,IAAe,IAAMF,EAAU,IAAMA,EAAU,UAAYA,EAAU,KAAOA,EAAU,IAm4B7gB,QAASK,GAAoBC,EAAIC,EAAOC,EAAKC,EAAMC,EAAOC,GACxD,GAAIC,GAAQ9C,EAAG8C,MAAMC,MAAMC,SAASJ,GAAS,GACzCK,EAAW,IAAMJ,GAAS,GAAK,GAE/BK,EAAWV,EAAGW,OAAO,QAAQA,OAAO,kBAAkBC,KAAK,KAAMT,GAAMS,KAAK,KAAMX,EAAMZ,GAAGuB,KAAK,KAAMX,EAAMX,GAAGsB,KAAK,KAAMV,EAAIb,GAAGuB,KAAK,KAAMV,EAAIZ,GAAGsB,KAAK,eAAgB,MAE5KF,GAASC,OAAO,QAAQC,KAAK,SAAUX,EAAMY,OAAS,KAAKD,KAAK,aAAcX,EAAMa,OAAOF,KAAK,eAAgBX,EAAMc,QAEtH,KAAK,GAAIhD,GAAI,EAAOsC,EAAJtC,EAAWA,IACzB2C,EAASC,OAAO,QAAQC,KAAK,SAAUX,EAAMY,OAAS9C,EAAI0C,GAAYP,EAAIW,OAASZ,EAAMY,QAAU,KAAKD,KAAK,aAAcV,EAAIY,OAAOF,KAAK,eAAgBX,EAAMc,QAAUT,EAAMvC,EAAI0C,IAAaP,EAAIa,QAAUd,EAAMc,SAGxNL,GAASC,OAAO,QAAQC,KAAK,SAAUV,EAAIW,OAAS,KAAKD,KAAK,aAAcV,EAAIY,OAAOF,KAAK,eAAgBV,EAAIa,SA7lClH,GAAIC,KAEJA,GAAaC,eAAiB,SAAUC,EAAUC,GAChD,KAAMD,YAAoBC,IACxB,KAAM,IAAIC,WAAU,sCAIxBJ,EAAaK,YAAc,WACzB,QAASC,GAAiBC,EAAQC,GAChC,IAAK,GAAIzD,GAAI,EAAGA,EAAIyD,EAAMxD,OAAQD,IAAK,CACrC,GAAI0D,GAAaD,EAAMzD,EACvB0D,GAAWC,WAAaD,EAAWC,aAAc,EACjDD,EAAWE,cAAe,EACtB,SAAWF,KAAYA,EAAWG,UAAW,GACjDC,OAAOC,eAAeP,EAAQE,EAAWM,IAAKN,IAIlD,MAAO,UAAUN,EAAaa,EAAYC,GAGxC,MAFID,IAAYV,EAAiBH,EAAYe,UAAWF,GACpDC,GAAaX,EAAiBH,EAAac,GACxCd,MAIXH,EAAamB,SAAW,SAAUC,EAAUC,GAC1C,GAA0B,kBAAfA,IAA4C,OAAfA,EACtC,KAAM,IAAIjB,WAAU,iEAAoEiB,GAG1FD,GAASF,UAAYL,OAAOS,OAAOD,GAAcA,EAAWH,WAC1DK,aACE7E,MAAO0E,EACPV,YAAY,EACZE,UAAU,EACVD,cAAc,KAGdU,IAAYR,OAAOW,eAAiBX,OAAOW,eAAeJ,EAAUC,GAAcD,EAASK,UAAYJ,IAG7GrB,EAAa0B,0BAA4B,SAAUC,EAAMC,GACvD,IAAKD,EACH,KAAM,IAAIE,gBAAe,4DAG3B,QAAOD,GAAyB,gBAATA,IAAqC,kBAATA,GAA8BD,EAAPC,EA+B5E,IAAIE,GAAkB,YAElBC,EAAa,QAASA,GAAWC,EAAeC,EAAS1D,GAC3D,GAAI2D,GAAQC,IAEZnC,GAAaC,eAAekC,KAAMJ,GAElCI,KAAKF,QAAUA,EACfE,KAAK5D,MAAQA,EAGb4D,KAAKC,UAAYJ,EAAcrC,OAAO,QAAQC,KAAK,QAASkC,GAAiBF,KAAK,SAAUQ,GAC1FA,EAAUC,KAAK,SAAUC,EAAMC,GAC7B/F,EAAGgG,OAAOL,KAAKM,YAAYC,QAAQC,UAAU3D,GAAKmD,SAEnDvC,KAAK,IAAK,SAAU0C,GACrB,MAAOA,GAAKK,UAAUtE,IACrBuB,KAAK,IAAK,SAAU0C,GACrB,MAAOA,GAAKK,UAAUrE,IACrBsB,KAAK,QAAS,SAAU0C,GACzB,MAAOJ,GAAM3D,QACZqB,KAAK,SAAU,SAAU0C,GAC1B,MAAOA,GAAKK,UAAUnE,SACrBoB,KAAK,KAAMuC,KAAK5D,MAAQ,GAAGqB,KAAK,KAAMuC,KAAK5D,MAAQ,GAAGqE,QAAQ,SAAS,IAGxEC,EAAY,aAEZC,EAAkB,EAClBC,EAAU,EACVC,EAAO,EAGPC,EAAY,GAEZC,EAAqB,OAErBC,EAAmB,MAEnBC,EAAuB,IAEvBC,EAAqB,UACrBC,EAAuB,UAyFvBC,EAAY,MAEZC,EAAM,WACR,QAASA,GAAIpB,EAAWqB,EAASC,EAAUzB,EAAS0B,GA+BlD,QAASC,GAAexB,GACtB,GAAIyB,GAAiBC,EAAK7B,QAAQ8B,MAAMD,EAAKJ,SAASM,OAAOC,MAE7D7B,GAAUxC,KAAK,IAAK,SAAU0C,GAC5B,MAAOkB,GAAIU,aAAa5B,EAAMuB,EAAgBC,EAAK7B,WAClDW,QAAQ,iBAAiB,GAG9B,QAASuB,GAAY/B,GACnBA,EAAUxC,KAAK,IAAK,GAAGA,KAAK,IAAKkE,EAAK7B,QAAQmC,OAAOC,IAAIC,SAAS1E,KAAK,QAASkE,EAAK7B,QAAQmC,OAAOG,OAAOC,cAAc5E,KAAK,SAAUkE,EAAK7B,QAAQmC,OAAOC,IAAII,eAAe7E,KAAK,KAAM,GAAGA,KAAK,KAAM,GAAGgD,QAAQ,cAAc,GAGnO,QAAS8B,GAAetC,GACtBA,EAAUxC,KAAK,IAAK,SAAU0C,GAC5B,MAAOkB,GAAIU,aAAa5B,EAAMqC,OAAWb,EAAK7B,QAASK,EAAK5F,SAC3DkG,QAAQ,iBAAiB,GA7C9B,GAAIV,GAAQC,IAEZnC,GAAaC,eAAekC,KAAMqB,EAElC,IAAIM,GAAO3B,IAEXA,MAAKG,KAAOmB,EACZtB,KAAKuB,SAAWA,EAChBvB,KAAKF,QAAUA,EACfE,KAAKwB,cAAgBA,EAErBxB,KAAKG,KAAKjE,EAAIqF,EAASrF,EACvB8D,KAAKG,KAAKsC,MAAQlB,EAASM,MAE3B7B,KAAK3D,OAAS2D,KAAKF,QAAQmC,OAAOC,IAAII,eAAoC,EAAnBtC,KAAKG,KAAKtF,QAAiD,EAAnCmF,KAAKF,QAAQmC,OAAOS,KAAKP,QAExGnC,KAAK2C,aAAe3C,KAAKF,QAAQmC,OAAOC,IAAII,cAAgB,EAE5DtC,KAAK4C,eAAoD,EAAnC5C,KAAKF,QAAQmC,OAAOS,KAAKP,QAAc,EAE7DnC,KAAKC,UAAYA,EAAU4C,UAAUzB,GAAWjB,KAAKH,KAAKG,MAAM2C,QAAQtF,OAAO,KAAKC,KAAK,QAAS,SAAU0C,GAC1G,MAAOiB,GAAY,IAAMjB,EAAKpF,KAC7B0F,QAAQ,SAAU,SAAUN,GAC7B,MAAOA,GAAKpF,KAAOgF,EAAMD,QAAQ8B,MAAM7B,EAAMwB,SAASM,OAAOC,SAyB/D9B,KAAKC,UAAUzC,OAAO,QAAQiC,KAAKuC,GAEnChC,KAAKC,UAAUzC,OAAO,QAAQiC,KAAKgC,GAEnCzB,KAAKC,UAAUzC,OAAO,QAAQiC,KAAK8C,GAkErC,MA/DA1E,GAAaK,YAAYmD,EAAK,OAC5BzC,IAAK,eACLrE,MAAO,SAAsB4F,EAAMuB,EAAgB5B,EAASiD,EAAWC,EAAaC,GAClF,MAAgC,QAA5BjD,KAAKwB,cAAc0B,KACdlD,KAAKmD,oBAAoBhD,EAAML,EAASmD,GAExCjD,KAAKoD,mBAAmBjD,EAAMuB,EAAgB5B,EAASiD,EAAWC,MAI7EpE,IAAK,qBACLrE,MAAO,SAA4B4F,EAAMuB,EAAgB5B,EAASiD,EAAWC,GAC3E,GAAI9G,GAAI,EAEJE,EAAQ,EAERC,EAASyD,EAAQmC,OAAOC,IAAII,cAE5BhG,GACFC,QAAS,EACTE,WAAY,EAsBd,OAnBIsG,KACFzG,MAGE6D,EAAKpF,KAAO2G,GAAuC,mBAAdqB,IACvC7G,EAAIiE,EAAK5F,MAAQuF,EAAQmC,OAAOG,OAAOC,aAAe,EACtD/F,MACSyG,GACT7G,EAAI6G,EAAYjD,EAAQmC,OAAOG,OAAOC,aAClCW,IACE7C,EAAK5F,MAAQwI,IACf7G,EAAIiE,EAAK5F,MAAQuF,EAAQmC,OAAOG,OAAOC,cAEzCjG,EAAQiH,KAAKC,IAAID,KAAKE,IAAIR,EAAY5C,EAAK5F,OAAQ,GAAKuF,EAAQmC,OAAOG,OAAOC,eAGhFjG,EAAQ0D,EAAQmC,OAAOG,OAAOC,aAAelC,EAAK5F,MAG7C0B,EAAUC,EAAG4D,EAAQmC,OAAOC,IAAIC,QAAS/F,EAAOC,EAAQC,MAGjEsC,IAAK,sBACLrE,MAAO,SAA6B4F,EAAML,EAASmD,GACjD,GAAI5G,GAASyD,EAAQmC,OAAOC,IAAII,cAAgB,EAE5ClG,EAAQ0D,EAAQmC,OAAOG,OAAOC,aAAelC,EAAK5F,MAElD4B,EAAI2D,EAAQmC,OAAOC,IAAIC,QAEvB7F,GAAWC,QAAS,EAOxB,OALI0G,KACF3G,GAAWG,WAAY,GACvBN,GAAKE,GAGAJ,EAAU,EAAGE,EAAGC,EAAOC,EAAQC,OAGnC+E,KAGLmC,EAAa,OAEbC,EAAO,WACT,QAASA,GAAKxD,EAAWiD,EAAMpD,GAC7BjC,EAAaC,eAAekC,KAAMyD,EAElC,IAAI9B,GAAO3B,IAEXA,MAAKkD,KAAOA,EACZlD,KAAKF,QAAUA,EAEfE,KAAKC,UAAYA,EAAUzC,OAAO,KAAKC,KAAK,QAAS+F,GAErDxD,KAAKC,UAAUC,KAAK,SAAUK,GAC5B,GAAIc,GAAIhH,EAAGgG,OAAOL,MAAOO,EAAMJ,KAAKuD,KAAMnD,EAAOoB,EAAK7B,QAAS6B,KA4EnE,MAxEA9D,GAAaK,YAAYuF,IACvB7E,IAAK,SACLrE,MAAO,SAAgB0F,EAAW6B,GAChC,GAAI/B,GAAQC,IAEZC,GAAUC,KAAK,WACb,GAAIrD,GAAKxC,EAAGgG,OAAOL,KAEfnD,GAAG4D,QAAQ,UACb5D,EAAG4D,QAAQ,UAAU,IAErB5D,EAAG4D,QAAQ,UAAU,GAGrBT,KAAKM,WAAWqD,aAAa3D,KAAM3F,EAAGgG,OAAOL,KAAKM,YAAYD,OAAO,QAAQpF,WAIjFgF,EAAU4C,UAAU,kBAAkBe,aAAaC,SAAS5C,GAAsBxD,KAAK,IAAK,SAAU0C,GACpG,MAAOkB,GAAIU,aAAa5B,EAAM2B,EAAQ/B,EAAMD,cAIhDlB,IAAK,kBACLrE,MAAO,SAAyBuJ,EAASC,EAAYC,GACnD,GAAIC,GAASjE,IAEb+D,GAAWH,aAAaC,SAAS,GAAGpG,KAAK,IAAK,SAAU0C,GACtD,MAAOkB,GAAIU,aAAa5B,EAAMqC,OAAWyB,EAAOnE,WAGlDgE,EAAQrG,KAAK,IAAK,SAAU0C,GAC1B,MAAOkB,GAAIU,aAAa5B,EAAMqC,OAAWyB,EAAOnE,QAASkE,KACxDvD,QAAQ,WAAY,SAAUN,GAC/B,MAAOA,GAAK5F,OAASyJ,IAGvBF,EAAQF,aAAaC,SAAS5C,GAAsBxD,KAAK,IAAK,SAAU0C,GACtE,MAAOkB,GAAIU,aAAa5B,EAAMqC,OAAWyB,EAAOnE,QAASkE,GAAgB,QAI7EpF,IAAK,aACLrE,MAAO,SAAoB2I,EAAMxB,GAC/B,GAAIwC,GAASlE,IAETA,MAAKkD,OAASA,IACH,QAATA,IACExB,EAAeO,OAAOzH,MACxBwF,KAAKC,UAAU4C,UAAU,QAAQA,UAAU,kBAAkBe,aAAaC,SAAS5C,GAAsBxD,KAAK,IAAK,SAAU0C,GAC3H,MAAOkB,GAAI+B,mBAAmBjD,EAAMuB,EAAeO,OAAOzH,KAAM0J,EAAOpE,WAEzEqE,QAAQC,IAAI,YAEZD,QAAQC,IAAI,WAIH,QAATlB,IACFlD,KAAKC,UAAU4C,UAAU,kBAAkBA,UAAU,kBAAkBe,aAAaC,SAAS5C,GAAsBxD,KAAK,IAAK,SAAU0C,GACrI,MAAOkB,GAAI8B,oBAAoBhD,EAAM+D,EAAOpE,WAG9CE,KAAKC,UAAU4C,UAAU,eAAeA,UAAU,kBAAkBe,aAAaC,SAAS5C,GAAsBxD,KAAK,IAAK,SAAU0C,GAClI,MAAOkB,GAAI8B,oBAAoBhD,EAAM+D,EAAOpE,SAAS,MAIzDE,KAAKkD,KAAOA,OAIXO,KAGLY,EAAc,QACdC,EAAa,OAEbC,EAAQ,WACV,QAASA,GAAMtE,EAAWH,EAAS0E,GACjC,GAAIzE,GAAQC,IAEZnC,GAAaC,eAAekC,KAAMuE,GAElCvE,KAAKF,QAAUA,EACfE,KAAKwE,OAASA,EAEdxE,KAAKyE,OAASxE,EAAUzC,OAAO,KAAKC,KAAK,QAAS4G,GAAa5E,KAAK,SAAUQ,GAC5EA,EAAUC,KAAK,SAAUC,EAAMC,GAC7B/F,EAAGgG,OAAOL,KAAKM,YAAYC,QAAQmE,MAAQ1E,SAI/CA,KAAK0E,MAAQ1E,KAAKyE,OAAO5B,UAAUyB,GAAYnE,KAAK,SAAUA,EAAMC,GAClE,MAAOL,GAAMyE,OAAOE,MAAMtE,KACzB0C,QAAQtF,OAAO,QAAQC,KAAK,QAAS,QAAQA,KAAK,IAAKuC,KAAK2E,UAiDjE,MA9CA9G,GAAaK,YAAYqG,IACvB3F,IAAK,YACLrE,MAAO,SAAmBqK,EAASC,GACjC7E,KAAK0E,MAAMvE,KAAKyE,EAAS,SAAUzE,GACjC,MAAOA,GAAKpF,KACX0F,QAAQ,YAAaoE,KAAe,GAAQ,GAAQ,MAGzDjG,IAAK,SACLrE,MAAO,SAAgB0F,EAAWE,GAChCF,EAAUE,KAAKA,GAAM1C,KAAK,IAAKuC,KAAK2E,UAAUG,OAAOC,YAGvDnG,IAAK,OACLrE,MAAO,SAAcyK,GACnB,GAAIlI,GAAQ,WACVzC,EAAGgG,OAAOL,MAAMS,QAAQ,WAAW,IAEjC1D,EAAM,WACR1C,EAAGgG,OAAOL,MAAMS,QAAQ,WAAW,GAGrCT,MAAK0E,MAAMvE,KAAK6E,EAAQ,SAAU7E,GAChC,MAAOA,GAAKpF,KACX6I,aAAaC,SAAS5C,GAAsBxD,KAAK,IAAKuC,KAAK2E,UAAUzE,KAAK,QAASpD,GAAOoD,KAAK,MAAOnD,MAG3G6B,IAAK,WACLqG,IAAK,WACH,GAAIhB,GAASjE,IAEb,OAAO3F,GAAG6K,IAAIP,WAAWQ,OAAO,SAAUhF,GACxC,OACEjE,EAAGiE,EAAKgF,OAAOlK,KAAKkB,EAAIgE,EAAKgF,OAAOC,QAAUnB,EAAOnE,QAAQmC,OAAOC,IAAI7F,OAAS,EACjFF,EAAGgE,EAAKgF,OAAOlK,KAAKiB,EAAIiE,EAAKgF,OAAOE,QAAUpB,EAAOnE,QAAQmC,OAAOG,OAAOC,aAAe4B,EAAOnE,QAAQmC,OAAOG,OAAOD,WAExH/D,OAAO,SAAU+B,GAClB,OACEjE,EAAGiE,EAAK/B,OAAOnD,KAAKkB,EAAIgE,EAAK/B,OAAOgH,QAAUnB,EAAOnE,QAAQmC,OAAOC,IAAI7F,OAAS,EACjFF,EAAGgE,EAAK/B,OAAOnD,KAAKiB,EAAIiE,EAAK/B,OAAOiH,QAAUpB,EAAOnE,QAAQmC,OAAOG,OAAOD,WAE5EmD,WAAW,SAAUnF,GACtB,OAAQA,EAAKhE,EAAGgE,EAAKjE,SAIpBqI,KAGLgB,EAAc,QACdC,EAAa,OACbC,EAAc,QAEdC,EAAQ,WACV,QAASA,GAAM7F,EAAeC,EAAS4E,EAAOiB,EAAQC,GAQpD,QAASC,GAAiB5F,EAAW6F,EAAWC,GACzCA,IACHA,EAAY,GAGd9F,EAAUxC,KAAK,IAAK,SAAU0C,GAC5B,MAAO4F,KACNtI,KAAK,IAAK,SAAU0C,GACrB,MAAOwB,GAAK7B,QAAQmC,OAAOC,IAAIC,QAAU4D,IACxCtI,KAAK,QAASkE,EAAK7B,QAAQmC,OAAOG,OAAOC,aAAe,EAAI0D,GAAWtI,KAAK,SAAUkE,EAAK7B,QAAQmC,OAAOC,IAAII,cAAgB,EAAIyD,GAAWtI,KAAK,KAAM,EAAIsI,GAAWtI,KAAK,KAAM,EAAIsI,GAAWtF,QAAQqF,GAAW,GAhBzN,GAAI/F,GAAQC,IAEZnC,GAAaC,eAAekC,KAAM0F,EAElC,IAAI/D,GAAO3B,IAeXA,MAAKF,QAAUA,EACfE,KAAK0E,MAAQA,EACb1E,KAAK2F,OAASA,EAEd3F,KAAKyE,OAAS5E,EAAcrC,OAAO,KAAKC,KAAK,QAAS8H,GAAa9F,KAAK,SAAUQ,GAChFA,EAAUC,KAAK,SAAUC,EAAMC,GAC7B/F,EAAGgG,OAAOL,KAAKM,YAAYC,QAAQqB,MAAQ5B,SAI/CA,KAAK4B,MAAQ5B,KAAKyE,OAAO5B,UAAU,IAAM2C,GAAYrF,KAAK,SAAUA,GAClE,MAAOA,GAAK6F,OACXlD,QAAQtF,OAAO,KAAKiD,QAAQ+E,GAAY,GAAM/E,QAAQgF,EAAa,SAAUtF,GAC9E,MAAOA,GAAKhF,QACXsC,KAAK,YAAa,SAAU0C,GAC7B,MAAO,cAAgBA,EAAKjE,EAAI6D,EAAMD,QAAQmC,OAAOG,OAAOD,SAAW,KAAOhC,EAAKhE,EAAI,MAGzF6D,KAAK4B,MAAMpE,OAAO,QAAQiC,KAAKoG,EAAkB,KAAM,GAEvD7F,KAAK4B,MAAMqE,GAAG,QAAS,SAAU9F,GAC/BwB,EAAKuE,WAAWlG,KAAMG,KAGxBH,KAAK4B,MAAMqE,GAAG,aAAc,SAAU9F,GACpCwB,EAAKwE,WAAWnG,KAAMG,KAGxBH,KAAK4B,MAAMqE,GAAG,aAAc,SAAU9F,GACpCwB,EAAKyE,WAAWpG,KAAMG,KAGxBH,KAAK0D,KAAO,GAAID,GAAKzD,KAAK4B,MAAOgE,EAAS5F,KAAKF,SAE/CE,KAAK4B,MAAMpE,OAAO,QAAQiC,KAAKoG,EAAkB,UAGjD7F,KAAK4B,MAAMnC,KAAK,SAAUQ,GACxBA,EAAUzC,OAAO,iBAAiBC,KAAK,IAAK,SAAU0C,GACpD,MAAOJ,GAAMD,QAAQmC,OAAOS,KAAKP,UAChC1E,KAAK,IAAK,SAAU0C,GACrB,MAAOJ,GAAMD,QAAQmC,OAAOC,IAAIC,QAAUpC,EAAMD,QAAQmC,OAAOS,KAAKP,UACnE1E,KAAK,QAASsC,EAAMD,QAAQmC,OAAOG,OAAOC,cAAc5E,KAAK,SAAUsC,EAAMD,QAAQmC,OAAOC,IAAII,cAAoD,EAApCvC,EAAMD,QAAQmC,OAAOS,KAAKP,SAAa1E,KAAK,QAAS,iBAAiBD,OAAO,aAAaC,KAAK,QAAS,SAASA,KAAK,QAAS,SAAU0C,GAC1P,MAAOA,GAAKA,KAAKnD,OAChBqJ,MAAM,cAAetG,EAAMD,QAAQmC,OAAOC,IAAII,cAAoD,EAApCvC,EAAMD,QAAQmC,OAAOS,KAAKP,QAAc,MAAM3E,OAAO,cAAc8I,KAAK,SAAUnG,GACjJ,MAAOA,GAAKA,KAAKnD,SAoIvB,MA/HAa,GAAaK,YAAYwH,IACvB9G,IAAK,aACLrE,MAAO,SAAoBsC,EAAIsD,GAC7BH,KAAK2F,OAAOY,UAAU,wBAA0BxL,GAAIoF,EAAKpF,QAG3D6D,IAAK,aACLrE,MAAO,SAAoBsC,EAAIsD,GAC7B,GAAI8D,GAASjE,KAET2B,EAAO3B,KACPwG,EAAkBrG,CAGtBH,MAAKyG,4BAEL,IAAIC,GAAwBrM,EAAGgG,OAAOxD,GAAIgG,UAAU,8BAA8BtC,QAE9EoG,EAAqB,SAA4BxG,EAAMyG,GACzDzG,EAAK0G,SAAW,CAChB,KAAK,GAAIjM,GAAIuF,EAAKuE,MAAM7J,OAAQD,KAI1BuF,EAAKuE,MAAM9J,GAAGwD,OAAOnD,KAAKF,KAAO6L,EAAU7L,IAC7CkJ,EAAOwC,0BAA0B3L,KAAKqF,EAAKuE,MAAM9J,GAAGG,KAKtD+L,EAAuB,SAA8B3G,GACvDA,EAAK0G,SAAW,CAChB,KAAK,GAAIjM,GAAIuF,EAAKuE,MAAM7J,OAAQD,KAC9BqJ,EAAOwC,0BAA0B3L,KAAKqF,EAAKuE,MAAM9J,GAAGG,IAGxDe,GAAUqE,EAAMwG,EAAoBG,GAEhC3G,EAAKhF,QACPgF,EAAKjF,aAAa2L,SAAW,GAG/B1G,EAAK0G,SAAW,EAEhB7G,KAAK4B,MAAM1B,KAAK,SAAUC,GACxB,GAAIlF,GAAOZ,EAAGgG,OAAOL,KAErB,IAAsB,IAAlBG,EAAK0G,SACP5L,EAAKwF,QAAQ,qBAAqB,OAC7B,IAAsB,IAAlBN,EAAK0G,SAAgB,CAC9B5L,EAAKwF,QAAQ,uBAAuB,GACpCxF,EAAK4H,UAAU,QAAU6D,EAAsB3L,IAAI0F,QAAQ,OAAQ,SAAUN,GAC3E,GAAIpF,GAAKoF,EAAKpF,EAMd,OAJIoF,GAAKhF,QACPJ,EAAKoF,EAAKjF,aAAaH,IAGrBA,IAAOyL,EAAgBzL,IAClB,EADT,QAKF,IAAIgJ,GAAa1J,EAAGgG,OAAOxD,GAAIgG,UAAU,QAAU6D,EAAsB3L,IAAI0F,QAAQ,aAAa,EAElGkB,GAAK+B,KAAKqD,gBAAgB9L,EAAK4H,UAAU,4BAA6BkB,EAAWlB,UAAU,kBAAmB6D,EAAsBnM,UAIxIyF,KAAK0E,MAAMsC,UAAUvM,EAAgBuF,KAAKyG,4BAE1CzG,KAAK2F,OAAOY,UAAU,wBAA0BxL,GAAIoF,EAAKpF,QAG3D6D,IAAK,aACLrE,MAAO,SAAoBsC,EAAIsD,GAC7B,GAAI8G,GAAmB,SAA0B9G,GAC/C,MAAOA,GAAK0G,SAAW,EAGzB1G,GAAK0G,SAAW,EAChB/K,EAAUqE,EAAM8G,GAEZ9G,EAAKhF,QACPgF,EAAKjF,aAAa2L,SAAW,GAG/B7G,KAAK4B,MAAMnB,QAAQ,qBAAqB,GACxCT,KAAK4B,MAAMnB,QAAQ,uBAAuB,GAC1CT,KAAK4B,MAAMiB,UAAU,kBAAkBpC,QAAQ,aAAa,GAE5DT,KAAK0E,MAAMsC,UAAUvM,EAAgBuF,KAAKyG,4BAA4B,GAEtEzG,KAAK2F,OAAOY,UAAU,wBAA0BxL,GAAIoF,EAAKpF,QAG3D6D,IAAK,OACLrE,MAAO,SAAcyK,EAAQkC,GAG3B,IAAK,GAFDhD,GAASlE,KAEJpF,EAAIoK,EAAOnK,OAAQD,KAAM,CAChC,GAAIkC,GAAQ,WACVzC,EAAGgG,OAAOL,MAAMS,QAAQ,WAAW,IAEjC1D,EAAM,WACR1C,EAAGgG,OAAOL,MAAMS,QAAQ,WAAW,IAGjCR,EAAYD,KAAK4B,MAAMzB,KAAK6E,EAAOpK,GAAGoL,KAAM,SAAU7F,GACxD,MAAOA,GAAKpF,IAGdkF,GAAU2D,aAAaC,SAAS5C,GAAsBxD,KAAK,YAAa,SAAU0C,GAChF,MAAO,cAAgBA,EAAKjE,EAAIgI,EAAOpE,QAAQmC,OAAOG,OAAOD,SAAW,KAAOhC,EAAKhE,EAAI,MACvF+D,KAAK,QAASpD,GAAOoD,KAAK,MAAOnD,GAEhCmK,GACFlH,KAAK0D,KAAKsB,OAAO/E,EAAU4C,UAAU,QAASmC,EAAOpK,GAAGkH,YAK9DlD,IAAK,UACLqG,IAAK,WACH,MAAOjF,MAAK0D,KAAKR,SAGdwC,KAGLyB,EAAe,SACfC,EAAyB,mBAEzBC,EAAU,WACZ,QAASA,GAAQpH,EAAWH,GAC1B,GAAIC,GAAQC,IAEZnC,GAAaC,eAAekC,KAAMqH,GAElCrH,KAAKF,QAAUA,EACfE,KAAKyE,OAASxE,EAAU4C,UAAU,KAAK1C,KAAKH,KAAKF,QAAQ8B,OAAOkB,QAAQtF,OAAO,KAAKC,KAAK,QAAS0J,GAKlGnH,KAAKyE,OAAOjH,OAAO,QAAQC,KAAK,QAAS2J,GAAwB3J,KAAK,IAAK,SAAU0C,GACnF,MAAOA,GAAKjE,IACXuB,KAAK,IAAK,SAAU0C,GACrB,MAAOA,GAAKhE,IACXsB,KAAK,QAAS,SAAU0C,GACzB,MAAOJ,GAAMD,QAAQmC,OAAOG,OAAOhG,QAClCqB,KAAK,SAAU,SAAU0C,GAC1B,MAAOJ,GAAMD,QAAQmC,OAAOG,OAAO/F,SAwCvC,MApCAwB,GAAaK,YAAYmJ,IACvBzI,IAAK,oBACLrE,MAAO,SAA2B+M,EAAKC,GACrC,GAAItD,GAASjE,IAEbA,MAAKyE,OAAOvE,KAAK,SAAUC,EAAMC,GAC/B,GAAIkC,GAAgBnC,EAAKyB,MAAM4F,wBAAwBnL,OAAS,EAAI4H,EAAOnE,QAAQmC,OAAOC,IAAIC,QAC1FsF,EAAenF,EAAgB2B,EAAOnE,QAAQmC,OAAOG,OAAO/F,OAC5DqL,EAAkBD,EAAe,EAAIpE,KAAKsE,IAAI1D,EAAOnE,QAAQmC,OAAOG,OAAO/F,OAAS4H,EAAOnE,QAAQmC,OAAOG,OAAO/F,OAASiG,EAAe,IAAM,CAEnJnC,GAAK9D,OAASiG,EACdnC,EAAKyH,gBACHC,SAAUzH,EAAQ,EAAIkH,EAAIQ,eAAe1H,EAAQ,EAAG,SAAW,KAC/D2H,SAAUT,EAAIQ,eAAe1H,EAAO,UAEtCD,EAAKsH,aAAeA,EACpBtH,EAAK6H,UAAY,EACjB7H,EAAKK,WACH3D,GAAI2F,OACJtG,EAAGiE,EAAKjE,EAAI+H,EAAOnE,QAAQmC,OAAOG,OAAOhG,MAAQmL,EACjDpL,EAAG,EACHC,MAAOmL,EACPlL,OAAQqL,EACRD,aAAcxD,EAAOnE,QAAQmC,OAAOG,OAAO/F,OAASqL,EACpDM,UAAW,EACXC,YAAa5N,EAAG8C,MAAM+K,SAASC,QAAQ,EAAGV,IAAeW,OAAO,EAAGnE,EAAOnE,QAAQmC,OAAOG,OAAO/F,OAASqL,KAE3GvH,EAAKkI,oBAAsBlI,EAAKK,UAAUyH,YAAYK,YAI1D1J,IAAK,SACLqG,IAAK,WACH,MAAOjF,MAAKF,QAAQmC,OAAOG,OAAO/F,WAG/BgL,KAGLkB,EAAY,MACZC,EAAe,UAEfC,EAAoB,KACpBC,EAAuB,WACvBC,EAA8B,kBAE9BC,EAAS,WACX,QAASA,GAAOtB,EAAKrH,EAAWH,GAC9B,GAAIC,GAAQC,IAEZnC,GAAaC,eAAekC,KAAM4I,EAElC,IAAIjH,GAAO3B,IAEXA,MAAKsH,IAAMA,EACXtH,KAAKF,QAAUA,EAEfE,KAAKnD,GAAKoD,EAAUI,OAAO,IAAMmI,GAE7BxI,KAAKnD,GAAGgM,UACV7I,KAAKnD,GAAKoD,EAAU6I,OAAOP,EAAW,gBAAgB9K,KAAK,QAAS+K,IAGtExI,KAAK+I,cAAgB/I,KAAKnD,GAAGW,OAAO,OAAOC,KAAK,QAAS,gCAAgC4I,MAAM,QAASrG,KAAKF,QAAQmC,OAAOG,OAAOD,QAAU,MAAM1B,QAAQ,kBAAkB,GAAMwF,GAAG,QAASjG,KAAAA,UAAYgJ,KAAKhJ,OAEhNA,KAAKiJ,YAAcjJ,KAAK+I,cAAcvL,OAAO,OAAOA,OAAO,OAAOC,KAAK,aAAcuC,KAAKsH,IAAI4B,SAAW,eAAezL,KAAK,QAAS,gBAEtIuC,KAAKmJ,eAAiBnJ,KAAKnD,GAAGW,OAAOiL,GAAmBhI,QAAQkI,GAA6B,GAE7F3I,KAAKoJ,gBAAkBpJ,KAAKmJ,eAAe3L,OAAO,MAAMC,KAAK,QAAS,8BAA8BgD,QAAQ,SAAU,WACpH,MAA4C,cAAxCkB,EAAK2F,IAAI5F,eAAeO,OAAOzH,MAGjCmH,EAAK2F,IAAI5F,eAAeO,OAAOpF,GAAKxC,EAAGgG,OAAOL,OACvC,GAJT,SAMCiG,GAAG,QAAS,SAAU9F,GACvBwB,EAAK0H,eAAerJ,KAAM,eACzBiG,GAAG,aAAc,WAClB,MAAOlG,GAAMuJ,cAAc9G,OAAW,eACrCyD,GAAG,aAAc,WAClB,MAAOlG,GAAMuJ,cAAc9G,OAAW,aAAa,KAGrDxC,KAAKuJ,uBAAyBvJ,KAAKoJ,gBAAgB5L,OAAO,OAAOC,KAAK,QAAS,WAAW6I,KAAK,aAAaD,MAAM,SAAU,KAAOrG,KAAKF,QAAQmC,OAAOG,OAAOD,QAAU,MAExKnC,KAAKuJ,uBAAuB/L,OAAO,OAAOC,KAAK,QAAS,iCAAiCgD,QAAQ,UAAmD,cAAxCT,KAAKsH,IAAI5F,eAAeO,OAAOzH,MAAsBgD,OAAO,OAAOC,KAAK,aAAcuC,KAAKsH,IAAI4B,SAAW,WAEtNlJ,KAAKuJ,uBAAuB/L,OAAO,OAAOC,KAAK,QAAS,mCAAmCgD,QAAQ,UAAmD,cAAxCT,KAAKsH,IAAI5F,eAAeO,OAAOzH,MAAiE,IAAzCwF,KAAKsH,IAAI5F,eAAeO,OAAOuH,OAAahM,OAAO,OAAOC,KAAK,aAAcuC,KAAKsH,IAAI4B,SAAW,aAEtQlJ,KAAKuJ,uBAAuB/L,OAAO,OAAOC,KAAK,QAAS,oCAAoCgD,QAAQ,UAAmD,cAAxCT,KAAKsH,IAAI5F,eAAeO,OAAOzH,MAAiE,IAAzCwF,KAAKsH,IAAI5F,eAAeO,OAAOuH,OAAahM,OAAO,OAAOC,KAAK,aAAcuC,KAAKsH,IAAI4B,SAAW,cAEvQlJ,KAAKyJ,aAAezJ,KAAKmJ,eAAe3L,OAAO,MAAMC,KAAK,QAAS,2BAA2BgD,QAAQ,SAAU,WAC9G,MAA4C,WAAxCkB,EAAK2F,IAAI5F,eAAeO,OAAOzH,MAEjCmH,EAAK2F,IAAI5F,eAAeO,OAAOpF,GAAKxC,EAAGgG,OAAOL,OACvC,GAHT,SAKCiG,GAAG,QAAS,SAAU9F,GACvBwB,EAAK0H,eAAerJ,KAAM,YACzBiG,GAAG,aAAc,WAClB,MAAOlG,GAAMuJ,cAAc9G,OAAW,YACrCyD,GAAG,aAAc,WAClB,MAAOlG,GAAMuJ,cAAc9G,OAAW,UAAU,KAGlDxC,KAAK0J,oBAAsB1J,KAAKyJ,aAAajM,OAAO,OAAOC,KAAK,QAAS,WAAW6I,KAAK,UAAUD,MAAM,SAAU,KAAOrG,KAAKF,QAAQmC,OAAOG,OAAOD,QAAU,MAE/JnC,KAAK0J,oBAAoBlM,OAAO,OAAOC,KAAK,QAAS,iCAAiCgD,QAAQ,UAAmD,WAAxCT,KAAKsH,IAAI5F,eAAeO,OAAOzH,MAAmBgD,OAAO,OAAOC,KAAK,aAAcuC,KAAKsH,IAAI4B,SAAW,WAEhNlJ,KAAK0J,oBAAoBlM,OAAO,OAAOC,KAAK,QAAS,mCAAmCgD,QAAQ,UAAmD,WAAxCT,KAAKsH,IAAI5F,eAAeO,OAAOzH,MAA8D,IAAzCwF,KAAKsH,IAAI5F,eAAeO,OAAOuH,OAAahM,OAAO,OAAOC,KAAK,aAAcuC,KAAKsH,IAAI4B,SAAW,aAEhQlJ,KAAK0J,oBAAoBlM,OAAO,OAAOC,KAAK,QAAS,oCAAoCgD,QAAQ,UAAmD,WAAxCT,KAAKsH,IAAI5F,eAAeO,OAAOzH,MAA8D,IAAzCwF,KAAKsH,IAAI5F,eAAeO,OAAOuH,OAAahM,OAAO,OAAOC,KAAK,aAAcuC,KAAKsH,IAAI4B,SAAW,cAEjQlJ,KAAK2J,WAAa3J,KAAKmJ,eAAe3L,OAAO,MAAMC,KAAK,QAAS,yBAAyBgD,QAAQ,SAAU,WAC1G,MAA4C,SAAxCkB,EAAK2F,IAAI5F,eAAeO,OAAOzH,MAEjCmH,EAAK2F,IAAI5F,eAAeO,OAAOpF,GAAKxC,EAAGgG,OAAOL,OACvC,GAHT,SAKCiG,GAAG,QAAS,SAAU9F,GACvBwB,EAAK0H,eAAerJ,KAAM,UACzBiG,GAAG,aAAc,WAClB,MAAOlG,GAAM6J,oBACZ3D,GAAG,aAAc,WAClB,MAAOlG,GAAM6J,iBAAgB,KAG/B5J,KAAK6J,kBAAoB7J,KAAK2J,WAAWnM,OAAO,OAAOC,KAAK,QAAS,WAAW6I,KAAK,QAAQD,MAAM,SAAU,KAAOrG,KAAKF,QAAQmC,OAAOG,OAAOD,QAAU,MAEzJnC,KAAK6J,kBAAkBrM,OAAO,OAAOC,KAAK,QAAS,iCAAiCgD,QAAQ,UAAmD,SAAxCT,KAAKsH,IAAI5F,eAAeO,OAAOzH,MAAiBgD,OAAO,OAAOC,KAAK,aAAcuC,KAAKsH,IAAI4B,SAAW,WAE5MlJ,KAAK6J,kBAAkBrM,OAAO,OAAOC,KAAK,QAAS,mCAAmCgD,QAAQ,UAAmD,SAAxCT,KAAKsH,IAAI5F,eAAeO,OAAOzH,MAA4D,IAAzCwF,KAAKsH,IAAI5F,eAAeO,OAAOuH,OAAahM,OAAO,OAAOC,KAAK,aAAcuC,KAAKsH,IAAI4B,SAAW,mBAE5PlJ,KAAK6J,kBAAkBrM,OAAO,OAAOC,KAAK,QAAS,oCAAoCgD,QAAQ,UAAmD,SAAxCT,KAAKsH,IAAI5F,eAAeO,OAAOzH,MAA4D,IAAzCwF,KAAKsH,IAAI5F,eAAeO,OAAOuH,OAAahM,OAAO,OAAOC,KAAK,aAAcuC,KAAKsH,IAAI4B,SAAW,oBAG7PlJ,KAAK8J,aAAe9J,KAAKmJ,eAAe3L,OAAO,MAAMC,KAAK,QAAS,uBAAuBgD,QAAQ,SAA+B,QAArBT,KAAKsH,IAAI1B,SAAmBK,GAAG,QAAS,WAClJtE,EAAKoI,cAAc/J,KAAM,SAG3BA,KAAKgK,oBAAsBhK,KAAK8J,aAAatM,OAAO,OAAOC,KAAK,QAAS,WAAW6I,KAAK,WAAWD,MAAM,SAAU,KAAOrG,KAAKF,QAAQmC,OAAOG,OAAOD,QAAU,MAEhKnC,KAAKgK,oBAAoBxM,OAAO,OAAOC,KAAK,QAAS,gBAAgBD,OAAO,OAAOC,KAAK,aAAcuC,KAAKsH,IAAI4B,SAAW,YAG1HlJ,KAAKiK,cAAgBjK,KAAKmJ,eAAe3L,OAAO,MAAMC,KAAK,QAAS,wBAAwBgD,QAAQ,SAA+B,QAArBT,KAAKsH,IAAI1B,SAAmBK,GAAG,QAAS,WACpJtE,EAAKoI,cAAc/J,KAAM,SAG3BA,KAAKkK,qBAAuBlK,KAAKiK,cAAczM,OAAO,OAAOC,KAAK,QAAS,WAAW6I,KAAK,YAAYD,MAAM,SAAU,KAAOrG,KAAKF,QAAQmC,OAAOG,OAAOD,QAAU,MAEnKnC,KAAKkK,qBAAqB1M,OAAO,OAAOC,KAAK,QAAS,iBAAiBD,OAAO,OAAOC,KAAK,aAAcuC,KAAKsH,IAAI4B,SAAW,aAE5HlJ,KAAKmK,oBAAsBnK,KAAKnD,GAAGW,OAAO,OAAOiD,QAAQ,kBAAkB,GAE3ET,KAAKoK,cAAgBpK,KAAKmK,oBAAoBtH,UAAU6F,GAAsBvI,KAAKL,EAAQ8B,OAAOkB,QAAQtF,OAAOiL,GAAmBhI,QAAQiI,GAAsB,GAAMrC,MAAM,QAASrG,KAAKF,QAAQmC,OAAOG,OAAOhG,MAAQ,MAE1N4D,KAAKoK,cAAclK,KAAK,SAAUC,EAAMC,GACtC,GAAIiK,GAAUhQ,EAAGgG,OAAOL,KAQxB2B,GAAK2F,IAAI5F,eAAe4I,MAAMlK,IAC5B5F,KAAM2F,EAAK2B,OACX0H,MAAOrJ,EAAKoK,UACZ1N,GAAI2F,QAGN6H,EAAQ7M,OAAO,MAAMC,KAAK,QAAS,sBAAsB4I,MAAM,QAAS1E,EAAK7B,QAAQmC,OAAOG,OAAOD,QAAU,MAAM8D,GAAG,QAAStE,EAAK6I,cAEpIH,EAAQ7M,OAAO,MAAMC,KAAK,QAAS,uCAAuC4I,OACxEjK,MAASuF,EAAK7B,QAAQmC,OAAOG,OAAOC,aAAe,EAAI,KACvDoI,KAAQ9I,EAAK7B,QAAQmC,OAAOG,OAAOD,QAAU,OAC5C8D,GAAG,QAAS,SAAU9F,GACvBwB,EAAK+I,WAAW1K,KAAMG,EAAKsC,MAAO,eACjCwD,GAAG,aAAc,WAClBtE,EAAK2H,cAActJ,KAAKM,WAAY,aACpCjG,EAAGgG,OAAOL,MAAMqG,MAAM,QAAS1E,EAAK7B,QAAQmC,OAAOG,OAAOC,aAAe,GAAK,QAC7E4D,GAAG,aAAc,WAClBtE,EAAK2H,cAActJ,KAAKM,WAAY,aAAa,GACjDjG,EAAGgG,OAAOL,MAAMqG,MAAM,QAAS1E,EAAK7B,QAAQmC,OAAOG,OAAOC,aAAe,EAAI,QAC5EsI,KAAK,wXAA+d,cAA9ChJ,EAAK2F,IAAI5F,eAAe4I,MAAMlK,GAAO5F,KAAuB,UAAY,IAAM,wBAA+BmH,EAAK2F,IAAI4B,SAAW,qEAA+H,cAA9CvH,EAAK2F,IAAI5F,eAAe4I,MAAMlK,GAAO5F,MAAuE,IAA/CmH,EAAK2F,IAAI5F,eAAe4I,MAAMlK,GAAOoJ,MAAc,UAAY,IAAM,wBAA+B7H,EAAK2F,IAAI4B,SAAW,wEAAkI,cAA9CvH,EAAK2F,IAAI5F,eAAe4I,MAAMlK,GAAO5F,MAAuE,IAA/CmH,EAAK2F,IAAI5F,eAAe4I,MAAMlK,GAAOoJ,MAAc,UAAY,IAAM,wBAA+B7H,EAAK2F,IAAI4B,SAAW,4BAEzkCmB,EAAQ7M,OAAO,MAAMC,KAAK,QAAS,oCAAoC4I,OACrEjK,MAASuF,EAAK7B,QAAQmC,OAAOG,OAAOC,aAAe,EAAI,KACvDoI,KAAQ9I,EAAK7B,QAAQmC,OAAOG,OAAOC,aAAe,EAAIV,EAAK7B,QAAQmC,OAAOG,OAAOD,QAAU,OAC1F8D,GAAG,QAAS,SAAU9F,GACvBwB,EAAK+I,WAAW1K,KAAMG,EAAKsC,MAAO,YACjCwD,GAAG,aAAc,WAClBtE,EAAK2H,cAActJ,KAAKM,WAAY,UACpCjG,EAAGgG,OAAOL,MAAMqG,OACdjK,MAASuF,EAAK7B,QAAQmC,OAAOG,OAAOC,aAAe,GAAK,KACxDoI,KAAQ9I,EAAK7B,QAAQmC,OAAOG,OAAOD,QAAU,GAAK,SAEnD8D,GAAG,aAAc,WAClBtE,EAAK2H,cAActJ,KAAKM,WAAY,UAAU,GAC9CjG,EAAGgG,OAAOL,MAAMqG,OACdjK,MAASuF,EAAK7B,QAAQmC,OAAOG,OAAOC,aAAe,EAAI,KACvDoI,KAAQ9I,EAAK7B,QAAQmC,OAAOG,OAAOC,aAAe,EAAIV,EAAK7B,QAAQmC,OAAOG,OAAOD,QAAU,SAE5FwI,KAAK,2RAAmX,WAA9ChJ,EAAK2F,IAAI5F,eAAe4I,MAAMlK,GAAO5F,KAAoB,UAAY,IAAM,wBAA+BmH,EAAK2F,IAAI4B,SAAW,qEAA+H,WAA9CvH,EAAK2F,IAAI5F,eAAe4I,MAAMlK,GAAO5F,MAAoE,IAA/CmH,EAAK2F,IAAI5F,eAAe4I,MAAMlK,GAAOoJ,MAAc,UAAY,IAAM,wBAA+B7H,EAAK2F,IAAI4B,SAAW,wEAAkI,WAA9CvH,EAAK2F,IAAI5F,eAAe4I,MAAMlK,GAAO5F,MAAoE,IAA/CmH,EAAK2F,IAAI5F,eAAe4I,MAAMlK,GAAOoJ,MAAc,UAAY,IAAM,wBAA+B7H,EAAK2F,IAAI4B,SAAW,4BAEp9BmB,EAAQ7M,OAAO,MAAMC,KAAK,QAAS,uBAAuB4I,MAAM,QAAS1E,EAAK7B,QAAQmC,OAAOG,OAAOD,QAAU,MAAM8D,GAAG,QAAStE,EAAKiJ,eAAeD,KAAK,6CAAoDhJ,EAAK2F,IAAI4B,SAAW,uBAE7NvH,EAAK2F,IAAI5F,eAAe4I,MAAMlK,GAAO5F,OACvCmH,EAAK2F,IAAI5F,eAAe4I,MAAMlK,GAAOvD,GAAKwN,EAAQhK,OAAO,SAAWsB,EAAK2F,IAAI5F,eAAe4I,MAAMlK,GAAO5F,SA4H/G,MAvHAqD,GAAaK,YAAY0K,IACvBhK,IAAK,eACLrE,MAAO,WACL4J,QAAQC,IAAI,oBAGdxF,IAAK,oBACLrE,MAAO,SAA2BsC,GAChC,MAAOmD,MAAKsH,IAAIQ,eAAezN,EAAGgG,OAAOxD,GAAI0D,QAAQkC,MAAO,YAG9D7D,IAAK,kBACLrE,MAAO,SAAyBsQ,GAC9B7K,KAAKsH,IAAIwD,SAASjI,UAAU,SAASpC,QAAQ,mBAAoBoK,MAGnEjM,IAAK,gBACLrE,MAAO,SAAuBsC,EAAIrC,EAAMqQ,GACtC,GAAIjJ,GAAQ/E,EAAKmD,KAAK+K,kBAAkBlO,GAAMmD,KAAKsH,IAAIwD,SAASjI,UAAU,QAE1EjB,GAAMnB,QAAQ,iBAAkBoK,GAAahI,UAAU,QAAUrI,GAAMiG,QAAQ,aAAcoK,MAG/FjM,IAAK,iBACLrE,MAAO,SAAwBsC,EAAIrC,GACjC,GAAI0M,IAAc,CAEdlH,MAAKsH,IAAI5F,eAAeO,OAAOzH,OAASA,IAC1C0M,GAAc,EAGVlH,KAAKsH,IAAI5F,eAAeO,OAAOpF,IACjCmD,KAAKgL,YAAYhL,KAAKsH,IAAI5F,eAAeO,OAAOpF,KAIpDmD,KAAKsH,IAAI5F,eAAeO,OAAOpF,GAAKxC,EAAGgG,OAAOxD,GAC9CmD,KAAKsH,IAAI5F,eAAeO,OAAOpF,GAAG4D,QAAQ,UAAU,GACpDT,KAAKsH,IAAI5F,eAAeO,OAAOzH,KAAOA,CAGtC,KAAK,GADDyQ,GAAavM,OAAOwM,KAAKlL,KAAKsH,IAAI5F,eAAe4I,OAC5C1P,EAAI,EAAGuQ,EAAMF,EAAWpQ,OAAYsQ,EAAJvQ,EAASA,IAChDoF,KAAK0K,WAAW7N,EAAIoO,EAAWrQ,GAAIJ,GAAM,MAI7CoE,IAAK,aACLrE,MAAO,SAAoBsC,EAAIuD,EAAO5F,EAAMyH,GAErCA,IACHjC,KAAKsH,IAAI5F,eAAeO,OAAOzH,KAAOgI,OACtCxC,KAAKgL,YAAYhL,KAAKsH,IAAI5F,eAAeO,OAAOpF,IAGlD,IAAIqK,IAAc,CAEdlH,MAAKsH,IAAI5F,eAAe4I,MAAMlK,GAAOvD,IACnCmD,KAAKsH,IAAI5F,eAAe4I,MAAMlK,GAAO5F,OAASA,GAChDwF,KAAKgL,YAAYhL,KAAKsH,IAAI5F,eAAe4I,MAAMlK,GAAOvD,IAItDmD,KAAKsH,IAAI5F,eAAe4I,MAAMlK,GAAO5F,OAASA,IAChD0M,GAAc,EAEdlH,KAAKsH,IAAI5F,eAAe4I,MAAMlK,GAAOoJ,MAAQ,GAG/CxJ,KAAKsH,IAAI5F,eAAe4I,MAAMlK,GAAOvD,GAAKxC,EAAGgG,OAAOxD,GACpDmD,KAAKsH,IAAI5F,eAAe4I,MAAMlK,GAAO5F,KAAOA,EAGO,KAA/CwF,KAAKsH,IAAI5F,eAAe4I,MAAMlK,GAAOoJ,OACvCxJ,KAAKsH,IAAI5F,eAAe4I,MAAMlK,GAAOoJ,MAAQ,EAC7CxJ,KAAKsH,IAAI5F,eAAe4I,MAAMlK,GAAOvD,GAAGwD,OAAO,mBAAmBI,QAAQ,WAAW,GACrFT,KAAKsH,IAAI5F,eAAe4I,MAAMlK,GAAOvD,GAAGwD,OAAO,kBAAkBI,QAAQ,WAAW,KAEpFT,KAAKsH,IAAI5F,eAAe4I,MAAMlK,GAAOoJ,MAAQ,GAC7CxJ,KAAKsH,IAAI5F,eAAe4I,MAAMlK,GAAOvD,GAAGwD,OAAO,kBAAkBI,QAAQ,WAAW,GACpFT,KAAKsH,IAAI5F,eAAe4I,MAAMlK,GAAOvD,GAAGwD,OAAO,mBAAmBI,QAAQ,WAAW,IAGvFT,KAAKsH,IAAI5F,eAAe4I,MAAMlK,GAAOvD,GAAGwD,OAAO,gBAAgBI,QAAQ,WAAW,GAElFT,KAAKsH,IAAIoD,WAAWtK,EAAO5F,EAAMwF,KAAKsH,IAAI5F,eAAe4I,MAAMlK,GAAOoJ,MAAOtC,MAG/EtI,IAAK,cACLrE,MAAO,SAAqBsC,GAC1BA,EAAG4D,QAAQ,UAAU,GACrB5D,EAAGwD,OAAO,mBAAmBI,QAAQ,WAAW,GAChD5D,EAAGwD,OAAO,kBAAkBI,QAAQ,WAAW,GAC/C5D,EAAGwD,OAAO,gBAAgBI,QAAQ,WAAW,MAG/C7B,IAAK,gBACLrE,MAAO,WACL4J,QAAQC,IAAI,qBAGdxF,IAAK,SACLrE,MAAO,WACLyF,KAAKnD,GAAG4D,QAAQ,WAAYT,KAAKnD,GAAG4D,QAAQ,eAG9C7B,IAAK,gBACLrE,MAAO,SAAuBsC,EAAIqG,GAC5BlD,KAAKsH,IAAI1F,MAAMgE,UAAY1C,IAChB,QAATA,GACFlD,KAAK8J,aAAarJ,QAAQ,UAAU,GACpCT,KAAKiK,cAAcxJ,QAAQ,UAAU,KAErCT,KAAK8J,aAAarJ,QAAQ,UAAU,GACpCT,KAAKiK,cAAcxJ,QAAQ,UAAU,IAEvCT,KAAKsH,IAAIyC,cAAc7G,QAItB0F,KAwDLwC,EAAkB,SAAWC,GAG/B,QAASD,GAAgBE,GACvBzN,EAAaC,eAAekC,KAAMoL,EAElC,IAAIrL,GAAQlC,EAAa0B,0BAA0BS,KAAMtB,OAAO6M,eAAeH,GAAiB3L,KAAKO,KAAMsL,GAK3G,OAHAvL,GAAM/C,KAAO+C,EAAMX,YAAYpC,KAC/B+C,EAAMuL,QAAUA,EAChBE,MAAMC,kBAAkB1L,EAAOA,EAAMX,YAAYpC,MAC1C+C,EAGT,MAbAlC,GAAamB,SAASoM,EAAiBC,GAahCD,GACNI,OAECE,EAAqB,SAAWC,GAGlC,QAASD,GAAmBJ,GAE1B,MADAzN,GAAaC,eAAekC,KAAM0L,GAC3B7N,EAAa0B,0BAA0BS,KAAMtB,OAAO6M,eAAeG,GAAoBjM,KAAKO,KAAMsL,GAAW,oDAGtH,MAPAzN,GAAamB,SAAS0M,EAAoBC,GAOnCD,GACNN,GAECQ,EAA4B,SAAWC,GAGzC,QAASD,GAA0BN,GAEjC,MADAzN,GAAaC,eAAekC,KAAM4L,GAC3B/N,EAAa0B,0BAA0BS,KAAMtB,OAAO6M,eAAeK,GAA2BnM,KAAKO,KAAMsL,GAAW,uCAG7H,MAPAzN,GAAamB,SAAS4M,EAA2BC,GAO1CD,GACNR,GAECU,EAAS,WACX,QAASA,GAAOjP,EAAI0J,GAGlB,GAFA1I,EAAaC,eAAekC,KAAM8L,GAE9BvF,GAAkC,kBAAdA,GACtB,KAAM,IAAIqF,EAGZ5L,MAAKnD,GAAKA,EACVmD,KAAK+L,SAAWxF,EAAYA,EAAYvG,KAAKgM,eAgB/C,MAbAnO,GAAaK,YAAY4N,IACvBlN,IAAK,iBACLrE,MAAO,SAAwB0R,EAAW9L,GACxC,GAAI+L,GAAQC,SAASC,YAAY,cACjCF,GAAMG,gBAAgBJ,GAAW,GAAO,EAAO9L,GAC/CH,KAAKnD,GAAGyP,cAAcJ,MAGxBtN,IAAK,YACLrE,MAAO,SAAmB2R,EAAO/L,GAC/BH,KAAK+L,SAASG,EAAO/L,OAGlB2L,KAGL3R,EAAY,WACd,QAASA,GAAUoS,EAAQpM,EAAMqM,EAAWC,GAC1C,GAAI1M,GAAQC,IAIZ,IAFAnC,EAAaC,eAAekC,KAAM7F,IAE7BE,EAAGmK,OAAOkI,UACb,KAAM,IAAIhB,EAGPpR,GAASmS,KACZA,KAGF,IAAI9K,GAAO3B,IAEXA,MAAKuM,OAASA,EACdvM,KAAK8K,SAAWzQ,EAAGgG,OAAOkM,GAC1BvM,KAAK2M,SAAWvS,EAAEmS,GAClBvM,KAAK4M,MAAQ5M,KAAK8K,SAASzK,OAAO,YAE9BL,KAAK4M,MAAM/D,SACb7I,KAAK4M,MAAQ5M,KAAK8K,SAAStN,OAAO,OAAOC,KAAK,QAAS,QACvDuC,KAAK6M,MAAQzS,EAAE4F,KAAK4M,MAAM,KAE1B5M,KAAK6M,MAAQzS,EAAE4F,KAAK4M,MAAM,IAG5B5M,KAAKwM,UAAYA,EAEjBxM,KAAK5D,MAAQqQ,EAAQrQ,OAAS4D,KAAK6M,MAAMzQ,QACzC4D,KAAK3D,OAASoQ,EAAQpQ,QAAU2D,KAAK6M,MAAMxQ,SAC3C2D,KAAKuH,eAAiBkF,EAAQlF,gBAAkB5G,EAChDX,KAAK8M,QAAUL,EAAQK,SAAWlM,EAClCZ,KAAKgG,KAAOyG,EAAQzG,MAAQnF,EAC5Bb,KAAKkJ,SAAWuD,EAAQvD,UAAYpI,EAEpCd,KAAK8B,OAAS2K,EAAQ3K,OACtB9B,KAAKuK,UAAYkC,EAAQlC,WAAaxJ,EAEtCf,KAAK2F,OAAS,GAAImG,GAAO9L,KAAKuM,OAAQE,EAAQM,YAE9C/M,KAAK2M,SAASvQ,MAAM4D,KAAK5D,OAAO4Q,SAAStM,GAEzCV,KAAKwE,OAAS,GAAInK,GAAGmK,OAAOkI,WAAW1M,KAAK5D,MAAO4D,KAAK3D,SAAU2D,KAAK8M,QAAS9M,KAAKgG,OAErFhG,KAAKG,KAAOA,EACZH,KAAKF,QAAUE,KAAKwE,OAAOyI,QAAQjN,KAAKG,KAAMH,KAAKwM,WACjD1K,OAAQ9B,KAAK8B,OACbyI,UAAWvK,KAAKuK,YAQlBvK,KAAK0B,gBACHO,QACEzH,KAAMwF,KAAK8B,OACX0H,MAAOxJ,KAAKuK,WAEdD,UAGF1N,EAAoBoD,KAAK4M,OACvBjP,MAAOuD,EACPxD,OAAQ,EACRE,QAAS,GACT1B,EAAG,EACHC,EAAG,IAEH+Q,mBAAoB,EACpBvP,MAAOuD,EACPxD,OAAQ,GACRE,QAAS,EACT1B,EAAG,EACHC,EAAG,GACF,cAAe,EAAG,IAErBS,EAAoBoD,KAAK4M,OACvBO,oBAAqB,EACrBxP,MAAOwD,EACPzD,OAAQ,EACRE,QAAS,EACT1B,EAAG,EACHC,EAAG,IAEHwB,MAAOwD,EACPzD,OAAQ,IACRE,QAAS,GACT1B,EAAG,EACHC,EAAG,GACF,gBAAiB,IAAM,IAE1B6D,KAAK4F,QAAU6G,EAAQ7G,SAAW5E,EAClChB,KAAK4M,MAAMnM,QAAQT,KAAK4F,QAAU,QAAQ,GAE1C5F,KAAKoN,OAAS,GAAIxE,GAAO5I,KAAMA,KAAK8K,SAAU9K,KAAKF,SAEnDE,KAAK4M,MAAMnP,KAAK,UAAW,OAASuC,KAAK5D,MAAQ,IAAM4D,KAAK3D,QAE5D2D,KAAKqN,UAAYrN,KAAK4M,MAAMpP,OAAO,KAEnCwC,KAAK8M,QAAU,GAAIzF,GAAQrH,KAAKqN,UAAWrN,KAAKF,SAEhDE,KAAK0E,MAAQ,GAAIH,GAAMvE,KAAK8M,QAAQrI,OAAQzE,KAAKF,QAASE,KAAKwE,QAC/DxE,KAAK4B,MAAQ,GAAI8D,GAAM1F,KAAK8M,QAAQrI,OAAQzE,KAAKF,QAASE,KAAK0E,MAAO1E,KAAK2F,OAAQ8G,EAAQ7G,SAAW5E,GACtGhB,KAAK8M,QAAQQ,kBAAkBtN,KAAMA,KAAKuH,gBAC1CvH,KAAKuN,WAAa,GAAI3N,GAAWI,KAAK8M,QAAQrI,OAAQzE,KAAKF,QAASE,KAAKuH,gBAGzEvH,KAAKwN,QAAUpT,EAAE4F,KAAK8M,QAAQrI,OAAO,IAAIwB,GAAG,aAAc,SAAUiG,GAClEvK,EAAK8L,iBAAiBzN,KAAMkM,KAM9BlM,KAAKuN,WAAWtN,UAAUgG,GAAG,YAAa,WACxCtE,EAAK+L,mBAAmB1N,KAAM3F,EAAG6R,SAMnC7R,EAAGgG,OAAO8L,UAAUlG,GAAG,UAAW,WAChClG,EAAM4N,cAActT,EAAG6R,SACtBjG,GAAG,YAAa,WACjBlG,EAAM6N,gBAAgBvT,EAAG6R,SAgH7B,MA5GArO,GAAaK,YAAY/D,IACvByE,IAAK,gBACLrE,MAAO,SAAuB2R,GAC5B,GAAIlM,KAAK6N,gBAAiB,CACxB,GAAI1N,GAAOH,KAAK6N,gBAAgBtN,QAC5BuN,EAAS3N,EAAKK,UAAUuN,QAAU7B,EAAM6B,OAI5C5N,GAAKK,UAAUwH,UAAY3E,KAAKC,IAAID,KAAKsE,IAAIxH,EAAKK,UAAUwH,UAAY8F,EAAQ,GAAI3N,EAAKK,UAAUiH,cAGnGtH,EAAK6H,UAAY3E,KAAKsE,IAAItE,KAAKC,IAAInD,EAAK6H,UAAY7H,EAAKkI,oBAAoByF,GAAS,IAAK3N,EAAKsH,cAEhGzH,KAAK6N,gBAAgBpN,QAAQ,UAAU,GAEvCT,KAAK6N,gBAAkBrL,WAI3B5D,IAAK,kBACLrE,MAAO,SAAyB2R,GAC9B,GAAIlM,KAAK6N,gBAAiB,CACxB,GAAI1N,GAAOH,KAAK6N,gBAAgBtN,QAC5BuN,EAAS3N,EAAKK,UAAUuN,QAAU7B,EAAM6B,OAG5C5T,GAAU6T,QAAQhO,KAAK6N,gBAAgB5S,OAAQoI,KAAKC,IAAID,KAAKsE,IAAIxH,EAAKK,UAAUwH,UAAY8F,EAAQ,GAAI3N,EAAKK,UAAUiH,cAGvH,IAAIwG,GAAmB5K,KAAKsE,IAAItE,KAAKC,IAAInD,EAAK6H,UAAY7H,EAAKkI,oBAAoByF,GAAS,IAAK3N,EAAKsH,aAEtGtN,GAAU6T,QAAQ7N,EAAKyB,MAAOqM,GAG9BjO,KAAK0E,MAAMwJ,OAAO/N,EAAKyH,eAAeG,SAAU/H,KAAKwE,OAAO2J,YAAYhO,EAAKsC,MAAOwL,EAAkB,WAEtGjO,KAAK0E,MAAMwJ,OAAO/N,EAAKyH,eAAeC,SAAU7H,KAAKwE,OAAO2J,YAAYhO,EAAKsC,MAAQ,EAAGwL,EAAkB,eAI9GrP,IAAK,qBACLrE,MAAO,SAA4BsC,EAAIqP,GACrClM,KAAK6N,gBAAkBxT,EAAGgG,OAAOxD,GAAI4D,QAAQ,UAAU,GACvDT,KAAK6N,gBAAgBtN,QAAQC,UAAUuN,QAAU7B,EAAM6B,WAGzDnP,IAAK,mBACLrE,MAAO,SAA0BsC,EAAIqP,GACnCA,EAAMkC,gBAEN,IAAIjO,GAAO9F,EAAGgG,OAAOxD,GAAI0D,OAErBJ,GAAKsH,aAAe,IAEtBtH,EAAK6H,UAAY3E,KAAKsE,IAAItE,KAAKC,IAAInD,EAAK6H,UAAYkE,EAAM4B,OAAQ,IAAK3N,EAAKsH,cAE5EtN,EAAU6T,QAAQ7N,EAAKyB,MAAOzB,EAAK6H,WAGnC7H,EAAKK,UAAUwH,UAAY7H,EAAKK,UAAUyH,aAAa9H,EAAK6H,WAE5D7N,EAAU6T,QAAQ7N,EAAKK,UAAU3D,GAAIsD,EAAKK,UAAUwH,WAGpDhI,KAAK0E,MAAMwJ,OAAO/N,EAAKyH,eAAeG,SAAU/H,KAAKwE,OAAO2J,YAAYhO,EAAKsC,MAAOtC,EAAK6H,UAAW,WAEpGhI,KAAK0E,MAAMwJ,OAAO/N,EAAKyH,eAAeC,SAAU7H,KAAKwE,OAAO2J,YAAYhO,EAAKsC,MAAQ,EAAGtC,EAAK6H,UAAW,eAI5GpJ,IAAK,iBACLrE,MAAO,SAAwB6F,EAAOiO,GACpC,MAAOhU,GAAGgG,OAAOL,KAAK8M,QAAQrI,OAAO,GAAGrE,IAAQyC,UAAUwL,MAG5DzP,IAAK,aACLrE,MAAO,SAAoBkI,EAAO6L,EAAU/D,EAAWrD,GACrDlH,KAAK4B,MAAM2M,KAAKvO,KAAKwE,OAAO+J,KAAK9L,EAAO6L,EAAU/D,GAAW3I,MAAMa,GAAQyE,GAC3ElH,KAAK0E,MAAM6J,KAAKvO,KAAKwE,OAAOE,MAAMjC,EAAQ,EAAGA,EAAQ,OAGvD7D,IAAK,gBACLrE,MAAO,SAAuB2I,GAC5BlD,KAAK4M,MAAMnM,QAAQ,UAAoB,QAATyC,GAC9BlD,KAAK4M,MAAMnM,QAAQ,UAAoB,QAATyC,GAC9BlD,KAAK4B,MAAM8B,KAAK8K,WAAWtL,EAAMlD,KAAK0B,mBAGxC9C,IAAK,UACLqG,IAAK,WACH,MAAIjF,MAAK0D,KACA1D,KAAK4B,MAAM8B,KAAKR,KAElBlD,KAAKyO,UAEdC,IAAK,SAAaxL,GACZlD,KAAK0D,OACP1D,KAAK4B,MAAM8B,KAAKR,KAAOA,GAEzBlD,KAAKyO,SAAWvL,OAGlBtE,IAAK,UACLrE,MAAO,SAAiBsC,EAAIa,GAC1BrD,EAAGgG,OAAOxD,GAAIY,KAAK,YAAa,gBAAkBC,EAAS,SAGxDvD,IAGT,OAAOA,IAENC,EAAEC","file":"listGraph.min.js","sourcesContent":["/* Copyright Fritz Lekschas: D3 example visualization app using list-based graphs */\nvar ListGraph = (function ($,d3) { 'use strict';\n\n  var babelHelpers = {};\n\n  babelHelpers.classCallCheck = function (instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  };\n\n  babelHelpers.createClass = (function () {\n    function defineProperties(target, props) {\n      for (var i = 0; i < props.length; i++) {\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n      }\n    }\n\n    return function (Constructor, protoProps, staticProps) {\n      if (protoProps) defineProperties(Constructor.prototype, protoProps);\n      if (staticProps) defineProperties(Constructor, staticProps);\n      return Constructor;\n    };\n  })();\n\n  babelHelpers.inherits = function (subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n  };\n\n  babelHelpers.possibleConstructorReturn = function (self, call) {\n    if (!self) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n  };\n\n  babelHelpers;\n  /**\n   * Checks if `value` is the [language type](https://es5.github.io/#x8) of `Object`.\n   * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n   * @example\n   *\n   * _.isObject({});\n   * // => true\n   *\n   * _.isObject([1, 2, 3]);\n   * // => true\n   *\n   * _.isObject(1);\n   * // => false\n   */\n  function isObject(value) {\n    // Avoid a V8 JIT bug in Chrome 19-20.\n    // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.\n    var type = typeof value;\n    return !!value && (type == 'object' || type == 'function');\n  }\n\n  var SCROLLBAR_CLASS = 'scrollbar';\n\n  var Scrollbars = function Scrollbars(baseSelection, visData, width) {\n    var _this = this;\n\n    babelHelpers.classCallCheck(this, Scrollbars);\n\n    this.visData = visData;\n    this.width = width;\n\n    // Add empty scrollbar element\n    this.selection = baseSelection.append('rect').attr('class', SCROLLBAR_CLASS).call(function (selection) {\n      selection.each(function (data, index) {\n        d3.select(this.parentNode).datum().scrollbar.el = this;\n      });\n    }).attr('x', function (data) {\n      return data.scrollbar.x;\n    }).attr('y', function (data) {\n      return data.scrollbar.y;\n    }).attr('width', function (data) {\n      return _this.width;\n    }).attr('height', function (data) {\n      return data.scrollbar.height;\n    }).attr('rx', this.width / 2).attr('ry', this.width / 2).classed('ready', true);\n  };\n\n  var CLASSNAME = 'list-graph';\n\n  var SCROLLBAR_WIDTH = 6;\n  var COLUMNS = 5;\n  var ROWS = 5;\n\n  // An empty path is equal to inline SVG.\n  var ICON_PATH = '';\n\n  var DEFAULT_SORT_ORDER = 'desc';\n\n  var DEFAULT_BAR_MODE = 'one';\n\n  var TRANSITION_SEMI_FAST = 250;\n  // Gradient colors\n  var COLOR_NEGATIVE_RED = '#e0001c';\n  var COLOR_POSITIVE_GREEN = '#60bf00';\n\n  function arrayToFakeObjs(arrayIds) {\n    var fakeObjs = [];\n\n    for (var i = arrayIds.length; i--;) {\n      fakeObjs.push({ id: arrayIds[i] });\n    }\n\n    return fakeObjs;\n  }\n\n  /**\n   * Collect all cloned nodes, including the original node.\n   *\n   * @method  collectInclClones\n   * @author  Fritz Lekschas\n   * @date    2015-12-30\n   * @param   {Object}  node  Start node\n   * @return  {Array}         Array of original and cloned nodes.\n   */\n  function collectInclClones(node) {\n    var originalNode = node;\n\n    if (node.clone) {\n      originalNode = node.originalNode;\n    }\n\n    var clones = [originalNode];\n\n    if (originalNode.clones.length) {\n      clones = clones.concat(originalNode.clones);\n    }\n\n    return clones;\n  }\n\n  function up(node, callback, child) {\n    var nodesInclClones = collectInclClones(node);\n\n    for (var i = nodesInclClones.length; i--;) {\n      if (child) {\n        callback(nodesInclClones[i], child);\n      }\n\n      for (var j = nodesInclClones[i].parent.length; j--;) {\n        up(nodesInclClones[i].parent[j], callback, nodesInclClones[i]);\n      }\n    }\n  }\n\n  function down(node, callback) {\n    var nodesInclClones = collectInclClones(node);\n\n    for (var i = nodesInclClones.length; i--;) {\n      callback(nodesInclClones[i]);\n\n      for (var j = nodesInclClones[i].childRefs.length; j--;) {\n        down(nodesInclClones[i].childRefs[j], callback);\n      }\n    }\n  }\n\n  function upAndDown(node, callbackUp, callbackDown) {\n    if (callbackDown) {\n      up(node, callbackUp);\n      down(node, callbackDown);\n    } else {\n      up(node, callbackUp);\n      down(node, callbackUp);\n    }\n  }\n\n  function roundRect(x, y, width, height, radius) {\n    var topLeft = 0;\n    var topRight = 0;\n    var bottomLeft = 0;\n    var bottomRight = 0;\n\n    try {\n      topLeft = radius.topLeft || 0;\n      topRight = radius.topRight || 0;\n      bottomLeft = radius.bottomLeft || 0;\n      bottomRight = radius.bottomRight || 0;\n    } catch (e) {}\n\n    return 'M' + (x + topLeft) + ',' + y + 'h' + (width - topLeft - topRight) + 'a' + topRight + ',' + topRight + ' 0 0 1 ' + topRight + ',' + topRight + 'v' + (height - (topRight + bottomRight)) + 'a' + bottomRight + ',' + bottomRight + ' 0 0 1 ' + -bottomRight + ',' + bottomRight + 'h' + (bottomLeft - (width - bottomRight)) + 'a' + bottomLeft + ',' + bottomLeft + ' 0 0 1 ' + -bottomLeft + ',' + -bottomLeft + 'v' + (topLeft - (height - bottomLeft)) + 'a' + topLeft + ',' + topLeft + ' 0 0 1 ' + topLeft + ',' + -topLeft + 'z';\n  }\n\n  var BAR_CLASS = 'bar';\n\n  var Bar = (function () {\n    function Bar(selection, barData, nodeData, visData, barCollection) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Bar);\n\n      var that = this;\n\n      this.data = barData;\n      this.nodeData = nodeData;\n      this.visData = visData;\n      this.barCollection = barCollection;\n\n      this.data.x = nodeData.x;\n      this.data.level = nodeData.depth;\n\n      this.height = this.visData.global.row.contentHeight / (this.data.length * 2) - this.visData.global.cell.padding * 2;\n\n      this.activeHeight = this.visData.global.row.contentHeight - 2;\n\n      this.inactiveheight = this.visData.global.cell.padding * 2 - 1;\n\n      this.selection = selection.selectAll(BAR_CLASS).data(this.data).enter().append('g').attr('class', function (data) {\n        return BAR_CLASS + ' ' + data.id;\n      }).classed('active', function (data) {\n        return data.id === _this.visData.nodes[_this.nodeData.depth].sortBy;\n      });\n\n      // Local helper method to avoid code duplication.\n      // Calling a class method from within the consructor is possible but `this`\n      // is not available. Thus, we need to create local function and pass in\n      // `this` as `that`, which feels very hacky but it works.\n      function setupMagnitude(selection) {\n        var currentSorting = that.visData.nodes[that.nodeData.depth].sortBy;\n\n        selection.attr('d', function (data) {\n          return Bar.generatePath(data, currentSorting, that.visData);\n        }).classed('bar-magnitude', true);\n      }\n\n      function setupBorder(selection) {\n        selection.attr('x', 0).attr('y', that.visData.global.row.padding).attr('width', that.visData.global.column.contentWidth).attr('height', that.visData.global.row.contentHeight).attr('rx', 2).attr('ry', 2).classed('bar-border', true);\n      }\n\n      function setupIndicator(selection) {\n        selection.attr('d', function (data) {\n          return Bar.generatePath(data, undefined, that.visData, data.value);\n        }).classed('bar-indicator', true);\n      }\n\n      this.selection.append('rect').call(setupBorder);\n\n      this.selection.append('path').call(setupMagnitude);\n\n      this.selection.append('path').call(setupIndicator);\n    }\n\n    babelHelpers.createClass(Bar, null, [{\n      key: 'generatePath',\n      value: function generatePath(data, currentSorting, visData, indicator, adjustWidth, bottom) {\n        if (this.barCollection.mode === 'two') {\n          return this.generateTwoBarsPath(data, visData, bottom);\n        } else {\n          return this.generateOneBarPath(data, currentSorting, visData, indicator, adjustWidth);\n        }\n      }\n    }, {\n      key: 'generateOneBarPath',\n      value: function generateOneBarPath(data, currentSorting, visData, indicator, adjustWidth) {\n        var x = 0;\n\n        var width = 2;\n\n        var height = visData.global.row.contentHeight;\n\n        var radius = {\n          topLeft: 2,\n          bottomLeft: 2\n        };\n\n        if (indicator) {\n          radius = {};\n        }\n\n        if (data.id !== currentSorting && typeof indicator === 'undefined') {\n          x = data.value * visData.global.column.contentWidth - 3;\n          radius = {};\n        } else if (indicator) {\n          x = indicator * visData.global.column.contentWidth;\n          if (adjustWidth) {\n            if (data.value < indicator) {\n              x = data.value * visData.global.column.contentWidth;\n            }\n            width = Math.min(Math.abs(indicator - data.value), 2) * visData.global.column.contentWidth;\n          }\n        } else {\n          width = visData.global.column.contentWidth * data.value;\n        }\n\n        return roundRect(x, visData.global.row.padding, width, height, radius);\n      }\n    }, {\n      key: 'generateTwoBarsPath',\n      value: function generateTwoBarsPath(data, visData, bottom) {\n        var height = visData.global.row.contentHeight / 2;\n\n        var width = visData.global.column.contentWidth * data.value;\n\n        var y = visData.global.row.padding;\n\n        var radius = { topLeft: 2 };\n\n        if (bottom) {\n          radius = { bottomLeft: 2 };\n          y += height;\n        }\n\n        return roundRect(0, y, width, height, radius);\n      }\n    }]);\n    return Bar;\n  })();\n\n  var BARS_CLASS = 'bars';\n\n  var Bars = (function () {\n    function Bars(selection, mode, visData) {\n      babelHelpers.classCallCheck(this, Bars);\n\n      var that = this;\n\n      this.mode = mode;\n      this.visData = visData;\n\n      this.selection = selection.append('g').attr('class', BARS_CLASS);\n\n      this.selection.each(function (datum) {\n        new Bar(d3.select(this), datum.data.bars, datum, that.visData, that);\n      });\n    }\n\n    babelHelpers.createClass(Bars, [{\n      key: 'update',\n      value: function update(selection, sortBy) {\n        var _this = this;\n\n        selection.each(function () {\n          var el = d3.select(this);\n\n          if (el.classed('active')) {\n            el.classed('active', false);\n          } else {\n            el.classed('active', true);\n            // Ensure that the active bars we are places before any other bar,\n            // thus placing them in the background\n            this.parentNode.insertBefore(this, d3.select(this.parentNode).select('.bar').node());\n          }\n        });\n\n        selection.selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n          return Bar.generatePath(data, sortBy, _this.visData);\n        });\n      }\n    }, {\n      key: 'updateIndicator',\n      value: function updateIndicator(refBars, currentBar, referenceValue) {\n        var _this2 = this;\n\n        currentBar.transition().duration(0).attr('d', function (data) {\n          return Bar.generatePath(data, undefined, _this2.visData);\n        });\n\n        refBars.attr('d', function (data) {\n          return Bar.generatePath(data, undefined, _this2.visData, referenceValue);\n        }).classed('positive', function (data) {\n          return data.value >= referenceValue;\n        });\n\n        refBars.transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n          return Bar.generatePath(data, undefined, _this2.visData, referenceValue, true);\n        });\n      }\n    }, {\n      key: 'switchMode',\n      value: function switchMode(mode, currentSorting) {\n        var _this3 = this;\n\n        if (this.mode !== mode) {\n          if (mode === 'one') {\n            if (currentSorting.global.type) {\n              this.selection.selectAll('.bar').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n                return Bar.generateOneBarPath(data, currentSorting.global.type, _this3.visData);\n              });\n              console.log('bratzen');\n            } else {\n              console.log('kacken');\n            }\n          }\n\n          if (mode === 'two') {\n            this.selection.selectAll('.bar.precision').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n              return Bar.generateTwoBarsPath(data, _this3.visData);\n            });\n\n            this.selection.selectAll('.bar.recall').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n              return Bar.generateTwoBarsPath(data, _this3.visData, true);\n            });\n          }\n\n          this.mode = mode;\n        }\n      }\n    }]);\n    return Bars;\n  })();\n\n  var LINKS_CLASS = 'links';\n  var LINK_CLASS = 'link';\n\n  var Links = (function () {\n    function Links(selection, visData, layout) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Links);\n\n      this.visData = visData;\n      this.layout = layout;\n\n      this.groups = selection.append('g').attr('class', LINKS_CLASS).call(function (selection) {\n        selection.each(function (data, index) {\n          d3.select(this.parentNode).datum().links = this;\n        });\n      });\n\n      this.links = this.groups.selectAll(LINK_CLASS).data(function (data, index) {\n        return _this.layout.links(index);\n      }).enter().append('path').attr('class', 'link').attr('d', this.diagonal);\n    }\n\n    babelHelpers.createClass(Links, [{\n      key: 'highlight',\n      value: function highlight(nodeIds, _highlight) {\n        this.links.data(nodeIds, function (data) {\n          return data.id;\n        }).classed('highlight', _highlight === false ? false : true);\n      }\n    }, {\n      key: 'scroll',\n      value: function scroll(selection, data) {\n        selection.data(data).attr('d', this.diagonal).exit().remove();\n      }\n    }, {\n      key: 'sort',\n      value: function sort(update) {\n        var start = function start() {\n          d3.select(this).classed('sorting', true);\n        };\n        var end = function end() {\n          d3.select(this).classed('sorting', false);\n        };\n\n        this.links.data(update, function (data) {\n          return data.id;\n        }).transition().duration(TRANSITION_SEMI_FAST).attr('d', this.diagonal).each('start', start).each('end', end);\n      }\n    }, {\n      key: 'diagonal',\n      get: function get() {\n        var _this2 = this;\n\n        return d3.svg.diagonal().source(function (data) {\n          return {\n            x: data.source.node.y + data.source.offsetY + _this2.visData.global.row.height / 2,\n            y: data.source.node.x + data.source.offsetX + _this2.visData.global.column.contentWidth + _this2.visData.global.column.padding\n          };\n        }).target(function (data) {\n          return {\n            x: data.target.node.y + data.target.offsetY + _this2.visData.global.row.height / 2,\n            y: data.target.node.x + data.target.offsetX + _this2.visData.global.column.padding\n          };\n        }).projection(function (data) {\n          return [data.y, data.x];\n        });\n      }\n    }]);\n    return Links;\n  })();\n\n  var NODES_CLASS = 'nodes';\n  var NODE_CLASS = 'node';\n  var CLONE_CLASS = 'clone';\n\n  var Nodes = (function () {\n    function Nodes(baseSelection, visData, links, events, barMode) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Nodes);\n\n      var that = this;\n\n      // Helper\n      function drawFullSizeRect(selection, className, shrinking) {\n        if (!shrinking) {\n          shrinking = 0;\n        }\n\n        selection.attr('x', function (data) {\n          return shrinking;\n        }).attr('y', function (data) {\n          return that.visData.global.row.padding + shrinking;\n        }).attr('width', that.visData.global.column.contentWidth - 2 * shrinking).attr('height', that.visData.global.row.contentHeight - 2 * shrinking).attr('rx', 2 - shrinking).attr('ry', 2 - shrinking).classed(className, true);\n      }\n\n      this.visData = visData;\n      this.links = links;\n      this.events = events;\n\n      this.groups = baseSelection.append('g').attr('class', NODES_CLASS).call(function (selection) {\n        selection.each(function (data, index) {\n          d3.select(this.parentNode).datum().nodes = this;\n        });\n      });\n\n      this.nodes = this.groups.selectAll('.' + NODE_CLASS).data(function (data) {\n        return data.rows;\n      }).enter().append('g').classed(NODE_CLASS, true).classed(CLONE_CLASS, function (data) {\n        return data.clone;\n      }).attr('transform', function (data) {\n        return 'translate(' + (data.x + _this.visData.global.column.padding) + ', ' + data.y + ')';\n      });\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'bg', 1);\n\n      this.nodes.on('click', function (data) {\n        that.mouseClick(this, data);\n      });\n\n      this.nodes.on('mouseenter', function (data) {\n        that.mouseEnter(this, data);\n      });\n\n      this.nodes.on('mouseleave', function (data) {\n        that.mouseLeave(this, data);\n      });\n\n      this.bars = new Bars(this.nodes, barMode, this.visData);\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'border');\n\n      // Add node label\n      this.nodes.call(function (selection) {\n        selection.append('foreignObject').attr('x', function (data) {\n          return _this.visData.global.cell.padding;\n        }).attr('y', function (data) {\n          return _this.visData.global.row.padding + _this.visData.global.cell.padding;\n        }).attr('width', _this.visData.global.column.contentWidth).attr('height', _this.visData.global.row.contentHeight - _this.visData.global.cell.padding * 2).attr('class', 'label-wrapper').append('xhtml:div').attr('class', 'label').attr('title', function (data) {\n          return data.data.name;\n        }).style('line-height', _this.visData.global.row.contentHeight - _this.visData.global.cell.padding * 2 + 'px').append('xhtml:span').text(function (data) {\n          return data.data.name;\n        });\n      });\n    }\n\n    babelHelpers.createClass(Nodes, [{\n      key: 'mouseClick',\n      value: function mouseClick(el, data) {\n        this.events.broadcast('d3ListGraphNodeClick', { id: data.id });\n      }\n    }, {\n      key: 'mouseEnter',\n      value: function mouseEnter(el, data) {\n        var _this2 = this;\n\n        var that = this;\n        var currentNodeData = data;\n\n        // Store link IDs\n        this.currentlyHighlightedLinks = [];\n\n        var currentActiveProperty = d3.select(el).selectAll('.bar.active .bar-magnitude').datum();\n\n        var traverseCallbackUp = function traverseCallbackUp(data, childData) {\n          data.hovering = 2;\n          for (var i = data.links.length; i--;) {\n            // Only push direct parent child connections. E.g.\n            // Store: (parent)->(child)\n            // Ignore: (parent)->(siblings of child)\n            if (data.links[i].target.node.id === childData.id) {\n              _this2.currentlyHighlightedLinks.push(data.links[i].id);\n            }\n          }\n        };\n\n        var traverseCallbackDown = function traverseCallbackDown(data) {\n          data.hovering = 2;\n          for (var i = data.links.length; i--;) {\n            _this2.currentlyHighlightedLinks.push(data.links[i].id);\n          }\n        };\n        upAndDown(data, traverseCallbackUp, traverseCallbackDown);\n\n        if (data.clone) {\n          data.originalNode.hovering = 1;\n        }\n\n        data.hovering = 1;\n\n        this.nodes.each(function (data) {\n          var node = d3.select(this);\n\n          if (data.hovering === 1) {\n            node.classed('hovering-directly', true);\n          } else if (data.hovering === 2) {\n            node.classed('hovering-indirectly', true);\n            node.selectAll('.bar.' + currentActiveProperty.id).classed('copy', function (data) {\n              var id = data.id;\n\n              if (data.clone) {\n                id = data.originalNode.id;\n              }\n\n              if (id !== currentNodeData.id) {\n                return true;\n              }\n            });\n\n            var currentBar = d3.select(el).selectAll('.bar.' + currentActiveProperty.id).classed('reference', true);\n\n            that.bars.updateIndicator(node.selectAll('.bar.copy .bar-indicator'), currentBar.selectAll('.bar-indicator'), currentActiveProperty.value);\n          }\n        });\n\n        this.links.highlight(arrayToFakeObjs(this.currentlyHighlightedLinks));\n\n        this.events.broadcast('d3ListGraphNodeEnter', { id: data.id });\n      }\n    }, {\n      key: 'mouseLeave',\n      value: function mouseLeave(el, data) {\n        var traverseCallback = function traverseCallback(data) {\n          return data.hovering = 0;\n        };\n\n        data.hovering = 0;\n        upAndDown(data, traverseCallback);\n\n        if (data.clone) {\n          data.originalNode.hovering = 0;\n        }\n\n        this.nodes.classed('hovering-directly', false);\n        this.nodes.classed('hovering-indirectly', false);\n        this.nodes.selectAll('.bar.reference').classed('reference', false);\n\n        this.links.highlight(arrayToFakeObjs(this.currentlyHighlightedLinks), false);\n\n        this.events.broadcast('d3ListGraphNodeLeave', { id: data.id });\n      }\n    }, {\n      key: 'sort',\n      value: function sort(update, newSortType) {\n        var _this3 = this;\n\n        for (var i = update.length; i--;) {\n          var start = function start() {\n            d3.select(this).classed('sorting', true);\n          };\n          var end = function end() {\n            d3.select(this).classed('sorting', false);\n          };\n\n          var selection = this.nodes.data(update[i].rows, function (data) {\n            return data.id;\n          });\n\n          selection.transition().duration(TRANSITION_SEMI_FAST).attr('transform', function (data) {\n            return 'translate(' + (data.x + _this3.visData.global.column.padding) + ', ' + data.y + ')';\n          }).each('start', start).each('end', end);\n\n          if (newSortType) {\n            this.bars.update(selection.selectAll('.bar'), update[i].sortBy);\n          }\n        }\n      }\n    }, {\n      key: 'barMode',\n      get: function get() {\n        return this.bars.mode;\n      }\n    }]);\n    return Nodes;\n  })();\n\n  var COLUMN_CLASS = 'column';\n  var SCROLL_CONTAINER_CLASS = 'scroll-container';\n\n  var Columns = (function () {\n    function Columns(selection, visData) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Columns);\n\n      this.visData = visData;\n      this.groups = selection.selectAll('g').data(this.visData.nodes).enter().append('g').attr('class', COLUMN_CLASS);\n\n      // We need to add an empty rectangle that fills up the whole column to ensure\n      // that the `g`'s size is at a maximum, otherwise scrolling will be halted\n      // when the cursor leaves an actually drawn element.\n      this.groups.append('rect').attr('class', SCROLL_CONTAINER_CLASS).attr('x', function (data) {\n        return data.x;\n      }).attr('y', function (data) {\n        return data.y;\n      }).attr('width', function (data) {\n        return _this.visData.global.column.width;\n      }).attr('height', function (data) {\n        return _this.visData.global.column.height;\n      });\n    }\n\n    babelHelpers.createClass(Columns, [{\n      key: 'scrollPreparation',\n      value: function scrollPreparation(vis, scrollbarWidth) {\n        var _this2 = this;\n\n        this.groups.each(function (data, index) {\n          var contentHeight = data.nodes.getBoundingClientRect().height + 2 * _this2.visData.global.row.padding;\n          var scrollHeight = contentHeight - _this2.visData.global.column.height;\n          var scrollbarHeight = scrollHeight > 0 ? Math.max(_this2.visData.global.column.height * _this2.visData.global.column.height / contentHeight, 10) : 0;\n\n          data.height = contentHeight;\n          data.linkSelections = {\n            incoming: index > 0 ? vis.selectByColumn(index - 1, '.link') : null,\n            outgoing: vis.selectByColumn(index, '.link')\n          };\n          data.scrollHeight = scrollHeight;\n          data.scrollTop = 0;\n          data.scrollbar = {\n            el: undefined,\n            x: data.x + _this2.visData.global.column.width - scrollbarWidth,\n            y: 0,\n            width: scrollbarWidth,\n            height: scrollbarHeight,\n            scrollHeight: _this2.visData.global.column.height - scrollbarHeight,\n            scrollTop: 0,\n            heightScale: d3.scale.linear().domain([0, scrollHeight]).range([0, _this2.visData.global.column.height - scrollbarHeight])\n          };\n          data.invertedHeightScale = data.scrollbar.heightScale.invert;\n        });\n      }\n    }, {\n      key: 'height',\n      get: function get() {\n        return this.visData.global.column.height;\n      }\n    }]);\n    return Columns;\n  })();\n\n  var TOPBAR_EL = 'div';\n  var TOPBAR_CLASS = 'top-bar';\n\n  var TOPBAR_CONTROL_EL = 'ul';\n  var TOPBAR_CONTROL_CLASS = 'controls';\n  var TOPBAR_GLOBAL_CONTROL_CLASS = 'global-controls';\n\n  var Topbar = (function () {\n    function Topbar(vis, selection, visData) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Topbar);\n\n      var that = this;\n\n      this.vis = vis;\n      this.visData = visData;\n      // Add base topbar element\n      this.el = selection.select('.' + TOPBAR_CLASS);\n\n      if (this.el.empty()) {\n        this.el = selection.insert(TOPBAR_EL, ':first-child').attr('class', TOPBAR_CLASS);\n      }\n\n      this.controlSwitch = this.el.append('div').attr('title', 'Toggle global / local topbar').style('width', this.visData.global.column.padding + 'px').classed('control-switch', true).on('click', this.switch.bind(this));\n\n      this.switchArrow = this.controlSwitch.append('svg').append('use').attr('xlink:href', this.vis.iconPath + '#arrow-down').attr('class', 'switch-arrow');\n\n      this.globalControls = this.el.append(TOPBAR_CONTROL_EL).classed(TOPBAR_GLOBAL_CONTROL_CLASS, true);\n\n      this.globalPrecision = this.globalControls.append('li').attr('class', 'control-btn sort-precision').classed('active', function () {\n        if (that.vis.currentSorting.global.type === 'precision') {\n          // Save currently active element. Needed when when re-sorting for the\n          // first time, to be able to de-highlight this element.\n          that.vis.currentSorting.global.el = d3.select(this);\n          return true;\n        }\n      }).on('click', function (data) {\n        that.sortAllColumns(this, 'precision');\n      }).on('mouseenter', function () {\n        return _this.highlightBars(undefined, 'precision');\n      }).on('mouseleave', function () {\n        return _this.highlightBars(undefined, 'precision', true);\n      });\n\n      this.globalPrecisionWrapper = this.globalPrecision.append('div').attr('class', 'wrapper').text('Precision').style('margin', '0 ' + this.visData.global.column.padding + 'px');\n\n      this.globalPrecisionWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'precision').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n      this.globalPrecisionWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'precision' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-asc');\n\n      this.globalPrecisionWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'precision' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-desc');\n\n      this.globalRecall = this.globalControls.append('li').attr('class', 'control-btn sort-recall').classed('active', function () {\n        if (that.vis.currentSorting.global.type === 'recall') {\n          // See precision\n          that.vis.currentSorting.global.el = d3.select(this);\n          return true;\n        }\n      }).on('click', function (data) {\n        that.sortAllColumns(this, 'recall');\n      }).on('mouseenter', function () {\n        return _this.highlightBars(undefined, 'recall');\n      }).on('mouseleave', function () {\n        return _this.highlightBars(undefined, 'recall', true);\n      });\n\n      this.globalRecallWrapper = this.globalRecall.append('div').attr('class', 'wrapper').text('Recall').style('margin', '0 ' + this.visData.global.column.padding + 'px');\n\n      this.globalRecallWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'recall').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n      this.globalRecallWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'recall' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-asc');\n\n      this.globalRecallWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'recall' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-desc');\n\n      this.globalName = this.globalControls.append('li').attr('class', 'control-btn sort-name').classed('active', function () {\n        if (that.vis.currentSorting.global.type === 'name') {\n          // See precision\n          that.vis.currentSorting.global.el = d3.select(this);\n          return true;\n        }\n      }).on('click', function (data) {\n        that.sortAllColumns(this, 'name');\n      }).on('mouseenter', function () {\n        return _this.highlightLabels();\n      }).on('mouseleave', function () {\n        return _this.highlightLabels(true);\n      });\n\n      this.globalNameWrapper = this.globalName.append('div').attr('class', 'wrapper').text('Name').style('margin', '0 ' + this.visData.global.column.padding + 'px');\n\n      this.globalNameWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'name').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n      this.globalNameWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'name' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-alpha-asc');\n\n      this.globalNameWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'name' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-alpha-desc');\n\n      // One bar\n      this.globalOneBar = this.globalControls.append('li').attr('class', 'control-btn one-bar').classed('active', this.vis.barMode === 'one').on('click', function () {\n        that.switchBarMode(this, 'one');\n      });\n\n      this.globalOneBarWrapper = this.globalOneBar.append('div').attr('class', 'wrapper').text('One bar').style('margin', '0 ' + this.visData.global.column.padding + 'px');\n\n      this.globalOneBarWrapper.append('svg').attr('class', 'icon-one-bar').append('use').attr('xlink:href', this.vis.iconPath + '#one-bar');\n\n      // Two bars\n      this.globalTwoBars = this.globalControls.append('li').attr('class', 'control-btn two-bars').classed('active', this.vis.barMode === 'two').on('click', function () {\n        that.switchBarMode(this, 'two');\n      });\n\n      this.globalTwoBarsWrapper = this.globalTwoBars.append('div').attr('class', 'wrapper').text('Two bars').style('margin', '0 ' + this.visData.global.column.padding + 'px');\n\n      this.globalTwoBarsWrapper.append('svg').attr('class', 'icon-two-bars').append('use').attr('xlink:href', this.vis.iconPath + '#two-bars');\n\n      this.localControlWrapper = this.el.append('div').classed('local-controls', true);\n\n      this.localControls = this.localControlWrapper.selectAll(TOPBAR_CONTROL_CLASS).data(visData.nodes).enter().append(TOPBAR_CONTROL_EL).classed(TOPBAR_CONTROL_CLASS, true).style('width', this.visData.global.column.width + 'px');\n\n      this.localControls.each(function (data, index) {\n        var control = d3.select(this);\n\n        /*\n         * Order:\n         * 0 = unsorted\n         * 1 = asc\n         * -1 = desc\n         */\n        that.vis.currentSorting.local[index] = {\n          type: data.sortBy,\n          order: data.sortOrder,\n          el: undefined\n        };\n\n        control.append('li').attr('class', 'control-btn toggle').style('width', that.visData.global.column.padding + 'px').on('click', that.toggleColumn);\n\n        control.append('li').attr('class', 'control-btn sort-precision ease-all').style({\n          'width': that.visData.global.column.contentWidth / 2 + 'px',\n          'left': that.visData.global.column.padding + 'px'\n        }).on('click', function (data) {\n          that.sortColumn(this, data.level, 'precision');\n        }).on('mouseenter', function () {\n          that.highlightBars(this.parentNode, 'precision');\n          d3.select(this).style('width', that.visData.global.column.contentWidth - 16 + 'px');\n        }).on('mouseleave', function () {\n          that.highlightBars(this.parentNode, 'precision', true);\n          d3.select(this).style('width', that.visData.global.column.contentWidth / 2 + 'px');\n        }).html('<div class=\"expandable-label\">' + '  <span class=\"letter abbr\">P</span>' + '  <span class=\"letter abbr\">r</span>' + '  <span class=\"letter\">e</span>' + '  <span class=\"letter abbr\">c</span>' + '  <span class=\"letter\">i</span>' + '  <span class=\"letter\">s</span>' + '  <span class=\"letter\">i</span>' + '  <span class=\"letter\">o</span>' + '  <span class=\"letter\">n</span>' + '</div>' + '<svg class=\"icon-unsort invisible-default ' + (that.vis.currentSorting.local[index].type !== 'precision' ? 'visible' : '') + '\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#unsort\"></use>' + '</svg>' + '<svg class=\"icon-sort-asc invisible-default ' + (that.vis.currentSorting.local[index].type === 'precision' && that.vis.currentSorting.local[index].order === 1 ? 'visible' : '') + '\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#sort-asc\"></use>' + '</svg>' + '<svg class=\"icon-sort-desc invisible-default ' + (that.vis.currentSorting.local[index].type === 'precision' && that.vis.currentSorting.local[index].order !== 1 ? 'visible' : '') + '\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#sort-desc\"></use>' + '</svg>');\n\n        control.append('li').attr('class', 'control-btn sort-recall ease-all').style({\n          'width': that.visData.global.column.contentWidth / 2 + 'px',\n          'left': that.visData.global.column.contentWidth / 2 + that.visData.global.column.padding + 'px'\n        }).on('click', function (data) {\n          that.sortColumn(this, data.level, 'recall');\n        }).on('mouseenter', function () {\n          that.highlightBars(this.parentNode, 'recall');\n          d3.select(this).style({\n            'width': that.visData.global.column.contentWidth - 16 + 'px',\n            'left': that.visData.global.column.padding + 16 + 'px'\n          });\n        }).on('mouseleave', function () {\n          that.highlightBars(this.parentNode, 'recall', true);\n          d3.select(this).style({\n            'width': that.visData.global.column.contentWidth / 2 + 'px',\n            'left': that.visData.global.column.contentWidth / 2 + that.visData.global.column.padding + 'px'\n          });\n        }).html('<div class=\"expandable-label\">' + '  <span class=\"letter abbr\">R</span>' + '  <span class=\"letter\">e</span>' + '  <span class=\"letter abbr\">c</span>' + '  <span class=\"letter\">a</span>' + '  <span class=\"letter abbr\">l</span>' + '  <span class=\"letter\">l</span>' + '</div>' + '<svg class=\"icon-unsort invisible-default ' + (that.vis.currentSorting.local[index].type !== 'recall' ? 'visible' : '') + '\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#unsort\"></use>' + '</svg>' + '<svg class=\"icon-sort-asc invisible-default ' + (that.vis.currentSorting.local[index].type === 'recall' && that.vis.currentSorting.local[index].order === 1 ? 'visible' : '') + '\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#sort-asc\"></use>' + '</svg>' + '<svg class=\"icon-sort-desc invisible-default ' + (that.vis.currentSorting.local[index].type === 'recall' && that.vis.currentSorting.local[index].order !== 1 ? 'visible' : '') + '\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#sort-desc\"></use>' + '</svg>');\n\n        control.append('li').attr('class', 'control-btn options').style('width', that.visData.global.column.padding + 'px').on('click', that.toggleOptions).html('<svg class=\"icon-gear\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#gear\"></use>' + '</svg>');\n\n        if (that.vis.currentSorting.local[index].type) {\n          that.vis.currentSorting.local[index].el = control.select('.sort-' + that.vis.currentSorting.local[index].type);\n        }\n      });\n    }\n\n    babelHelpers.createClass(Topbar, [{\n      key: 'toggleColumn',\n      value: function toggleColumn() {\n        console.log('Toggle column');\n      }\n    }, {\n      key: 'selectNodesColumn',\n      value: function selectNodesColumn(el) {\n        return this.vis.selectByColumn(d3.select(el).datum().level, '.node');\n      }\n    }, {\n      key: 'highlightLabels',\n      value: function highlightLabels(deHighlight) {\n        this.vis.baseElD3.selectAll('.node').classed('highlight-label', !deHighlight);\n      }\n    }, {\n      key: 'highlightBars',\n      value: function highlightBars(el, type, deHighlight) {\n        var nodes = el ? this.selectNodesColumn(el) : this.vis.baseElD3.selectAll('.node');\n\n        nodes.classed('highlight-bar', !deHighlight).selectAll('.bar.' + type).classed('highlight', !deHighlight);\n      }\n    }, {\n      key: 'sortAllColumns',\n      value: function sortAllColumns(el, type) {\n        var newSortType = false;\n\n        if (this.vis.currentSorting.global.type !== type) {\n          newSortType = true;\n\n          // Unset class of previous global sorting element\n          if (this.vis.currentSorting.global.el) {\n            this.resetSortEl(this.vis.currentSorting.global.el);\n          }\n        }\n\n        this.vis.currentSorting.global.el = d3.select(el);\n        this.vis.currentSorting.global.el.classed('active', true);\n        this.vis.currentSorting.global.type = type;\n\n        var columnKeys = Object.keys(this.vis.currentSorting.local);\n        for (var i = 0, len = columnKeys.length; i < len; i++) {\n          this.sortColumn(el, columnKeys[i], type, true);\n        }\n      }\n    }, {\n      key: 'sortColumn',\n      value: function sortColumn(el, index, type, global) {\n        // Reset global sorting\n        if (!global) {\n          this.vis.currentSorting.global.type = undefined;\n          this.resetSortEl(this.vis.currentSorting.global.el);\n        }\n\n        var newSortType = false;\n\n        if (this.vis.currentSorting.local[index].el) {\n          if (this.vis.currentSorting.local[index].type !== type) {\n            this.resetSortEl(this.vis.currentSorting.local[index].el);\n          }\n        }\n\n        if (this.vis.currentSorting.local[index].type !== type) {\n          newSortType = true;\n          // Reset sort order\n          this.vis.currentSorting.local[index].order = 0;\n        }\n\n        this.vis.currentSorting.local[index].el = d3.select(el);\n        this.vis.currentSorting.local[index].type = type;\n\n        // -1 = desc, 1 = asc\n        if (this.vis.currentSorting.local[index].order === -1) {\n          this.vis.currentSorting.local[index].order = 1;\n          this.vis.currentSorting.local[index].el.select('.icon-sort-desc').classed('visible', false);\n          this.vis.currentSorting.local[index].el.select('.icon-sort-asc').classed('visible', true);\n        } else {\n          this.vis.currentSorting.local[index].order = -1;\n          this.vis.currentSorting.local[index].el.select('.icon-sort-asc').classed('visible', false);\n          this.vis.currentSorting.local[index].el.select('.icon-sort-desc').classed('visible', true);\n        }\n\n        this.vis.currentSorting.local[index].el.select('.icon-unsort').classed('visible', false);\n\n        this.vis.sortColumn(index, type, this.vis.currentSorting.local[index].order, newSortType);\n      }\n    }, {\n      key: 'resetSortEl',\n      value: function resetSortEl(el) {\n        el.classed('active', false);\n        el.select('.icon-sort-desc').classed('visible', false);\n        el.select('.icon-sort-asc').classed('visible', false);\n        el.select('.icon-unsort').classed('visible', true);\n      }\n    }, {\n      key: 'toggleOptions',\n      value: function toggleOptions() {\n        console.log('Toggle options');\n      }\n    }, {\n      key: 'switch',\n      value: function _switch() {\n        this.el.classed('details', !this.el.classed('details'));\n      }\n    }, {\n      key: 'switchBarMode',\n      value: function switchBarMode(el, mode) {\n        if (this.vis.nodes.barMode !== mode) {\n          if (mode === 'one') {\n            this.globalOneBar.classed('active', true);\n            this.globalTwoBars.classed('active', false);\n          } else {\n            this.globalOneBar.classed('active', false);\n            this.globalTwoBars.classed('active', true);\n          }\n          this.vis.switchBarMode(mode);\n        }\n      }\n    }]);\n    return Topbar;\n  })();\n\n  /**\n   * Creates and adds an interpolated exponential SVG gradient to an SVG element.\n   *\n   * @example\n   * ```\n   * exponentialGradient(\n   *   d3.select('svg'),\n   *   {\n   *     color: #fff,\n   *     offset: 10,\n   *     opacity: 0.5,\n   *     x: 0,\n   *     y: 0\n   *   },\n   *   {\n   *     color: #000,\n   *     offset: 10,\n   *     opacity: 1,\n   *     x: 1,\n   *     y: 1\n   *   },\n   *   'myFancyGradient',\n   *   3,\n   *   5\n   * );\n   * ```\n   *\n   * @method  exponentialGradient\n   * @author  Fritz Lekschas\n   * @date    2015-12-30\n   * @param   {Object}  el     Element to which the `def` gradient should be\n   *   added to.\n   * @param   {Object}  start  Start properies.\n   * @param   {Object}  end    End properies.\n   * @param   {String}  name   Name of the gradient.\n   * @param   {Number}  power  Exponential power.\n   * @param   {Number}  steps  Interpolation steps.\n   */\n  function exponentialGradient(el, start, end, name, power, steps) {\n    var scale = d3.scale.pow().exponent(power || 2);\n    var stepSize = 1 / ((steps || 0) + 1);\n\n    var gradient = el.append('defs').append('linearGradient').attr('id', name).attr('x1', start.x).attr('y1', start.y).attr('x2', end.x).attr('y2', end.y).attr('spreadMethod', 'pad');\n\n    gradient.append('stop').attr('offset', start.offset + '%').attr('stop-color', start.color).attr('stop-opacity', start.opacity);\n\n    for (var i = 0; i < steps; i++) {\n      gradient.append('stop').attr('offset', start.offset + i * stepSize * (end.offset - start.offset) + '%').attr('stop-color', end.color).attr('stop-opacity', start.opacity + scale(i * stepSize) * (end.opacity - start.opacity));\n    }\n\n    gradient.append('stop').attr('offset', end.offset + '%').attr('stop-color', end.color).attr('stop-opacity', end.opacity);\n  }\n\n  var ExtendableError = (function (_Error) {\n    babelHelpers.inherits(ExtendableError, _Error);\n\n    function ExtendableError(message) {\n      babelHelpers.classCallCheck(this, ExtendableError);\n\n      var _this = babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(ExtendableError).call(this, message));\n\n      _this.name = _this.constructor.name;\n      _this.message = message;\n      Error.captureStackTrace(_this, _this.constructor.name);\n      return _this;\n    }\n\n    return ExtendableError;\n  })(Error);\n\n  var LayoutNotAvailable = (function (_ExtendableError) {\n    babelHelpers.inherits(LayoutNotAvailable, _ExtendableError);\n\n    function LayoutNotAvailable(message) {\n      babelHelpers.classCallCheck(this, LayoutNotAvailable);\n      return babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(LayoutNotAvailable).call(this, message || 'D3.layout.listGraph.js has not been loaded yet.'));\n    }\n\n    return LayoutNotAvailable;\n  })(ExtendableError);\n\n  var EventDispatcherNoFunction = (function (_ExtendableError2) {\n    babelHelpers.inherits(EventDispatcherNoFunction, _ExtendableError2);\n\n    function EventDispatcherNoFunction(message) {\n      babelHelpers.classCallCheck(this, EventDispatcherNoFunction);\n      return babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(EventDispatcherNoFunction).call(this, message || 'Dispatcher needs to be a function.'));\n    }\n\n    return EventDispatcherNoFunction;\n  })(ExtendableError);\n\n  var Events = (function () {\n    function Events(el, broadcast) {\n      babelHelpers.classCallCheck(this, Events);\n\n      if (broadcast && typeof broadcast !== 'function') {\n        throw new EventDispatcherNoFunction();\n      }\n\n      this.el = el;\n      this.dispatch = broadcast ? broadcast : this._dispatchEvent;\n    }\n\n    babelHelpers.createClass(Events, [{\n      key: '_dispatchEvent',\n      value: function _dispatchEvent(eventName, data) {\n        var event = document.createEvent('CustomEvent');\n        event.initCustomEvent(eventName, false, false, data);\n        this.el.dispatchEvent(event);\n      }\n    }, {\n      key: 'broadcast',\n      value: function broadcast(event, data) {\n        this.dispatch(event, data);\n      }\n    }]);\n    return Events;\n  })();\n\n  var ListGraph = (function () {\n    function ListGraph(baseEl, data, rootNodes, options) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, ListGraph);\n\n      if (!d3.layout.listGraph) {\n        throw new LayoutNotAvailable();\n      }\n\n      if (!isObject(options)) {\n        options = {};\n      }\n\n      var that = this;\n\n      this.baseEl = baseEl;\n      this.baseElD3 = d3.select(baseEl);\n      this.baseElJq = $(baseEl);\n      this.svgD3 = this.baseElD3.select('svg.base');\n\n      if (this.svgD3.empty()) {\n        this.svgD3 = this.baseElD3.append('svg').attr('class', 'base');\n        this.svgJq = $(this.svgD3[0]);\n      } else {\n        this.svgJq = $(this.svgD3[0]);\n      }\n\n      this.rootNodes = rootNodes;\n\n      this.width = options.width || this.svgJq.width();\n      this.height = options.height || this.svgJq.height();\n      this.scrollbarWidth = options.scrollbarWidth || SCROLLBAR_WIDTH;\n      this.columns = options.columns || COLUMNS;\n      this.rows = options.rows || ROWS;\n      this.iconPath = options.iconPath || ICON_PATH;\n\n      this.sortBy = options.sortBy;\n      this.sortOrder = options.sortOrder || DEFAULT_SORT_ORDER;\n\n      this.events = new Events(this.baseEl, options.dispatcher);\n\n      this.baseElJq.width(this.width).addClass(CLASSNAME);\n\n      this.layout = new d3.layout.listGraph([this.width, this.height], [this.columns, this.rows]);\n\n      this.data = data;\n      this.visData = this.layout.process(this.data, this.rootNodes, {\n        sortBy: this.sortBy,\n        sortOrder: this.sortOrder\n      });\n\n      /**\n       * Stores current sorting, e.g. type, order and a reference to the element.\n       *\n       * @type  {Object}\n       */\n      this.currentSorting = {\n        global: {\n          type: this.sortBy,\n          order: this.sortOrder\n        },\n        local: {}\n      };\n\n      exponentialGradient(this.svgD3, {\n        color: COLOR_NEGATIVE_RED,\n        offset: 0,\n        opacity: 0.2,\n        x: 0,\n        y: 0\n      }, {\n        afterOffsetOpacity: 1,\n        color: COLOR_NEGATIVE_RED,\n        offset: 99,\n        opacity: 1,\n        x: 1,\n        y: 0\n      }, 'negativeRed', 4, 10);\n\n      exponentialGradient(this.svgD3, {\n        beforeOffsetOpacity: 1,\n        color: COLOR_POSITIVE_GREEN,\n        offset: 1,\n        opacity: 1,\n        x: 0,\n        y: 0\n      }, {\n        color: COLOR_POSITIVE_GREEN,\n        offset: 100,\n        opacity: 0.2,\n        x: 1,\n        y: 0\n      }, 'positiveGreen', 0.25, 10);\n\n      this.barMode = options.barMode || DEFAULT_BAR_MODE;\n      this.svgD3.classed(this.barMode + '-bar', true);\n\n      this.topbar = new Topbar(this, this.baseElD3, this.visData);\n\n      this.svgD3.attr('viewBox', '0 0 ' + this.width + ' ' + this.height);\n\n      this.container = this.svgD3.append('g');\n\n      this.columns = new Columns(this.container, this.visData);\n\n      this.links = new Links(this.columns.groups, this.visData, this.layout);\n      this.nodes = new Nodes(this.columns.groups, this.visData, this.links, this.events, options.barMode || DEFAULT_BAR_MODE);\n      this.columns.scrollPreparation(this, this.scrollbarWidth);\n      this.scrollbars = new Scrollbars(this.columns.groups, this.visData, this.scrollbarWidth);\n\n      // jQuery's mousewheel plugin is much nicer than D3's half-baked zoom event.\n      this.$levels = $(this.columns.groups[0]).on('mousewheel', function (event) {\n        that.mousewheelColumn(this, event);\n      });\n\n      // Normally we would reference a named methods but since we need to aceess\n      // the class' `this` property instead of the DOM element we need to use an\n      // arrow function.\n      this.scrollbars.selection.on('mousedown', function () {\n        that.scrollbarMouseDown(this, d3.event);\n      });\n\n      // We need to listen to `mouseup` and `mousemove` globally otherwise\n      // scrolling will only work as long as the cursor hovers the actual\n      // scrollbar, which is super annoying.\n      d3.select(document).on('mouseup', function () {\n        _this.globalMouseUp(d3.event);\n      }).on('mousemove', function () {\n        _this.globalMouseMove(d3.event);\n      });\n    }\n\n    babelHelpers.createClass(ListGraph, [{\n      key: 'globalMouseUp',\n      value: function globalMouseUp(event) {\n        if (this.activeScrollbar) {\n          var data = this.activeScrollbar.datum();\n          var deltaY = data.scrollbar.clientY - event.clientY;\n\n          // Save final vertical position\n          // Scrollbar\n          data.scrollbar.scrollTop = Math.min(Math.max(data.scrollbar.scrollTop - deltaY, 0), data.scrollbar.scrollHeight);\n\n          // Content\n          data.scrollTop = Math.max(Math.min(data.scrollTop + data.invertedHeightScale(deltaY), 0), -data.scrollHeight);\n\n          this.activeScrollbar.classed('active', false);\n\n          this.activeScrollbar = undefined;\n        }\n      }\n    }, {\n      key: 'globalMouseMove',\n      value: function globalMouseMove(event) {\n        if (this.activeScrollbar) {\n          var data = this.activeScrollbar.datum();\n          var deltaY = data.scrollbar.clientY - event.clientY;\n\n          // Scroll scrollbar\n          ListGraph.scrollY(this.activeScrollbar.node(), Math.min(Math.max(data.scrollbar.scrollTop - deltaY, 0), data.scrollbar.scrollHeight));\n\n          // Scroll content\n          var contentScrollTop = Math.max(Math.min(data.scrollTop + data.invertedHeightScale(deltaY), 0), -data.scrollHeight);\n\n          ListGraph.scrollY(data.nodes, contentScrollTop);\n\n          // Scroll Links\n          this.links.scroll(data.linkSelections.outgoing, this.layout.offsetLinks(data.level, contentScrollTop, 'source'));\n\n          this.links.scroll(data.linkSelections.incoming, this.layout.offsetLinks(data.level - 1, contentScrollTop, 'target'));\n        }\n      }\n    }, {\n      key: 'scrollbarMouseDown',\n      value: function scrollbarMouseDown(el, event) {\n        this.activeScrollbar = d3.select(el).classed('active', true);\n        this.activeScrollbar.datum().scrollbar.clientY = event.clientY;\n      }\n    }, {\n      key: 'mousewheelColumn',\n      value: function mousewheelColumn(el, event) {\n        event.preventDefault();\n\n        var data = d3.select(el).datum();\n\n        if (data.scrollHeight > 0) {\n          // Scroll nodes\n          data.scrollTop = Math.max(Math.min(data.scrollTop + event.deltaY, 0), -data.scrollHeight);\n\n          ListGraph.scrollY(data.nodes, data.scrollTop);\n\n          // Scroll scrollbar\n          data.scrollbar.scrollTop = data.scrollbar.heightScale(-data.scrollTop);\n\n          ListGraph.scrollY(data.scrollbar.el, data.scrollbar.scrollTop);\n\n          // Scroll Links\n          this.links.scroll(data.linkSelections.outgoing, this.layout.offsetLinks(data.level, data.scrollTop, 'source'));\n\n          this.links.scroll(data.linkSelections.incoming, this.layout.offsetLinks(data.level - 1, data.scrollTop, 'target'));\n        }\n      }\n    }, {\n      key: 'selectByColumn',\n      value: function selectByColumn(index, selector) {\n        return d3.select(this.columns.groups[0][index]).selectAll(selector);\n      }\n    }, {\n      key: 'sortColumn',\n      value: function sortColumn(level, property, sortOrder, newSortType) {\n        this.nodes.sort(this.layout.sort(level, property, sortOrder).nodes(level), newSortType);\n        this.links.sort(this.layout.links(level - 1, level + 1));\n      }\n    }, {\n      key: 'switchBarMode',\n      value: function switchBarMode(mode) {\n        this.svgD3.classed('one-bar', mode === 'one');\n        this.svgD3.classed('two-bar', mode === 'two');\n        this.nodes.bars.switchMode(mode, this.currentSorting);\n      }\n    }, {\n      key: 'barMode',\n      get: function get() {\n        if (this.bars) {\n          return this.nodes.bars.mode;\n        }\n        return this._barMode;\n      },\n      set: function set(mode) {\n        if (this.bars) {\n          this.nodes.bars.mode = mode;\n        }\n        this._barMode = mode;\n      }\n    }], [{\n      key: 'scrollY',\n      value: function scrollY(el, offset) {\n        d3.select(el).attr('transform', 'translate(0, ' + offset + ')');\n      }\n    }]);\n    return ListGraph;\n  })();\n\n  return ListGraph;\n\n})($,d3);"],"sourceRoot":"/source/"}