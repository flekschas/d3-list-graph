{"version":3,"sources":["listGraph.min.js"],"names":["ListGraph","$","d3","mergeSelections","selections","pushSelection","selection","each","mergedSelection","push","this","selectAll","i","length","onDragDrop","dragMoveHandler","dropHandler","elsToBeDragged","orientation","limits","notWhenTrue","drag","behavior","on","data","call","el","select","dragX","dragY","datum","withinLimits","value","applyingLimits","restrictedValue","undefined","Math","min","max","e","LimitsUnsupportedFormat","els","event","dx","x","style","dy","y","arrayToFakeObjs","arrayIds","fakeObjs","id","collectInclClones","node","originalNode","clone","clones","concat","isFinite","nativeIsFinite","up","callback","depth","includeClones","child","nodesInclClones","j","parents","down","childRefs","upAndDown","callbackUp","callbackDown","siblings","isObject","type","isFunction","objToString","funcTag","roundRect","width","height","radius","topLeft","topRight","bottomLeft","bottomRight","exponentialGradient","start","end","name","power","steps","scale","pow","exponent","stepSize","gradient","append","attr","offset","color","opacity","isObjectLike","isNative","reIsNative","test","fnToString","reIsHostCtor","getNative","object","key","isLength","MAX_SAFE_INTEGER","babelHelpers","classCallCheck","instance","Constructor","TypeError","createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","protoProps","staticProps","prototype","inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","possibleConstructorReturn","self","ReferenceError","CLASSNAME","SCROLLBAR_WIDTH","COLUMNS","ROWS","ICON_PATH","DEFAULT_SORT_ORDER","DEFAULT_BAR_MODE","TRANSITION_LIGHTNING_FAST","TRANSITION_SEMI_FAST","COLOR_NEGATIVE_RED","COLOR_POSITIVE_GREEN","ExtendableError","_Error","message","_this","getPrototypeOf","Error","captureStackTrace","_ExtendableError","SCROLLBAR_CLASS","Scrollbars","baseSelection","visData","all","parentNode","scrollbar","classed","transition","duration","objectTypes","function","freeExports","exports","nodeType","freeModule","module","freeGlobal","global","freeSelf","freeWindow","window","root","objectProto","toString","BAR_CLASS","Bar","barGroup","barData","nodeData","bars","setupMagnitude","_this2","currentSorting","nodes","sortBy","generatePath","mode","setupBorder","row","padding","column","contentWidth","contentHeight","setupIndicatorBg","_this3","setupIndicator","class","level","cell","activeHeight","inactiveheight","enter","bind","referenceValue","indicator","adjustWidth","bottom","generateTwoBarsPath","generateOneBarPath","abs","BARS_CLASS","Bars","vis","that","insertBefore","refBars","refBarsBg","currentBar","updateIndicator","lessAnimations","NODES_CLASS","NODE_CLASS","CLONE_CLASS","Nodes","links","events","drawFullSizeRect","className","shrinking","shrinkingAmount","currentLinks","groups","rows","nodeRooted","rootHandler","setUpFocusControls","iconPath","nodeLocks","lockHandler","clickHandler","activeScrollbar","enterHandler","leaveHandler","barMode","text","focusNodes","blurNodes","nodeIds","eventHelper","highlightNodes","unhighlightNodes","toggleLock","toggleRoot","broadcast","locked","unlocked","rooted","unrooted","zoomOut","globalView","zoomIn","zoomedView","optionalParams","subSelectionClass","filter","indexOf","apply","setFalse","d3El","lockedNode","active","inactive","unlockNode","lockNode","parseInt","rootedNode","unrootNode","rootNode","hideNodes","showNodes","location","cx","cy","r","direction","nodesVisibility","show","hidden","updateVisibility","restriction","nodeId","currentNodeData","includeParents","includeChildren","appliedClassName","currentActiveProperty","traverseCallbackUp","childData","hovering","traverseCallbackDown","highlight","traverseCallback","update","newSortType","_this4","layout","updateNodesVisibility","completed","size","n","arguments","updateScrollbarVisibility","get","LINKS_CLASS","LINK_CLASS","Links","levels","index","d","diagonal","_highlight","source","svg","offsetY","offsetX","projection","COLUMN_CLASS","SCROLL_CONTAINER_CLASS","Levels","scrollbarWidth","getBoundingClientRect","scrollHeight","scrollbarHeight","linkSelections","incoming","selectByLevel","outgoing","scrollTop","heightScale","linear","domain","range","invertedHeightScale","invert","TOPBAR_EL","TOPBAR_CLASS","TOPBAR_CONTROL_EL","TOPBAR_CONTROL_CLASS","TOPBAR_GLOBAL_CONTROL_CLASS","Topbar","empty","insert","controlSwitch","switchArrow","globalControls","globalPrecision","sortAllColumns","highlightBars","globalPrecisionWrapper","order","globalRecall","globalRecallWrapper","globalName","highlightLabels","globalNameWrapper","globalOneBar","switchBarMode","globalOneBarWrapper","globalTwoBars","globalTwoBarsWrapper","localControlWrapper","localControls","control","local","sortOrder","toggleColumn","left","controlData","sortColumn","html","toggleOptions","deHighlight","baseElD3","selectNodesLevel","resetSortEl","columnKeys","keys","len","objectProto$2","Function","hasOwnProperty","RegExp","replace","arrayTag","objectProto$1","objToString$1","nativeIsArray","Array","isArray","LayoutNotAvailable","EventDispatcherNoFunction","_ExtendableError2","Events","_stack","dispatch","_dispatchEvent","eventName","document","createEvent","initCustomEvent","dispatchEvent","times","normTimes","Infinity","stack","splice","off","baseEl","rootNodes","options","listGraph","baseElJq","svgD3","svgJq","columns","dispatcher","addClass","forceWidth","process","afterOffsetOpacity","beforeOffsetOpacity","topbar","container","scrollPreparation","scrollbars","$levels","mousewheelColumn","scrollbarMouseDown","globalMouseUp","globalMouseMove","getBBox","scrollbarDragging","deltaY","clientY","scrollY","contentScrollTop","scroll","offsetLinks","preventDefault","selector","property","sort","switchMode","trigger","updateScrollProperties","bBox","_barMode","set"],"mappings":"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","file":"listGraph.min.js","sourcesContent":["/* Copyright Fritz Lekschas: D3 example visualization app using list-based graphs */\nvar ListGraph = (function ($,d3) { 'use strict';\n\n  var babelHelpers = {};\n\n  babelHelpers.classCallCheck = function (instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  };\n\n  babelHelpers.createClass = (function () {\n    function defineProperties(target, props) {\n      for (var i = 0; i < props.length; i++) {\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n      }\n    }\n\n    return function (Constructor, protoProps, staticProps) {\n      if (protoProps) defineProperties(Constructor.prototype, protoProps);\n      if (staticProps) defineProperties(Constructor, staticProps);\n      return Constructor;\n    };\n  })();\n\n  babelHelpers.inherits = function (subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n  };\n\n  babelHelpers.possibleConstructorReturn = function (self, call) {\n    if (!self) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n  };\n\n  babelHelpers;\n  var CLASSNAME = 'list-graph';\n\n  var SCROLLBAR_WIDTH = 6;\n  var COLUMNS = 5;\n  var ROWS = 5;\n\n  // An empty path is equal to inline SVG.\n  var ICON_PATH = '';\n\n  var DEFAULT_SORT_ORDER = 'desc';\n\n  var DEFAULT_BAR_MODE = 'one';\n\n  var TRANSITION_LIGHTNING_FAST = 150;\n  var TRANSITION_SEMI_FAST = 250;\n  // Gradient colors\n  var COLOR_NEGATIVE_RED = '#e0001c';\n  var COLOR_POSITIVE_GREEN = '#60bf00';\n\n  var ExtendableError = (function (_Error) {\n    babelHelpers.inherits(ExtendableError, _Error);\n\n    function ExtendableError(message) {\n      babelHelpers.classCallCheck(this, ExtendableError);\n\n      var _this = babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(ExtendableError).call(this, message));\n\n      _this.name = _this.constructor.name;\n      _this.message = message;\n      Error.captureStackTrace(_this, _this.constructor.name);\n      return _this;\n    }\n\n    return ExtendableError;\n  })(Error);\n\n  function mergeSelections(selections) {\n    // Create a new empty selection\n    var mergedSelection = d3.selectAll('.d3-list-graph-not-existent');\n\n    function pushSelection(selection) {\n      selection.each(function pushDomNode() {\n        mergedSelection[0].push(this);\n      });\n    }\n\n    for (var i = selections.length; i--;) {\n      pushSelection(selections[i]);\n    }\n\n    return mergedSelection;\n  }\n\n  var LimitsUnsupportedFormat = (function (_ExtendableError) {\n    babelHelpers.inherits(LimitsUnsupportedFormat, _ExtendableError);\n\n    function LimitsUnsupportedFormat(message) {\n      babelHelpers.classCallCheck(this, LimitsUnsupportedFormat);\n      return babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(LimitsUnsupportedFormat).call(this, message || 'The limits are wrongly formatted. Please provide an ' + 'object of the following format: `{ x: { min: 0, max: 1 }, y: { min: ' + '0, max: 1 } }`'));\n    }\n\n    return LimitsUnsupportedFormat;\n  })(ExtendableError);\n\n  /**\n   * Drap and drop event handler that works via translation.\n   *\n   * @method  onDragDrop\n   * @author  Fritz Lekschas\n   * @date    2016-01-21\n   * @param   {Object}  selection        D3 selection to listen for the drag\n   *   event.\n   * @param   {Object}  dragMoveHandler  Handler for drag-move.\n   * @param   {Object}  dropHandler      Handler for drag-end, i.e. drop.\n   * @param   {Array}   elsToBeDragged   Array of D3 selections to be moved.\n   *   according to the drag event. If empty or undefined `selection` will be\n   * @param   {String}  orientation      Can either be \"horizontal\", \"vertical\" or\n   *   `undefined`, i.e. both directions.\n   * @param   {Object}  limits           X and Y drag limits. E.g.\n   *   `{ x: { min: 0, max: 10 } }`.\n   * @param   {Array}    notWhenTrue     List if function returning a Boolean\n   *   value which should prevent the dragMoveHandler from working.\n   */\n  function onDragDrop(selection, dragMoveHandler, dropHandler, elsToBeDragged, orientation, limits, notWhenTrue) {\n    var drag = d3.behavior.drag();\n\n    limits = limits || {}; // eslint-disable-line no-param-reassign\n\n    if (dragMoveHandler) {\n      drag.on('drag', function (data) {\n        dragMoveHandler.call(this, data, elsToBeDragged, orientation, limits, notWhenTrue);\n      });\n    }\n\n    if (dropHandler) {\n      drag.on('dragend', function (data) {\n        dropHandler.call(this, data, elsToBeDragged, orientation, limits, notWhenTrue);\n      });\n    }\n\n    selection.each(function (data) {\n      var el = d3.select(this);\n\n      // Set default data if not available.\n      if (!data) {\n        data = { dragX: 0, dragY: 0 }; // eslint-disable-line no-param-reassign\n        el.datum(data);\n      }\n\n      // Add drag event handler\n      el.call(drag);\n    });\n  }\n\n  function dragMoveHandler(data, elsToBeDragged, orientation, limits, notWhenTrue) {\n    for (var i = notWhenTrue.length; i--;) {\n      if (notWhenTrue[i]()) {\n        return;\n      }\n    }\n\n    var els = d3.select(this);\n\n    if (elsToBeDragged && elsToBeDragged.length) {\n      els = mergeSelections(elsToBeDragged);\n    }\n\n    function withinLimits(value, applyingLimits) {\n      var restrictedValue = undefined;\n\n      if (applyingLimits) {\n        try {\n          restrictedValue = Math.min(applyingLimits.max, Math.max(applyingLimits.min, value));\n        } catch (e) {\n          throw new LimitsUnsupportedFormat();\n        }\n      }\n      return restrictedValue;\n    }\n\n    if (orientation === 'horizontal' || orientation === 'vertical') {\n      if (orientation === 'horizontal') {\n        data.dragX += d3.event.dx;\n        data.dragX = withinLimits(data.dragX + d3.event.dx, limits.x);\n        els.style('transform', 'translateX(' + data.dragX + 'px)');\n      }\n      if (orientation === 'vertical') {\n        data.dragY += d3.event.dy;\n        data.dragX = withinLimits(data.dragY + d3.event.dy, limits.y);\n        els.style('transform', 'translateY(' + data.dragY + 'px)');\n      }\n    } else {\n      data.dragX += d3.event.dx;\n      data.dragY += d3.event.dy;\n      els.style('transform', 'translate(' + data.dragX + 'px,' + data.dragY + 'px)');\n    }\n  }\n\n  var SCROLLBAR_CLASS = 'scrollbar';\n\n  var Scrollbars = (function () {\n    function Scrollbars(baseSelection, visData, width) {\n      babelHelpers.classCallCheck(this, Scrollbars);\n\n      this.visData = visData;\n      this.width = width;\n\n      // Add empty scrollbar element\n      this.all = baseSelection.append('rect').attr('class', SCROLLBAR_CLASS).call(function (selection) {\n        selection.each(function setScrollBarDomElement() {\n          d3.select(this.parentNode).datum().scrollbar.el = this;\n        });\n      }).attr('x', function (data) {\n        return data.scrollbar.x;\n      }).attr('y', function (data) {\n        return data.scrollbar.y;\n      }).attr('width', this.width).attr('height', function (data) {\n        return data.scrollbar.height;\n      }).attr('rx', this.width / 2).attr('ry', this.width / 2).classed('ready', true);\n    }\n\n    babelHelpers.createClass(Scrollbars, [{\n      key: 'updateVisibility',\n      value: function updateVisibility() {\n        this.all.transition().duration(TRANSITION_LIGHTNING_FAST).attr({\n          x: function x(data) {\n            return data.scrollbar.x;\n          },\n          height: function height(data) {\n            return data.scrollbar.height;\n          }\n        });\n      }\n    }]);\n    return Scrollbars;\n  })();\n\n  /**\n   * Turns an array of IDs into an array of objects holding the ID.\n   *\n   * @description\n   * We need to translate the array of objects into an array of fake objects in\n   * order to easily match the links to be highlighted.\n   *\n   * Using this method selection can be matched easily via the array of fake\n   * objects:\n   *\n   * ```\n   * this.links\n   *   .data(arrayToFakeObjs([1, 2, 3]), data => data)\n   *   .classed('highlight', highlight === false ? false : true);\n   * ```\n   *\n   * @method  arrayToFakeObjs\n   * @author  Fritz Lekschas\n   * @date    2015-12-23\n   * @param   {Array}  arrayIds  Array of IDs.\n   * @return  {Array}            Array of objects holding the ID. E.g. `[1]` will\n   *   be translated into `[{ id: 1 }]`.\n   */\n  function arrayToFakeObjs(arrayIds) {\n    var fakeObjs = [];\n\n    for (var i = arrayIds.length; i--;) {\n      fakeObjs.push({ id: arrayIds[i] });\n    }\n\n    return fakeObjs;\n  }\n\n  /**\n   * Collect all cloned nodes, including the original node.\n   *\n   * @method  collectInclClones\n   * @author  Fritz Lekschas\n   * @date    2015-12-30\n   * @param   {Object}  node  Start node\n   * @return  {Array}         Array of original and cloned nodes.\n   */\n  function collectInclClones(node) {\n    var originalNode = node;\n\n    if (node.clone) {\n      originalNode = node.originalNode;\n    }\n\n    var clones = [originalNode];\n\n    if (originalNode.clones.length) {\n      clones = clones.concat(originalNode.clones);\n    }\n\n    return clones;\n  }\n\n  /** Used to determine if values are of the language type `Object`. */\n  var objectTypes = {\n    'function': true,\n    'object': true\n  };\n\n  /** Detect free variable `exports`. */\n  var freeExports = objectTypes[typeof exports] && exports && !exports.nodeType && exports;\n\n  /** Detect free variable `module`. */\n  var freeModule = objectTypes[typeof module] && module && !module.nodeType && module;\n\n  /** Detect free variable `global` from Node.js. */\n  var freeGlobal = freeExports && freeModule && typeof global == 'object' && global && global.Object && global;\n\n  /** Detect free variable `self`. */\n  var freeSelf = objectTypes[typeof self] && self && self.Object && self;\n\n  /** Detect free variable `window`. */\n  var freeWindow = objectTypes[typeof window] && window && window.Object && window;\n\n  /**\n   * Used as a reference to the global object.\n   *\n   * The `this` value is used if it's the global object to avoid Greasemonkey's\n   * restricted `window` object, otherwise the `window` object is used.\n   */\n  var root = freeGlobal || ((freeWindow !== (this && this.window)) && freeWindow) || freeSelf || this;\n\n  /* Native method references for those with the same name as other `lodash` methods. */\n  var nativeIsFinite = root.isFinite;\n\n  /**\n   * Checks if `value` is a finite primitive number.\n   *\n   * **Note:** This method is based on [`Number.isFinite`](http://ecma-international.org/ecma-262/6.0/#sec-number.isfinite).\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is a finite number, else `false`.\n   * @example\n   *\n   * _.isFinite(10);\n   * // => true\n   *\n   * _.isFinite('10');\n   * // => false\n   *\n   * _.isFinite(true);\n   * // => false\n   *\n   * _.isFinite(Object(10));\n   * // => false\n   *\n   * _.isFinite(Infinity);\n   * // => false\n   */\n  function isFinite(value) {\n    return typeof value == 'number' && nativeIsFinite(value);\n  }\n\n  function up(node, callback, depth, includeClones, child) {\n    var nodesInclClones = includeClones ? collectInclClones(node) : [node];\n\n    for (var i = nodesInclClones.length; i--;) {\n      if (child) {\n        callback(nodesInclClones[i], child);\n      }\n\n      if (!isFinite(depth) || depth > 0) {\n        for (var j = nodesInclClones[i].parents.length; j--;) {\n          up(nodesInclClones[i].parents[j], callback, depth - 1, includeClones, nodesInclClones[i]);\n        }\n      }\n    }\n  }\n\n  function down(node, callback, depth, includeClones) {\n    var nodesInclClones = includeClones ? collectInclClones(node) : [node];\n\n    for (var i = nodesInclClones.length; i--;) {\n      callback(nodesInclClones[i]);\n\n      if (!isFinite(depth) || depth > 0) {\n        for (var j = nodesInclClones[i].childRefs.length; j--;) {\n          down(nodesInclClones[i].childRefs[j], callback, depth - 1, includeClones);\n        }\n      }\n    }\n  }\n\n  function upAndDown(node, callbackUp, callbackDown, depth, includeClones) {\n    if (callbackDown) {\n      up(node, callbackUp, depth, includeClones);\n      down(node, callbackDown, depth, includeClones);\n    } else {\n      up(node, callbackUp, depth, includeClones);\n      down(node, callbackUp, depth, includeClones);\n    }\n  }\n\n  function siblings(node, callback) {\n    for (var i = node.parents.length; i--;) {\n      for (var j = node.parents[i].childRefs.length; j--;) {\n        callback(node.parents[i].childRefs[j]);\n      }\n    }\n  }\n\n  /**\n   * Checks if `value` is the [language type](https://es5.github.io/#x8) of `Object`.\n   * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n   * @example\n   *\n   * _.isObject({});\n   * // => true\n   *\n   * _.isObject([1, 2, 3]);\n   * // => true\n   *\n   * _.isObject(1);\n   * // => false\n   */\n  function isObject(value) {\n    // Avoid a V8 JIT bug in Chrome 19-20.\n    // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.\n    var type = typeof value;\n    return !!value && (type == 'object' || type == 'function');\n  }\n\n  /** `Object#toString` result references. */\n  var funcTag = '[object Function]';\n\n  /** Used for native method references. */\n  var objectProto = Object.prototype;\n\n  /**\n   * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n   * of values.\n   */\n  var objToString = objectProto.toString;\n\n  /**\n   * Checks if `value` is classified as a `Function` object.\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n   * @example\n   *\n   * _.isFunction(_);\n   * // => true\n   *\n   * _.isFunction(/abc/);\n   * // => false\n   */\n  function isFunction(value) {\n    // The use of `Object#toString` avoids issues with the `typeof` operator\n    // in older versions of Chrome and Safari which return 'function' for regexes\n    // and Safari 8 which returns 'object' for typed array constructors.\n    return isObject(value) && objToString.call(value) == funcTag;\n  }\n\n  // Credits go to Mike Bostock: http://bl.ocks.org/mbostock/3468167\n  function roundRect(x, y, width, height, radius) {\n    var topLeft = radius.topLeft || 0;\n    var topRight = radius.topRight || 0;\n    var bottomLeft = radius.bottomLeft || 0;\n    var bottomRight = radius.bottomRight || 0;\n\n    return 'M' + (x + topLeft) + ',' + y + 'h' + (width - topLeft - topRight) + 'a' + topRight + ',' + topRight + ' 0 0 1 ' + topRight + ',' + topRight + 'v' + (height - (topRight + bottomRight)) + 'a' + bottomRight + ',' + bottomRight + ' 0 0 1 ' + -bottomRight + ',' + bottomRight + 'h' + (bottomLeft - (width - bottomRight)) + 'a' + bottomLeft + ',' + bottomLeft + ' 0 0 1 ' + -bottomLeft + ',' + -bottomLeft + 'v' + (topLeft - (height - bottomLeft)) + 'a' + topLeft + ',' + topLeft + ' 0 0 1 ' + topLeft + ',' + -topLeft + 'z';\n  }\n\n  var BAR_CLASS = 'bar';\n\n  var Bar = (function () {\n    function Bar(barGroup, barData, nodeData, visData, bars) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Bar);\n\n      this.data = barData;\n      this.nodeData = nodeData;\n      this.visData = visData;\n      this.bars = bars;\n\n      this.data.x = nodeData.x;\n      this.data.level = nodeData.depth;\n\n      this.height = this.visData.global.row.contentHeight / (this.data.length * 2) - this.visData.global.cell.padding * 2;\n\n      this.activeHeight = this.visData.global.row.contentHeight - 2;\n\n      this.inactiveheight = this.visData.global.cell.padding * 2 - 1;\n\n      this.selection = barGroup.selectAll(BAR_CLASS).data(this.data).enter().append('g').attr('class', function (data) {\n        return BAR_CLASS + ' ' + data.id;\n      }).classed('active', function (data) {\n        return data.id === _this.visData.nodes[_this.nodeData.depth].sortBy;\n      });\n\n      // Local helper method to avoid code duplication.\n      // Calling a class method from within the consructor is possible but `this`\n      // is not available. Thus, we need to create local function and pass in\n      // `this` as `that`, which feels very hacky but it works.\n      function setupMagnitude(selection) {\n        var _this2 = this;\n\n        var currentSorting = this.visData.nodes[this.nodeData.depth].sortBy;\n\n        selection.attr('d', function (data) {\n          return Bar.generatePath(data, _this2.bars.mode, currentSorting, _this2.visData);\n        }).classed('bar-magnitude', true);\n      }\n\n      function setupBorder(selection) {\n        selection.attr('x', 0).attr('y', this.visData.global.row.padding).attr('width', this.visData.global.column.contentWidth).attr('height', this.visData.global.row.contentHeight).attr('rx', 2).attr('ry', 2).classed('bar-border', true);\n      }\n\n      function setupIndicatorBg(selection) {\n        var _this3 = this;\n\n        selection.attr('d', function (data) {\n          return Bar.generatePath(data, _this3.bars.mode, undefined, _this3.visData, data.value);\n        }).classed('bar-indicator-bg', true);\n      }\n\n      function setupIndicator(selection) {\n        selection.attr({\n          class: 'bar-indicator',\n          x: 0,\n          y: this.visData.global.row.padding,\n          width: 2,\n          height: this.visData.global.row.contentHeight\n        });\n      }\n\n      this.selection.append('rect').call(setupBorder.bind(this));\n\n      this.selection.append('path').call(setupMagnitude.bind(this));\n\n      this.selection.append('path').call(setupIndicatorBg.bind(this));\n\n      this.selection.append('rect').call(setupIndicator.bind(this));\n    }\n\n    babelHelpers.createClass(Bar, null, [{\n      key: 'updateIndicator',\n      value: function updateIndicator(selection, x, referenceValue) {\n        selection.attr('x', x - 1).classed('positive', function (data) {\n          return data.value >= referenceValue;\n        });\n      }\n    }, {\n      key: 'generatePath',\n      value: function generatePath(data, mode, currentSorting, visData, indicator, adjustWidth, bottom) {\n        if (mode === 'two') {\n          return Bar.generateTwoBarsPath(data, visData, bottom);\n        }\n        return Bar.generateOneBarPath(data, currentSorting, visData, indicator, adjustWidth);\n      }\n    }, {\n      key: 'generateOneBarPath',\n      value: function generateOneBarPath(data, currentSorting, visData, indicator, adjustWidth) {\n        var x = 0;\n\n        var width = 2;\n\n        var height = visData.global.row.contentHeight;\n\n        var radius = {\n          topLeft: 2,\n          bottomLeft: 2\n        };\n\n        if (indicator) {\n          radius = {};\n        }\n\n        if (data.id !== currentSorting && typeof indicator === 'undefined') {\n          x = data.value * visData.global.column.contentWidth - 3;\n          radius = {};\n        } else if (indicator) {\n          x = indicator * visData.global.column.contentWidth;\n          if (adjustWidth) {\n            if (data.value < indicator) {\n              x = data.value * visData.global.column.contentWidth;\n            }\n            width = Math.min(Math.abs(indicator - data.value), 2) * visData.global.column.contentWidth;\n          }\n        } else {\n          width = visData.global.column.contentWidth * data.value;\n        }\n\n        return roundRect(x, visData.global.row.padding, width, height, radius);\n      }\n    }, {\n      key: 'generateTwoBarsPath',\n      value: function generateTwoBarsPath(data, visData, bottom) {\n        var height = visData.global.row.contentHeight / 2;\n\n        var width = visData.global.column.contentWidth * data.value;\n\n        var y = visData.global.row.padding;\n\n        var radius = { topLeft: 2 };\n\n        if (bottom) {\n          radius = { bottomLeft: 2 };\n          y += height;\n        }\n\n        return roundRect(0, y, width, height, radius);\n      }\n    }]);\n    return Bar;\n  })();\n\n  var BARS_CLASS = 'bars';\n\n  var Bars = (function () {\n    function Bars(vis, selection, mode, visData) {\n      babelHelpers.classCallCheck(this, Bars);\n\n      var that = this;\n\n      this.vis = vis;\n      this.mode = mode;\n      this.visData = visData;\n\n      this.selection = selection.append('g').attr('class', BARS_CLASS);\n\n      this.selection.each(function (datum) {\n        new Bar(d3.select(this), datum.data.bars, datum, that.visData, that);\n      });\n    }\n\n    babelHelpers.createClass(Bars, [{\n      key: 'update',\n      value: function update(selection, sortBy) {\n        var _this = this;\n\n        selection.each(function () {\n          var el = d3.select(this);\n\n          if (el.classed('active')) {\n            el.classed('active', false);\n          } else {\n            el.classed('active', true);\n            // Ensure that the active bars we are places before any other bar,\n            // thus placing them in the background\n            this.parentNode.insertBefore(this, d3.select(this.parentNode).select('.bar').node());\n          }\n        });\n\n        selection.selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n          return Bar.generatePath(data, _this.mode, sortBy, _this.visData);\n        });\n      }\n    }, {\n      key: 'updateIndicator',\n      value: function updateIndicator(refBars, refBarsBg, currentBar, referenceValue) {\n        var _this2 = this;\n\n        Bar.updateIndicator(currentBar, this.visData.global.column.contentWidth * referenceValue, referenceValue);\n\n        Bar.updateIndicator(refBars, this.visData.global.column.contentWidth * referenceValue, referenceValue);\n\n        refBarsBg.attr('d', function (data) {\n          return Bar.generatePath(data, _this2.mode, undefined, _this2.visData, referenceValue);\n        }).classed('positive', function (data) {\n          return data.value >= referenceValue;\n        });\n\n        var transition = refBarsBg;\n\n        if (!this.vis.lessAnimations) {\n          transition = refBarsBg.transition().duration(TRANSITION_SEMI_FAST);\n        }\n\n        transition.attr('d', function (data) {\n          return Bar.generatePath(data, _this2.mode, undefined, _this2.visData, referenceValue, true);\n        });\n      }\n    }, {\n      key: 'switchMode',\n      value: function switchMode(mode, currentSorting) {\n        var _this3 = this;\n\n        if (this.mode !== mode) {\n          if (mode === 'one') {\n            if (currentSorting.global.type) {\n              this.selection.selectAll('.bar').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n                return Bar.generateOneBarPath(data, currentSorting.global.type, _this3.visData);\n              });\n            } else {\n              // console.error(\n              //   'Switching magnitude visualization after individual sorting is ' +\n              //   'not supported yet.'\n              // );\n            }\n          }\n\n          if (mode === 'two') {\n            this.selection.selectAll('.bar.precision').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n              return Bar.generateTwoBarsPath(data, _this3.visData);\n            });\n\n            this.selection.selectAll('.bar.recall').selectAll('.bar-magnitude').transition().duration(TRANSITION_SEMI_FAST).attr('d', function (data) {\n              return Bar.generateTwoBarsPath(data, _this3.visData, true);\n            });\n          }\n\n          this.mode = mode;\n        }\n      }\n    }]);\n    return Bars;\n  })();\n\n  var NODES_CLASS = 'nodes';\n  var NODE_CLASS = 'node';\n  var CLONE_CLASS = 'clone';\n\n  var Nodes = (function () {\n    function Nodes(vis, baseSelection, visData, links, events) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Nodes);\n\n      var that = this;\n\n      // Helper\n      function drawFullSizeRect(selection, className, shrinking) {\n        var shrinkingAmount = shrinking ? shrinking : 0;\n\n        selection.attr('x', shrinkingAmount).attr('y', that.visData.global.row.padding + shrinkingAmount).attr('width', that.visData.global.column.contentWidth - 2 * shrinkingAmount).attr('height', that.visData.global.row.contentHeight - 2 * shrinkingAmount).attr('rx', 2 - shrinkingAmount).attr('ry', 2 - shrinkingAmount).classed(className, true);\n      }\n\n      this.vis = vis;\n      this.visData = visData;\n      this.links = links;\n      this.events = events;\n      this.currentLinks = {};\n\n      this.groups = baseSelection.append('g').attr('class', NODES_CLASS).call(function (selection) {\n        selection.each(function storeLinkToGroupNode() {\n          d3.select(this.parentNode).datum().nodes = this;\n        });\n      });\n\n      this.nodes = this.groups.selectAll('.' + NODE_CLASS).data(function (data) {\n        return data.rows;\n      }).enter().append('g').classed(NODE_CLASS, true).classed(CLONE_CLASS, function (data) {\n        return data.clone;\n      }).attr('transform', function (data) {\n        return 'translate(' + (data.x + _this.visData.global.column.padding) + ', ' + data.y + ')';\n      });\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'bg-extension').attr('width', this.visData.global.column.padding + 5);\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'bg-border');\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'bg', 1);\n\n      // Rooting icons\n      var nodeRooted = this.nodes.append('g').attr('class', 'focus-controls root inactive').on('click', function clickHandler(data) {\n        that.rootHandler.call(that, this, data);\n      });\n\n      nodeRooted.append('circle').call(this.setUpFocusControls.bind(this), 'left', 'bg', 'bg');\n\n      nodeRooted.append('svg').call(this.setUpFocusControls.bind(this), 'left', 'icon', 'ease-all state-inactive invisible-default').append('use').attr('xlink:href', this.vis.iconPath + '#unlocked');\n\n      nodeRooted.append('svg').call(this.setUpFocusControls.bind(this), 'left', 'icon', 'ease-all state-active invisible-default').append('use').attr('xlink:href', this.vis.iconPath + '#locked');\n\n      var nodeLocks = this.nodes.append('g').attr('class', 'focus-controls lock inactive').on('click', function clickHandler(data) {\n        that.lockHandler.call(that, this, data);\n      });\n\n      nodeLocks.append('circle').call(this.setUpFocusControls.bind(this), 'right', 'bg', 'bg');\n\n      nodeLocks.append('svg').call(this.setUpFocusControls.bind(this), 'right', 'icon', 'ease-all state-inactive invisible-default').append('use').attr('xlink:href', this.vis.iconPath + '#unlocked');\n\n      nodeLocks.append('svg').call(this.setUpFocusControls.bind(this), 'right', 'icon', 'ease-all state-active invisible-default').append('use').attr('xlink:href', this.vis.iconPath + '#locked');\n\n      this.nodes.on('click', function clickHandler(data) {\n        that.clickHandler.call(that, this, data);\n      });\n\n      this.nodes.on('mouseenter', function mouseEnterHandler(data) {\n        if (!!!that.vis.activeScrollbar) {\n          that.enterHandler.call(that, this, data);\n        }\n      });\n\n      this.nodes.on('mouseleave', function mouseLeaveHandler(data) {\n        if (!!!that.vis.activeScrollbar) {\n          that.leaveHandler.call(that, this, data);\n        }\n      });\n\n      this.bars = new Bars(this.vis, this.nodes, this.vis.barMode, this.visData);\n\n      this.nodes.append('rect').call(drawFullSizeRect, 'border');\n\n      // Add node label\n      this.nodes.call(function (selection) {\n        selection.append('foreignObject').attr('x', _this.visData.global.cell.padding).attr('y', _this.visData.global.row.padding + _this.visData.global.cell.padding).attr('width', _this.visData.global.column.contentWidth).attr('height', _this.visData.global.row.contentHeight - _this.visData.global.cell.padding * 2).attr('class', 'label-wrapper').append('xhtml:div').attr('class', 'label').attr('title', function (data) {\n          return data.data.name;\n        }).style('line-height', _this.visData.global.row.contentHeight - _this.visData.global.cell.padding * 2 + 'px').append('xhtml:span').text(function (data) {\n          return data.data.name;\n        });\n      });\n\n      if (isFunction(this.events.on)) {\n        // this.events.on('d3ListGraphNodeClick', dataSetIds => {\n        //   console.log('d3ListGraphNodeClick', dataSetIds);\n        // });\n\n        this.events.on('d3ListGraphFocusNodes', function (event) {\n          return _this.focusNodes(event);\n        });\n\n        this.events.on('d3ListGraphBlurNodes', function (event) {\n          return _this.blurNodes(event);\n        });\n\n        this.events.on('d3ListGraphNodeEnter', function (nodeIds) {\n          return _this.eventHelper(nodeIds, _this.highlightNodes);\n        });\n\n        this.events.on('d3ListGraphNodeLeave', function (nodeIds) {\n          return _this.eventHelper(nodeIds, _this.unhighlightNodes);\n        });\n\n        this.events.on('d3ListGraphNodeLock', function (nodeIds) {\n          return _this.eventHelper(nodeIds, _this.toggleLock, [], '.lock');\n        });\n\n        this.events.on('d3ListGraphNodeUnlock', function (nodeIds) {\n          return _this.eventHelper(nodeIds, _this.toggleLock, [true], '.lock');\n        });\n\n        this.events.on('d3ListGraphNodeRoot', function (nodeIds) {\n          return _this.eventHelper(nodeIds, _this.toggleRoot, [], '.root');\n        });\n\n        this.events.on('d3ListGraphNodeUnroot', function (nodeIds) {\n          return _this.eventHelper(nodeIds, _this.toggleRoot, [true], '.root');\n        });\n      }\n    }\n\n    babelHelpers.createClass(Nodes, [{\n      key: 'clickHandler',\n      value: function clickHandler(el, data) {\n        this.events.broadcast('d3ListGraphNodeClick', { id: data.id });\n      }\n    }, {\n      key: 'enterHandler',\n      value: function enterHandler(el, data) {\n        this.highlightNodes(el, data);\n        this.events.broadcast('d3ListGraphNodeEnter', { id: data.id });\n      }\n    }, {\n      key: 'leaveHandler',\n      value: function leaveHandler(el, data) {\n        this.unhighlightNodes(el, data);\n        this.events.broadcast('d3ListGraphNodeLeave', { id: data.id });\n      }\n    }, {\n      key: 'lockHandler',\n      value: function lockHandler(el) {\n        var events = this.toggleLock(el);\n\n        if (events.locked) {\n          this.events.broadcast('d3ListGraphNodeLock', { id: events.locked });\n        }\n        if (events.unlocked) {\n          this.events.broadcast('d3ListGraphNodeUnlock', { id: events.unlocked });\n        }\n      }\n    }, {\n      key: 'rootHandler',\n      value: function rootHandler(el) {\n        var events = this.toggleRoot(el);\n\n        if (events.rooted) {\n          this.events.broadcast('d3ListGraphNodeRoot', { id: events.rooted });\n        }\n        if (events.unrooted) {\n          this.events.broadcast('d3ListGraphNodeUnroot', { id: events.unrooted });\n        }\n      }\n    }, {\n      key: 'focusNodes',\n      value: function focusNodes(event) {\n        this.eventHelper(event.nodeIds, this.highlightNodes, ['focus', 'directParentsOnly', true]);\n        if (event.zoomOut) {\n          this.vis.globalView();\n        }\n      }\n    }, {\n      key: 'blurNodes',\n      value: function blurNodes(event) {\n        this.eventHelper(event.nodeIds, this.unhighlightNodes, ['focus', 'directParentsOnly', true]);\n        if (event.zoomIn) {\n          this.vis.zoomedView();\n        }\n      }\n    }, {\n      key: 'eventHelper',\n      value: function eventHelper(nodeIds, callback, optionalParams, subSelectionClass) {\n        var that = this;\n\n        this.nodes\n        // Filter by node ID\n        .filter(function (data) {\n          return !! ~nodeIds.indexOf(data.id);\n        }).each(function triggerCallback(data) {\n          var el = this;\n\n          if (subSelectionClass) {\n            el = d3.select(this).select(subSelectionClass).node();\n          }\n\n          callback.apply(that, [el, data].concat(optionalParams ? optionalParams : []));\n        });\n      }\n    }, {\n      key: 'toggleLock',\n      value: function toggleLock(el, nodeData, setFalse) {\n        var d3El = d3.select(el);\n        var data = d3El.datum();\n        var events = { locked: false, unlocked: false };\n\n        if (this.lockedNode) {\n          if (this.lockedNode.datum().id === data.id) {\n            this.lockedNode.classed({ active: false, inactive: true });\n            this.unlockNode(this.lockedNode.datum().id);\n            events.unlocked = this.lockedNode.datum().id;\n            this.lockedNode = undefined;\n          } else {\n            // Reset previously locked node;\n            this.lockedNode.classed({ active: false, inactive: true });\n            this.unlockNode(this.lockedNode.datum().id);\n            events.unlocked = this.lockedNode.datum().id;\n\n            if (!setFalse) {\n              d3El.classed({ active: true, inactive: false });\n              this.lockNode(data.id);\n              events.locked = data.id;\n              this.lockedNode = d3El;\n            }\n          }\n        } else {\n          if (!setFalse) {\n            d3El.classed({ active: true, inactive: false });\n            this.lockNode(data.id);\n            events.locked = data.id;\n            this.lockedNode = d3El;\n          }\n        }\n\n        return events;\n      }\n    }, {\n      key: 'lockNode',\n      value: function lockNode(id) {\n        var that = this;\n        var els = this.nodes.filter(function (data) {\n          return data.id === id;\n        });\n\n        els.each(function triggerHighlighter(data) {\n          that.highlightNodes(this, data, 'lock', undefined);\n        });\n\n        els.selectAll('.bg-border').transition().duration(TRANSITION_SEMI_FAST).attr('width', function width() {\n          return parseInt(d3.select(this).attr('width'), 10) + that.visData.global.row.height / 2;\n        });\n      }\n    }, {\n      key: 'unlockNode',\n      value: function unlockNode(id) {\n        var that = this;\n        var els = this.nodes.filter(function (data) {\n          return data.id === id;\n        });\n        var start = function animationStart() {\n          d3.select(this.parentNode).classed('animating', true);\n        };\n        var end = function animationEnd() {\n          d3.select(this.parentNode).classed('animating', false);\n        };\n\n        els.selectAll('.bg-border').transition().duration(TRANSITION_SEMI_FAST).attr('width', this.visData.global.column.contentWidth).each('start', start).each('end', end);\n\n        els.each(function (data) {\n          that.unhighlightNodes(this, data, 'lock', undefined);\n        });\n      }\n    }, {\n      key: 'toggleRoot',\n      value: function toggleRoot(el, nodeData, setFalse) {\n        var d3El = d3.select(el);\n        var data = d3El.datum();\n        var events = { rooted: false, unrooted: false };\n\n        if (this.rootedNode) {\n          // Reset current root node\n          this.rootedNode.classed({ active: false, inactive: true });\n          this.unrootNode(this.rootedNode.datum().id);\n          events.unrooted = this.rootedNode.datum().id;\n\n          // Activate new root\n          if (this.rootedNode.datum().id !== data.id && !setFalse) {\n            d3El.classed({ active: true, inactive: false });\n            this.rootNode(data.id);\n            this.rootedNode = d3El;\n            events.rooted = data.id;\n          } else {\n            this.rootedNode = undefined;\n          }\n        } else {\n          if (!setFalse) {\n            d3El.classed({ active: true, inactive: false });\n            this.rootNode(data.id);\n            events.rooted = data.id;\n            this.rootedNode = d3El;\n          }\n        }\n\n        return events;\n      }\n    }, {\n      key: 'rootNode',\n      value: function rootNode(id) {\n        var that = this;\n        var els = this.nodes.filter(function (data) {\n          return data.id === id;\n        });\n\n        els.each(function (data) {\n          data.rooted = true;\n          d3.select(this).classed('rooted', true);\n          that.hideNodes.call(that, this, data, 'downStream');\n        });\n\n        els.selectAll('.bg-extension').transition().duration(TRANSITION_SEMI_FAST).attr('x', -that.visData.global.row.height / 2);\n      }\n    }, {\n      key: 'unrootNode',\n      value: function unrootNode(id) {\n        var that = this;\n        var els = this.nodes.filter(function (data) {\n          return data.id === id;\n        });\n        var start = function start() {\n          d3.select(this.parentNode).classed('animating', true);\n        };\n        var end = function end() {\n          d3.select(this.parentNode).classed('animating', false);\n        };\n\n        els.selectAll('.bg-extension').transition().duration(TRANSITION_SEMI_FAST).attr('x', 0).each('start', start).each('end', end);\n\n        els.each(function (data) {\n          data.rooted = false;\n          d3.select(this).classed('rooted', false);\n          that.showNodes.call(that, this, data, 'downStream');\n        });\n      }\n    }, {\n      key: 'setUpFocusControls',\n      value: function setUpFocusControls(selection, location, mode, className) {\n        var height = this.visData.global.row.contentHeight / 2 - this.visData.global.cell.padding * 2;\n        var x = location === 'left' ? -height - 2 : this.visData.global.column.contentWidth + 2;\n        var y = this.visData.global.row.padding + (this.visData.global.row.contentHeight - 2 * this.visData.global.cell.padding) / 4;\n\n        if (mode === 'bg') {\n          selection.attr({\n            class: className,\n            cx: x + height / 2,\n            cy: y + height / 2,\n            r: height * 3 / 4\n          });\n        } else {\n          selection.attr({\n            class: className,\n            x: x,\n            y: y,\n            width: height,\n            height: height\n          });\n        }\n      }\n    }, {\n      key: 'hideNodes',\n      value: function hideNodes(el, data, direction) {\n        return this.nodesVisibility(el, data, direction);\n      }\n    }, {\n      key: 'showNodes',\n      value: function showNodes(el, data, direction) {\n        return this.nodesVisibility(el, data, direction, true);\n      }\n    }, {\n      key: 'nodesVisibility',\n      value: function nodesVisibility(el, data, direction, show) {\n        if (show) {\n          this.nodes.classed('hidden', false).each(function (nodeData) {\n            return nodeData.hidden = false;\n          });\n        } else {\n          // First we set all nodes to `hidden`.\n          this.nodes.each(function (nodeData) {\n            return nodeData.hidden = true;\n          });\n\n          // Then we set direct child and parent nodes of the current node visible.\n          upAndDown(data, function (nodeData) {\n            return nodeData.hidden = false;\n          });\n\n          // We also show sibling nodes.\n          siblings(data, function (nodeData) {\n            return nodeData.hidden = false;\n          });\n\n          this.nodes.classed('hidden', function (nodeData) {\n            return nodeData.hidden;\n          });\n        }\n        this.updateVisibility();\n      }\n    }, {\n      key: 'highlightNodes',\n      value: function highlightNodes(el, data, className, restriction) {\n        var _this2 = this;\n\n        var that = this;\n        var nodeId = data.id;\n        var currentNodeData = data;\n        var includeClones = true;\n        var includeParents = true;\n        var includeChildren = true;\n\n        var appliedClassName = className ? className : 'hovering';\n\n        if (restriction === 'directParentsOnly') {\n          includeClones = false;\n          includeChildren = false;\n        }\n\n        // Store link IDs\n        if (!this.currentLinks[appliedClassName]) {\n          this.currentLinks[appliedClassName] = {};\n        }\n        this.currentLinks[appliedClassName][nodeId] = [];\n\n        var currentActiveProperty = d3.select(el).selectAll('.bar.active .bar-magnitude').datum();\n\n        var traverseCallbackUp = function traverseCallbackUp(nodeData, childData) {\n          nodeData.hovering = 2;\n          for (var i = nodeData.links.length; i--;) {\n            // Only push direct parent child connections. E.g.\n            // Store: (parent)->(child)\n            // Ignore: (parent)->(siblings of child)\n            if (nodeData.links[i].target.node.id === childData.id) {\n              _this2.currentLinks[appliedClassName][nodeId].push(nodeData.links[i].id);\n            }\n          }\n        };\n\n        var traverseCallbackDown = function traverseCallbackDown(nodeData) {\n          nodeData.hovering = 2;\n          for (var i = nodeData.links.length; i--;) {\n            _this2.currentLinks[appliedClassName][nodeId].push(nodeData.links[i].id);\n          }\n        };\n\n        if (includeParents && includeChildren) {\n          upAndDown(data, traverseCallbackUp, traverseCallbackDown, undefined, includeClones);\n        }\n        if (includeParents && !includeChildren) {\n          up(data, traverseCallbackUp, undefined, includeClones);\n        }\n        if (!includeParents && includeChildren) {\n          down(data, traverseCallbackUp, undefined, includeClones);\n        }\n\n        if (data.clone) {\n          data.originalNode.hovering = 1;\n        }\n\n        data.hovering = 1;\n\n        this.nodes.each(function (nodeData) {\n          var node = d3.select(this);\n\n          if (nodeData.hovering === 1) {\n            node.classed(appliedClassName + '-directly', true);\n          } else if (nodeData.hovering === 2) {\n            node.classed(appliedClassName + '-indirectly', true);\n            node.selectAll('.bar.' + currentActiveProperty.id).classed('copy', function (barData) {\n              var id = barData.id;\n\n              if (barData.clone) {\n                id = barData.originalNode.id;\n              }\n\n              if (id !== currentNodeData.id) {\n                return true;\n              }\n            });\n\n            var currentBar = d3.select(el).selectAll('.bar.' + currentActiveProperty.id).classed('reference', true);\n\n            that.bars.updateIndicator(node.selectAll('.bar.copy .bar-indicator'), node.selectAll('.bar.copy .bar-indicator-bg'), currentBar.selectAll('.bar-indicator'), currentActiveProperty.value);\n          }\n        });\n\n        this.links.highlight(arrayToFakeObjs(this.currentLinks[appliedClassName][data.id]), true, appliedClassName);\n      }\n    }, {\n      key: 'unhighlightNodes',\n      value: function unhighlightNodes(el, data, className, restriction) {\n        var traverseCallback = function traverseCallback(nodeData) {\n          return nodeData.hovering = 0;\n        };\n        var includeParents = true;\n        var appliedClassName = className ? className : 'hovering';\n\n        var includeClones = true;\n        var includeChildren = true;\n\n        if (restriction === 'directParentsOnly') {\n          includeClones = false;\n          includeChildren = false;\n        }\n\n        data.hovering = 0;\n        if (includeParents && includeChildren) {\n          upAndDown(data, traverseCallback, undefined, undefined, includeClones);\n        }\n        if (includeParents && !includeChildren) {\n          up(data, traverseCallback, undefined, includeClones);\n        }\n        if (!includeParents && includeChildren) {\n          down(data, traverseCallback, undefined, includeClones);\n        }\n\n        if (data.clone) {\n          data.originalNode.hovering = 0;\n        }\n\n        this.nodes.classed(appliedClassName + '-directly', false);\n        this.nodes.classed(appliedClassName + '-indirectly', false);\n\n        if (this.currentLinks[appliedClassName]) {\n          this.links.highlight(arrayToFakeObjs(this.currentLinks[appliedClassName][data.id]), false, appliedClassName);\n        }\n      }\n    }, {\n      key: 'sort',\n      value: function sort(update, newSortType) {\n        var _this3 = this;\n\n        var start = function start() {\n          d3.select(this).classed('sorting', true);\n        };\n        var end = function end() {\n          d3.select(this).classed('sorting', false);\n        };\n\n        for (var i = update.length; i--;) {\n          var selection = this.nodes.data(update[i].rows, function (data) {\n            return data.id;\n          });\n\n          selection.transition().duration(TRANSITION_SEMI_FAST).attr('transform', function (data) {\n            return 'translate(' + (data.x + _this3.visData.global.column.padding) + ', ' + data.y + ')';\n          }).each('start', start).each('end', end);\n\n          if (newSortType) {\n            this.bars.update(selection.selectAll('.bar'), update[i].sortBy);\n          }\n        }\n      }\n    }, {\n      key: 'updateVisibility',\n      value: function updateVisibility() {\n        var _this4 = this;\n\n        this.vis.layout.updateNodesVisibility();\n\n        var completed = function completed(transition, callback) {\n          if (transition.size() === 0) {\n            callback();\n          }\n          var n = 0;\n          transition.each(function () {\n            return ++n;\n          }).each('end', function () {\n            if (! --n) callback.apply(this, arguments);\n          });\n        };\n\n        this.nodes.transition().duration(TRANSITION_SEMI_FAST).attr('transform', function (data) {\n          return 'translate(' + (data.x + _this4.visData.global.column.padding) + ', ' + data.y + ')';\n        }).call(completed, function () {\n          return _this4.vis.updateScrollbarVisibility();\n        });\n\n        this.vis.links.updateVisibility();\n      }\n    }, {\n      key: 'barMode',\n      get: function get() {\n        return this.bars.mode;\n      }\n    }]);\n    return Nodes;\n  })();\n\n  var LINKS_CLASS = 'links';\n  var LINK_CLASS = 'link';\n\n  var Links = (function () {\n    function Links(levels, visData, layout) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Links);\n\n      this.visData = visData;\n      this.layout = layout;\n\n      this.groups = levels.append('g').attr('class', LINKS_CLASS).call(function (selection) {\n        selection.each(function () {\n          d3.select(this.parentNode).datum().links = this;\n        });\n      });\n\n      this.links = this.groups.selectAll(LINK_CLASS + '-bg').data(function (data, index) {\n        return _this.layout.links(index);\n      }).enter().append('g').attr('class', LINK_CLASS);\n\n      this.links.append('path').attr({\n        class: LINK_CLASS + '-bg',\n        d: this.diagonal\n      });\n\n      this.links.append('path').attr({\n        class: LINK_CLASS + '-direct',\n        d: this.diagonal\n      });\n    }\n\n    babelHelpers.createClass(Links, [{\n      key: 'highlight',\n      value: function highlight(nodeIds, _highlight, className) {\n        this.links.data(nodeIds, function (data) {\n          return data.id;\n        }).classed(className ? className : 'hovering', _highlight === false ? false : true);\n      }\n    }, {\n      key: 'scroll',\n      value: function scroll(selection, data) {\n        // Update data of `g`.\n        selection.data(data);\n\n        // Next update all paths according to the new data.\n        selection.selectAll('path').attr('d', this.diagonal);\n      }\n    }, {\n      key: 'sort',\n      value: function sort(update) {\n        var start = function start() {\n          d3.select(this).classed('sorting', true);\n        };\n        var end = function end() {\n          d3.select(this).classed('sorting', false);\n        };\n\n        // Update data of `g`.\n        this.links.data(update, function (data) {\n          return data.id;\n        });\n\n        // Next update all paths according to the new data.\n        this.links.selectAll('path').transition().duration(TRANSITION_SEMI_FAST).attr('d', this.diagonal).each('start', start).each('end', end);\n      }\n    }, {\n      key: 'updateVisibility',\n      value: function updateVisibility() {\n        this.links.selectAll('path').classed('hidden', function (data) {\n          return data.target.node.hidden || data.source.node.hidden;\n        }).transition().duration(TRANSITION_SEMI_FAST).attr('d', this.diagonal);\n      }\n    }, {\n      key: 'diagonal',\n      get: function get() {\n        var _this2 = this;\n\n        return d3.svg.diagonal().source(function (data) {\n          return {\n            x: data.source.node.y + data.source.offsetY + _this2.visData.global.row.height / 2,\n            y: data.source.node.x + data.source.offsetX + _this2.visData.global.column.contentWidth + _this2.visData.global.column.padding\n          };\n        }).target(function (data) {\n          return {\n            x: data.target.node.y + data.target.offsetY + _this2.visData.global.row.height / 2,\n            y: data.target.node.x + data.target.offsetX + _this2.visData.global.column.padding\n          };\n        }).projection(function (data) {\n          return [data.y, data.x];\n        });\n      }\n    }]);\n    return Links;\n  })();\n\n  var COLUMN_CLASS = 'column';\n  var SCROLL_CONTAINER_CLASS = 'scroll-container';\n\n  var Levels = (function () {\n    function Levels(selection, visData) {\n      babelHelpers.classCallCheck(this, Levels);\n\n      this.visData = visData;\n      this.groups = selection.selectAll('g').data(this.visData.nodes).enter().append('g').attr('class', COLUMN_CLASS);\n\n      // We need to add an empty rectangle that fills up the whole column to ensure\n      // that the `g`'s size is at a maximum, otherwise scrolling will be halted\n      // when the cursor leaves an actually drawn element.\n      this.groups.append('rect').attr('class', SCROLL_CONTAINER_CLASS).attr('x', function (data) {\n        return data.x;\n      }).attr('y', function (data) {\n        return data.y;\n      }).attr('width', this.visData.global.column.width).attr('height', this.visData.global.column.height);\n    }\n\n    babelHelpers.createClass(Levels, [{\n      key: 'scrollPreparation',\n      value: function scrollPreparation(vis, scrollbarWidth) {\n        var _this = this;\n\n        this.groups.each(function (data, index) {\n          var contentHeight = data.nodes.getBoundingClientRect().height + 2 * _this.visData.global.row.padding;\n          var scrollHeight = contentHeight - _this.visData.global.column.height;\n          var scrollbarHeight = scrollHeight > 0 ? Math.max(_this.visData.global.column.height * _this.visData.global.column.height / contentHeight, 10) : 0;\n\n          data.height = contentHeight;\n          data.linkSelections = {\n            incoming: index > 0 ? vis.selectByLevel(index - 1, '.link') : null,\n            outgoing: vis.selectByLevel(index, '.link')\n          };\n          data.scrollHeight = scrollHeight;\n          data.scrollTop = 0;\n          data.scrollbar = {\n            el: undefined,\n            x: data.x + _this.visData.global.column.width - scrollbarWidth,\n            y: 0,\n            width: scrollbarWidth,\n            height: scrollbarHeight,\n            scrollHeight: _this.visData.global.column.height - scrollbarHeight,\n            scrollTop: 0,\n            heightScale: d3.scale.linear().domain([0, scrollHeight]).range([0, _this.visData.global.column.height - scrollbarHeight])\n          };\n          data.invertedHeightScale = data.scrollbar.heightScale.invert;\n        });\n      }\n    }, {\n      key: 'updateScrollProperties',\n      value: function updateScrollProperties() {\n        var _this2 = this;\n\n        this.groups.each(function (data) {\n          var contentHeight = data.nodes.getBoundingClientRect().height + 2 * _this2.visData.global.row.padding;\n          var scrollHeight = contentHeight - _this2.visData.global.column.height;\n          var scrollbarHeight = scrollHeight > 0 ? Math.max(_this2.visData.global.column.height * _this2.visData.global.column.height / contentHeight, 10) : 0;\n\n          data.height = contentHeight;\n          data.scrollHeight = scrollHeight;\n          data.scrollTop = 0;\n          data.scrollbar.y = 0;\n          data.scrollbar.height = scrollbarHeight;\n          data.scrollbar.scrollHeight = _this2.visData.global.column.height - scrollbarHeight;\n          data.scrollbar.scrollTop = 0;\n          data.scrollbar.heightScale = d3.scale.linear().domain([0, scrollHeight]).range([0, _this2.visData.global.column.height - scrollbarHeight]);\n        });\n      }\n    }, {\n      key: 'height',\n      get: function get() {\n        return this.visData.global.column.height;\n      }\n    }]);\n    return Levels;\n  })();\n\n  var TOPBAR_EL = 'div';\n  var TOPBAR_CLASS = 'top-bar';\n\n  var TOPBAR_CONTROL_EL = 'ul';\n  var TOPBAR_CONTROL_CLASS = 'controls';\n  var TOPBAR_GLOBAL_CONTROL_CLASS = 'global-controls';\n\n  var Topbar = (function () {\n    function Topbar(vis, selection, visData) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, Topbar);\n\n      var that = this;\n\n      this.vis = vis;\n      this.visData = visData;\n      // Add base topbar element\n      this.el = selection.select('.' + TOPBAR_CLASS);\n\n      if (this.el.empty()) {\n        this.el = selection.insert(TOPBAR_EL, ':first-child').attr('class', TOPBAR_CLASS);\n      }\n\n      this.controlSwitch = this.el.append('div').attr('title', 'Toggle global / local topbar').style('width', this.visData.global.column.padding + 'px').classed('control-switch', true).on('click', this.switch.bind(this));\n\n      this.switchArrow = this.controlSwitch.append('svg').append('use').attr('xlink:href', this.vis.iconPath + '#arrow-down').attr('class', 'switch-arrow');\n\n      this.globalControls = this.el.append(TOPBAR_CONTROL_EL).classed(TOPBAR_GLOBAL_CONTROL_CLASS, true);\n\n      // Add button for sorting by precision\n      this.globalPrecision = this.globalControls.append('li').attr('class', 'control-btn sort-precision').classed('active', function () {\n        if (that.vis.currentSorting.global.type === 'precision') {\n          // Save currently active element. Needed when when re-sorting for the\n          // first time, to be able to de-highlight this element.\n          that.vis.currentSorting.global.el = d3.select(this);\n          return true;\n        }\n      }).on('click', function () {\n        that.sortAllColumns(this, 'precision');\n      }).on('mouseenter', function () {\n        return _this.highlightBars(undefined, 'precision');\n      }).on('mouseleave', function () {\n        return _this.highlightBars(undefined, 'precision', true);\n      });\n\n      this.globalPrecisionWrapper = this.globalPrecision.append('div').attr('class', 'wrapper').text('Precision').style('margin', '0 ' + this.visData.global.column.padding + 'px');\n\n      this.globalPrecisionWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'precision').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n      this.globalPrecisionWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'precision' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-asc');\n\n      this.globalPrecisionWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'precision' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-desc');\n\n      // Add button for sorting by recall\n      this.globalRecall = this.globalControls.append('li').attr('class', 'control-btn sort-recall').classed('active', function () {\n        if (that.vis.currentSorting.global.type === 'recall') {\n          // See precision\n          that.vis.currentSorting.global.el = d3.select(this);\n          return true;\n        }\n      }).on('click', function () {\n        that.sortAllColumns(this, 'recall');\n      }).on('mouseenter', function () {\n        return _this.highlightBars(undefined, 'recall');\n      }).on('mouseleave', function () {\n        return _this.highlightBars(undefined, 'recall', true);\n      });\n\n      this.globalRecallWrapper = this.globalRecall.append('div').attr('class', 'wrapper').text('Recall').style('margin', '0 ' + this.visData.global.column.padding + 'px');\n\n      this.globalRecallWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'recall').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n      this.globalRecallWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'recall' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-asc');\n\n      this.globalRecallWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'recall' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-desc');\n\n      // Add button for sorting by name\n      this.globalName = this.globalControls.append('li').attr('class', 'control-btn sort-name').classed('active', function () {\n        if (that.vis.currentSorting.global.type === 'name') {\n          // See precision\n          that.vis.currentSorting.global.el = d3.select(this);\n          return true;\n        }\n      }).on('click', function () {\n        that.sortAllColumns(this, 'name');\n      }).on('mouseenter', function () {\n        return _this.highlightLabels();\n      }).on('mouseleave', function () {\n        return _this.highlightLabels(true);\n      });\n\n      this.globalNameWrapper = this.globalName.append('div').attr('class', 'wrapper').text('Name').style('margin', '0 ' + this.visData.global.column.padding + 'px');\n\n      this.globalNameWrapper.append('svg').attr('class', 'icon-unsort invisible-default').classed('visible', this.vis.currentSorting.global.type !== 'name').append('use').attr('xlink:href', this.vis.iconPath + '#unsort');\n\n      this.globalNameWrapper.append('svg').attr('class', 'icon-sort-asc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'name' && this.vis.currentSorting.global.order === 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-alpha-asc');\n\n      this.globalNameWrapper.append('svg').attr('class', 'icon-sort-desc invisible-default').classed('visible', this.vis.currentSorting.global.type === 'name' && this.vis.currentSorting.global.order !== 1).append('use').attr('xlink:href', this.vis.iconPath + '#sort-alpha-desc');\n\n      // Add button for switching to 'one bar'\n      this.globalOneBar = this.globalControls.append('li').attr('class', 'control-btn one-bar').classed('active', this.vis.barMode === 'one').on('click', function () {\n        that.switchBarMode(this, 'one');\n      });\n\n      this.globalOneBarWrapper = this.globalOneBar.append('div').attr('class', 'wrapper').text('One bar').style('margin', '0 ' + this.visData.global.column.padding + 'px');\n\n      this.globalOneBarWrapper.append('svg').attr('class', 'icon-one-bar').append('use').attr('xlink:href', this.vis.iconPath + '#one-bar');\n\n      // Add button for switching to 'two bars'\n      this.globalTwoBars = this.globalControls.append('li').attr('class', 'control-btn two-bars').classed('active', this.vis.barMode === 'two').on('click', function () {\n        that.switchBarMode(this, 'two');\n      });\n\n      this.globalTwoBarsWrapper = this.globalTwoBars.append('div').attr('class', 'wrapper').text('Two bars').style('margin', '0 ' + this.visData.global.column.padding + 'px');\n\n      this.globalTwoBarsWrapper.append('svg').attr('class', 'icon-two-bars').append('use').attr('xlink:href', this.vis.iconPath + '#two-bars');\n\n      this.localControlWrapper = this.el.append('div').classed('local-controls', true);\n\n      this.localControls = this.localControlWrapper.selectAll(TOPBAR_CONTROL_CLASS).data(visData.nodes).enter().append(TOPBAR_CONTROL_EL).classed(TOPBAR_CONTROL_CLASS, true).style('width', this.visData.global.column.width + 'px');\n\n      this.localControls.each(function (data, index) {\n        var control = d3.select(this);\n\n        /*\n         * Order:\n         * 0 = unsorted\n         * 1 = asc\n         * -1 = desc\n         */\n        that.vis.currentSorting.local[index] = {\n          type: data.sortBy,\n          order: data.sortOrder,\n          el: undefined\n        };\n\n        control.append('li').attr('class', 'control-btn toggle').style('width', that.visData.global.column.padding + 'px').on('click', that.toggleColumn);\n\n        control.append('li').attr('class', 'control-btn sort-precision ease-all').style({\n          width: that.visData.global.column.contentWidth / 2 + 'px',\n          left: that.visData.global.column.padding + 'px'\n        }).on('click', function (controlData) {\n          that.sortColumn(this, controlData.level, 'precision');\n        }).on('mouseenter', function () {\n          that.highlightBars(this.parentNode, 'precision');\n          d3.select(this).style('width', that.visData.global.column.contentWidth - 16 + 'px');\n        }).on('mouseleave', function () {\n          that.highlightBars(this.parentNode, 'precision', true);\n          d3.select(this).style('width', that.visData.global.column.contentWidth / 2 + 'px');\n        }).html('<div class=\"expandable-label\">' + '  <span class=\"letter abbr\">P</span>' + '  <span class=\"letter abbr\">r</span>' + '  <span class=\"letter\">e</span>' + '  <span class=\"letter abbr\">c</span>' + '  <span class=\"letter\">i</span>' + '  <span class=\"letter\">s</span>' + '  <span class=\"letter\">i</span>' + '  <span class=\"letter\">o</span>' + '  <span class=\"letter\">n</span>' + '</div>' + '<svg class=\"icon-unsort invisible-default ' + (that.vis.currentSorting.local[index].type !== 'precision' ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#unsort\"></use>' + '</svg>' + '<svg class=\"icon-sort-asc invisible-default ' + (that.vis.currentSorting.local[index].type === 'precision' && that.vis.currentSorting.local[index].order === 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#sort-asc\"></use>' + '</svg>' + '<svg class=\"icon-sort-desc invisible-default ' + (that.vis.currentSorting.local[index].type === 'precision' && that.vis.currentSorting.local[index].order !== 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#sort-desc\"></use>' + '</svg>');\n\n        control.append('li').attr('class', 'control-btn sort-recall ease-all').style({\n          width: that.visData.global.column.contentWidth / 2 + 'px',\n          left: that.visData.global.column.contentWidth / 2 + that.visData.global.column.padding + 'px'\n        }).on('click', function (controlData) {\n          that.sortColumn(this, controlData.level, 'recall');\n        }).on('mouseenter', function () {\n          that.highlightBars(this.parentNode, 'recall');\n          d3.select(this).style({\n            width: that.visData.global.column.contentWidth - 16 + 'px',\n            left: that.visData.global.column.padding + 16 + 'px'\n          });\n        }).on('mouseleave', function () {\n          that.highlightBars(this.parentNode, 'recall', true);\n          d3.select(this).style({\n            width: that.visData.global.column.contentWidth / 2 + 'px',\n            left: that.visData.global.column.contentWidth / 2 + that.visData.global.column.padding + 'px'\n          });\n        }).html('<div class=\"expandable-label\">' + '  <span class=\"letter abbr\">R</span>' + '  <span class=\"letter\">e</span>' + '  <span class=\"letter abbr\">c</span>' + '  <span class=\"letter\">a</span>' + '  <span class=\"letter abbr\">l</span>' + '  <span class=\"letter\">l</span>' + '</div>' + '<svg class=\"icon-unsort invisible-default ' + (that.vis.currentSorting.local[index].type !== 'recall' ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#unsort\"></use>' + '</svg>' + '<svg class=\"icon-sort-asc invisible-default ' + (that.vis.currentSorting.local[index].type === 'recall' && that.vis.currentSorting.local[index].order === 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#sort-asc\"></use>' + '</svg>' + '<svg class=\"icon-sort-desc invisible-default ' + (that.vis.currentSorting.local[index].type === 'recall' && that.vis.currentSorting.local[index].order !== 1 ? 'visible' : '') + '\">' + // eslint-disable-line\n        '  <use xlink:href=\"' + that.vis.iconPath + '#sort-desc\"></use>' + '</svg>');\n\n        control.append('li').attr('class', 'control-btn options').style('width', that.visData.global.column.padding + 'px').on('click', that.toggleOptions).html('<svg class=\"icon-gear\">' + '  <use xlink:href=\"' + that.vis.iconPath + '#gear\"></use>' + '</svg>');\n\n        if (that.vis.currentSorting.local[index].type) {\n          that.vis.currentSorting.local[index].el = control.select('.sort-' + that.vis.currentSorting.local[index].type);\n        }\n      });\n    }\n\n    // toggleColumn () {\n    //   console.log('Toggle column');\n    // }\n\n    babelHelpers.createClass(Topbar, [{\n      key: 'selectNodesLevel',\n      value: function selectNodesLevel(el) {\n        return this.vis.selectByLevel(d3.select(el).datum().depth, '.node');\n      }\n    }, {\n      key: 'highlightLabels',\n      value: function highlightLabels(deHighlight) {\n        this.vis.baseElD3.selectAll('.node').classed('highlight-label', !deHighlight);\n      }\n    }, {\n      key: 'highlightBars',\n      value: function highlightBars(el, type, deHighlight) {\n        var nodes = el ? this.selectNodesLevel(el) : this.vis.baseElD3.selectAll('.node');\n\n        nodes.classed('highlight-bar', !deHighlight).selectAll('.bar.' + type).classed('highlight', !deHighlight);\n      }\n    }, {\n      key: 'sortAllColumns',\n      value: function sortAllColumns(el, type) {\n        if (this.vis.currentSorting.global.type !== type) {\n          // Unset class of previous global sorting element\n          if (this.vis.currentSorting.global.el) {\n            this.resetSortEl(this.vis.currentSorting.global.el);\n          }\n        }\n\n        this.vis.currentSorting.global.el = d3.select(el);\n        this.vis.currentSorting.global.el.classed('active', true);\n        this.vis.currentSorting.global.type = type;\n\n        var columnKeys = Object.keys(this.vis.currentSorting.local);\n        for (var i = 0, len = columnKeys.length; i < len; i++) {\n          this.sortColumn(el, columnKeys[i], type, true);\n        }\n      }\n    }, {\n      key: 'sortColumn',\n      value: function sortColumn(el, index, type, global) {\n        // Reset global sorting\n        if (!global) {\n          this.vis.currentSorting.global.type = undefined;\n          this.resetSortEl(this.vis.currentSorting.global.el);\n        }\n\n        var newSortType = false;\n\n        if (this.vis.currentSorting.local[index].el) {\n          if (this.vis.currentSorting.local[index].type !== type) {\n            this.resetSortEl(this.vis.currentSorting.local[index].el);\n          }\n        }\n\n        if (this.vis.currentSorting.local[index].type !== type) {\n          newSortType = true;\n          // Reset sort order\n          this.vis.currentSorting.local[index].order = 0;\n        }\n\n        this.vis.currentSorting.local[index].el = d3.select(el);\n        this.vis.currentSorting.local[index].type = type;\n\n        // -1 = desc, 1 = asc\n        if (this.vis.currentSorting.local[index].order === -1) {\n          this.vis.currentSorting.local[index].order = 1;\n          this.vis.currentSorting.local[index].el.select('.icon-sort-desc').classed('visible', false);\n          this.vis.currentSorting.local[index].el.select('.icon-sort-asc').classed('visible', true);\n        } else {\n          this.vis.currentSorting.local[index].order = -1;\n          this.vis.currentSorting.local[index].el.select('.icon-sort-asc').classed('visible', false);\n          this.vis.currentSorting.local[index].el.select('.icon-sort-desc').classed('visible', true);\n        }\n\n        this.vis.currentSorting.local[index].el.select('.icon-unsort').classed('visible', false);\n\n        this.vis.sortColumn(index, type, this.vis.currentSorting.local[index].order, newSortType);\n      }\n    }, {\n      key: 'resetSortEl',\n      value: function resetSortEl(el) {\n        el.classed('active', false);\n        el.select('.icon-sort-desc').classed('visible', false);\n        el.select('.icon-sort-asc').classed('visible', false);\n        el.select('.icon-unsort').classed('visible', true);\n      }\n\n      // toggleOptions () {\n      //   console.log('Toggle options');\n      // }\n\n    }, {\n      key: 'switch',\n      value: function _switch() {\n        this.el.classed('details', !this.el.classed('details'));\n      }\n    }, {\n      key: 'switchBarMode',\n      value: function switchBarMode(el, mode) {\n        if (this.vis.nodes.barMode !== mode) {\n          if (mode === 'one') {\n            this.globalOneBar.classed('active', true);\n            this.globalTwoBars.classed('active', false);\n          } else {\n            this.globalOneBar.classed('active', false);\n            this.globalTwoBars.classed('active', true);\n          }\n          this.vis.switchBarMode(mode);\n        }\n      }\n    }]);\n    return Topbar;\n  })();\n\n  /**\n   * Creates and adds an interpolated exponential SVG gradient to an SVG element.\n   *\n   * @example\n   * ```\n   * exponentialGradient(\n   *   d3.select('svg'),\n   *   {\n   *     color: #fff,\n   *     offset: 10,\n   *     opacity: 0.5,\n   *     x: 0,\n   *     y: 0\n   *   },\n   *   {\n   *     color: #000,\n   *     offset: 10,\n   *     opacity: 1,\n   *     x: 1,\n   *     y: 1\n   *   },\n   *   'myFancyGradient',\n   *   3,\n   *   5\n   * );\n   * ```\n   *\n   * @method  exponentialGradient\n   * @author  Fritz Lekschas\n   * @date    2015-12-30\n   * @param   {Object}  el     Element to which the `def` gradient should be\n   *   added to.\n   * @param   {Object}  start  Start properies.\n   * @param   {Object}  end    End properies.\n   * @param   {String}  name   Name of the gradient.\n   * @param   {Number}  power  Exponential power.\n   * @param   {Number}  steps  Interpolation steps.\n   */\n  function exponentialGradient(el, start, end, name, power, steps) {\n    var scale = d3.scale.pow().exponent(power || 2);\n    var stepSize = 1 / ((steps || 0) + 1);\n\n    var gradient = el.append('defs').append('linearGradient').attr('id', name).attr('x1', start.x).attr('y1', start.y).attr('x2', end.x).attr('y2', end.y).attr('spreadMethod', 'pad');\n\n    gradient.append('stop').attr('offset', start.offset + '%').attr('stop-color', start.color).attr('stop-opacity', start.opacity);\n\n    for (var i = 0; i < steps; i++) {\n      gradient.append('stop').attr('offset', start.offset + i * stepSize * (end.offset - start.offset) + '%').attr('stop-color', end.color).attr('stop-opacity', start.opacity + scale(i * stepSize) * (end.opacity - start.opacity));\n    }\n\n    gradient.append('stop').attr('offset', end.offset + '%').attr('stop-color', end.color).attr('stop-opacity', end.opacity);\n  }\n\n  /**\n   * Checks if `value` is object-like.\n   *\n   * @private\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n   */\n  function isObjectLike(value) {\n    return !!value && typeof value == 'object';\n  }\n\n  /** Used to detect host constructors (Safari > 5). */\n  var reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n  /** Used for native method references. */\n  var objectProto$2 = Object.prototype;\n\n  /** Used to resolve the decompiled source of functions. */\n  var fnToString = Function.prototype.toString;\n\n  /** Used to check objects for own properties. */\n  var hasOwnProperty = objectProto$2.hasOwnProperty;\n\n  /** Used to detect if a method is native. */\n  var reIsNative = RegExp('^' +\n    fnToString.call(hasOwnProperty).replace(/[\\\\^$.*+?()[\\]{}|]/g, '\\\\$&')\n    .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n  );\n\n  /**\n   * Checks if `value` is a native function.\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is a native function, else `false`.\n   * @example\n   *\n   * _.isNative(Array.prototype.push);\n   * // => true\n   *\n   * _.isNative(_);\n   * // => false\n   */\n  function isNative(value) {\n    if (value == null) {\n      return false;\n    }\n    if (isFunction(value)) {\n      return reIsNative.test(fnToString.call(value));\n    }\n    return isObjectLike(value) && reIsHostCtor.test(value);\n  }\n\n  /**\n   * Gets the native function at `key` of `object`.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @param {string} key The key of the method to get.\n   * @returns {*} Returns the function if it's native, else `undefined`.\n   */\n  function getNative(object, key) {\n    var value = object == null ? undefined : object[key];\n    return isNative(value) ? value : undefined;\n  }\n\n  /**\n   * Used as the [maximum length](http://ecma-international.org/ecma-262/6.0/#sec-number.max_safe_integer)\n   * of an array-like value.\n   */\n  var MAX_SAFE_INTEGER = 9007199254740991;\n\n  /**\n   * Checks if `value` is a valid array-like length.\n   *\n   * **Note:** This function is based on [`ToLength`](http://ecma-international.org/ecma-262/6.0/#sec-tolength).\n   *\n   * @private\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n   */\n  function isLength(value) {\n    return typeof value == 'number' && value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n  }\n\n  /** `Object#toString` result references. */\n  var arrayTag = '[object Array]';\n\n  /** Used for native method references. */\n  var objectProto$1 = Object.prototype;\n\n  /**\n   * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n   * of values.\n   */\n  var objToString$1 = objectProto$1.toString;\n\n  /* Native method references for those with the same name as other `lodash` methods. */\n  var nativeIsArray = getNative(Array, 'isArray');\n\n  /**\n   * Checks if `value` is classified as an `Array` object.\n   *\n   * @static\n   * @memberOf _\n   * @category Lang\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n   * @example\n   *\n   * _.isArray([1, 2, 3]);\n   * // => true\n   *\n   * _.isArray(function() { return arguments; }());\n   * // => false\n   */\n  var isArray = nativeIsArray || function(value) {\n    return isObjectLike(value) && isLength(value.length) && objToString$1.call(value) == arrayTag;\n  };\n\n  var LayoutNotAvailable = (function (_ExtendableError) {\n    babelHelpers.inherits(LayoutNotAvailable, _ExtendableError);\n\n    function LayoutNotAvailable(message) {\n      babelHelpers.classCallCheck(this, LayoutNotAvailable);\n      return babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(LayoutNotAvailable).call(this, message || 'D3.layout.listGraph.js has not been loaded yet.'));\n    }\n\n    return LayoutNotAvailable;\n  })(ExtendableError);\n\n  var EventDispatcherNoFunction = (function (_ExtendableError2) {\n    babelHelpers.inherits(EventDispatcherNoFunction, _ExtendableError2);\n\n    function EventDispatcherNoFunction(message) {\n      babelHelpers.classCallCheck(this, EventDispatcherNoFunction);\n      return babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(EventDispatcherNoFunction).call(this, message || 'Dispatcher needs to be a function.'));\n    }\n\n    return EventDispatcherNoFunction;\n  })(ExtendableError);\n\n  var Events = (function () {\n    function Events(el, broadcast) {\n      babelHelpers.classCallCheck(this, Events);\n\n      if (broadcast && !isFunction(broadcast)) {\n        throw new EventDispatcherNoFunction();\n      }\n\n      this.el = el;\n      this._stack = {};\n      this.dispatch = broadcast ? broadcast : this._dispatchEvent;\n    }\n\n    babelHelpers.createClass(Events, [{\n      key: '_dispatchEvent',\n      value: function _dispatchEvent(eventName, data) {\n        var event = document.createEvent('CustomEvent');\n        event.initCustomEvent(eventName, false, false, data);\n        this.el.dispatchEvent(event);\n      }\n    }, {\n      key: 'broadcast',\n      value: function broadcast(event, data) {\n        this.dispatch(event, data);\n      }\n\n      /**\n       * Add a callback function to an event stack.\n       *\n       * @method  on\n       * @author  Fritz Lekschas\n       * @date    2016-01-07\n       *\n       * @param   {String}    event     Event identifier.\n       * @param   {Function}  callback  Function which is called when the event\n       *   stack is triggered.\n       * @param   {Number}    times     Number of times the callback function should\n       *   be triggered before it is removed from the event stack. This is useful\n       *   when an event happens only a certain number of times.\n       * @return  {Number}              Index of callback, which is needed to\n       *   manually remove the callback from the event stack.\n       */\n\n    }, {\n      key: 'on',\n      value: function on(event, callback, times) {\n        if (!isFunction(callback)) {\n          return false;\n        }\n\n        var normTimes = isFinite(times) ? parseInt(times, 10) : Infinity;\n\n        if (isArray(this.stack[event])) {\n          return this.stack[event].push({ callback: callback, times: normTimes }) - 1;\n        }\n        this.stack[event] = [{ callback: callback, times: normTimes }];\n        return 0;\n      }\n\n      /**\n       * Removes a callback function from an event stack given its index.\n       *\n       * @method  off\n       * @author  Fritz Lekschas\n       * @date    2016-01-07\n       *\n       * @param   {String}   event  Event identifier.\n       * @param   {Number}   index  Index of the callback to be removed.\n       * @return  {Boolean}         Returns `true` if event callback was found and\n       *   successfully removed.\n       */\n\n    }, {\n      key: 'off',\n      value: function off(event, index) {\n        try {\n          this.stack[event].splice(index, 1);\n          return true;\n        } catch (e) {\n          return false;\n        }\n      }\n\n      /**\n       * Trigger an event stack\n       *\n       * @method  trigger\n       * @author  Fritz Lekschas\n       * @date    2016-01-07\n       *\n       * @param   {String}   event  Event identifier.\n       * @return  {Boolean}         Returns `true` if an event stack was found.\n       */\n\n    }, {\n      key: 'trigger',\n      value: function trigger(event, data) {\n        if (isArray(this.stack[event])) {\n          // Traversing from the end to the start, which has the advantage that\n          // deletion of events, i.e. calling `Event.off()` doesn't affect the index\n          // of event listeners in the next step.\n          for (var i = this.stack[event].length; i--;) {\n            // Instead of checking whether `stack[event][i]` is a function here,\n            // we do it just once when we add the function to the stack.\n            if (this.stack[event][i].times--) {\n              this.stack[event][i].callback(data);\n            } else {\n              this.off(event, i);\n            }\n          }\n          return true;\n        }\n        return false;\n      }\n    }, {\n      key: 'stack',\n      get: function get() {\n        return this._stack;\n      }\n    }]);\n    return Events;\n  })();\n\n  var ListGraph = (function () {\n    function ListGraph(baseEl, data, rootNodes, options) {\n      var _this = this;\n\n      babelHelpers.classCallCheck(this, ListGraph);\n\n      if (!d3.layout.listGraph) {\n        throw new LayoutNotAvailable();\n      }\n\n      if (!isObject(options)) {\n        options = {}; // eslint-disable-line no-param-reassign\n      }\n\n      var that = this;\n\n      this.baseEl = baseEl;\n      this.baseElD3 = d3.select(baseEl);\n      this.baseElJq = $(baseEl);\n      this.svgD3 = this.baseElD3.select('svg.base');\n\n      if (this.svgD3.empty()) {\n        this.svgD3 = this.baseElD3.append('svg').attr('class', 'base');\n        this.svgJq = $(this.svgD3[0]);\n      } else {\n        this.svgJq = $(this.svgD3[0]);\n      }\n\n      this.rootNodes = rootNodes;\n\n      this.width = options.width || this.svgJq.width();\n      this.height = options.height || this.svgJq.height();\n      this.scrollbarWidth = options.scrollbarWidth || SCROLLBAR_WIDTH;\n      this.columns = options.columns || COLUMNS;\n      this.rows = options.rows || ROWS;\n      this.iconPath = options.iconPath || ICON_PATH;\n\n      this.lessAnimations = !!options.lessAnimations;\n      this.baseElD3.classed('less-animations', this.lessAnimations);\n\n      this.sortBy = options.sortBy;\n      this.sortOrder = options.sortOrder || DEFAULT_SORT_ORDER;\n\n      this.events = new Events(this.baseEl, options.dispatcher);\n\n      this.baseElJq.addClass(CLASSNAME);\n\n      if (options.forceWidth) {\n        this.baseElJq.width(this.width);\n      }\n\n      this.layout = new d3.layout.listGraph( // eslint-disable-line new-cap\n      [this.width, this.height], [this.columns, this.rows]);\n\n      this.data = data;\n      this.visData = this.layout.process(this.data, this.rootNodes, {\n        sortBy: this.sortBy,\n        sortOrder: this.sortOrder\n      });\n\n      /**\n       * Stores current sorting, e.g. type, order and a reference to the element.\n       *\n       * @type  {Object}\n       */\n      this.currentSorting = {\n        global: {\n          type: this.sortBy,\n          order: this.sortOrder\n        },\n        local: {}\n      };\n\n      exponentialGradient(this.svgD3, {\n        color: COLOR_NEGATIVE_RED,\n        offset: 0,\n        opacity: 0.2,\n        x: 0,\n        y: 0\n      }, {\n        afterOffsetOpacity: 1,\n        color: COLOR_NEGATIVE_RED,\n        offset: 99,\n        opacity: 1,\n        x: 1,\n        y: 0\n      }, 'negativeRed', 4, 10);\n\n      exponentialGradient(this.svgD3, {\n        beforeOffsetOpacity: 1,\n        color: COLOR_POSITIVE_GREEN,\n        offset: 1,\n        opacity: 1,\n        x: 0,\n        y: 0\n      }, {\n        color: COLOR_POSITIVE_GREEN,\n        offset: 100,\n        opacity: 0.2,\n        x: 1,\n        y: 0\n      }, 'positiveGreen', 0.25, 10);\n\n      this.barMode = options.barMode || DEFAULT_BAR_MODE;\n      this.svgD3.classed(this.barMode + '-bar', true);\n\n      this.topbar = new Topbar(this, this.baseElD3, this.visData);\n\n      this.svgD3.attr('viewBox', '0 0 ' + this.width + ' ' + this.height);\n\n      this.container = this.svgD3.append('g').attr('class', 'main-container');\n\n      this.levels = new Levels(this.container, this.visData);\n\n      this.links = new Links(this.levels.groups, this.visData, this.layout);\n      this.nodes = new Nodes(this, this.levels.groups, this.visData, this.links, this.events);\n      this.levels.scrollPreparation(this, this.scrollbarWidth);\n      this.scrollbars = new Scrollbars(this.levels.groups, this.visData, this.scrollbarWidth);\n\n      // jQuery's mousewheel plugin is much nicer than D3's half-baked zoom event.\n      this.$levels = $(this.levels.groups[0]).on('mousewheel', function (event) {\n        that.mousewheelColumn(this, event);\n      });\n\n      // Normally we would reference a named methods but since we need to aceess\n      // the class' `this` property instead of the DOM element we need to use an\n      // arrow function.\n      this.scrollbars.all.on('mousedown', function () {\n        that.scrollbarMouseDown(this, d3.event);\n      });\n\n      // We need to listen to `mouseup` and `mousemove` globally otherwise\n      // scrolling will only work as long as the cursor hovers the actual\n      // scrollbar, which is super annoying.\n      d3.select(document).on('mouseup', function () {\n        _this.globalMouseUp(d3.event);\n      }).on('mousemove', function () {\n        _this.globalMouseMove(d3.event);\n      });\n\n      // Enable dragging of the whole graph.\n      this.svgD3.call(onDragDrop, dragMoveHandler, undefined, [this.container, this.topbar.localControlWrapper], 'horizontal', {\n        x: {\n          min: Math.min(0, this.width - this.container.node().getBBox().width),\n          max: 0\n        }\n      }, [this.scrollbarDragging.bind(this)]);\n    }\n\n    babelHelpers.createClass(ListGraph, [{\n      key: 'scrollbarDragging',\n      value: function scrollbarDragging() {\n        return !!this.activeScrollbar;\n      }\n    }, {\n      key: 'globalMouseUp',\n      value: function globalMouseUp(event) {\n        if (this.activeScrollbar) {\n          var data = this.activeScrollbar.datum();\n          var deltaY = data.scrollbar.clientY - event.clientY;\n\n          // Save final vertical position\n          // Scrollbar\n          data.scrollbar.scrollTop = Math.min(Math.max(data.scrollbar.scrollTop - deltaY, 0), data.scrollbar.scrollHeight);\n\n          // Content\n          data.scrollTop = Math.max(Math.min(data.scrollTop + data.invertedHeightScale(deltaY), 0), -data.scrollHeight);\n\n          this.activeScrollbar.classed('active', false);\n\n          this.activeScrollbar = undefined;\n        }\n      }\n    }, {\n      key: 'globalMouseMove',\n      value: function globalMouseMove(event) {\n        if (this.activeScrollbar) {\n          var data = this.activeScrollbar.datum();\n          var deltaY = data.scrollbar.clientY - event.clientY;\n\n          // Scroll scrollbar\n          ListGraph.scrollY(this.activeScrollbar.node(), Math.min(Math.max(data.scrollbar.scrollTop - deltaY, 0), data.scrollbar.scrollHeight));\n\n          // Scroll content\n          var contentScrollTop = Math.max(Math.min(data.scrollTop + data.invertedHeightScale(deltaY), 0), -data.scrollHeight);\n\n          ListGraph.scrollY(data.nodes, contentScrollTop);\n\n          // Scroll Links\n          this.links.scroll(data.linkSelections.outgoing, this.layout.offsetLinks(data.level, contentScrollTop, 'source'));\n\n          this.links.scroll(data.linkSelections.incoming, this.layout.offsetLinks(data.level - 1, contentScrollTop, 'target'));\n        }\n      }\n    }, {\n      key: 'scrollbarMouseDown',\n      value: function scrollbarMouseDown(el, event) {\n        this.activeScrollbar = d3.select(el).classed('active', true);\n        this.activeScrollbar.datum().scrollbar.clientY = event.clientY;\n      }\n    }, {\n      key: 'mousewheelColumn',\n      value: function mousewheelColumn(el, event) {\n        event.preventDefault();\n\n        var data = d3.select(el).datum();\n\n        if (data.scrollHeight > 0) {\n          // Scroll nodes\n          data.scrollTop = Math.max(Math.min(data.scrollTop + event.deltaY, 0), -data.scrollHeight);\n\n          ListGraph.scrollY(data.nodes, data.scrollTop);\n\n          // Scroll scrollbar\n          data.scrollbar.scrollTop = data.scrollbar.heightScale(-data.scrollTop);\n\n          ListGraph.scrollY(data.scrollbar.el, data.scrollbar.scrollTop);\n\n          // Scroll Links\n          this.links.scroll(data.linkSelections.outgoing, this.layout.offsetLinks(data.level, data.scrollTop, 'source'));\n\n          this.links.scroll(data.linkSelections.incoming, this.layout.offsetLinks(data.level - 1, data.scrollTop, 'target'));\n        }\n      }\n    }, {\n      key: 'selectByLevel',\n      value: function selectByLevel(level, selector) {\n        return d3.select(this.levels.groups[0][level]).selectAll(selector);\n      }\n    }, {\n      key: 'sortColumn',\n      value: function sortColumn(level, property, sortOrder, newSortType) {\n        this.nodes.sort(this.layout.sort(level, property, sortOrder).nodes(level), newSortType);\n        this.links.sort(this.layout.links(level - 1, level + 1));\n      }\n    }, {\n      key: 'switchBarMode',\n      value: function switchBarMode(mode) {\n        this.svgD3.classed('one-bar', mode === 'one');\n        this.svgD3.classed('two-bar', mode === 'two');\n        this.nodes.bars.switchMode(mode, this.currentSorting);\n      }\n    }, {\n      key: 'trigger',\n      value: function trigger(event, data) {\n        this.events.trigger(event, data);\n      }\n    }, {\n      key: 'updateScrollbarVisibility',\n      value: function updateScrollbarVisibility() {\n        this.levels.updateScrollProperties();\n        this.scrollbars.updateVisibility();\n      }\n    }, {\n      key: 'globalView',\n      value: function globalView() {\n        var bBox = this.container.node().getBBox();\n        var width = this.width > bBox.width ? this.width : bBox.width;\n        var height = this.height > bBox.height ? this.height : bBox.height;\n\n        this.svgD3.transition().duration(TRANSITION_SEMI_FAST).attr('viewBox', '0 0 ' + width + ' ' + height);\n      }\n    }, {\n      key: 'zoomedView',\n      value: function zoomedView() {\n        this.svgD3.transition().duration(TRANSITION_SEMI_FAST).attr('viewBox', '0 0 ' + this.width + ' ' + this.height);\n      }\n    }, {\n      key: 'barMode',\n      get: function get() {\n        if (this.bars) {\n          return this.nodes.bars.mode;\n        }\n        return this._barMode;\n      },\n      set: function set(mode) {\n        if (this.bars) {\n          this.nodes.bars.mode = mode;\n        }\n        this._barMode = mode;\n      }\n    }], [{\n      key: 'scrollY',\n      value: function scrollY(el, offset) {\n        d3.select(el).attr('transform', 'translate(0, ' + offset + ')');\n      }\n    }]);\n    return ListGraph;\n  })();\n\n  return ListGraph;\n\n})($,d3);"],"sourceRoot":"/source/"}